(function(){"use strict";var e=function(){return this||(0,eval)("this")}(),r=e.define||e.requirejs&&e.requirejs.define||requirejsVars.define,u="undefined"===typeof window&&!(process&&process.versions);r("wml",["text","View/config","Core/pathResolver","Env/Env"],function(l,f,m,c){function s(e,r){c.IoC.resolve("ILogger").error(r+"!",e.message,e);var i=function(){return"<div>"+e.message+"</div>"};return i.stable=true,i.includedFunctions={},i}function n(r,e,i,n,t,o){try{if(!n.fileName)n.fileName=r;i.getFile(e,n,function(e){t.fromTextFixed?t.fromTextFixed(e):t.fromText(e),t=void 0},void 0,o)}catch(e){e.message='Error while parsing template "'+r+'": '+e.message,t(s(e,o)),t=void 0}}function d(i,e,n,t,o,s,a){var r=function(r){if(r&&0===r.indexOf("define"))n.fromTextFixed?n.fromTextFixed(r):n.fromText(r);else try{e(s,function(e){a(i,r,e.Tmpl,t,n,o)})}catch(e){e.message='Error while loading builder for template "'+i+'": '+e.message,n.error(e)}};return r.error=function(e){e.message='Error while loading template "'+i+'": '+e.message,n.error(e)},r}var t={loadBase:function(r,e,i,n,t,o){try{var s=m(r,n,true),a={config:f,filename:s};if(u&&"release"===c.constants.buildMode&&c.constants.isNodePlatform)s=(s=s.replace(/(\.min)?\.tmpl$/,".min.tmpl")).replace(/(\.min)?\.wml/,".min.wml");l.load(s,e,d(r,e,i,a,n,t,o),a)}catch(e){e.message='Error while resolving template "'+r+'": '+e.message,i.error(e)}},load:function(e,r,i){t.loadBase(e,r,i,"wml",["View/Builder"],n)},createLostFunction:s,createLoader:d};return t})})();