if(_bigCalc=function(){if(!Array.prototype.map)Array.map=function(e,t){var n=e.length>>>0;if("function"!==typeof t)throw new TypeError;for(var r=new Array(n),i=arguments[2],o=0;o<n;o++)if(o in e)r[o]=t.call(i,e[o],o,e);return r};if(!Array.indexOf)Array.indexOf=function(e,t){if(!(e instanceof Array))throw new TypeError("Incorrect type of the first arguments. Array expected");if([].indexOf)return e.indexOf(t,arguments[2]);var n=e.length,r=Number(arguments[2])||0;if((r=r<0?Math.ceil(r):Math.floor(r))<0)r+=n;for(;r<n;r++)if(e[r]===t)return r;return-1};var global=function(){return this||(0,eval)("this")}();function BigInteger(e,t){if(!(this instanceof BigInteger)){if(e instanceof BigInteger)return e;else if("undefined"===typeof e)return BigInteger.ZERO;return BigInteger.parse(e)}this._s=this._d=void 0,e=e||[];while(e.length&&!e[e.length-1])--e.length;this._d=e,this._s=e.length?t||1:0}if(BigInteger.base=1e7,BigInteger.base_log10=7,BigInteger.init=function(){BigInteger.ZERO=new BigInteger([],0),BigInteger.ONE=new BigInteger([1],1),BigInteger.M_ONE=new BigInteger(BigInteger.ONE._d,-1),BigInteger._0=BigInteger.ZERO,BigInteger._1=BigInteger.ONE,BigInteger.small=[BigInteger.ZERO,BigInteger.ONE,new BigInteger([2],1),new BigInteger([3],1),new BigInteger([4],1),new BigInteger([5],1),new BigInteger([6],1),new BigInteger([7],1),new BigInteger([8],1),new BigInteger([9],1),new BigInteger([10],1),new BigInteger([11],1),new BigInteger([12],1),new BigInteger([13],1),new BigInteger([14],1),new BigInteger([15],1),new BigInteger([16],1),new BigInteger([17],1),new BigInteger([18],1),new BigInteger([19],1),new BigInteger([20],1),new BigInteger([21],1),new BigInteger([22],1),new BigInteger([23],1),new BigInteger([24],1),new BigInteger([25],1),new BigInteger([26],1),new BigInteger([27],1),new BigInteger([28],1),new BigInteger([29],1),new BigInteger([30],1),new BigInteger([31],1),new BigInteger([32],1),new BigInteger([33],1),new BigInteger([34],1),new BigInteger([35],1),new BigInteger([36],1)]},BigInteger.init(),BigInteger.digits="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),BigInteger.prototype.toString=function(e){if((e=+e||10)<2||e>36)throw new Error("illegal radix "+e+".");if(0===this._s)return"0";if(10===e){var t=this._s<0?"-":"";t+=this._d[this._d.length-1].toString();for(var n=this._d.length-2;n>=0;n--){var r=this._d[n].toString();while(r.length<BigInteger.base_log10)r="0"+r;t+=r}return t}else{var i=BigInteger.digits;e=BigInteger.small[e];var o=this._s,a=this.abs(),u=[],s;while(0!==a._s){var g=a.divRem(e);a=g[0],s=g[1],u.push(i[s.valueOf()])}return(o<0?"-":"")+u.reverse().join("")}},BigInteger.radixRegex=[/^$/,/^$/,/^[01]*$/,/^[012]*$/,/^[0-3]*$/,/^[0-4]*$/,/^[0-5]*$/,/^[0-6]*$/,/^[0-7]*$/,/^[0-8]*$/,/^[0-9]*$/,/^[0-9aA]*$/,/^[0-9abAB]*$/,/^[0-9abcABC]*$/,/^[0-9a-dA-D]*$/,/^[0-9a-eA-E]*$/,/^[0-9a-fA-F]*$/,/^[0-9a-gA-G]*$/,/^[0-9a-hA-H]*$/,/^[0-9a-iA-I]*$/,/^[0-9a-jA-J]*$/,/^[0-9a-kA-K]*$/,/^[0-9a-lA-L]*$/,/^[0-9a-mA-M]*$/,/^[0-9a-nA-N]*$/,/^[0-9a-oA-O]*$/,/^[0-9a-pA-P]*$/,/^[0-9a-qA-Q]*$/,/^[0-9a-rA-R]*$/,/^[0-9a-sA-S]*$/,/^[0-9a-tA-T]*$/,/^[0-9a-uA-U]*$/,/^[0-9a-vA-V]*$/,/^[0-9a-wA-W]*$/,/^[0-9a-xA-X]*$/,/^[0-9a-yA-Y]*$/,/^[0-9a-zA-Z]*$/],BigInteger.parse=function(e,t){function n(e){return(e=e.replace(/\s*[*xX]\s*10\s*(\^|\*\*)\s*/,"e")).replace(/^([+\-])?(\d+)\.?(\d*)[eE]([+\-]?\d+)$/,function(e,t,n,r,i){var o=(i=+i)<0,a=n.length+i;e=(o?n:r).length,i=(i=Math.abs(i))>=e?i-e+o:0;var u=new Array(i+1).join("0"),s=n+r;return(t||"")+(o?s=u+s:s+=u).substr(0,a+=o?u.length:0)+(a<s.length?"."+s.substr(a):"")})}if(e=e.toString(),"undefined"===typeof t||10===+t)e=n(e);var r=/^([+\-]?)(0[xXcCbB])?([0-9A-Za-z]*)(?:\.\d*)?$/.exec(e);if(r){var i=r[1]||"+",o=r[2]||"",a=r[3]||"";if("undefined"===typeof t)if("0x"===o||"0X"===o)t=16;else if("0c"===o||"0C"===o)t=8;else if("0b"===o||"0B"===o)t=2;else t=10;else if(t<2||t>36)throw new Error("Illegal radix "+t+".");if(t=+t,!BigInteger.radixRegex[t].test(a))throw new Error("Bad digit for radix "+t);if(0===(a=a.replace(/^0+/,"").split("")).length)return BigInteger.ZERO;if(i="-"===i?-1:1,10==t){var u=[];while(a.length>=BigInteger.base_log10)u.push(parseInt(a.splice(Math.max(0,a.length-BigInteger.base_log10),BigInteger.base_log10).join(""),10));return u.push(parseInt(a.join(""),10)),new BigInteger(u,i)}if(t===BigInteger.base)return new BigInteger(Array.map(a,Number).reverse(),i);var u=BigInteger.ZERO;t=BigInteger.small[t];for(var s=BigInteger.small,g=0;g<a.length;g++)u=u.multiply(t).add(s[parseInt(a[g],36)]);return new BigInteger(u._d,i)}else throw new Error("Invalid BigInteger format: "+e)},BigInteger.prototype.add=function(e){if(0===this._s)return BigInteger(e);if(0===(e=BigInteger(e))._s)return this;if(this._s!==e._s)return e=e.negate(),this.subtract(e);for(var t=this._d,n=e._d,r=t.length,i=n.length,o=new Array(Math.max(r,i)+1),a=Math.min(r,i),u=0,s,g=0;g<a;g++)s=t[g]+n[g]+u,o[g]=s%BigInteger.base,u=s/BigInteger.base|0;if(i>r)t=n,r=i;for(g=a;u&&g<r;g++)s=t[g]+u,o[g]=s%BigInteger.base,u=s/BigInteger.base|0;if(u)o[g]=u;for(;g<r;g++)o[g]=t[g];return new BigInteger(o,this._s)},BigInteger.prototype.negate=function(){return new BigInteger(this._d,-this._s)},BigInteger.prototype.abs=function(){return this._s<0?this.negate():this},BigInteger.prototype.subtract=function(e){if(0===this._s)return BigInteger(e).negate();if(0===(e=BigInteger(e))._s)return this;if(this._s!==e._s)return e=e.negate(),this.add(e);var t=this,n;if(this._s<0)n=t,t=new BigInteger(e._d,1),e=new BigInteger(n._d,1);var r=t.compareAbs(e);if(0===r)return BigInteger.ZERO;else if(r<0)n=e,e=t,t=n;var i=t._d,o=e._d,a=i.length,u=o.length,s=new Array(a),g=0,c,l;for(c=0;c<u;c++){if((l=i[c]-g-o[c])<0)l+=BigInteger.base,g=1;else g=0;s[c]=l}for(c=u;c<a;c++){if((l=i[c]-g)<0)l+=BigInteger.base;else{s[c++]=l;break}s[c]=l}for(;c<a;c++)s[c]=i[c];return new BigInteger(s,r)},function(){function e(e,t){var n=e._d,r=n.slice(),i=true,o=0;while(true){var a=(n[o]||0)+1;if(r[o]=a%BigInteger.base,a<=BigInteger.base-1)break;++o}return new BigInteger(r,t)}function t(e,t){var n=e._d,r=n.slice(),i=true,o=0;while(true){var a=(n[o]||0)-1;if(a<0)r[o]=a+BigInteger.base;else{r[o]=a;break}++o}return new BigInteger(r,t)}BigInteger.prototype.next=function(){switch(this._s){case 0:return BigInteger.ONE;case-1:return t(this,-1);default:return e(this,1)}},BigInteger.prototype.prev=function(){switch(this._s){case 0:return BigInteger.M_ONE;case-1:return e(this,-1);default:return t(this,1)}}}(),BigInteger.prototype.compareAbs=function(e){if(this===e)return 0;if(!(e instanceof BigInteger)){if(!isFinite(e))return isNaN(e)?e:-1;e=BigInteger(e)}if(0===this._s)return 0!==e._s?-1:0;if(0===e._s)return 1;var t=this._d.length,n=e._d.length;if(t<n)return-1;else if(t>n)return 1;for(var r=this._d,i=e._d,o=t-1;o>=0;o--)if(r[o]!==i[o])return r[o]<i[o]?-1:1;return 0},BigInteger.prototype.compare=function(e){if(this===e)return 0;if(e=BigInteger(e),0===this._s)return-e._s;if(this._s===e._s){var t;return this.compareAbs(e)*this._s}else return this._s},BigInteger.prototype.isUnit=function(){return this===BigInteger.ONE||this===BigInteger.M_ONE||1===this._d.length&&1===this._d[0]},BigInteger.prototype.multiply=function(e){if(0===this._s)return BigInteger.ZERO;if(0===(e=BigInteger(e))._s)return BigInteger.ZERO;if(this.isUnit()){if(this._s<0)return e.negate();return e}if(e.isUnit()){if(e._s<0)return this.negate();return this}if(this===e)return this.square();var t=this._d.length>=e._d.length,n=(t?this:e)._d,r=(t?e:this)._d,i=n.length,o=r.length,a=i+o,u=new Array(a),s;for(s=0;s<a;s++)u[s]=0;for(s=0;s<o;s++){for(var g=0,c=r[s],l=i+s,f,h=s;h<l;h++)g=(f=u[h]+c*n[h-s]+g)/BigInteger.base|0,u[h]=f%BigInteger.base|0;if(g)g=(f=u[h]+g)/BigInteger.base|0,u[h]=f%BigInteger.base}return new BigInteger(u,this._s*e._s)},BigInteger.prototype.multiplySingleDigit=function(e){if(0===e||0===this._s)return BigInteger.ZERO;if(1===e)return this;var t;if(1===this._d.length){if((t=this._d[0]*e)>=BigInteger.base)return new BigInteger([t%BigInteger.base|0,t/BigInteger.base|0],1);return new BigInteger([t],1)}if(2===e)return this.add(this);if(this.isUnit())return new BigInteger([e],1);for(var n=this._d,r=n.length,i=r+1,o=new Array(i),a=0;a<i;a++)o[a]=0;for(var u=0,s=0;s<r;s++)u=(t=e*n[s]+u)/BigInteger.base|0,o[s]=t%BigInteger.base|0;if(u)u=(t=u)/BigInteger.base|0,o[s]=t%BigInteger.base;return new BigInteger(o,1)},BigInteger.prototype.square=function(){if(0===this._s)return BigInteger.ZERO;if(this.isUnit())return BigInteger.ONE;var e=this._d,t=e.length,n=new Array(t+t+1),r,i,o,a;for(a=0;a<t;a++)o=2*a,i=(r=e[a]*e[a])/BigInteger.base|0,n[o]=r%BigInteger.base,n[o+1]=i;for(a=0;a<t;a++){i=0,o=2*a+1;for(var u=a+1;u<t;u++,o++)i=(r=e[u]*e[a]*2+n[o]+i)/BigInteger.base|0,n[o]=r%BigInteger.base;var s=i+n[o=t+a];i=s/BigInteger.base|0,n[o]=s%BigInteger.base,n[o+1]+=i}return new BigInteger(n,1)},BigInteger.prototype.quotient=function(e){return this.divRem(e)[0]},BigInteger.prototype.divide=BigInteger.prototype.quotient,BigInteger.prototype.remainder=function(e){return this.divRem(e)[1]},BigInteger.prototype.divRem=function(e){if(0===(e=BigInteger(e))._s)throw new Error("Divide by zero");if(0===this._s)return[BigInteger.ZERO,BigInteger.ZERO];if(1===e._d.length)return this.divRemSmall(e._s*e._d[0]);switch(this.compareAbs(e)){case 0:return[this._s===e._s?BigInteger.ONE:BigInteger.M_ONE,BigInteger.ZERO];case-1:return[BigInteger.ZERO,this]}var t=this._s*e._s,n=e.abs(),r=this._d.slice(),i=e._d.length,o=r.length,a=[],u,s=new BigInteger([],1);s._s=1;while(r.length){if(s._d.unshift(r.pop()),(s=new BigInteger(s._d,1)).compareAbs(e)<0){a.push(0);continue}if(0===s._s)u=0;else{var g=s._d.length,c=n._d.length,l=s._d[g-1]*BigInteger.base+s._d[g-2],f=n._d[c-1]*BigInteger.base+n._d[c-2];if(s._d.length>n._d.length)l=(l+1)*BigInteger.base;u=Math.ceil(l/f)}do{var h=n.multiplySingleDigit(u);if(h.compareAbs(s)<=0)break;u--}while(u);if(a.push(u),!u)continue;var p=s.subtract(h);s._d=p._d.slice()}return[new BigInteger(a.reverse(),t),new BigInteger(s._d,this._s)]},BigInteger.prototype.divRemSmall=function(e){var t;if(0===(e=+e))throw new Error("Divide by zero");var n=e<0?-1:1,r=this._s*n;if((e=Math.abs(e))<1||e>=BigInteger.base)throw new Error("Argument out of range");if(0===this._s)return[BigInteger.ZERO,BigInteger.ZERO];if(1===e||-1===e)return[1===r?this.abs():new BigInteger(this._d,r),BigInteger.ZERO];if(1===this._d.length){var i=new BigInteger([this._d[0]/e|0],1);if(t=new BigInteger([this._d[0]%e|0],1),r<0)i=i.negate();if(this._s<0)t=t.negate();return[i,t]}var o=this._d.slice(),a=new Array(o.length),u=0,s=0,g=0,c;while(o.length){if((u=u*BigInteger.base+o[o.length-1])<e){a[g++]=0,o.pop(),s=BigInteger.base*s+u;continue}if(0===u)c=0;else c=u/e|0;var l;if(s=u-e*c,!(a[g++]=c)){o.pop();continue}o.pop(),u=s}if(t=new BigInteger([s],1),this._s<0)t=t.negate();return[new BigInteger(a.reverse(),r),t]},BigInteger.prototype.isEven=function(){var e=this._d;return 0===this._s||0===e.length||e[0]%2===0},BigInteger.prototype.isOdd=function(){return!this.isEven()},BigInteger.prototype.sign=function(){return this._s},BigInteger.prototype.isPositive=function(){return this._s>0},BigInteger.prototype.isNegative=function(){return this._s<0},BigInteger.prototype.isZero=function(){return 0===this._s},BigInteger.prototype.exp10=function(e){if(0===(e=+e))return this;if(Math.abs(e)>Number(BigInteger.MAX_EXP))throw new Error("exponent too large in BigInteger.exp10");if(e>0){for(var t=new BigInteger(this._d.slice(),this._s);e>=BigInteger.base_log10;e-=BigInteger.base_log10)t._d.unshift(0);if(0==e)return t;return t._s=1,t=t.multiplySingleDigit(Math.pow(10,e)),this._s<0?t.negate():t}else if(-e>=this._d.length*BigInteger.base_log10)return BigInteger.ZERO;else{var t=new BigInteger(this._d.slice(),this._s);for(e=-e;e>=BigInteger.base_log10;e-=BigInteger.base_log10)t._d.shift();return 0==e?t:t.divRemSmall(Math.pow(10,e))[0]}},BigInteger.prototype.pow=function(e){if(this.isUnit())if(this._s>0)return this;else return BigInteger(e).isOdd()?this:this.negate();if(0===(e=BigInteger(e))._s)return BigInteger.ONE;else if(e._s<0)if(0===this._s)throw new Error("Divide by zero");else return BigInteger.ZERO;if(0===this._s)return BigInteger.ZERO;if(e.isUnit())return this;if(e.compareAbs(BigInteger.MAX_EXP)>0)throw new Error("exponent too large in BigInteger.pow");var t=this,n=BigInteger.ONE,r=BigInteger.small[2];while(e.isPositive()){if(e.isOdd())if(n=n.multiply(t),e.isUnit())return n;t=t.square(),e=e.quotient(r)}return n},BigInteger.prototype.modPow=function(e,t){var n=BigInteger.ONE,r=this;while(e.isPositive()){if(e.isOdd())n=n.multiply(r).remainder(t);if((e=e.quotient(BigInteger.small[2])).isPositive())r=r.square().remainder(t)}return n},BigInteger.prototype.log=function(){switch(this._s){case 0:return-1/0;case-1:return NaN}var e=this._d.length;if(e*BigInteger.base_log10<30)return Math.log(this.valueOf());var t=Math.ceil(30/BigInteger.base_log10),n=this._d.slice(e-t);return Math.log(new BigInteger(n,1).valueOf())+(e-t)*Math.log(BigInteger.base)},BigInteger.prototype.valueOf=function(){return parseInt(this.toString(),10)},BigInteger.prototype.toJSValue=function(){return parseInt(this.toString(),10)},BigInteger.MAX_EXP=BigInteger(2147483647),function(){function o(t){return function(e){return t.call(BigInteger(e))}}function a(n){return function(e,t){return n.call(BigInteger(e),BigInteger(t))}}function u(r){return function(e,t,n){return r.call(BigInteger(e),BigInteger(t),BigInteger(n))}}(function(){var e,t,n="toJSValue,isEven,isOdd,sign,isZero,isNegative,abs,isUnit,square,negate,isPositive,toString,next,prev,log".split(","),r="compare,remainder,divRem,subtract,add,quotient,divide,multiply,pow,compareAbs".split(","),i=["modPow"];for(e=0;e<n.length;e++)BigInteger[t=n[e]]=o(BigInteger.prototype[t]);for(e=0;e<r.length;e++)BigInteger[t=r[e]]=a(BigInteger.prototype[t]);for(e=0;e<i.length;e++)BigInteger[t=i[e]]=u(BigInteger.prototype[t]);BigInteger.exp10=function(e,t){return BigInteger(e).exp10(t)}})()}(),"undefined"!==typeof exports)exports.BigInteger=BigInteger;var SchemeNumber=function(){var DispatchJs=function(){"use strict";function P(e){return String(e).replace(/(?:.|\n)*(function .*?\(.*?\))(?:.|\n)*/,"$1")}var q=[];function e(h){var e=h.globals,p=e?e.Function:Function,t=p.prototype.bind.bind(p.prototype.call),n=e?e.Object:Object,r=e?e.String:String,d=e?e.Array:Array,v=e?e.Error:Error,_=t(p.prototype.apply),m=t(d.prototype.slice),x=t(d.prototype.join),I=t(d.prototype.push),i=t(d.prototype.unshift),b=t(d.prototype.concat),y=t(r.prototype.replace),N=t(r.prototype.split),B=n.create,w=t(n.prototype.hasOwnProperty),E=t(r.prototype.indexOf),R=Array.indexOf,S=h.methodNamePrefix||"_jsmd",C=y(S,/([\"\\])/g,"\\$1"),O=h.methodNameSeparator||" ",F=B(null);function A(e){if(null!=e){var t=e[S];if("string"===typeof t)if(F[t]&&F[t].ctor===e)return t;else for(t in F)if(F[t]&&F[t].ctor===e)return t}}function T(e){if("string"===typeof e)return e;var t=A(e);if(t)return t;throw v("Class not defined: "+e)}function M(){var t="Abstract method not overridden for ";try{t+=this}catch(e){try{t+=n.prototype.toString.call(this)}catch(e){t+="object"}}throw new v(t)}var o={getConstructor:function(e){return F[e]&&F[e].ctor},defClass:function(t,n){var e,r,i,o,a,u,s,g,c,l,f,h,p,d,_,m;if(n.debug&&console.log("defClass: ",t),n)if(e=n.ctor,n.base)r=T(n.base);if("undefined"===typeof r&&e&&null!=e.prototype)r=A(e.prototype.constructor);if("undefined"!==typeof r)i=F[r].ctor;if(e=e||function(){},"string"!==typeof t)throw v("Usage: defClass(NAME, [OPTS])");if(F[t]){if(F[t].ctor!==e||F[t].base!==r)throw v("Can't redefine class "+t);return e}if(-1!=E(t,O))throw v((" "==O?"Space":"Separator")+" in class name: "+t);if("undefined"!==typeof e[S]){if(e[S]!==t)throw v("Cannot define constructor as "+t+", it was previously defined as "+e[S])}else e[S]=t;if(e.prototype)if(e.prototype.hasOwnProperty("constructor")){if(e.prototype.constructor!==e)throw v("ctor.prototype.constructor is not ctor")}else e.prototype.constructor=e;if(!e.prototype||i&&!(e.prototype instanceof i)){if(o=i?new i:B(null),e.prototype){for(a in e.prototype)if(e.prototype.hasOwnProperty(a))o[a]=e.prototype[a];o.valueOf=e.prototype.valueOf,o.toString=e.prototype.toString}(o.constructor=e).prototype=o}if(F[t]={ctor:e,base:r,sub:[],ename:y(O+t,/([\"\\])/g,"\\$1")},"undefined"!==typeof r){if(u=F[r].sub,-1===R(u,t))I(u,t);for(g in s=O+r,F){if(!w(F,g))continue;for(l in o=F[g].ctor.prototype){if(!w(o,l))continue;if(!E(l,s))continue;if((p=N(l,O))[0]!==S)continue;for(h=o[l],m=[],_=R(p,r,2);-1!==_;_=R(p,r,_+1))I(m,_);(d=function(e){if(e===m.length){if((f=x(p,O))!==l)n.debug&&console.log(g+'["'+f+'"] propagated -> '+P(h)),o[f]=h;return}p[m[e]]=r,d(e+1),p[m[e]]=t,d(e+1)})(0)}}}return e},defGeneric:function(r,i,o){if(-1!=E(r,O))throw v((" "==O?"Space":"Separator")+" in function name: "+r);if(o=o||i,""==r||i<1||i!=(0|i)||o<1||o!=(0|o))throw Error("Usage: defGeneric(NAME, NDISP [, NARGS])");for(var a=y(O+r,/([\"\\])/g,"\\$1"),e=C+a,n=q.length;n<o;n++)q[n]="a"+n;var t=m(q,0,o);I(t,"return "+q[i-1]+'["'+e+'"]('+x(b(m(t,0,i-1),m(t,i,o)),",")+")");var u=_(p,null,t),s=B(null);function f(e,t){var n=x(m(t,e),"");if(!s[n]){var r=C+a+n,i=b(m(q,0,e),m(q,e+1,o));I(i,"return "+q[e-1]+'["'+r+'"]('+x(b(m(q,0,e-1),"this",m(q,e+1,o)),",")+")"),s[n]=_(p,null,i)}return s[n]}function g(){switch(i){case 1:return"TYPE";case 2:return"TYPE1, TYPE2";case 3:return"TYPE1, TYPE2, TYPE3";default:return"TYPE1, ..., TYPE"+i}}function c(){var e=arguments[i]||M;if("function"!==typeof e)throw v("Not a function.  Usage: "+r+".def("+g()+", FUNCTION)");var t=m(arguments,0,i);for(n=0;n<i;n++)t[n]=T(t[n]);l(t,e,B(null))}function l(o,e,a){var u=new d(i),s=new d(i),t,n,g,c;for(t=0;t<i;t++)u[t]=F[o[t]],s[t]=u[t].ename;for(h.debug&&console.log("do_def",r,s),g=new Array(i),t=i-1,n="";;t--){if(g[t]=u[t].ctor.prototype[S+O+r+n],0===t)break;n=s[t]+n}for((c=new d(i))[0]=e,t=1;t<i;t++)c[t]=f(t,s);function l(t,n){var e,r=u[t].ctor.prototype;if(r[n]&&r[n]!==g[t])return void(h.debug&&console.log("Skipping "+t+" "+o[t]+'["'+n+'"] '+P(r[n])+"!="+P(g[t])));if(r===Object.prototype)throw Error("BUG: code would modify Object.prototype.");if(r[n]!==c[t])if((e=o[t]+O+n)in a&&c[t]===a[e])h.debug&&console.log(s[t]+'["'+n+'"] '+P(r[n])+" -> DELETED"),delete r[n];else{if(h.debug&&console.log(s[t]+'["'+n+'"] '+P(r[n])+" -> "+P(c[t])),!w(r,n))a[e]=r[n];r[n]=c[t]}if(0===t)return;function i(e){l(t-1,n+O+e),F[e].sub.forEach(i)}i(o[t])}l(i-1,S+O+r)}return u.def=c,u}};if(h.debug)o.classes=F;return o}var t=e(Object.create(null));return t.makeContext=e,t}();function PluginContainer(e){"use strict";if(!(this instanceof PluginContainer))throw Error("Usage: new PluginContainer()");var n=this,r=[],i=Object.create(null);function o(e,t,n){var r=false;for(var i in e){if(void 0!==t[i]&&t[i]!==e[i])throw Error("Conflicting changes to "+i);if(n)n[i]=e[i];t[i]=e[i],r=true}return r}var a={fire:function(t){function e(e){e.call(e,n,t)}r.forEach(e)},subscribe:function(e){r.push(e)},unsubscribe:function(t){function e(e){return e!==t}r=r.filter(e)}};if(n.onChange=a,n.extend=function(){var e=Object.create(null),t=arguments[0],n;if("object"!==typeof t){if(1&arguments.length)throw Error("extend: Wrong argument types");for(t=Object.create(null),n=0;n<arguments.length;n+=2){if(arguments[n]in t)throw Error("extend: "+arguments[n]+" given more than once");t[arguments[n]]=arguments[n+1]}}if(o(t,i,e))a.fire(e)},n.get=function(e){return i[e]},n.list=function(){return Object.keys(i)},e)n.extend(e)}function assert(e){if(!e)throw new Error("assertion failed")}function getEs5Globals(){return{NaN:NaN,Infinity:1/0,undefined:void 0,eval:eval,parseInt:parseInt,parseFloat:parseFloat,isNaN:isNaN,isFinite:isFinite,decodeURI:decodeURI,decodeURIComponent:decodeURIComponent,encodeURI:encodeURI,encodeURIComponent:encodeURIComponent,Object:Object,Function:Function,Array:Array,String:String,Boolean:Boolean,Number:Number,Date:Date,RegExp:RegExp,Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError,Math:Math,JSON:JSON}}function implementUncurry(e){var t=e.get("es5globals"),n=t.Object.create(null);return n.uncurry=t.Function.prototype.bind.bind(t.Function.prototype.call),n}function defineGenericFunctions(e){"use strict";var t=e.get("es5globals"),r=e.get("Dispatch"),i=t.Object.create(null);function n(e,t,n){i[e]=r.defGeneric(e,t,n)}return n("toSchemeNumber",1),n("numberToString",1,3),n("isExact",1),n("isInexact",1),n("isComplex",1),n("isReal",1),n("isRational",1),n("isInteger",1),n("isZero",1),n("toExact",1),n("toInexact",1),n("negate",1),n("reciprocal",1),n("eq",2),n("ne",2),n("add",2),n("subtract",2),n("multiply",2),n("divide",2),n("square",1),n("realPart",1),n("imagPart",1),n("magnitude",1),n("angle",1),n("conjugate",1),n("expt",2),n("exp",1),n("sqrt",1),n("log",1),n("asin",1),n("acos",1),n("atan",1),n("sin",1),n("cos",1),n("tan",1),n("SN_isFinite",1),n("SN_isInfinite",1),n("SN_isNaN",1),n("isUnit",1),n("abs",1),n("isPositive",1),n("isNegative",1),n("sign",1),n("floor",1),n("ceiling",1),n("truncate",1),n("round",1),n("compare",2),n("gt",2),n("lt",2),n("ge",2),n("le",2),n("divAndMod",2),n("div",2),n("mod",2),n("atan2",2),n("numerator",1),n("denominator",1),n("numeratorAndDenominator",1),n("isEven",1),n("isOdd",1),n("exactIntegerSqrt",1),n("exp10",1,2),n("gcdNonnegative",2),n("divideReduced",2),n("bitwiseNot",1),n("bitwiseAnd",2),n("bitwiseIor",2),n("bitwiseXor",2),n("bitCount",1),n("bitLength",1),n("firstBitSet",1),n("isBitSet",1,2),n("copyBit",1,3),n("bitField",1,3),n("copyBitField",2,4),n("bitShift",1,2),n("rotateBitField",1,4),n("reverseBitField",1,3),i}function defineSchemeNumberType(e){"use strict";var t=e.get("es5globals"),n=t.NaN,r=t.Object.create(null),i=e.get("numberToString"),o=e.get("Dispatch");function a(){}function u(e){if(i)return i(this,e);return"[object SchemeNumber]"}function s(){return u()}function g(){return n}function c(){if(i)return i(this);return"SchemeNumber"}return(a.prototype=new Number).toFixed=c,a.prototype.toExponential=c,a.prototype.toPrecision=c,a.prototype.toString=u,a.prototype.toLocaleString=s,a.prototype.valueOf=g,o.defClass("SchemeNumber",{ctor:a}),r.SchemeNumberType=a,r}function defineDebugFunction(e){"use strict";var t=e.get("es5globals"),n=e.get("uncurry"),r=e.get("Dispatch"),i=e.get("SchemeNumberType"),o=n(t.Object.prototype.toString),a=t.Object.create(null);function u(){var t;try{t=this.toString()}catch(e){try{t=o(this)}catch(e){t="?"}}return"SchemeNumber("+t+")"}return a.debug=r.defGeneric("debug",1),a.debug.def(i,u),a}function implementCoreLibrary(e){"use strict";var t,n,r,i,o,a,u,s,g,c,l,m,f,h,p,d,_,v,x,I,b,y,N,B,w,E,R,S,C,O,F,F,A,T,M,P,q,Z,D,U,$,j,k,L,X,G,Y,z,W,J,V,Q,H,K,ee,te,ne,re,ie,oe,ae,ue,se,ge,ce,le,fe,he,pe,de,_e,me,ve,xe,Ie,be,ye,Ne,Be,we,Ee,Re,Se,Ce,Oe,Fe,Ae,Te,Me,Pe,qe,Ze,De;t=e.get("SchemeNumber"),r=e.get("SchemeNumberType"),i=e.get("Complex"),o=e.get("Real"),a=e.get("InexactReal"),u=e.get("ExactReal"),s=e.get("ExactRational"),g=e.get("ExactInteger"),n=e.get("toSchemeNumber"),c=e.get("numberToString"),l=e.get("isExact"),m=e.get("isInexact"),f=e.get("isComplex"),h=e.get("isReal"),p=e.get("isRational"),d=e.get("isInteger"),_=e.get("isZero"),v=e.get("toExact"),x=e.get("toInexact"),I=e.get("negate"),b=e.get("reciprocal"),y=e.get("eq"),N=e.get("ne"),B=e.get("add"),w=e.get("subtract"),E=e.get("multiply"),R=e.get("divide"),S=e.get("square"),C=e.get("realPart"),O=e.get("imagPart"),F=e.get("expt"),F=e.get("expt"),A=e.get("exp"),T=e.get("magnitude"),M=e.get("angle"),P=e.get("sqrt"),q=e.get("log"),Z=e.get("asin"),D=e.get("acos"),U=e.get("atan"),$=e.get("sin"),j=e.get("cos"),k=e.get("tan"),L=e.get("SN_isFinite"),X=e.get("SN_isInfinite"),G=e.get("SN_isNaN"),Y=e.get("isUnit"),z=e.get("abs"),W=e.get("isPositive"),J=e.get("isNegative"),V=e.get("sign"),Q=e.get("floor"),H=e.get("ceiling"),K=e.get("truncate"),ee=e.get("round"),te=e.get("compare"),ne=e.get("gt"),re=e.get("lt"),ie=e.get("ge"),oe=e.get("le"),ae=e.get("divAndMod"),ue=e.get("div"),se=e.get("mod"),ge=e.get("atan2"),ce=e.get("numerator"),le=e.get("denominator"),fe=e.get("numeratorAndDenominator"),he=e.get("isEven"),pe=e.get("isOdd"),de=e.get("exp10"),_e=e.get("gcdNonnegative"),me=e.get("divideReduced");var Ue=e.get("es5globals"),$e=e.get("uncurry"),je=$e(Ue.Array.prototype.slice),ke=$e(Ue.Array.prototype.join),Le=$e(Ue.Number.prototype.toString),Xe=$e(Ue.String.prototype.indexOf),Ge=$e(Ue.String.prototype.substring),Ye=$e(Ue.String.prototype.replace),ze=$e(Ue.RegExp.prototype.test),We=Ue.Math.LN10,Je=Ue.Math.LN2,Ve=Ue.Math.PI,Qe=Ue.Math.abs,He=Ue.Math.floor,Ke=Ue.Math.pow,et=Ue.Math.LN2,tt=Ue.Math.LN10,nt=Ue.Math.PI,rt=Ue.undefined,it=Ue.Infinity,ot=Ue.NaN,at=Ue.parseInt,ut=Ue.isNaN,st=Ue.isFinite,gt=Ue.Object.create(null);function ct(e,t){function n(e,t){try{return Ne(be(e),be(t))}catch(e){return rt}}be=e.get("nativeToExactInteger"),Ie=e.get("parseExactInteger"),ve=e.get("nativeToInexact"),xe=e.get("parseInexact"),ye=e.get("divideReducedNotByOne"),Ne=e.get("exactRectangular"),Be=e.get("inexactRectangular"),we=e.get("exactPolar"),Ee=e.get("inexactPolar");var r=Ue.Object.create(null);if(t.nativeToExactInteger||t.exactRectangular)Fe=r.I=n(0,1),Ae=r.MINUS_I=n(0,-1);if(t.nativeToExactInteger)Re=r.ZERO=be(0),Se=r.ONE=be(1),Ce=r.TWO=be(2),Oe=r.MINUS_ONE=be(-1);if(t.nativeToInexact)Te=r.INEXACT_ZERO=ve(0),Me=r.INEXACT_ONE=ve(1),Pe=r.PI=ve(Ve),qe=r.INFINITY=ve(it),Ze=r.MINUS_INFINITY=ve(-it),De=r.NAN=ve(ot);e.extend(r)}function lt(){return false}function ft(){return true}function ht(){return this}function pt(){return Re}function dt(){return Se}function _t(e){return e}function mt(e,t){if(m(e))return Be(e,x(t));if(m(t))return Be(x(e),t);return Ne(e,t)}function vt(e,t){if(m(e))return Ee(e,x(t));if(m(t))return Ee(x(e),t);return we(e,t)}function xt(e,t,n){var r,i,o="SchemeNumber: "+e+": "+t;if(arguments.length>2){o+=": ",r=2;while(true){i=arguments[r];try{o+=c(i)}catch(e){try{o+=i}catch(e){o+="?"}}if(++r===arguments.length)break;o+=", "}}throw new Ue.Error(o)}function It(){var e=je(arguments);t.raise.apply(t,e),xt.apply(this,e)}function bt(){It("&assertion","division by exact zero")}function yt(e,t,n){if(false===e||!h(e))lose();if(!_(e)){var r=z(e),i=t-He(q(r)/Je)-1,o=F(Ce,be(Qe(i)));if(i<0)o=b(o);var a=E(r,o),u=F(Ce,be(t));while(ie(a,u))a=R(a,Ce),o=R(o,Ce);for(var s=B(a,a);re(s,u);s=B(a,a))a=s,o=B(o,o);var g=R(ee(a),o);if(J(e))g=I(g);e=g}if(!n)e=x(e);return e}function Nt(e){if(!h(e))It("&assertion","not a real number",e);return e}function Bt(e){return e=t(e),h(e)||Nt(e),e}function wt(e){if(!p(e))It("&assertion","not a rational number",e);return e}function Et(e){return e=t(e),p(e)||wt(e),e}function Rt(e){if(e=t(e),!d(e))It("&assertion","not an integer",e);return e}function St(e){return e=t(e),d(e)||Rt(e),e}function Ct(e){if(m(e))It("&assertion","inexact number",e);return e}function Ot(e){return e instanceof r}e.onChange.subscribe(ct),ct(e,{});var Ft=/^(.*[^a-zA-Z]|)([-+].*)i$/,At=/^(.*)([-+].*)i$/,Tt=/^[-+](nan|inf)\.0$/,Mt=/[eEsSfFdDlL]/,Pt=/^([0-9]+\.?|[0-9]*\.[0-9]+)([eEsSfFdDlL][-+]?[0-9]+)?$/,qt={2:/^[01]+$/,8:/^[0-7]+$/,10:/^[0-9]+$/,16:/^[0-9a-fA-F]+$/},Zt=new Ue.Object;function Dt(t,l,f){function h(){throw Zt}function p(e){return false===e?h():e}function e(e){if(f!==rt)h();f=e}function n(e){if(l)h();l=e}function d(e,t){if(!ze(qt[l],e))h();if(false===f){if(10===l)return xe(t,e);return x(Ie(t,e,l))}return Ie(t,e,l)}function _(e){if(ze(Tt,e)){if(f)h();switch(e){case"+inf.0":return qe;case"-inf.0":return Ze;default:return De}}var t=1;switch(e[0]){case"-":t=-1;case"+":e=Ge(e,1)}var n=Xe(e,"/");if(-1!=n)return R(d(Ge(e,0,n),t),d(Ge(e,n+1),1));if(10!==l)return d(e,t);var r=Xe(e,"|");if(-1!==r){var i=Ge(e,r+1);if(!ze(qt[10],i))h();e=Ge(e,0,r);var o=at(i,10);if(0===o)e="0.0";else if(o<53)return p(yt(Dt(e,l,true),o,f))}e=Ye(e,Mt,"e");var a=Xe(e,"."),u=Xe(e,"e");if(-1===a&&-1===u)return d(e,t);if(!ze(Pt,e))h();if(!f)return xe(t,e);var s=Ge(e,0,-1===a?u:a),g=Re,c;if(-1===u)c=Ge(e,a+1);else{if(-1===a)c="";else c=Ge(e,a+1,u);g=_(Ge(e,u+1))}return de(Ie(t,s+c),w(g,be(c.length)))}function r(e){var t=Xe(e,"@");if(-1!==t){var n=vt(_(Ge(e,0,t)),_(Ge(e,t+1)));if(f&&m(n))n=n;return n}if("i"!==e[e.length-1])return _(e);if("i"===e){if(false===f)return Be(Te,Me);return Fe}if("-i"===e){if(false===f)return Be(Te,I(Me));return Ae}var r=(10===l?Ft:At).exec(e),i,o;if(r)i=r[1],o=r[2],i=i?_(i):false===f?Te:Re,o="+"===o?Se:"-"===o?Oe:_(o);else i=false===f?Te:Re,o=_(Ge(e,0,e.length-1));return mt(i,o)}if(!l||10===l)if(ze(/^-?[0-9]{1,15}$/,t)){if(false===f)return ve(at(t,10));return be(at(t,10))}var i=0;try{while("#"===t[i]){switch(t[i+1]){case"i":case"I":e(false);break;case"e":case"E":e(true);break;case"b":case"B":n(2);break;case"o":case"O":n(8);break;case"d":case"D":n(10);break;case"x":case"X":n(16);break;default:return false}i+=2}return l=l||10,r(Ge(t,i))}catch(e){if(e===Zt)return false;if(t==rt)It("&assertion","missing argument");throw e}}return gt.I=Fe,gt.ZERO=Re,gt.ONE=Se,gt.TWO=Ce,gt.MINUS_ONE=Oe,gt.INEXACT_ZERO=Te,gt.INEXACT_ONE=Me,gt.PI=Pe,gt.INFINITY=qe,gt.MINUS_INFINITY=Ze,gt.NAN=De,gt.raise=It,gt.defaultRaise=xt,gt.raiseDivisionByExactZero=bt,gt.stringToNumber=Dt,gt.isNumber=Ot,gt.assertReal=Nt,gt.toReal=Bt,gt.assertRational=wt,gt.toRational=Et,gt.assertInteger=Rt,gt.toInteger=St,gt.assertExact=Ct,gt.makeRectangular=mt,gt.makePolar=vt,gt.truncateToPrecision=yt,gt.retFalse=lt,gt.retTrue=ft,gt.retThis=ht,gt.retZero=pt,gt.retOne=dt,gt.retFirst=_t,gt}function implementRnrsBase(e){var t=e.get("es5globals"),n,l,r,f,u,s,h,p,g,i,d,c,o,a,_,m,v,x,I,b,y,N,B,w,E,R,S,C,O,F,A,T,M,P,q,Z,D,U,$,j,k,L,X,G,Y,z,W,J,V,Q,H,K,ee,te,ne,re,ie,oe,ae,ue,se,ge,ce,le,fe,he,pe,de,_e,me,ve,xe,Ie,be,ye=e.get("uncurry")(t.Array.prototype.push);function Ne(e){f=e.get("ZERO"),u=e.get("ONE"),s=e.get("MINUS_ONE"),h=e.get("INEXACT_ZERO"),p=e.get("NAN"),g=e.get("raise"),i=e.get("isNumber"),d=e.get("assertReal"),c=e.get("toReal"),o=e.get("toRational"),a=e.get("toInteger"),_=e.get("assertExact"),m=e.get("makeRectangular"),v=e.get("makePolar")}l=e.get("SchemeNumber"),x=e.get("numberToString"),I=e.get("isExact"),b=e.get("isInexact"),y=e.get("isComplex"),N=e.get("isReal"),B=e.get("isRational"),w=e.get("isInteger"),E=e.get("isZero"),R=e.get("toExact"),S=e.get("toInexact"),C=e.get("negate"),O=e.get("reciprocal"),F=e.get("eq"),A=e.get("ne"),T=e.get("add"),M=e.get("subtract"),P=e.get("multiply"),q=e.get("divide"),Z=e.get("realPart"),D=e.get("imagPart"),U=e.get("expt"),$=e.get("exp"),j=e.get("magnitude"),k=e.get("angle"),L=e.get("sqrt"),X=e.get("log"),G=e.get("asin"),Y=e.get("acos"),z=e.get("atan"),W=e.get("sin"),J=e.get("cos"),V=e.get("tan"),Q=e.get("SN_isFinite"),H=e.get("SN_isInfinite"),K=e.get("SN_isNaN"),ee=e.get("abs"),te=e.get("isPositive"),ne=e.get("isNegative"),re=e.get("floor"),ie=e.get("ceiling"),oe=e.get("truncate"),ae=e.get("round"),ue=e.get("compare"),se=e.get("gt"),ge=e.get("lt"),ce=e.get("ge"),le=e.get("le"),fe=e.get("divAndMod"),he=e.get("div"),pe=e.get("mod"),de=e.get("atan2"),_e=e.get("numerator"),me=e.get("denominator"),ve=e.get("isEven"),xe=e.get("isOdd"),Ie=e.get("exactIntegerSqrt"),be=e.get("gcdNonnegative"),r=e.get("stringToNumber"),e.onChange.subscribe(Ne),Ne(e);var Be={"eqv?":Oe,"number?":Fe,"complex?":Ae,"real?":Te,"rational?":Me,"integer?":Pe,"real-valued?":qe,"rational-valued?":Ze,"integer-valued?":De,"exact?":$e(l,I),"inexact?":$e(l,b),inexact:$e(l,S),exact:$e(l,R),"=":Ue,"<":je(ge),">":je(se),"<=":je(le),">=":je(ce),"zero?":$e(l,E),"positive?":$e(c,te),"negative?":$e(c,ne),"odd?":$e(a,xe),"even?":$e(a,ve),"finite?":$e(c,Q),"infinite?":$e(c,H),"nan?":$e(c,K),max:ke(se),min:ke(ge),"+":function(){var e=f,t=arguments.length,n=0;while(n<t)e=T(e,l(arguments[n++]));return e},"*":function(){var e=u,t=arguments.length,n=0;while(n<t)e=P(e,l(arguments[n++]));return e},"-":function(e){var t=arguments.length;switch(t){case 0:Se(arguments);case 1:return C(l(e))}var n=l(e),r=1;while(r<t)n=M(n,l(arguments[r++]));return n},"/":function(e){var t=arguments.length;switch(t){case 0:Se(arguments);case 1:return O(l(e));case 2:return q(l(e),l(arguments[1]))}var n=u,r=1;while(r<t)n=P(n,l(arguments[r++]));return q(l(e),n)},abs:$e(c,ee),"div-and-mod":Le(false,2),div:Le(false,0),mod:Le(false,1),"div0-and-mod0":Le(true,2),div0:Le(true,0),mod0:Le(true,1),gcd:function(){for(var e=f,t=arguments.length,n=true,r=0;r<t;r++){var i=a(arguments[r]);n=n&&I(i),e=be(e,R(ee(i)))}return e=ee(e),n?e:S(e)},lcm:function(){for(var e=u,t=arguments.length,n=true,r=0;r<t;r++){var i=a(arguments[r]);n=n&&I(i),i=R(ee(i)),e=q(P(e,i),be(e,ee(i)))}return n?e:S(e)},numerator:$e(o,_e),denominator:$e(o,me),floor:$e(c,re),ceiling:$e(c,ie),truncate:$e(c,oe),round:$e(c,ae),rationalize:Xe,exp:$e(l,$),log:function(e,t){var n=X(l(e));switch(arguments.length){case 2:n=q(n,X(l(t)));case 1:return n;default:we("1-2",arguments)}},sin:$e(l,W),cos:$e(l,J),tan:$e(l,V),asin:$e(l,G),acos:$e(l,Y),atan:function(e,t){switch(arguments.length){case 1:return z(l(e));case 2:return de(c(e),c(t));default:we("1-2",arguments)}},sqrt:$e(l,L),"exact-integer-sqrt":$e(a,Ie),expt:function(e,t){return 2===arguments.length||Re(arguments),U(l(e),l(t))},"make-rectangular":function(e,t){return 2===arguments.length||Re(arguments),m(c(e),c(t))},"make-polar":function(e,t){return 2===arguments.length||Re(arguments),v(c(e),c(t))},"real-part":$e(l,Z),"imag-part":$e(l,D),magnitude:$e(l,j),angle:$e(l,k),"number->string":function(e,t,n){var r=t;switch(arguments.length){case 3:n=a(n),_(n);case 2:if(10!==(r=_(a(r)).valueOf())&&16!==r&&8!==r&&2!==r)g("&assertion","invalid radix",t);case 1:break;default:we("1-3",arguments)}return x(l(e),r,n)},"string->number":function(e,t){switch(arguments.length){case 1:case 2:return r(String(e),t);default:we("1-2",arguments)}}};function we(e,t){var n="Function",r;try{r=t.callee}catch(e){}if(r)for(name in Be)if(Be[name]===r){n+=" '"+name+"'";break}g("&assertion",n+" expected "+e+" argument"+("1"==e?"":"s")+", got "+t.length)}function Ee(e){1===e.length||we(1,e)}function Re(e){2===e.length||we(2,e)}function Se(e){e.length>0||we("1 or more",e)}function Ce(e){e.length>1||we("2 or more",e)}function Oe(e,t){if(2===arguments.length||Re(arguments),e===t)return true;if(!i(e)||!i(t))return false;return F(e,t)&&I(e)===I(t)}function Fe(e){return 1===arguments.length||Ee(arguments),i(e)}function Ae(e){return 1===arguments.length||Ee(arguments),i(e)&&y(e)}function Te(e){return 1===arguments.length||Ee(arguments),i(e)&&N(e)}function Me(e){return 1===arguments.length||Ee(arguments),i(e)&&B(e)}function Pe(e){return 1===arguments.length||Ee(arguments),i(e)&&w(e)}function qe(e){return 1===arguments.length||Ee(arguments),i(e)&&y(e)&&E(D(e))}function Ze(e){return 1===arguments.length||Ee(arguments),qe(e)&&B(Z(e))}function De(e){return 1===arguments.length||Ee(arguments),qe(e)&&w(Z(e))}function Ue(e,t){var n=arguments.length;n>1||Ce(arguments),e=l(e);for(var r=1;r<n;r++)if(!F(e,l(arguments[r])))return false;return true}function $e(t,n){function e(e){return 1===arguments.length||Ee(arguments),n(t(e))}return e}function je(o){function e(e,t){var n=arguments.length;if(n>1||Ce(arguments),t=c(t),!o(c(e),t))return false;for(var r=2;r<n;r++){var i=c(arguments[r]);if(!o(t,i))return false;t=i}return true}return e}function ke(a){function e(e){var t=arguments.length;t>0||Se(arguments);for(var n=c(e),r=I(n),i=1;i<t;i++){var o=c(arguments[i]);if(K(o))return o;if(r)if(!(r=I(o)))n=S(n);if(false!==a(o,n))n=o}return r?n:S(n)}return e}function Le(o,a){function e(e,t){if(2===arguments.length||Re(arguments),e=c(e),t=c(t),!Q(e))g("&assertion","div/mod first argument is not finite",e);if(E(t))g("&assertion","div/mod second argument is zero",t);if(!o)switch(a){case 0:return he(e,t);case 1:return pe(e,t);case 2:default:return fe(e,t)}var n=fe(e,t),r=n[1],i=ee(t);if(ce(T(r,r),i))switch(a){case 0:return T(n[0],ne(t)?s:u);case 1:return M(r,i);case 2:default:return[T(n[0],ne(t)?s:u),M(r,i)]}switch(a){case 0:return n[0];case 1:return r;case 2:default:return n}}return e}function Xe(e,t){if(Re(arguments),e=l(e),t=l(t),!Q(e)||!Q(t)){if(d(e),d(t),H(t))return Q(e)?h:p;if(K(t))return t;return e}if(E(t))return e;t=ee(t);var n=b(e)||b(t);if(n)e=R(e),t=R(t);var r=M(e,t),i=T(e,t),o=re(r),a=re(i);if(A(o,a)){var u=ne(o);if(ne(a)!=u)return n?h:f;return o=u?a:ie(r),n?S(o):o}var s=[];while(true){if(r=M(r,o),E(r))break;if(i=M(i,o),E(i))break;switch(r=O(r),i=O(i),o=re(r),ue(o,re(i))){case-1:ye(s,ie(r));break;case 1:ye(s,ie(i));break;case 0:default:ye(s,o);continue}break}var g=f,c=s.length;while(c--)g=O(T(g,s[c]));return g=T(g,a),n?S(g):g}var Ge=t.Object.create(null);for(var Ye in Be)if(t.Object.prototype.hasOwnProperty.call(Be,Ye))Ge[Ye]=Be[Ye];return Ge}function implementSchemeNumber(e){"use strict";var n,r,i,o,a;function t(t){var e;if(t instanceof n)return t;if("string"===typeof t){if(false===(e=i(t)))a("&assertion","not a number",t);return e}if("number"===typeof t)return r(t);try{return o(t)}catch(e){a("&assertion","not a number",t,e)}}function u(e){n=e.get("SchemeNumberType"),r=e.get("nativeToInexact"),i=e.get("stringToNumber"),o=e.get("toSchemeNumber"),a=e.get("raise")}return t.VERSION=[1,3,2],t.fn=void 0,t.raise=void 0,t.maxIntegerDigits=1e6,(t.plugins=e).onChange.subscribe(u),u(e),t}function makeMinimalBase(){var e,t,n,r=new PluginContainer({Dispatch:DispatchJs.makeContext({methodNamePrefix:"SN_",methodNameSeparator:" "}),es5globals:getEs5Globals()});return r.extend(implementUncurry(r)),r.extend(defineGenericFunctions(r)),r.extend(defineSchemeNumberType(r)),r.extend(defineDebugFunction(r)),e=implementSchemeNumber(r),r.extend("SchemeNumber",e),r.extend(implementCoreLibrary(r)),e.raise=r.get("defaultRaise"),e.fn=implementRnrsBase(r),e}function defineAbstractTypes(e){"use strict";var t,n=e.get("es5globals").Object.create(null),r=e.get("SchemeNumberType");function i(){}function o(){}function a(){}function u(){}function s(){}function g(){}return i.prototype=new r,o.prototype=new i,a.prototype=new o,u.prototype=new o,s.prototype=new u,g.prototype=new s,n.Complex=i,n.Real=o,n.InexactReal=a,n.ExactReal=u,n.ExactRational=s,n.ExactInteger=g,n}function installAbstractTypes(t){"use strict";var n=t.get("Dispatch");function e(e){n.defClass(e,{ctor:t.get(e)})}e("Complex"),e("Real"),e("InexactReal"),e("ExactReal"),e("ExactRational"),e("ExactInteger")}function installStubFunctions(r){"use strict";var e=r.get("es5globals"),t=r.get("uncurry"),i=t(e.Function.prototype.apply),n=t(e.Array.prototype.concat),o=r.get("SchemeNumberType"),a=r.get("Complex"),u=r.get("Real"),s=r.get("InexactReal"),g=r.get("ExactReal"),c=r.get("ExactRational"),l=r.get("ExactInteger");function f(e,t){var n=r.get(e);if(!n)return void console.log(e,"not found");i(n.def,n,t)}f("numberToString",[o]),f("isExact",[o]),f("isInexact",[o]),f("isComplex",[o]),f("isReal",[o]),f("isRational",[o]),f("isInteger",[o]),f("isZero",[o]),f("toExact",[o]),f("toInexact",[o]),f("negate",[o]),f("reciprocal",[o]),f("eq",[o,o]),f("ne",[o,o]),f("add",[o,o]),f("subtract",[o,o]),f("multiply",[o,o]),f("divide",[o,o]),f("square",[o]),f("realPart",[a]),f("imagPart",[a]),f("magnitude",[a]),f("angle",[a]),f("conjugate",[a]),f("expt",[o,l]),f("expt",[a,a]),f("exp",[a]),f("sqrt",[a]),f("log",[a]),f("asin",[a]),f("acos",[a]),f("atan",[a]),f("sin",[a]),f("cos",[a]),f("tan",[a]),f("SN_isFinite",[u]),f("SN_isInfinite",[u]),f("SN_isNaN",[u]),f("isUnit",[u]),f("abs",[u]),f("isPositive",[u]),f("isNegative",[u]),f("sign",[u]),f("floor",[u]),f("ceiling",[u]),f("truncate",[u]),f("round",[u]),f("compare",[u,u]),f("gt",[u,u]),f("lt",[u,u]),f("ge",[u,u]),f("le",[u,u]),f("divAndMod",[u,u]),f("div",[u,u]),f("mod",[u,u]),f("atan2",[u,u]),f("numerator",[c]),f("denominator",[c]),f("numeratorAndDenominator",[c]),f("isEven",[l]),f("isOdd",[l]),f("exactIntegerSqrt",[l]),f("exp10",[l]),f("gcdNonnegative",[l,l]),f("divideReduced",[l,l]),f("bitwiseNot",[l]),f("bitwiseAnd",[l,l]),f("bitwiseIor",[l,l]),f("bitwiseXor",[l,l]),f("bitCount",[l]),f("bitLength",[l]),f("firstBitSet",[l]),f("isBitSet",[l]),f("copyBit",[l]),f("bitField",[l]),f("copyBitField",[l,l]),f("bitShift",[l]),f("rotateBitField",[l]),f("reverseBitField",[l])}function implementPluginLibrary(e){"use strict";var g,t,n,r,i,o,a,u,s,c,l,f,h,p,d,_,m,v,x,I,b,y,N,B,w,E,R,S,C,O,F,F,A,T,M,P,q,Z,D,U,$,j,k,L,X,G,Y,z,W,J,V,Q,H,K,ee,te,ne,re,ie,oe,ae,ue,se,ge,ce,le,fe,he,pe,de,_e,me,ve,xe,Ie,be;g=e.get("SchemeNumber"),n=e.get("SchemeNumberType"),r=e.get("Complex"),i=e.get("Real"),o=e.get("InexactReal"),a=e.get("ExactReal"),u=e.get("ExactRational"),s=e.get("ExactInteger"),t=e.get("toSchemeNumber"),c=e.get("numberToString"),l=e.get("isExact"),f=e.get("isInexact"),h=e.get("isComplex"),p=e.get("isReal"),d=e.get("isRational"),_=e.get("isInteger"),m=e.get("isZero"),v=e.get("toExact"),x=e.get("toInexact"),I=e.get("negate"),b=e.get("reciprocal"),y=e.get("eq"),N=e.get("ne"),B=e.get("add"),w=e.get("subtract"),E=e.get("multiply"),R=e.get("divide"),S=e.get("square"),C=e.get("realPart"),O=e.get("imagPart"),F=e.get("expt"),F=e.get("expt"),A=e.get("exp"),T=e.get("magnitude"),M=e.get("angle"),P=e.get("sqrt"),q=e.get("log"),Z=e.get("asin"),D=e.get("acos"),U=e.get("atan"),$=e.get("sin"),j=e.get("cos"),k=e.get("tan"),L=e.get("SN_isFinite"),X=e.get("SN_isInfinite"),G=e.get("SN_isNaN"),Y=e.get("isUnit"),z=e.get("abs"),W=e.get("isPositive"),J=e.get("isNegative"),V=e.get("sign"),Q=e.get("floor"),H=e.get("ceiling"),K=e.get("truncate"),ee=e.get("round"),te=e.get("compare"),ne=e.get("gt"),re=e.get("lt"),ie=e.get("ge"),oe=e.get("le"),ae=e.get("divAndMod"),ue=e.get("div"),se=e.get("mod"),ge=e.get("atan2"),ce=e.get("numerator"),le=e.get("denominator"),fe=e.get("numeratorAndDenominator"),he=e.get("isEven"),pe=e.get("isOdd"),de=e.get("exp10"),_e=e.get("gcdNonnegative"),me=e.get("divideReduced");var ye=e.get("es5globals"),Ne=e.get("uncurry"),Be=Ne(ye.Array.prototype.join),we=Ne(ye.Number.prototype.toString),Ee=Ne(ye.String.prototype.indexOf),Re=Ne(ye.String.prototype.substring),Se=Ne(ye.String.prototype.replace),Ce=ye.Math.LN10,Oe=ye.Math.LN2,Fe=ye.Math.abs,Ae=ye.Math.floor,Te=ye.Math.pow,Me=ye.undefined,Pe=ye.NaN,qe=ye.parseInt,Ze=ye.isFinite,De,Ue,$e,je,ke,Le,Xe,Ge,Ye,ze=e.get("makePolar"),We=e.get("makeRectangular"),Je=e.get("raise"),Ve=e.get("raiseDivisionByExactZero"),Qe=ye.Object.create(null);function He(e,t){ve=e.get("nativeToExactInteger"),xe=e.get("divideReducedNotByOne"),Ie=e.get("exactRectangular"),be=e.get("inexactRectangular"),De=e.get("ZERO"),Ue=e.get("ONE"),$e=e.get("TWO"),je=e.get("MINUS_ONE"),Xe=e.get("INEXACT_ZERO"),Ge=e.get("INEXACT_ONE"),Ye=e.get("PI"),ke=e.get("I"),Le=e.get("MINUS_I")}function Ke(){return ze(P(T(this)),R(M(this),$e))}function et(){return ze(A(C(this)),O(this))}function tt(){var e=E(ke,this);return E(R(w(A(e),A(I(e))),$e),Le)}function nt(){var e=E(ke,this);return R(B(A(e),A(I(e))),$e)}function rt(e,t){if(m(e)){if(m(t))return l(e)&&l(t)?Ue:Ge;if(W(C(t)))return l(t)?e:Xe;Je("&implementation-restriction","invalid power for zero expt",t)}return A(E(q(e),t))}function it(e){return E(Le,q(B(E(ke,e),P(w(Ue,S(e))))))}function ot(e){return w(R(Ye,$e),it(e))}function at(e){var t=E(ke,e);return E(R(w(q(B(Ue,t)),q(w(Ue,t))),$e),Le)}function ut(e){return We(q(T(e)),M(e))}function st(e){return rt(this,e)}function gt(){return it(this)}function ct(){return ot(this)}function lt(){return at(this)}function ft(){return ut(this)}function ht(){if(m(O(this)))return C(this).valueOf();return Pe}function pt(e,t){if("-"===t[0]||"+"===t[0])return e+t+"i";return e+"+"+t+"i"}function dt(e,t){return pt(c(C(this),e,t),c(O(this),e,t))}function _t(e){return e=e||10,pt(C(this).toString(e),O(this).toString(e))}function mt(e){return pt(C(this).toFixed(e),O(this).toFixed(e))}function vt(e){return pt(C(this).toExponential(e),O(this).toExponential(e))}function xt(e){return pt(C(this).toPrecision(e),O(this).toPrecision(e))}function It(){if(f(this))return this;return be(x(C(this)),x(O(this)))}function bt(){if(l(this))return this;return Ie(v(C(this)),v(O(this)))}function yt(){return m(C(this))&&m(O(this))}function Nt(){var e=C(this),t=O(this);if(m(e))return z(t);if(m(t))return z(e);return P(B(S(e),S(t)))}function Bt(){return ge(O(this),C(this))}function wt(e){return y(C(this),C(e))&&y(O(this),O(e))}function Et(e){return m(O(this))&&y(e,C(this))}function Rt(e){return m(O(e))&&y(C(e),this)}function St(e){return N(C(this),C(e))||N(O(this),O(e))}function Ct(e){return!m(O(this))||N(e,C(this))}function Ot(e){return!m(O(e))||N(C(e),this)}function Ft(e){return We(B(this,C(e)),O(e))}function At(e){return We(B(C(this),e),O(this))}function Tt(e){return We(B(C(this),C(e)),B(O(this),O(e)))}function Mt(e){return We(w(this,C(e)),I(O(e)))}function Pt(e){return We(w(C(this),e),O(this))}function qt(e){return We(w(C(this),C(e)),w(O(this),O(e)))}function Zt(){return We(I(C(this)),I(O(this)))}function Dt(e,t,n,r){return We(w(E(e,n),E(t,r)),B(E(e,r),E(t,n)))}function Ut(e){return We(E(C(e),this),E(O(e),this))}function $t(e){return We(E(C(this),e),E(O(this),e))}function jt(e){return Dt(C(this),O(this),C(e),O(e))}function kt(e){return We(R(C(this),e),R(O(this),e))}function Lt(){var e=C(this),t=O(this),n=E(e,t);return We(w(S(e),S(t)),B(n,n))}function Xt(){var e=C(this),t=O(this),n=B(S(e),S(t));return We(R(e,n),I(R(t,n)))}function Gt(e,t,n){var r=C(n),i=O(n),o=B(S(r),S(i));return Dt(e,t,R(r,o),I(R(i,o)))}function Yt(e){return Gt(this,l(this)?De:Xe,e)}function zt(e){return Gt(C(this),O(this),e)}function Wt(e){return we(e,2)}function Jt(e){var t=Wt(Fe(e)),n=Ee(t,".");if(-1===n)return 0;return t.length-n-1}function Vt(e){return Te(2,Jt(e))}function Qt(){return E(this,this)}function Ht(){return!l(this)}function Kt(e){return!y(this,e)}function en(e){return B(this,I(e))}function tn(e){return E(this,b(e))}function nn(e){if(l(this))return Tn(this,e);return rt(this,e)}function rn(){return R($(this),j(this))}function on(){return y(Ue,this)||y(je,this)}function an(){return z(this)}function un(){return J(this)?Ye:Xe}function sn(){return J(this)?Ye:De}function gn(){return V(this)>0}function cn(){return V(this)<0}function ln(){return 0===V(this)}function fn(){return te(this,De)}function hn(e){return 0===te(this,e)}function pn(e){return 0!==te(this,e)}function dn(e){return te(this,e)>0}function _n(e){return te(this,e)<0}function mn(e){return te(this,e)>=0}function vn(e){return te(this,e)<=0}function xn(e,t){return J(t)?H(R(e,t)):Q(R(e,t))}function In(e){var t=xn(this,e);return[t,w(this,E(t,e))]}function bn(e){return xn(this,e)}function yn(e){return w(this,E(xn(this,e),e))}function Nn(){return J(this)?I(this):this}function Bn(){return _(this)?this:B(Ue,Q(this))}function wn(){return J(this)?H(this):Q(this)}function En(){var e=Q(this),t=w(this,e),n=B(t,t);switch(te(n,Ue)){case-1:return e;case 1:return B(Ue,e);case 0:default:return he(e)?e:B(Ue,e)}}function Rn(e){if(Y(e))return this;return xe(this,e)}function Sn(e){var t=this,n=_e(z(e),z(t));if(t=ue(t,n),e=ue(e,n),J(e))t=I(t),e=I(e);return Y(e)?t:xe(t,e)}function Cn(){switch(V(this)){case-1:return me(je,I(this));case 1:return me(Ue,this);case 0:default:return Ve()}}function On(e){var t=fe(this),n=t[0],r=t[1];if(Y(r))return c(n,e);return c(n,e)+"/"+c(r,e)}function Fn(){return[this,Ue]}function An(e){return E(this,Tn(ve(10),e))}function Tn(e,t){var n=z(t),r=e,i=Ue,o;while(W(n)){if(n=(o=ae(n,$e))[0],!m(o[1]))i=E(i,r);r=S(r)}return J(t)?b(i):i}function Mn(e){return Tn(this,e)}function Pn(e){var t=this,n;while(!m(t))t=se(e,n=t),e=n;return e}function qn(){return w(je,this)}function Zn(e){var t=Re("000000000000000",0,15&e);if(e>15)t+=Be(new ye.Array((e>>4)+1),"0000000000000000");return t}function Dn(e){var t=e===Me?0:qe(e,10);if(t>g.maxIntegerDigits)throw new RangeError("fractionDigits exceeds "+"SchemeNumber.maxIntegerDigits: "+e);var n=this,r="";if(J(n))n=I(n),r="-";var i=de(Ue,ve(-t)),o=ae(n,i),a=o[0];if(ie(B(o[1],o[1]),i))a=B(Ue,a);if(m(a))return r+"0"+(e>0?"."+Zn(e):"");if(a=c(a),0===t)return r+a;var u=t-a.length;if(t>0){if(u>=0)a=Zn(u+1)+a;var s=a.length-t;return r+Re(a,0,s)+"."+Re(a,s)}return r+a+Zn(-t)}function Un(e){var t=e===Me?20:qe(e,10);if(t<0)throw new RangeError("SchemeNumber toExponential: negative "+"argument: "+t);if(t>g.maxIntegerDigits)throw new RangeError("fractionDigits exceeds "+"SchemeNumber.maxIntegerDigits: "+e);var n=this,r="";if(J(n))n=I(n),r="-";else if(m(n))return"0"+(e>0?"."+Zn(t):"")+"e+0";var i=Ae(q(n)/Ce),o=de(Ue,ve(i-t)),a=ae(n,o),u=a[0];if(ie(B(a[1],a[1]),o))u=B(Ue,u);if((u=c(u)).length!=t+1){if(i+=u.length-(t+1),o=de(Ue,ve(i-t)),u=(a=ae(n,o))[0],ie(B(a[1],a[1]),o))u=B(Ue,u);if((u=c(u)).length!=t+1)return c(this)}if(e===Me)u=Se(u,/(\d)0+$/,"$1");if(u.length>1)u=u[0]+"."+Re(u,1);return r+u+"e"+(i<0?"":"+")+i}function $n(e){var t,n;if(e===Me){if(n=x(this),L(n))return we(+n);t=21}else{if((t=qe(e,10))<1)throw new RangeError("SchemeNumber toPrecision: expected a "+"positive precision, got: "+e);if(t>g.maxIntegerDigits)throw new RangeError("precision exceeds "+"SchemeNumber.maxIntegerDigits: "+e)}var r="";if(J(n=this))n=I(n),r="-";else if(m(n))return"0"+(t>1?"."+Zn(t-1):"");var i=n.toExponential(t-1),o=Ee(i,"e"),a=qe(Re(i,o+1),10);if(a>=-6&&a<t){if(0===a)i=Re(i,0,o);else if(i=Re(i,0,1)+(-1===Ee(i,".")?"":Re(i,2,o)),a<0)i="0."+Zn(-1-a)+i;else if(a<t-1)i=Re(i,0,a+1)+"."+Re(i,a+1)}else if(e===Me)i=Se(Re(i,0,o),/\.?0+/,"")+Re(i,o);return r+i}return e.onChange.subscribe(He),He(e,{}),Qe.Complex_sqrt=Ke,Qe.Complex_exp=et,Qe.Complex_sin=tt,Qe.Complex_cos=nt,Qe.Complex_expt_fn=rt,Qe.Complex_expt=st,Qe.Complex_asin_fn=it,Qe.Complex_asin=gt,Qe.Complex_acos_fn=ot,Qe.Complex_acos=ct,Qe.Complex_atan_fn=at,Qe.Complex_atan=lt,Qe.Complex_log_fn=ut,Qe.Complex_log=ft,Qe.Complex_numberToString=dt,Qe.Complex_toString=_t,Qe.Complex_toFixed=mt,Qe.Complex_toExponential=vt,Qe.Complex_toPrecision=xt,Qe.Complex_toInexact=It,Qe.Complex_toExact=bt,Qe.Complex_isZero=yt,Qe.Complex_magnitude=Nt,Qe.Complex_angle=Bt,Qe.Complex_eq=wt,Qe.Complex_eq_Real=Et,Qe.Real_eq_Complex=Rt,Qe.Complex_ne=St,Qe.Complex_ne_Real=Ct,Qe.Real_ne_Complex=Ot,Qe.Real_add_Complex=Ft,Qe.Complex_add_Real=At,Qe.Complex_add=Tt,Qe.Real_subtract_Complex=Mt,Qe.Complex_subtract_Real=Pt,Qe.Complex_subtract=qt,Qe.Complex_negate=Zt,Qe.Real_multiply_Complex=Ut,Qe.Complex_multiply_Real=$t,Qe.Complex_multiply=jt,Qe.Complex_divide_Real=kt,Qe.Complex_square=Lt,Qe.Complex_reciprocal=Xt,Qe.Real_divide_Complex=Yt,Qe.Complex_divide=zt,Qe.numberToBinary=Wt,Qe.nativeDenominatorLog2=Jt,Qe.nativeDenominator=Vt,Qe.square_via_multiply=Qt,Qe.isInexact_via_isExact=Ht,Qe.ne_via_eq=Kt,Qe.subtract_via_negate_add=en,Qe.divide_via_reciprocal_multiply=tn,Qe.complex_or_exact_expt=nn,Qe.tan_via_divide_sin_cos=rn,Qe.isUnit_via_eq=on,Qe.Real_magnitude_via_abs=an,Qe.InexactReal_angle_via_isNegative=un,Qe.ExactReal_angle_via_isNegative=sn,Qe.isPositive_via_sign=gn,Qe.isNegative_via_sign=cn,Qe.isZero_via_sign=ln,Qe.sign_via_compare=fn,Qe.eq_via_compare=hn,Qe.ne_via_compare=pn,Qe.gt_via_compare=dn,Qe.lt_via_compare=_n,Qe.ge_via_compare=mn,Qe.le_via_compare=vn,Qe.divAndMod_via_divide_floor=In,Qe.div_via_divide_floor=bn,Qe.mod_via_divide_floor=yn,Qe.abs_via_isNegative_negate=Nn,Qe.ceiling_via_floor=Bn,Qe.truncate_via_ceiling_floor=wn,Qe.round_via_floor_compare_isEven=En,Qe.divideReduced_via_isUnit=Rn,Qe.Integer_divide_via_gcd_div=Sn,Qe.Integer_reciprocal_via_divideReduced=Cn,Qe.ExactRational_numberToString=On,Qe.Integer_numeratorAndDenominator=Fn,Qe.genericExp10=An,Qe.expt_N_EI_fn=Tn,Qe.expt_N_EI=Mn,Qe.gcdNonnegative_via_isZero_mod=Pn,Qe.bitwiseNot_via_subtract=qn,Qe.Real_toFixed=Dn,Qe.Real_toExponential=Un,Qe.Real_toPrecision=$n,Qe.Complex_valueOf=ht,Qe}function installGenericFunctions(o){"use strict";var e=o.get("SchemeNumberType"),t=o.get("Complex"),n=o.get("Real"),r=o.get("InexactReal"),i=o.get("ExactReal"),a=o.get("ExactRational"),u=o.get("ExactInteger"),s=o.get("raise");function g(e,t,n){var r=o.get(e);if(!r)return;var i=void 0;if(n)if(!(i=o.get(n)))return void console.log(n+" not defined");r.def.apply(r.def,t.concat(i))}g("expt",[e,u],"expt_N_EI"),g("square",[e],"square_via_multiply"),g("isInexact",[e],"isInexact_via_isExact"),g("ne",[e,e],"ne_via_eq"),g("subtract",[e,e],"subtract_via_negate_add"),g("divide",[e,e],"divide_via_reciprocal_multiply"),g("isComplex",[t],"retTrue"),g("numberToString",[t],"Complex_numberToString"),g("sqrt",[t],"Complex_sqrt"),g("exp",[t],"Complex_exp"),g("log",[t],"Complex_log"),g("sin",[t],"Complex_sin"),g("cos",[t],"Complex_cos"),g("tan",[t],"tan_via_divide_sin_cos"),g("asin",[t],"Complex_asin"),g("acos",[t],"Complex_acos"),g("atan",[t],"Complex_atan"),g("toInexact",[t],"Complex_toInexact"),g("toExact",[t],"Complex_toExact"),g("isZero",[t],"Complex_isZero"),g("magnitude",[t],"Complex_magnitude"),g("angle",[t],"Complex_angle"),g("eq",[t,t],"Complex_eq"),g("eq",[t,n],"Complex_eq_Real"),g("eq",[n,t],"Real_eq_Complex"),g("ne",[t,t],"Complex_ne"),g("ne",[t,n],"Complex_ne_Real"),g("ne",[n,t],"Real_ne_Complex"),g("add",[n,t],"Real_add_Complex"),g("add",[t,n],"Complex_add_Real"),g("add",[t,t],"Complex_add"),g("subtract",[n,t],"Real_subtract_Complex"),g("subtract",[t,n],"Complex_subtract_Real"),g("subtract",[t,t],"Complex_subtract"),g("negate",[t],"Complex_negate"),g("multiply",[n,t],"Real_multiply_Complex"),g("multiply",[t,n],"Complex_multiply_Real"),g("multiply",[t,t],"Complex_multiply"),g("divide",[t,n],"Complex_divide_Real"),g("square",[t],"Complex_square"),g("reciprocal",[t],"Complex_reciprocal"),g("divide",[n,t],"Real_divide_Complex"),g("divide",[t,t],"Complex_divide"),g("isReal",[n],"retTrue"),g("realPart",[n],"retThis"),g("imagPart",[n],"retZero"),g("conjugate",[n],"retThis"),g("isUnit",[n],"isUnit_via_eq"),g("magnitude",[n],"Real_magnitude_via_abs"),g("isPositive",[n],"isPositive_via_sign"),g("isNegative",[n],"isNegative_via_sign"),g("isZero",[n],"isZero_via_sign"),g("sign",[n],"sign_via_compare"),g("eq",[n,n],"eq_via_compare"),g("ne",[n,n],"ne_via_compare"),g("gt",[n,n],"gt_via_compare"),g("lt",[n,n],"lt_via_compare"),g("ge",[n,n],"ge_via_compare"),g("le",[n,n],"le_via_compare"),g("divAndMod",[n,n],"divAndMod_via_divide_floor"),g("div",[n,n],"div_via_divide_floor"),g("mod",[n,n],"mod_via_divide_floor"),g("abs",[n],"abs_via_isNegative_negate"),g("ceiling",[n],"ceiling_via_floor"),g("truncate",[n],"truncate_via_ceiling_floor"),g("round",[n],"round_via_floor_compare_isEven"),g("isExact",[r],"retFalse"),g("isInexact",[r],"retTrue"),g("toInexact",[r],"retThis"),g("angle",[r],"InexactReal_angle_via_isNegative"),g("isExact",[i],"retTrue"),g("isInexact",[i],"retFalse"),g("toExact",[i],"retThis"),g("SN_isNaN",[i],"retFalse"),g("SN_isFinite",[i],"retTrue"),g("SN_isInfinite",[i],"retFalse"),g("angle",[i],"ExactReal_angle_via_isNegative"),g("isRational",[a],"retTrue"),g("divideReduced",[u,u],"divideReduced_via_isUnit"),g("divide",[u,u],"Integer_divide_via_gcd_div"),g("reciprocal",[u],"Integer_reciprocal_via_divideReduced"),g("isInteger",[u],"retTrue"),g("numerator",[u],"retThis"),g("denominator",[u],"retOne"),g("floor",[u],"retThis"),g("ceiling",[u],"retThis"),g("round",[u],"retThis"),g("truncate",[u],"retThis"),g("exp10",[u],"genericExp10"),g("gcdNonnegative",[u,u],"gcdNonnegative_via_isZero_mod"),g("bitwiseNot",[u],"bitwiseNot_via_subtract"),g("expt",[t,t],"Complex_expt"),g("expt",[i,u],"expt_N_EI"),g("expt",[t,u],"complex_or_exact_expt"),g("numberToString",[a],"ExactRational_numberToString"),g("numberToString",[u],void 0),g("numeratorAndDenominator",[u],"Integer_numeratorAndDenominator")}function installEcmaMethods(e){"use strict";var t=e.get("SchemeNumberType"),n=e.get("ExactReal"),r=e.get("Complex"),i=e.get("Real"),o=e.get("ExactRational");r.prototype.valueOf=e.get("Complex_valueOf"),r.prototype.toString=e.get("Complex_toString"),r.prototype.toFixed=e.get("Complex_toFixed"),r.prototype.toExponential=e.get("Complex_toExponential"),r.prototype.toPrecision=e.get("Complex_toPrecision"),i.prototype.valueOf=t.prototype.valueOf,i.prototype.toFixed=t.prototype.toFixed,i.prototype.toExponential=t.prototype.toExponential,i.prototype.toPrecision=t.prototype.toPrecision,i.prototype.toString=t.prototype.toString,n.prototype.toFixed=e.get("Real_toFixed"),n.prototype.toExponential=e.get("Real_toExponential"),n.prototype.toPrecision=e.get("Real_toPrecision")}function makeBase(){var e=makeMinimalBase(),t=e.plugins;return e.makeMinimalBase=makeMinimalBase,e.makeBase=makeBase,t.extend(implementPluginLibrary(t)),t.extend(defineAbstractTypes(t)),installAbstractTypes(t),installStubFunctions(t),installGenericFunctions(t),installEcmaMethods(t),e}function installDefaultExactInteger(r,i){var o=r.get("ExactInteger");function e(e){var t=r.get(e);function n(e){return t(i(this),i(e))}t.def(o,o,n)}e("compare"),e("add"),e("subtract"),e("multiply"),e("expt"),e("divAndMod"),e("div"),e("mod"),e("gcdNonnegative"),r.extend("canonicalExactInteger",i)}function installDefaultRational(r,i,t){var e=r.get("ExactInteger"),o=r.get("ExactRational");function n(e){var t=r.get(e);function n(e){return t(i(this),i(e))}t.def(o,o,n)}function a(e){return t(this,e)}n("compare"),n("add"),n("subtract"),n("multiply"),n("divide"),r.get("divideReduced").def(e,e,a),r.extend("canonicalRational",i)}function implementNativeInexactReal(e){"use strict";var i=e.get("es5globals"),t=e.get("uncurry"),n=e.get("InexactReal"),o=i.Object.create(null),r=t(i.Number.prototype.toFixed),a=t(i.Number.prototype.toExponential),u=t(i.Number.prototype.toPrecision),s=t(i.Number.prototype.toString),g=t(i.Number.prototype.toLocaleString),c=i.parseFloat;function l(e){this._=e}function f(){return"NativeInexact("+this._+")"}function h(){return this._}function p(e){return r(this._,e)}function d(e){return a(this._,e)}function _(e){return u(this._,e)}function m(e){return s(this._,e)}function v(){return g(this._)}(l.prototype=new n).valueOf=h,l.prototype.toFixed=p,l.prototype.toExponential=d,l.prototype.toPrecision=_,l.prototype.toString=m,l.prototype.toLocaleString=v;var x=l,I=new l(0);function b(e){return 0===e?I:new l(e)}function y(e,t){return b(e*c(t))}function N(e){var n=i.Math[e];function t(e){return b(n(e))}function r(e,t){return b(n(e,t))}o["Native_"+e]=1===n.length?t:r}return N("log"),N("sqrt"),N("atan2"),N("atan"),N("cos"),N("sin"),N("tan"),N("exp"),N("abs"),N("floor"),N("ceil"),N("pow"),o.parseInexact=y,o.nativeToInexact=b,o.NativeInexactReal=l,o.NativeInexactReal_debug=f,o}function implementNativeFlonumLibrary(e){"use strict";var t=e.get("es5globals"),n=e.get("uncurry"),r=t.Object.create(null),a=n(t.String.prototype.indexOf),u=n(t.String.prototype.substring),s=n(t.String.prototype.replace),g=n(t.Number.prototype.toString),i=t.Math.E,o=t.Math.LN10,c=t.Math.LN2,l=t.Math.LOG2E,f=t.Math.LOG10E,h=t.Math.PI,p=t.Math.SQRT1_2,d=t.Math.SQRT2,_=t.Math.abs,m=t.Math.acos,v=t.Math.asin,x=t.Math.atan,I=t.Math.atan2,b=t.Math.ceil,y=t.Math.cos,N=t.Math.exp,B=t.Math.floor,w=t.Math.log,E=t.Math.max,R=t.Math.min,S=t.Math.pow,C=t.Math.random,O=t.Math.round,F=t.Math.sin,A=t.Math.sqrt,T=t.Math.tan,M=t.isFinite,P=t.isNaN,q=t.parseFloat,Z=t.undefined,D=t.Number,U,$,j,k,L,X,G,Y,z,W,J,V,Q,H,K,ee,te,ne,re,ie,oe,ae,ue,se,ge,ce,le,fe,he,pe,de,_e,me,ve,xe,Ie,be,ye,Ne,Be,we,Ee,Re,Se,Ce,Oe,Fe,Ae,Te,Me,Pe,qe,Ze,De,Ue,$e,je,ke,Le,Xe,Ge,Ye,ze,We,Je,Ve,Qe,He,Ke,et,tt,nt,rt;function it(e){U=e.get("nativeToInexact"),$=e.get("Native_log"),j=e.get("Native_sqrt"),k=e.get("Native_atan2"),L=e.get("Native_atan"),X=e.get("Native_cos"),G=e.get("Native_sin"),Y=e.get("Native_tan"),z=e.get("Native_exp"),W=e.get("Native_abs"),J=e.get("Native_floor"),V=e.get("Native_ceil"),Q=e.get("Native_pow"),H=e.get("raise"),K=e.get("inexactRectangular"),ee=e.get("INEXACT_ZERO"),te=e.get("nativeToExactInteger"),re=e.get("divideReducedNotByOne"),ne=e.get("TWO"),ie=e.get("numberToString"),oe=e.get("isExact"),ae=e.get("isInexact"),ue=e.get("toExact"),se=e.get("toInexact"),ge=e.get("isRational"),ce=e.get("isInteger"),le=e.get("isZero"),fe=e.get("negate"),he=e.get("square"),pe=e.get("eq"),de=e.get("ne"),_e=e.get("add"),me=e.get("subtract"),ve=e.get("multiply"),xe=e.get("divide"),Ie=e.get("expt"),be=e.get("exp"),ye=e.get("sqrt"),Ne=e.get("log"),Be=e.get("asin"),we=e.get("acos"),Ee=e.get("atan"),Re=e.get("sin"),Se=e.get("cos"),Ce=e.get("tan"),Oe=e.get("abs"),Fe=e.get("isPositive"),Ae=e.get("isNegative"),Te=e.get("sign"),Me=e.get("floor"),Pe=e.get("ceiling"),qe=e.get("truncate"),Ze=e.get("round"),De=e.get("compare"),Ue=e.get("gt"),$e=e.get("lt"),je=e.get("ge"),ke=e.get("le"),Le=e.get("divAndMod"),Xe=e.get("div"),Ge=e.get("mod"),Ye=e.get("atan2"),ze=e.get("numerator"),We=e.get("denominator"),Je=e.get("isEven"),Ve=e.get("isOdd"),Qe=e.get("Complex_expt_fn"),He=e.get("Complex_acos_fn"),Ke=e.get("Complex_asin_fn"),et=e.get("Complex_log_fn"),tt=e.get("numberToBinary"),nt=e.get("nativeDenominatorLog2"),rt=e.get("nativeDenominator")}function ot(){return U(Number(this))}function at(e,t){var n=+this;if(e&&10!=e&&M(n))return"#i"+ie(ue(this),e);if(!M(n)){if(P(n))return"+nan.0";return n>0?"+inf.0":"-inf.0"}var r=g(n);if(-1===a(r,".")){var i=a(r,"e");if(-1===i)r+=".";else r=u(r,0,i)+"."+u(r,i)}if(t!=Z){if(t<53){var o=s(s(s(tt(+this),/[-+.]/g,""),/^0+/,""),/0+$/,"").length;if(t<o)t=o}r+="|"+t}return r}function ut(){var e=+this;if(!M(e))H("&assertion","not a rational number",e);return Q(2,nt(e))}function st(){var e=+this;if(!M(e))H("&assertion","not a rational number",e);return U(this*rt(e))}function gt(){var e=+this;return M(e)&&e===B(e)}function ct(){return M(+this)}function lt(){var e=+this;return!M(e)&&!P(e)}function ft(){return P(+this)}function ht(){return 0===+this}function pt(){return+this>0}function dt(){return+this<0}function _t(){var e=+this;return 0===e?0:e>0?1:-1}function mt(){return 0===(1&+this)}function vt(){return 1===(1&+this)}function xt(e){return+this===+e}function It(e){return+this!==+e}function bt(e){return+this>+e}function yt(e){return+this<+e}function Nt(e){return+this>=+e}function Bt(e){return+this<=+e}function wt(e){var t=+this;if(t===(e=+e))return 0;if(t<e)return-1;if(t>e)return 1;return NaN}function Et(){var e=+this;if(!M(e))H("&implementation-violation","inexact argument has no reasonably close exact equivalent",this);var t=rt(e),n;if(1===t)return te(e);if(M(t))n=e*t,t=te(t);else{var r=nt(e);n=9007199254740992*e,n*=natPow(2,r-53),t=Ie(ne,te(r))}return re(te(n),t)}function Rt(e){return U(+this+ +e)}function St(e){return U(+this-+e)}function Ct(e){return U(+this*+e)}function Ot(e){return U(+this/+e)}function Ft(){return U(-+this)}function At(){return U(_(+this))}function Tt(){return U(1/+this)}function Mt(e,t){if(t>0)return B(e/t);if(t<0)return b(e/t);return NaN}function Pt(e){var t=+this,n=Mt(t,e=+e);return[U(n),U(t-e*n)]}function qt(e){var t;return U(Mt(+this,e=+e))}function Zt(e){var t=+this;return U(t-(e=+e)*Mt(t,e))}function Dt(){var e=+this;return U(e*e)}function Ut(e){var t=+this;if(t<0)return Qe(this,e);return Q(t,e)}function $t(){var e=+this,t=B(e),n=e-t;if(n<.5)return U(t);if(n>.5)return U(t+1);return U(2*O(e/2))}function jt(){var e=+this;return e<0?V(e):J(e)}function kt(e){return function(){return e(+this)}}e.onChange.subscribe(it),it(e);var Lt=kt(V),Xt=kt(J),Gt=kt(L),Yt=kt(X),zt=kt(z),Wt=kt(G),Jt=kt(Y);function Vt(n,r){return function(){var e,t=n(+this);if(P(t))return r(this);return U(t)}}var Qt=Vt(m,He),Ht=Vt(v,Ke);function Kt(){var e=+this;if(e<0)return et(this);return $(e)}function en(){var e=+this;if(e>=0)return j(e);if(P(e))return U(e);return K(ee,j(-e))}function tn(e){return k(+this,e)}return r.Real_toInexact_via_Flonum=ot,r.Flonum_numberToString=at,r.Flonum_isRational=ct,r.Flonum_denominator=ut,r.Flonum_numerator=st,r.Flonum_isInteger=gt,r.Flonum_SN_isFinite=ct,r.Flonum_SN_isInfinite=lt,r.Flonum_SN_isNaN=ft,r.Flonum_isZero=ht,r.Flonum_isPositive=pt,r.Flonum_isNegative=dt,r.Flonum_sign=_t,r.Flonum_isEven=mt,r.Flonum_isOdd=vt,r.Flonum_eq=xt,r.Flonum_ne=It,r.Flonum_gt=bt,r.Flonum_lt=yt,r.Flonum_ge=Nt,r.Flonum_le=Bt,r.Flonum_compare=wt,r.Flonum_toExact=Et,r.Flonum_add=Rt,r.Flonum_subtract=St,r.Flonum_multiply=Ct,r.Flonum_divide=Ot,r.Flonum_negate=Ft,r.Flonum_abs=At,r.Flonum_reciprocal=Tt,r.Flonum_divAndMod=Pt,r.Flonum_div=qt,r.Flonum_mod=Zt,r.Flonum_square=Dt,r.Flonum_expt=Ut,r.Flonum_round=$t,r.Flonum_truncate=jt,r.Flonum_ceiling=Lt,r.Flonum_floor=Xt,r.Flonum_atan=Gt,r.Flonum_cos=Yt,r.Flonum_exp=zt,r.Flonum_sin=Wt,r.Flonum_tan=Jt,r.Flonum_acos=Qt,r.Flonum_asin=Ht,r.Flonum_log=Kt,r.Flonum_sqrt=en,r.Flonum_atan2=tn,r}function installFlonum(r){"use strict";var i=r.get("Flonum"),o=r.get("Real"),a=r.get("InexactReal"),u=r.get("ExactReal"),e,t=true;if(!(i.prototype instanceof a))for(e in a.prototype)if(!(e in i.prototype))i.prototype[e]=a.prototype[e];if(t)r.get("toInexact").def(u,r.get("Real_toInexact_via_Flonum"));function n(e){var t=r.get("Flonum_"+e);if(!t)console.log("Flonum_"+e+" not defined");r.get(e).def(i,t)}function s(e){var t=r.get("Flonum_"+e);if(!t)console.log("Flonum_"+e+" not defined");r.get(e).def(a,t)}function g(e){var t=r.get("Flonum_"+e);if(!t)console.log("Flonum_"+e+" not defined");r.get(e).def(o,t)}function c(e){var t=r.get(e),n=r.get("Flonum_"+e);if(!n)console.log("Flonum_"+e+" not defined");t.def(i,i,n)}function l(e){var t=r.get(e),n=r.get("Flonum_"+e);c(e),t.def(u,i,n),t.def(i,u,n)}function f(e){var t=r.get(e),n=r.get("Flonum_"+e);c(e),t.def(o,a,n),t.def(a,o,n)}function h(e){var t=r.get(e),n=r.get("Flonum_"+e);c(e),t.def(o,o,n)}var p=t?s:n,d=t?g:n,_=t?f:l,m=t?h:l;p("numberToString"),p("isRational"),p("denominator"),p("numerator"),p("isInteger"),p("SN_isFinite"),p("SN_isInfinite"),p("SN_isNaN"),p("isZero"),p("isPositive"),p("isNegative"),p("sign"),p("isEven"),p("isOdd"),p("toExact"),p("negate"),p("abs"),p("reciprocal"),p("square"),p("round"),p("truncate"),p("ceiling"),p("floor"),d("atan"),d("cos"),d("exp"),d("sin"),d("tan"),d("acos"),d("asin"),d("log"),d("sqrt"),_("eq"),_("ne"),_("gt"),_("lt"),_("ge"),_("le"),_("compare"),_("add"),_("subtract"),_("multiply"),_("divide"),_("divAndMod"),_("div"),_("mod"),m("expt"),m("atan2")}function implementBigInteger(s,c){"use strict";var e=s.get("es5globals"),t=s.get("uncurry"),n=s.get("SchemeNumber"),r=c.name||"BigInteger",o=t(e.Number.prototype.toString),i=t(e.String.prototype.replace),a=t(e.Array.prototype.concat),u=t(e.Array.map),g=e.Math.LN10,l=e.Math.LN2,f=e.Math.abs,h=e.Math.exp,p=e.Math.floor,d=e.Math.pow,_=e.Math.sqrt,m=e.Object.create(null),v=s.get("Dispatch").defGeneric("to"+r,1),x,I,b,y,N,B,w,E,R,S,C,O,F,A,T,M,P,q;function Z(e,t){C=e.get("nativeToInexact"),O=e.get("inexactRectangular"),F=e.get("ZERO"),A=e.get("ONE"),T=e.get("MINUS_ONE"),P=e.get("PI"),q=e.get("INEXACT_ZERO")}function D(){return r+"("+this.toString()+")"}function U(e,t,n){var r=c.parse(i(t,/^0+/,""),n);if(e<0)r=r.negate();return r}function $(e){return c.parse(o(e,16),16)}function j(){return c.parse(I(this))}function k(e){x("&implementation-restriction","exact integer would exceed limit of "+ +n.maxIntegerDigits+" digits; adjust SchemeNumber.maxIntegerDigits",e)}function L(e){if(this.isZero())return e.isZero()?A:this;if(this.isUnit()){if(this.isPositive())return this;return e.isEven()?A:this}e=e.valueOf();var t=this.pow(f(e));return e>=0?t:w(t)}function X(e){return this.toString(e)}function G(e,t){var n=e.divRem(t);if(n[1].isNegative()){if(t.isNegative())return[n[0].next(),n[1].subtract(t)];return[n[0].prev(),n[1].add(t)]}return n}function Y(e){return G(this,e)}function z(e){return G(this,e)[0]}function W(e){return G(this,e)[1]}function J(){var e=C(this.abs().log());return this.isPositive()?e:O(e,P)}function V(e){switch(R(e)){case 0:return this;case-1:return E(this,S(A,y(e)));case 1:if((e=+e)>n.maxIntegerDigits&&!this.isZero())k(e);return this.exp10(e)}}function Q(){var e=this.sign();if(0===e)return this;var t=C(h(this.abs().log()/2));if(e<0)return O(q,t);return t}function H(){function e(e,t){while(true){var n=e.divRem(t),r=n[0],i=t.subtract(r);if(i.isZero())return[r,n[1]];if(i.isUnit()){if(i.isPositive())return[r,r.add(n[1])];return[t,t.add(n[1])]}t=r.add(i.quotient(2))}}switch(this.sign()){case-1:x("&assertion","negative number",this);case 0:return[F,F]}var t=this.log()/2/g,n;if(t<7){var r=this.valueOf(),i=p(_(r));return[c(i),c(r-i*i)]}return e(this,c(o(d(10,t-p(t)))+"e"+p(t)))}function K(e){var t=this;if(t.isZero())return e;var n=e,r;while(true){if(r=t,(t=n.remainder(t)).isZero())return r;n=r}}function ee(a){function e(e){var t=this,n=c.ZERO,r=c.ONE,i,o;while(true){if(i=+(o=t.divRem(M))[1],t=o[0],o=e.divRem(M),i=a(i,+o[1]),e=o[0],i<0)i+=4294967296;if(n=n.add(r.multiply($(i))),t.isZero())break;r=r.multiply(M)}if(a(0,1))n=n.add(e.multiply(r));return n}return e}x=s.get("raise"),I=s.get("numberToString"),b=s.get("isNegative"),y=s.get("negate"),N=s.get("abs"),B=s.get("mod"),w=s.get("reciprocal"),E=s.get("divide"),R=s.get("sign"),S=s.get("exp10"),M=$(4294967296),s.onChange.subscribe(Z),Z(s);var te=ee(function(e,t){return e&t}),ne=ee(function(e,t){return e|t}),re=ee(function(e,t){return e^t}),ie,oe;function ae(e){return e+1}function ue(){if(!ie){ie=[0];while(ie.length<1<<8)ie=a(ie,u(ie,ae))}return ie}function se(){if(!oe){oe=[0];while(oe.length<1<<8)(oe=oe.concat(oe))[0]++}return oe}function ge(){var e=this,t=0,n,r,i;while(!e.isZero())e=(n=e.divRem(M))[0],r=+n[1],t+=(i=ue())[r>>0&255],t+=i[r>>8&255],t+=i[r>>16&255],t+=i[r>>24&255];return $(t)}function ce(){var e=this;switch(e.sign()){case 0:return F;case-1:e=c.M_ONE.subtract(e)}var t=e.log()/l,n=p(t),r=c.pow(2,p(t));if(r.compare(e)>0)while(true){if(e=e.add(e),r.compare(e)<=0)return $(n);n--}while(true)if(n++,(r=r.add(r)).compare(e)>0)return $(n)}function le(){var e=this,t,n,r;if(e.isZero())return T;for(r=0;;r+=32){if(!(n=(t=e.divRem(M))[1]).isZero())break;e=t[0]}n=+n;while(0===(255&n))r+=8,n>>=8;return $(r+se()[255&n])}function fe(e){var t=c.pow(2,+e);return this.remainder(t.add(t)).compare(t)>=0}function he(e,t){var n=c.pow(2,+e),r;switch(t-(this.remainder(n.add(n)).compare(n)>=0)){case 0:return this;case 1:return this.add(n);case-1:return this.subtract(n)}}function pe(e,t){e=+e;var n=c.pow(2,t-e),r=c.pow(2,e);return this.quotient(r).remainder(n)}function de(e,t,n){t=+t;var r=c.pow(2,n-t),i=c.pow(2,t),o=this.quotient(i).remainder(r);return this.add(i.multiply(e.subtract(o).quotient(r)))}function _e(e){var t=c.pow(2,+N(e));return b(e)?this.quotient(t):this.multiply(t)}function me(e,t,n){var r=t-(e=+e);if(r<2)return this;if(0===(n=+B(n,$(r))))return this;var i=c.pow(2,r),o=c.pow(2,e),a=c.pow(2,n),u=this.quotient(o).remainder(i),s=u.multiply(a);return s=s.add(s.quotient(i)).remainder(i),this.add(o.multiply(s.subtract(u)))}function ve(e,t){var n;e=+e;var r=c.pow(2,t-e),i=c.pow(2,+e),o=this.quotient(i).remainder(r),a=o.toString(2),u=a.length-1;if(u<1)return this;var s="";for(n=0;n<a.length;n++)s+=a[u-n];var g=c.parse(s,2);return this.add(g.subtract(o).multiply(i))}function xe(){var e=s.get("Dispatch"),t=s.get("ExactInteger"),n=s.get("debug"),r=s.get("retThis");function i(e,t){s.get(e).def(c,t)}function o(e,t){s.get(e).def(c,c,t)}function a(e){s.get(e).def(c,c.prototype[e])}function u(e){s.get(e).def(c,c,c.prototype[e])}e.defClass("BigInteger",{ctor:c,base:"ExactInteger"}),c.init(),n.def(c,D),v.def(c,r),v.def(t,j),o("expt",L),i("numberToString",X),a("isZero"),a("isEven"),a("isOdd"),a("sign"),a("isUnit"),a("isPositive"),a("isNegative"),a("negate"),a("abs"),a("square"),u("compare"),u("add"),u("subtract"),u("multiply"),i("log",J),i("exp10",V),i("sqrt",Q),i("exactIntegerSqrt",H),o("divAndMod",Y),o("div",z),o("mod",W),o("gcdNonnegative",K),o("bitwiseAnd",te),o("bitwiseIor",ne),o("bitwiseXor",re),i("bitCount",ge),i("bitLength",ce),i("firstBitSet",le),i("isBitSet",fe),i("copyBit",he),i("bitField",pe),o("copyBitField",de),i("bitShift",_e),i("rotateBitField",me),i("reverseBitField",ve)}return m.parseExactInteger=U,m.nativeToExactInteger=$,m.importExactInteger=v,m.install=xe,m}function defaultRationalFactory(o){"use strict";var a=o.get("ExactRational"),e=o.get("es5globals"),t=o.get("uncurry"),n=e.Object.create(null),r=e.Math.exp,i=e.isNaN,u=e.isFinite,s,g,c,l,f,h,p,d,_,m,v,x,I,b,y,N,B,w,E,R,S,C,O,F,A,T,M,w,P;function q(e,t){this._n=e,this._d=t}function Z(){return"Fraction("+s(this._n)+" / "+s(this._d)+")"}function D(){var e=this._n,t=this._d,n=e/t;if(u(n))return n;switch(C(e)){case 1:return r(N(e)-N(t));case-1:return-r(N(y(e))-N(t));case 0:default:return 0}}function U(){return this._n}function $(){return this._d}function j(e,t){return new q(e,t)}function k(e,t){return c(t)?e:new q(e,t)}s=o.get("debug"),g=o.get("retFalse"),c=o.get("isUnit"),l=o.get("numeratorAndDenominator"),f=o.get("ZERO"),h=o.get("ONE"),p=o.get("TWO"),d=o.get("makeRectangular"),_=o.get("eq"),m=o.get("compare"),v=o.get("add"),x=o.get("subtract"),I=o.get("multiply"),b=o.get("divide"),y=o.get("negate"),N=o.get("log"),B=o.get("exp"),w=o.get("isNegative"),E=o.get("abs"),R=o.get("sqrt"),S=o.get("SN_isFinite"),C=o.get("sign"),O=o.get("div"),F=o.get("expt"),A=o.get("square"),T=o.get("isZero"),M=o.get("isPositive"),w=o.get("isNegative"),P=o.get("raiseDivisionByExactZero"),(q.prototype=new a).valueOf=D;var L=o.get("Dispatch").defGeneric("toFraction",1);function X(){var e=l(this);return k(e[0],e[1])}function G(){return[this._n,this._d]}function Y(e){return _(this._d,e._d)&&_(this._n,e._n)}function z(e){var t=C(this._n)-C(e._n);if(0!==t)return t>0?1:-1;if(e._d===this._d)return m(this._n,e._n);return m(I(this._n,e._d),I(this._d,e._n))}function W(e){return m(this._n,I(this._d,e))}function J(e){return m(I(this,e._d),e._n)}function V(){return C(this._n)}function Q(){return M(this._n)}function H(){return w(this._n)}function K(){return j(y(this._n),this._d)}function ee(){return j(A(this._n),A(this._d))}function te(){var e=this._n;switch(C(e)){case-1:return k(y(this._d),y(e));case 1:return k(this._d,e);case 0:default:P()}}function ne(e){return b(v(I(this._n,e._d),I(e._n,this._d)),I(this._d,e._d))}function re(e){return j(v(this._n,I(e,this._d)),this._d)}function ie(e){return j(v(I(this,e._d),e._n),e._d)}function oe(e){return b(x(I(this._n,e._d),I(e._n,this._d)),I(this._d,e._d))}function ae(e){return j(x(this._n,I(e,this._d)),this._d)}function ue(e){return j(x(I(this,e._d),e._n),e._d)}function se(e){return b(I(this._n,e._n),I(this._d,e._d))}function ge(e,t,n){var r=l(b(n,t));return k(I(e,r[0]),r[1])}function ce(e){return ge(this._n,this._d,e)}function le(e){return ge(e._n,e._d,this)}function fe(e){return b(I(this._n,e._d),I(this._d,e._n))}function he(e){var t=l(b(this._n,e));return new q(t[0],I(t[1],this._d))}function pe(e){return b(I(this,e._d),e._n)}function de(e){var t,n;switch(C(e)){case 0:return h;case 1:t=this._n,n=this._d;break;case-1:default:if(t=this._d,n=this._n,e=E(e),w(n))t=y(t),n=y(n);if(c(n))return F(t,e)}return j(F(t,e),F(n,e))}function _e(){var e=E(this._n),t=R(e),n=R(this._d),r;if(S(t))if(S(n))r=b(t,n);else r=B(x(N(t),b(N(this._d),p)));else r=B(x(b(N(e),p),S(n)?N(n):b(N(this._d),p)));return w(this._n)?d(f,r):r}function me(){return x(N(this._n),N(this._d))}function ve(){return O(this._n,this._d)}function xe(){var e=o.get("Dispatch"),t=o.get("ExactInteger");function n(e,t,n,r){o.get(e).def(t,n,r)}function r(e,t){o.get(e).def(q,t)}function i(e,t){o.get(e).def(q,q,t)}e.defClass("Fraction",{ctor:q}),L.def(q,o.get("retThis")),L.def(a,X),r("debug",Z),r("numerator",U),r("denominator",$),r("numeratorAndDenominator",G),r("isInteger",g),i("eq",Y),n("eq",q,t,g),n("eq",t,q,g),i("compare",z),n("compare",q,t,W),n("compare",t,q,J),r("sign",V),r("isPositive",Q),r("isNegative",H),r("isZero",g),r("isUnit",g),r("floor",ve),r("negate",K),r("square",ee),r("reciprocal",te),i("add",ne),n("add",q,t,re),n("add",t,q,ie),i("subtract",oe),n("subtract",q,t,ae),n("subtract",t,q,ue),i("multiply",se),n("multiply",q,t,ce),n("multiply",t,q,le),i("divide",fe),n("divide",q,t,he),n("divide",t,q,pe),n("expt",q,t,de),r("sqrt",_e),r("log",me)}return n.divideReducedNotByOne=j,n.divideReduced=k,n.importRational=L,n.install=xe,n}function implementRectangular(e){"use strict";var t=e.get("Real"),n=e.get("Complex"),r=e.get("es5globals"),i=e.get("uncurry"),o=r.Object.create(null),a,u,s,g,c,l,f,h,p,d,_,m,v,x,I;function b(e){m=e.get("ZERO"),v=e.get("ONE"),x=e.get("MINUS_ONE"),I=e.get("INEXACT_ZERO")}function y(e,t){this._x=e,this._y=t}function N(){return this._x}function B(){return this._y}function w(){if(c(this._x))return C(this._x,h(this._y));return O(this._x,h(this._y))}function E(){return"Rectangular("+a(this._x)+", "+a(this._y)+")"}a=e.get("debug"),u=e.get("isZero"),s=e.get("isUnit"),g=e.get("isPositive"),c=e.get("isExact"),l=e.get("isInexact"),f=e.get("toInexact"),h=e.get("negate"),p=e.get("multiply"),d=e.get("cos"),_=e.get("sin"),e.onChange.subscribe(b),b(e),y.prototype=new n;var R=new y(m,v),S=new y(m,x);function C(e,t){if(u(t))return e;if(u(e)&&s(t))return g(t)?R:S;return new y(e,t)}function O(e,t){return new y(e,t)}function F(e,t){return O(p(d(t),e),p(_(t),e))}function A(e,t){return F(f(e),f(t))}function T(){return c(this._x)}function M(){return l(this._x)}return o.Rectangular=y,o.Rectangular_debug=E,o.Rectangular_realPart=N,o.Rectangular_imagPart=B,o.Rectangular_conjugate=w,o.exactRectangular=C,o.inexactRectangular=O,o.exactPolar=A,o.inexactPolar=F,o.Rectangular_isExact=T,o.Rectangular_isInexact=M,o}function installRectangular(r){var i=r.get("Rectangular");function t(e,t){var n=r.get(t);if(!n)console.log(t+" is not defined");r.get(e).def(i,n)}function e(e){t(e,"Rectangular_"+e)}t("isReal","retFalse"),t("isRational","retFalse"),t("isInteger","retFalse"),e("realPart"),e("imagPart"),e("isExact"),e("isInexact"),e("conjugate")}function defaultIntegerFactory(plugins){var BgIntgr=BigInteger;if(!BgIntgr)if("undefined"!==typeof load)load("biginteger.js");else if(this.readFile)eval(this.readFile("biginteger.js"));else throw new Error("BigInteger is not defined.");return implementBigInteger(plugins,BgIntgr)}function configure(e){var t=makeBase(),n=t.plugins,r=n.get("Dispatch"),i=n.get("debug")||{def:function(){}},o=e.integerFactory||defaultIntegerFactory,a=e.rationalFactory||defaultRationalFactory,u=o(n);u.install(),n.extend("nativeToExactInteger",u.nativeToExactInteger,"parseExactInteger",u.parseExactInteger),installDefaultExactInteger(n,u.importExactInteger);var s=a(n);s.install(),n.extend("divideReducedNotByOne",s.divideReducedNotByOne),installDefaultRational(n,s.importRational,s.divideReduced);var g=implementRectangular(n),c=g.Rectangular;n.extend(g),r.defClass("Rectangular",{ctor:c}),i.def(c,g.Rectangular_debug),installRectangular(n);var l=implementNativeInexactReal(n),f=l.NativeInexactReal;return n.extend("Flonum",f),n.extend(l),n.extend(implementNativeFlonumLibrary(n)),r.defClass("NativeInexactReal",{ctor:f}),i.def(f,l.NativeInexactReal_debug),installFlonum(n),t}var SchemeNumber=configure({});return SchemeNumber.configure=configure,SchemeNumber}();if("undefined"!==typeof exports)exports.SchemeNumber=SchemeNumber;function numberToString(e){var t=e+"";return-1===t.indexOf("e")?t:e.toFixed(20)}function convertToSchemeNumber(e){var t=e.indexOf("."),n;if(-1!==t){n=e.length-t-1,e=e.replace(".","")+"/1";for(var r=0;r<n;++r)e+="0"}return SchemeNumber(e)}function parseExpression(e,r){if(e&&e._v)return e._v;if(e&&"string"==typeof e&&r)e=e.replace(/%([a-z0-9-_]+)/gi,function(e,t){var n;if((t=isNaN(Number(t))?t:t-1)in r)if(isNaN(Number(r[t])))throw Error("   "+e+" ("+r[t]+")   ");else return r[t];else throw Error("  "+e+"   ")});if("number"==typeof(e=e||"0"))e=numberToString(e);var u={"-":2,"+":2,"*":3,"/":3,"<":1,"<=":1,">":1,">=":1,"=":1,"==":1,"!=":1,")":0,"(":-1};function s(e){return e.replace(/([0-9]+(?:\.[0-9]+)?)(?:e(-|\+)?([0-9]+))?/gi,function(e,t,n,r){var i="";if(r){r=parseInt(r,10),i="1";for(var o=0;o<r;o++)i+="0";return"("+t+(n&&"-"==n?"/":"*")+i+")"}else return e})}function t(t){var e=[],n=[],r,i=true;function o(){var e=t.match(/^\s*([+-]*)\s*([0-9]+(?:\.[0-9]+)?)\s*/);if(e){if(t=t.substr(e[0].length),"+"==e[1])e[1]="";return e[1]+e[2]}else return false}function a(){var e=t.match(/^\s*(>=|<=|==|!=|[\(\)\+\-*/><=])\s*/);if(e){if(t=t.substr(e[0].length),"=="==e[1])e[1]="=";return e[1]}else return false}t=s(t);while(t.length){if(i)if(r=o()){n.push(r),i=false;continue}if(r=a()){if(i&&"("!=r)throw'Unparsable expression: expected number or expression at >"'+t+'".';if(i=true,"("==r){e.push(r);continue}while(e.length&&u[e[e.length-1]]>=u[r])n.push(e.pop());if(")"==r)if(i=false,e.length&&"("==e[e.length-1])e.pop();else throw"Unparsable expression: closing bracket without opening.";else e.push(r);continue}throw'Unparsable expression: at symbol >"'+t+'".'}while(e.length&&"("!=e[e.length-1])n.push(e.pop());if(e.length)throw"Unparsable expression: opening bracket without closing.";return n}var n=t(e),i=[],o;for(o=0;o<n.length;++o)if(u[n[o]]){if(i.length<2)throw'Unparsable expression: incorrect queue in prefix notation (not enough operands) >"['+n.join(",")+"]["+o+']".';var a=i.pop(),g=i.pop();if(1==u[n[o]]&&o!=n.length-1)throw"Unparsable expression: multiple logic operations.";i.push(innerBigCalc(g,n[o],a))}else i.push(n[o]);if(i.length>1)throw'Unparsable expression: incorrect queue in prefix notation (too much operands) >"['+n.join(",")+"]["+o+']".';if(i.length<1)throw'Unparsable expression: incorrect queue in prefix notation (not enough operands) >"['+n.join(",")+"]["+o+']".';return i[0]}function mySchemeNumberConstructor(e){if("number"==typeof(e=e||"0"))e=numberToString(e);if("string"==typeof e)return convertToSchemeNumber(e);else if(e&&e._v)return e._v;else return e}function innerBigCalc(e,t,n){var r=["+","-","*","/","abs"],i=[">",">=","<","<=","=","!="],o=["toString"],a=r.concat(i).concat(o);if(-1==Array.indexOf(a,t)){var u=[].slice.apply(arguments),s;if(u.shift(),1==u.length&&"object"==typeof u[0])u=u[0];if("boolean"==typeof(s=parseExpression.apply(null,[e,u])))return s;return new MyBigNum(s)}if("!="==t)return!SchemeNumber.fn["="](mySchemeNumberConstructor(e),mySchemeNumberConstructor(n));else if(-1!=Array.indexOf(r,t))return new MyBigNum(SchemeNumber.fn[t](mySchemeNumberConstructor(e),mySchemeNumberConstructor(n)));else if(-1!=Array.indexOf(i,t))return SchemeNumber.fn[t](mySchemeNumberConstructor(e),mySchemeNumberConstructor(n));else if(-1!=Array.indexOf(o,t))if("toString"===t)return new MyBigNum(e).toString(n);else throw"Behaviour of operation "+t+" should be defined in bignumLibrary";else throw'bigNum operation "'+t+'" is no allowed. Allowed operations are '+a.join(", ")+". "}function MyBigNum(e){this._v=mySchemeNumberConstructor(e)}return MyBigNum.prototype.toString=function(e){return e=void 0!==e?e:2,this._v.toFixed(e)},innerBigCalc},bigCalc=function(){var e;function t(){return(e=e?e:_bigCalc()).apply(this,arguments)}return t}(),"function"==typeof define)define("WS/ext/bignumWrapper",[],function(){return bigCalc});