define("Core/TimeInterval",["Core/core-clone"],function(r){var e=1e3,n=6e4,o=36e5,i=864e5,t=60,s=60,u=24,a=["days","hours","minutes","seconds","milliseconds"],l={days:i,hours:o,minutes:n,seconds:e,milliseconds:1},c=[{regExp:/^P(?:(-?[0-9]+)D)?(?:T(?:(-?[0-9]+)H)?(?:(-?[0-9]+)M)?(?:(-?[0-9]+(?:\.[0-9]{0,3})?)[0-9]*S)?)?$/i,format:"P[<Число_дней>D][T[<Число_часов>H][<Число_минут>M][<Число_секунд>[.Число_долей_секунды]S]"}],f=[{regExp:/^P(-?[0-9]+D)?(T(-?[0-9]+H)?(-?[0-9]+M)?(-?[0-9]+(\.[0-9]+)?S)?)?$/i,format:"P[<Число_дней>D][T[<Число_часов>H][<Число_минут>M][<Число_секунд>[.Число_долей_секунды]S]"}];function h(){for(var t=[],e=0;e<f.length;e++)t[e]=f[e].format;return t.join(", ")}function p(t){return parseFloat(t)||0}function d(t){return t>0?Math.floor(t):Math.ceil(t)}function v(t,e){return p(p(t).toFixed(e))}function m(t){var e=[],r,n;if(!M(t))throw new Error(rk("Передаваемый аргумент не соответствует формату ISO 8601. Допустимые форматы")+": "+h()+". ");for(n=0;n<c.length;n++)if(r=c[n].regExp.exec(t))break;switch(n){case 0:for(var o=1;o<r.length;o++)if(o===r.length-1)e.push(d(r[o])),e.push(v(r[o]%1*1e3));else e.push(p(r[o]))}return e}function y(t){for(var e={},r=0;r<a.length;r++)e[a[r]]=p(t[r]);return e}function g(t){var e=0;for(var r in l)if(l.hasOwnProperty(r)){var n;e+=l[r]*p(t[r])}return e}function _(t){var e={};for(var r in l)if(l.hasOwnProperty(r)){var n=l[r];e[r]=d(t/n),t%=n}return e}function b(t){var e=v(t.seconds+t.milliseconds/1e3,3);return"P"+t.days+"D"+"T"+t.hours+"H"+t.minutes+"M"+e+"S"}function M(t){for(var e=0;e<f.length;e++)if(f[e].regExp.test(String(t)))return true;return false}function I(t){if("number"===typeof t&&t%1===0)return true;return false}function O(t,e){if(!(e instanceof Date))throw new Error(rk("Передаваемый аргумент должен быть объектом класса Date"));return(e=new Date(e.getTime())).setTime(e.getTime()+t*this.getTotalMilliseconds()),e}function T(t){if(this instanceof T)this._normIntervalObj=void 0,this._normIntervalStr=void 0,this.set(t);else throw new Error(rk("TimeInterval вызывать через оператор new"))}return T.prototype.getDays=function(){return this._normIntervalObj.days},T.prototype.addDays=function(t){return this.addMilliseconds(p(t)*i)},T.prototype.subDays=function(t){return this.subMilliseconds(p(t)*i)},T.prototype.getHours=function(){return this._normIntervalObj.hours},T.prototype.addHours=function(t){return this.addMilliseconds(p(t)*o)},T.prototype.subHours=function(t){return this.subMilliseconds(p(t)*o)},T.prototype.getMinutes=function(){return this._normIntervalObj.minutes},T.prototype.addMinutes=function(t){return this.addMilliseconds(p(t)*n)},T.prototype.subMinutes=function(t){return this.subMilliseconds(p(t)*n)},T.prototype.getSeconds=function(){return this._normIntervalObj.seconds},T.prototype.addSeconds=function(t){return this.addMilliseconds(p(t)*e)},T.prototype.subSeconds=function(t){return this.subMilliseconds(p(t)*e)},T.prototype.getMilliseconds=function(){return this._normIntervalObj.milliseconds},T.prototype.addMilliseconds=function(t){return this.set(this.getTotalMilliseconds()+d(t))},T.prototype.subMilliseconds=function(t){return this.set(this.getTotalMilliseconds()-d(t))},T.prototype.getTotalHours=function(){return this._normIntervalObj.days*u+this._normIntervalObj.hours},T.prototype.getTotalMinutes=function(){return this.getTotalHours()*s+this._normIntervalObj.minutes},T.prototype.getTotalSeconds=function(){return this.getTotalMinutes()*t+this._normIntervalObj.seconds},T.prototype.getTotalMilliseconds=function(){return this.getTotalSeconds()*e+this._normIntervalObj.milliseconds},T.prototype.set=function(t){var e;if((t=r(t))instanceof T)e="timeInterval";else if("string"===typeof t)e="intervalStr";else if(t instanceof Array)e="intervalArray";else if(t&&"object"===typeof t)e="intervalObj";else t=p(t),e="milliseconds";switch(e){case"intervalStr":t=m(t);case"intervalArray":t=y(t);case"intervalObj":t=g(t);case"milliseconds":this._normIntervalObj=t=_(t,false),this._normIntervalStr=b(t,false);break;case"timeInterval":this._normIntervalObj=t._normIntervalObj,this._normIntervalStr=t._normIntervalStr}return this},T.prototype.valueOf=T.prototype.toString=function(){return this._normIntervalStr},T.prototype.toObject=function(){return this._normIntervalObj},T.prototype.clone=function(){return new T(this)},T.prototype.calc=function(t,e){var r=["==","!=",">=","<=",">","<","+","-","+=","-="];if(-1===r.indexOf(t))throw new Error(rk("Операция")+' "'+t+'" '+rk("не доступна. Разрешенные операции")+": "+r.join(", "));if(!(this instanceof T&&e instanceof T))throw new Error(rk("Operand должен быть объектом класса TimeInterval"));var n=this.getTotalMilliseconds(),o=e.getTotalMilliseconds();switch(t){case"==":return n===o;case"!=":return n!==o;case">=":return n>=o;case"<=":return n<=o;case">":return n>o;case"<":return n<o;case"+":return(new T).set(n+o);case"-":return(new T).set(n-o);case"+=":return this.set(n+o);case"-=":return this.set(n-o)}},T.prototype.addToDate=function(t){return O.call(this,1,t)},T.prototype.subFromDate=function(t){return O.call(this,-1,t)},T.toString=function(t){if(void 0!==t)return T.prototype.set.call({},t)._normIntervalStr;return Function.toString.call(this)},T});