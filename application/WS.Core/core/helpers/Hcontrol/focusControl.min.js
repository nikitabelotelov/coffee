define("Core/helpers/Hcontrol/focusControl",["Core/helpers/Hcontrol/isScrollable","Core/helpers/Hcontrol/hasScrollbar","Vdom/Vdom"],function(c,u,f){var e;function a(){return e||(e=$(window))}return function(e){function o(e,n){return 1===e&&("fixed"===n.css("position")||n.is(".ws-scrolling-content")||c(n,"y")&&u(n,"y"))}function r(e){if(0===e.length)return $(null);else{var n=e.prop("nodeType");if(9===n)return $(e.prop("defaultView")||e.prop("parentWindow"));else if(o(n,e))return e;else return r(e.parent())}}function n(e){while(e){var n=e._getEnvironment();if(n)return n;e=e._logicParent}throw new Error("environment не был найден среди предков")}if(!e.isDestroyed()&&e._needFocusOnActivated()&&e.isVisibleWithParents()){var t=e._getElementToFocus(),i,l,s;if(t&&t.focus&&document.activeElement!==t.get(0))if((i=r(t.parent())).length>0){if(!$.isWindow(i.get(0))&&i.is("body, html"))i=a();l=i.scrollTop();try{if(e._ignoreNativeFocusIn=true,e.iWantVDOM&&n(e)._haveRebuildRequest)e.__$focusing=true;else f.Focus.focus(t.get(0))}finally{e._ignoreNativeFocusIn=false}if((s=i.scrollTop())!==l)i.scrollTop(l)}}}});