define("Core/generatePageURL",["Env/Env","Core/helpers/Object/isEmpty","Browser/Transport"],function(i,c,m){return function(e,r,a){if(e.editDialogTemplate&&(i.constants.htmlNames[e.editDialogTemplate]||i.constants.xmlContents[e.editDialogTemplate])){var t=!!e.isBranch,o=e.handlers&&"[object Object]"==Object.prototype.toString.call(e.handlers),n={id:e.id,hierMode:t,pk:e.recordId,copy:e.isCopy||false,readOnly:e.readOnly||false,obj:e.dataSource.readerParams.linkedObject,_events:{}},d,s;if(a)s=a;else if(i.constants.htmlNames[e.editDialogTemplate]){var l=i.constants.htmlNames[e.editDialogTemplate].split("/");s=l[l.length-1]}else d=i.constants.xmlContents[e.editDialogTemplate].split("/"),s=i.constants.appRoot+d[d.length-1]+".html";if(n["changedRecordValues"]=e.changedRecordValues,n["history"]=e.history,n["format"]=e.dataSource.readerParams.format,n["type"]=e.dataSource.readerType,e.dataSource.readerParams.otherURL!==i.constants.defaultServiceUrl)n["url"]=e.dataSource.readerParams.otherURL;if(n["db"]=e.dataSource.readerParams.dbScheme,n["method"]=e.dataSource.readerParams.queryName,n["readMethod"]=e.dataSource.readerParams.readMethodName,n["createMethod"]=e.dataSource.readerParams.createMethodName,n["updateMethod"]=e.dataSource.readerParams.updateMethodName,n["destroyMethod"]=e.dataSource.readerParams.destroyMethodName,t)if(n["branch"]=e.isBranch,n["pId"]=e.parentId,e.columnParentId)n["pIdCol"]=e.columnParentId;if(void 0===e.recordId)n["filter"]=e.filter,n._events["onBeforeCreate"]=o&&e.handlers.onBeforeCreate||[],n._events["onBeforeInsert"]=o&&e.handlers.onBeforeInsert||[];if(n._events["onBeforeRead"]=o&&e.handlers.onBeforeRead||[],n._events["onBeforeUpdate"]=o&&e.handlers.onBeforeUpdate||[],n._events["onBeforeShowRecord"]=o&&e.handlers.onBeforeShowRecord||[],n._events["onLoadError"]=o&&e.handlers.onLoadError||[],e.reports&&!c(e.reports))n["reports"]=e.reports,n._events["onBeforeShowPrintReports"]=o&&e.handlers.onBeforeShowPrintReports||[],n._events["onPrepareReportData"]=o&&e.handlers.onPrepareReportData||[],n._events["onSelectReportTransform"]=o&&e.handlers.onSelectReportTransform||[];if(r)return n;else return s+="?editParams="+encodeURIComponent(m.URL.serializeData(n))}else{if(!i.constants.htmlNames[e.editDialogTemplate]&&!i.constants.xmlContents[e.editDialogTemplate])i.IoC.resolve("ILogger").log("Core/generatePageURL",'ВНИМАНИЕ! Диалог "'+e.editDialogTemplate+'" отсутствует в оглавлении!');return false}}});