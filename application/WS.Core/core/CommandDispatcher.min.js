define("Core/CommandDispatcher",["Core/core-extend","Core/constants"],function(n,e){var t=null,r;function a(n){if(e.isBuildOnServer)return false;if(!t)t=requirejs("Lib/Control/Control").Control;return n&&n instanceof t||n&&n._template}return new(n({},{declareCommand:function(n,e,t){var r;if(a(n))(r=n.getUserData("commandStorage")||{})[e]=t.bind(n),n.setUserData("commandStorage",r)},deleteCommandsForObject:function(n){if(a(n))n.setUserData("commandStorage")},sendCommand:function(n,e){var t=Array.prototype.slice,r=t.call(arguments,2),a=t.call(arguments,1),o,l,i,m;if(n){if(n.hasEventHandlers("onCommandCatch"))if(i=n._notify.apply(n,["onCommandCatch"].concat(a)))return i;if(null!==(l=this._getCommand(n,e)))if(i=l.apply(n,r))return i;if(n.getOwner&&null!==(m=n.getOwner(true)))if(o=m,null!==(l=this._getCommand(o,e)))return l.apply(o,r)||true;var u=false;o=n;while(null!==(o=o.getParent())){if(o.hasEventHandlers("onCommandCatch"))if(u=true,i=o._notify.apply(o,["onCommandCatch"].concat(a)))return i;if(null!==(l=this._getCommand(o,e)))if(u=true,i=l.apply(o,r))return i}return u}else return false},_getCommand:function(n,e){if(a(n)){var t=n.getUserData("commandStorage");if(t)return t[e]||null}return null}}))});