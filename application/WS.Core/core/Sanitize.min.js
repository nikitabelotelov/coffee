define("Core/Sanitize",["Core/markup/ParserUtilities","Core/validHtml","Core/core-merge","Core/core-clone","Core/helpers/String/escapeHtml","Core/helpers/String/unEscapeASCII"],function(d,l,u,f,p,s){"use strict";var o=function e(t){return/^data-([\w-])*$/gi.test(t)},n=/(&#\d+)/gim,c=/javascript:/gim,e=/<!--/gim,t=/-->/gim;function h(e,t){var i;for(var r in e.attributes)if(e.attributes.hasOwnProperty(r)){var a=e.attributes[r];if("function"!==typeof(i=t.validAttributes[r]||(t.checkDataAttribute?o(r):false)))if(i){a.value=a.value.replace(n,function(e){return s(e+";")});while(c.test(a.value))a.value=a.value.replace(c,"")}else delete e.attributes[r];else i(e,r)}}function v(e,t){if(e.childNodes){var i=e.childNodes.length;while(i--){var r=e.childNodes[i],a=r.nodeType,s=r.nodeName,l=t.validNodes[(s||"").toLowerCase()];if("object"!==typeof l)if(1!==a||l){if("component"!==s)v(r,t)}else if(t.escapeInvalidTags)if(t.fullEscapeNodes[s]){var o=p(r.outerHTML());e.childNodes[i]=new d.Node({nodeType:3,text:o})}else{var n=r.childNodes;if(r.startTag)n.unshift(new d.Node({nodeType:3,text:p(r.startTag)}));if(r.closeTag)n.push(new d.Node({nodeType:3,text:p(r.closeTag)}));e.childNodes.splice.apply(e.childNodes,[i,1].concat(n)),i+=n.length}else e.childNodes.splice(i,1);else{var c=u(f(t),{validAttributes:l});v(e.childNodes[i],c)}}}h(e,t)}return function(e,t){var i,r,a,s;if("string"!==typeof e)return e;if(-1===e.search(/<[A-zA-я]/g))return e;e=e.replace(/<([^>]*)$/g,"&lt;$1");try{i=d.parse(e),a=true}catch(e){a=false}if(a)v(i,r=t?u(f(l),t):l),s=i.innerHTML();else s=p(e);return s}});