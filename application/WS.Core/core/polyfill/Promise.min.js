(function(t){var e=t["Promise"],n=e&&"resolve"in e&&"reject"in e&&"all"in e&&"race"in e&&(new e(function(t){r=t}),"function"===typeof r),r;if("undefined"!==typeof exports&&exports)exports.Promise=n?e:T,exports.Polyfill=T;else{if("function"===typeof define&&define.amd)define(function(){return n?e:T});if(!n)t["Promise"]=T}var o="pending",i="sealed",f="fulfilled",u="rejected",c=function(){};function a(t){return"[object Array]"===Object.prototype.toString.call(t)}var s="undefined"!==typeof setImmediate?setImmediate:setTimeout,l=[],h=function(){if("function"===typeof getPromiseAsyncQueue)return getPromiseAsyncQueue();else return l};function p(){for(var t=h(),e=0;e<t.length;e++)t[e][0](t[e][1]);t.length=0,t.timer=false}function d(t,e){var n=h();if(n.push([t,e]),!n.timer)n.timer=true,s(p,0)}function y(t,e){function n(t){v(e,t)}function r(t){g(e,t)}try{t(n,r)}catch(t){r(t)}}function m(t){var e=t.owner,n=e.state_,r=e.data_,o=t[n],i=t.then;if("function"===typeof o){n=f;try{r=o(r)}catch(t){g(i,t)}}if(!w(i,r)){if(n===f)v(i,r);if(n===u)g(i,r)}}function w(e,n){var r;try{if(e===n)throw new TypeError("A promises callback cannot return that same promise.");if(n&&("function"===typeof n||"object"===typeof n)){var t=n.then;if("function"===typeof t)return t.call(n,function(t){if(!r)if(r=true,n!==t)v(e,t);else _(e,t)},function(t){if(!r)r=true,g(e,t)}),true}}catch(t){if(!r)g(e,t);return true}return false}function v(t,e){if(t===e||!w(t,e))_(t,e)}function _(t,e){if(t.state_===o)t.state_=i,t.data_=e,d(b,t)}function g(t,e){if(t.state_===o)t.state_=i,t.data_=e,d(j,t)}function P(t){var e=t.then_;t.then_=void 0;for(var n=0;n<e.length;n++)m(e[n])}function b(t){t.state_=f,P(t)}function j(t){t.state_=u,P(t)}function T(t){if("function"!==typeof t)throw new TypeError("Promise constructor takes a function argument");if(this instanceof T===false)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],y(t,this)}T.prototype={constructor:T,state_:o,then_:null,data_:void 0,then:function(t,e){var n={owner:this,then:new this.constructor(c),fulfilled:t,rejected:e};if(this.state_===f||this.state_===u)d(m,n);else this.then_.push(n);return n.then},catch:function(t){return this.then(null,t)}},T.all=function(u){var t=this;if(!a(u))throw new TypeError("You must pass an array to Promise.all().");return new t(function(n,t){var r=[],o=0;function e(e){return o++,function(t){if(r[e]=t,!--o)n(r)}}for(var i=0,f;i<u.length;i++)if((f=u[i])&&"function"===typeof f.then)f.then(e(i),t);else r[i]=f;if(!o)n(r)})},T.race=function(o){var t=this;if(!a(o))throw new TypeError("You must pass an array to Promise.race().");return new t(function(t,e){for(var n=0,r;n<o.length;n++)if((r=o[n])&&"function"===typeof r.then)r.then(t,e);else t(r)})},T.resolve=function(e){var t=this;if(e&&"object"===typeof e&&e.constructor===t)return e;return new t(function(t){t(e)})},T.reject=function(n){var t;return new this(function(t,e){e(n)})}})("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this);