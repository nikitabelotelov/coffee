define("Core/LinkResolver/LinkResolver",["Core/core-extend","Core/helpers/getResourceUrl"],function(e,r){"use strict";function t(e){for(var i=[],t=0;t<e.length;t++)i.push(n(e[t]));return i.join("/")}function n(e){var i=e;return i=(i=i.replace(/\/+$/,"")).replace(/^\/+/,"")}var i;return e.extend([],{constructor:function(e,i,t,r,n){this.isDebug=e,this.buildNumber=i||"",this.wsRootFolder=t.replace(n,"");var s="";if(r&&!(n&&~n.indexOf(r)))s+="/"+r+"/";else if(r)this.resourceRootFolder=n.split(r)[1];if(n)s+="/"+n+"/";this.resourceRoot=("/"+s).replace(/[\/]+/g,"/"),this.originResourceRoot=n,this.initPaths()},resolveLinkTemplated:function(e){var i=e;if(i=this.resolveOldLink(e),!~e.indexOf("%"))i=this.originResourceRoot+i;return i},initPaths:function(e){e=e||requirejs.s.contexts._.config.paths;var i={},t;for(var r in e){if(0!==(t=e[r]).indexOf("/"))t="/"+t;t=t.split(this.resourceRootFolder)[1],i[r]=t}this.paths=i},getLinkWithResourceRoot:function(e){var i=t([this.resourceRoot,e]);if(0!==i.indexOf("/"))i="/"+i;return i},isRelativeLink:function(e){if(0===e.indexOf("/"))return false;else return true},resolveOldLink:function(e){var i=e,t="";for(var r in this.paths)if(0===e.indexOf(r))if(r.length>t.length)t=r;if(t.length&&this.paths[t])i=i.replace(t,this.paths[t]);return i},resolveLink:function(e,i){if(!this.isRelativeLink(e))return this.getLinkWithExt(e,i,false);else if(~this.resourceRoot.indexOf("%"))return this.getLinkWithExt(this.resolveLinkTemplated(e),i);var t=e;return t=this.resolveOldLink(t),t=this.getLinkWithResourceRoot(t),t=this.getLinkWithExt(t,i,!this.isDebug),t=r(t)},resolveCssWithTheme:function(e,i){var t=e;return t=this.getLinkWithResourceRoot(t),t=this.getLinkWithTheme(t,i),t=this.getLinkWithExt(t,"css",!this.isDebug)},getLinkWithTheme:function(e,i){if(!i)return e;return e+"_"+i},getLinkWithExt:function(e,i,t){var r=e;if(!t)r=e+"."+i;else{if("min"!==e.slice(-3))r=e+".min."+i;else r=e+"."+i;if(this.buildNumber)r=r+"?x_version="+this.buildNumber}return r}})});