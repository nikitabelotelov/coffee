define("Core/LinkResolver/LinkResolver",["Core/core-extend","Core/helpers/getResourceUrl"],function(e,n){"use strict";function t(e){for(var i=[],t=0;t<e.length;t++)i.push(r(e[t]));return i.join("/")}function r(e){var i=e;return i=(i=i.replace(/\/+$/,"")).replace(/^\/+/,"")}var i;return e.extend([],{constructor:function(e,i,t,n,r){this.isDebug=e,this.buildNumber=i||"",this.wsRootFolder=t.replace(r,"");var s="";if(n&&!(r&&~r.indexOf(n)))s+="/"+n+"/";if(r)s+="/"+r+"/";this.resourceRoot=("/"+s).replace(/[\/]+/g,"/"),this.originResourceRoot=r,this.initPaths()},resolveLinkTemplated:function(e){var i=e;if(i=this.fixOldAndBundles(e),!~e.indexOf("%"))i=this.originResourceRoot+i;return i},initPaths:function(e){var e=e||requirejs.s.contexts._.config.paths,i={},t,n=this.resourceRoot;if("undefined"!==typeof wsConfig)if(wsConfig._baseUrl&&wsConfig._baseUrl.length>this.resourceRoot.length)n=wsConfig._baseUrl;for(var r in e){if(0!==(t=e[r]).indexOf("/"))t="/"+t;t=t.split(n)[1],i[r]=t}this.paths=i},getLinkWithResourceRoot:function(e){var i=t([this.resourceRoot,e]);if(0!==i.indexOf("/"))i="/"+i;return i},isRelativeLink:function(e){if(0===e.indexOf("/"))return false;else return true},fixOldAndBundles:function(e){var i=e,t="";for(var n in this.paths)if(0===e.indexOf(n))if(n.length>t.length)t=n;if(t.length&&this.paths[t])i=i.replace(t,this.paths[t]);return i},resolveLink:function(e,i){if(!this.isRelativeLink(e))return this.getLinkWithExt(e,i,false);else if(~this.resourceRoot.indexOf("%"))return this.getLinkWithExt(this.resolveLinkTemplated(e),i);var t=e;return t=this.fixOldAndBundles(t),t=this.getLinkWithResourceRoot(t),t=this.getLinkWithExt(t,i,!this.isDebug),t=n(t)},resolveCssWithTheme:function(e,i){var t=e;return t=this.getLinkWithResourceRoot(t),t=this.getLinkWithTheme(t,i),t=this.getLinkWithExt(t,"css",!this.isDebug)},getLinkWithTheme:function(e,i){if(!i)return e;return e+"_"+i},getLinkWithExt:function(e,i,t){var n=e;if(!t)n=e+"."+i;else{if("min"!==e.slice(-3))n=e+".min."+i;else n=e+"."+i;if(this.buildNumber)n=n+"?x_version="+this.buildNumber}return n}})});