define("Core/js-template-doT",["Core/IoC","Core/helpers/Number/randomId"],function(IoC){"use strict";var doT={version:"0.2.0",templateSettings:null,template:void 0,compile:void 0,getSettings:function(){return{evaluate:/\{\{([\s\S]+?(\}?)+)\}\}/g,interpolate:/\{\{=([\s\S]+?)\}\}/g,translate:/\{\[([\s\S]+?)\]\}/g,encode:/\{\{!([\s\S]+?)\}\}/g,use:/\{\{#([\s\S]+?)\}\}/g,define:/\{\{##\s*([\w\.$]+)\s*(\:|=)([\s\S]+?)#\}\}/g,conditional:/\{\{\?(\?)?\s*([\s\S]*?)\s*\}\}/g,iterate:/\{\{~\s*(?:\}\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*\}\})/g,expertMode:/<!--WS-EXPERT([\s\S]+?)WS-EXPERT-->/g,ref:/\{\{@([\s\S]+?)\}\}/g,varname:"it",strip:true,append:true,selfcontained:true}}};doT.templateSettings=doT.getSettings();var global=function(){return this||(0,eval)("this")}();if(global.doT=doT,"undefined"!==typeof window)window.global=global;function initVarStorage(){if(!global.wsDotVarStorage)global.wsDotVarStorage={storage:{}}}function encodeHTMLSource(){var r={"&":"&#38;","<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","/":"&#47;"},n=/&(?!#?\w+;)|<|>|"|'|\//g;return function e(t){return t?t.toString().replace(n,function(e){return r[e]||e}):t}}function getStringPresentation(e){return e.join?e.join(""):e.toString()}function wrapUndefinedSource(){return function e(t){return void 0===t?"":t&&"object"===typeof t?getStringPresentation(t):""+t}}function encodeEvalSource(){var r=/\{\{([\s\S]+?)\}\}/g,n="&#123;&#123;$1&#125;&#125;";return function e(t){while(r.test(t))t=t.replace(r,n);return t}}global.encodeHTML=encodeHTMLSource(),global.wrapUndefined=wrapUndefinedSource(),global.encodeEval=encodeEvalSource();var startend={append:{start:"'+(encodeEval(wrapUndefined(",end:")))+'",startencode:"'+encodeEval(wrapUndefined(encodeHTML("},split:{start:"';out+=(",end:");out+='",startencode:"';out+=encodeHTML("}},skip=/$^/;function resolveDefs(c,block,def){return("string"===typeof block?block:block.toString()).replace(c.define||skip,function(m,code,assign,value){if(0===code.indexOf("def."))code=code.substring(4);if(!(code in def))if(":"===assign)def[code]=value;else eval("def['"+code+"']="+value);return""}).replace(c.use||skip,function(m,code){var v=eval(code);return v?resolveDefs(c,v,def):v})}function unescape(e){return e.replace(/\\('|\\)/g,"$1").replace(/[\r\t\n]/g," ")}return doT.template=function(e,t,r,n){var o=(t=t||doT.templateSettings).append?startend.append:startend.split,a,i,c=0,u;if(t.use||t.define){var s=global.def;global.def=r||{},a=resolveDefs(t,e,global.def),global.def=s}else a=e;if(a=("var randomId = (typeof _randomId !== 'undefined' ? _randomId : undefined) || (function(){return this || (0, eval)('this')})().requirejs('Core/helpers/Number/randomId');"+"function escapeHtml(str) {return typeof str == \"string\" ? str.replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;') : str;}"+"var storage = (function() { return this || (0,eval)('this') })().wsDotVarStorage.storage;"+" var out='"+(t.strip?a.replace(/(^|\r|\n)\t* +| +\t*(\r|\n|$)/g," ").replace(/\r|\n|\t|\/\*[\s\S]*?\*\//g,""):a).replace(/'|\\/g,"\\$&").replace(t.expertMode||skip,function(e,t){return unescape(t)}).replace(t.translate||skip,function(e,t){return o.start+"escapeHtml(rk('"+unescape(t.replace(/'/g,"\\'"))+"'))"+o.end}).replace(t.ref||skip,function(e,t){return o.start+"(function setRefValue(s, v){var k = randomId(); s[k] = v; return k;}(storage, "+unescape(t)+"))"+o.end}).replace(t.encode||skip,function(e,t){return i=true,o.startencode+unescape(t)+o.end}).replace(t.interpolate||skip,function(e,t){return o.start+unescape(t)+o.end}).replace(t.conditional||skip,function(e,t,r){return t?r?"';}else if("+unescape(r)+"){out+='":"';}else{out+='":r?"';if("+unescape(r)+"){out+='":"';}out+='"}).replace(t.iterate||skip,function(e,t,r,n){if(!t)return"';} } out+='";return c+=1,u=n||"i"+c,t=unescape(t),"';var arr"+c+"="+t+";if(arr"+c+"){var "+r+","+u+"=-1,l"+c+"=arr"+c+".length-1;while("+u+"<l"+c+"){"+r+"=arr"+c+"["+u+"+=1];out+='"}).replace(t.evaluate||skip,function(e,t){return"';"+unescape(t)+"out+='"})+"'; out = encodeEval(out); return out + (pp && out.indexOf('{{') !== -1 ? String.fromCharCode(8203,8203) : '');").replace(/\n/g,"\\n").replace(/\t/g,"\\t").replace(/\r/g,"\\r").replace(/\u2028/g,"\\n").replace(/\u2029/g,"\\n").replace(/(\s|;|}|^|{)out\+='';/g,"$1").replace(/\+''/g,"").replace(/(\s|;|}|^|{)out\+=''\+/g,"$1out+="),a="var encodeEval=("+encodeEvalSource.toString()+"());"+"var getStringPresentation="+getStringPresentation.toString()+";"+"var wrapUndefined=("+wrapUndefinedSource.toString()+"());"+"var pp = typeof process !== 'undefined';"+a,i&&t.selfcontained)a="var encodeHTML=("+encodeHTMLSource.toString()+"());"+a;try{return new Function(t.varname,a)}catch(e){if(!n)throw IoC.resolve("ILogger").error("doT","Could not create template function: "+a,e),e}},doT.compile=function(e,t){return doT.template(e,null,t)},initVarStorage(),doT});