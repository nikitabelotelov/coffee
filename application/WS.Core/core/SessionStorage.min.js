define("Core/SessionStorage",["Core/UserInfo","Core/detection","Core/constants","Core/_storage"],function(t,e,o,r){var n,i=r.getSession(),s=4*1e3,f="wsss",u,a;function c(){if(!o.isBrowserPlatform&&o.isBuildOnServer){var e=process&&process.domain&&process.domain.req||{};u=e.sessionStorage=e.sessionStorage||{}}if(u)return u;var r=i.getItem(f);try{u=JSON.parse(r)||{}}catch(e){u={}}if(!t.isValid(u.user))i.removeItem(f),(u={}).user=t.getCurrent();return u}if(o.isBrowserPlatform){var l=e.firefox?"beforeunload":"unload";window.addEventListener(l,function(){i.setItem(f,JSON.stringify(c()))})}function m(){if(!o.isBrowserPlatform)return;if(n)clearTimeout(n);n=setTimeout(function(){i.setItem(f,JSON.stringify(c())),n=null},s)}return{get:function(e){return c()[e]},set:function(e,r){if(!e)return;if(null==r&&"object"==typeof e&&"[object Object]"==Object.prototype.toString.call(e)){for(var t in e)if(e.hasOwnProperty(t))c()[t]=e[t]}else c()[e]=r;m()},remove:function(e){delete c()[e],m()},toObject:function(){return c()}}});