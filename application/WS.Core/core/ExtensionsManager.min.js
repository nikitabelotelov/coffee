define("Core/ExtensionsManager",["Core/helpers/Object/isEmpty","Core/constants","Core/Deferred","Core/IoC","optional!Types/source"],function(i,a,n,r,o){var e;return{checkExtensions:function(e){var s;if(this.extensionsNeeded())if(a.isNodePlatform)s=process&&process.domain&&process.domain.req&&process.domain.req.systemExtensions;else if(a.isBrowserPlatform)if(window.systemExtensions&&!i(window.systemExtensions))s=window.systemExtensions;if(s=s||{},e){var n=!!Object.keys(s).length,r={};if(!(e instanceof Array))e=[e];for(var o in e)if(e.hasOwnProperty(o)){var t=e[o];if(n)r[t]=s&&s[t]||false;else r[t]=false}return r}return s},loadExtensions:function(){var s=new n;if(a.isBrowserPlatform)if((null===window.systemExtensions||void 0===window.systemExtensions)&&a.systemExtensions)this.getSystemExtensions().addCallback(function(e){window.systemExtensions=e,s.callback(e)}).addErrback(function(e){s.errback(e)});else s.callback(window.systemExtensions||{});else s.callback(null);return s},extensionsLoaded:function(){if(a.isBrowserPlatform)return!!window.systemExtensions;return true},getSystemExtensions:function(){if(!o)throw new Error("Для работы Core/ExtensionsManager нужен модуль Types/source:SbisService");var s=new n,e=new o.SbisService({endpoint:"КонфигурацияИнтерфейса"});return s.addErrback(function(e){return e}),e.call("Extensions",{}).addCallback(function(e){s.callback(e.getScalar())}).addErrback(function(e){r.resolve("ILogger").error("System extensions","Transport error",e),s.errback(e)}),s},extensionsNeeded:function(){if(a.isNodePlatform){var e;try{e=process.application.getCurrentService()}catch(e){}return e&&e.extensionsNeeded()}else if(a.isBrowserPlatform)return window.systemExtensions&&!i(window.systemExtensions)||a.systemExtensions||false}}});