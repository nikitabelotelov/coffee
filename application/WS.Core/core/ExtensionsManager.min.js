define("Core/ExtensionsManager",["Core/helpers/Object/isEmpty","Env/Env","Core/Deferred","optional!Types/source"],function(i,a,n,t){var e;return{checkExtensions:function(e){var s;if(this.extensionsNeeded())if(a.constants.isNodePlatform)s=process&&process.domain&&process.domain.req&&process.domain.req.systemExtensions;else if(a.constants.isBrowserPlatform)if(window.systemExtensions&&!i(window.systemExtensions))s=window.systemExtensions;if(s=s||{},e){var n=!!Object.keys(s).length,t={};if(!(e instanceof Array))e=[e];for(var o in e)if(e.hasOwnProperty(o)){var r=e[o];if(n)t[r]=s&&s[r]||false;else t[r]=false}return t}return s},loadExtensions:function(){var s=new n;if(a.constants.isBrowserPlatform)if((null===window.systemExtensions||void 0===window.systemExtensions)&&a.constants.systemExtensions)this.getSystemExtensions().addCallback(function(e){window.systemExtensions=e,s.callback(e)}).addErrback(function(e){s.errback(e)});else s.callback(window.systemExtensions||{});else s.callback(null);return s},extensionsLoaded:function(){if(a.constants.isBrowserPlatform)return!!window.systemExtensions;return true},getSystemExtensions:function(){if(!t)throw new Error("Для работы Core/ExtensionsManager нужен модуль Types/source:SbisService");var s=new n,e=new t.SbisService({endpoint:"КонфигурацияИнтерфейса"});return s.addErrback(function(e){return e}),e.call("Extensions",{}).addCallback(function(e){s.callback(e.getScalar())}).addErrback(function(e){a.IoC.resolve("ILogger").error("System extensions","Transport error",e),s.errback(e)}),s},extensionsNeeded:function(){if(a.constants.isNodePlatform){var e;try{e=process.application.getCurrentService()}catch(e){}return e&&e.extensionsNeeded()}else if(a.constants.isBrowserPlatform)return window.systemExtensions&&!i(window.systemExtensions)||a.constants.systemExtensions||false}}});