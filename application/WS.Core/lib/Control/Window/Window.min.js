define("Lib/Control/Window/Window",["Core/core-extend","Core/helpers/isNewEnvironment","require","Core/core-instance","Core/helpers/Function/callNext","Core/helpers/Function/forAliveOnly","Core/WindowManager","Core/CommandDispatcher","Env/Env","Core/helpers/Hcontrol/doAutofocus","Lib/Control/TemplatedAreaAbstract/TemplatedAreaAbstract","Lib/Control/ModalOverlay/ModalOverlay","Lib/FloatAreaManager/FloatAreaManager","Lib/Mixins/LikeWindowMixin","Lib/Mixins/PendingOperationParentMixin","Core/Deferred","Env/Event","Core/dom/wheel","Core/dom/getTouchEventCoords","Core/dom/getTouchEventClientCoords","css!Lib/Control/FloatArea/FloatArea","i18n!Lib/Control/Window/Window"],function(t,i,e,h,s,a,r,n,I,o,d,l,_,c,u,f,w,p,m,g){"use strict";var v=10,W=150,b=(I.constants.defaultOptions||{})["Lib/Control/Window/Window"]||{};function k(i,t){var e=function(){var t;try{this._updateCount++,t=i.apply(this,arguments)}finally{if(this._updateCount--,0===this._updateCount&&false!==t){this._updateCount++;try{this._adjustWindowPosition(),this._onResizeHandler()}finally{this._updateCount--}}}return t};return t?e.bind(t):e}var C=t.mixin(d,[c,u]).extend({$protected:{_window:void 0,_windowContent:void 0,_updateCount:0,_titleBar:void 0,_resizeBar:void 0,_resizeBtn:void 0,_isShow:false,_isMaximized:false,_isCenteredV:false,_isCenteredH:false,_isAnimated:false,_isAnimating:false,_animatedWindows:false,_leftOpt:void 0,_topOpt:void 0,_maximizeBtn:void 0,_left:void 0,_top:void 0,_dRender:null,_zIndex:0,_startCoords:null,_options:{modal:false,resizable:true,caption:void 0,windowState:true,disableActions:false,deprecated:false,border:true,maximize:void 0,top:void 0,left:void 0,parent:null,title:"",animatedWindows:void 0,closeOnOverlayClick:true,draggable:true,origWidth:0,needSetDocumentTitle:true,origHeight:0,needRecalcPositionOnSizeChange:true,task_1174068748:false,adjustPositionAfterResize:false},_keysWeHandle:[I.constants.key.esc,I.constants.key.tab,I.constants.key.enter,I.constants.key.left,I.constants.key.right],_haveTitle:false,_haveContentTitleBlock:false,_mouseMoveHandler:null,_mouseUpHandler:null,_absolutePosition:false},$constructor:function(t){if(this._mouseMoveHandler=this._mouseMove.bind(this),this._mouseUpHandler=this._mouseUp.bind(this),this._animatedWindows=void 0===this._options.animatedWindows?b.animatedWindows:this._options.animatedWindows,this._leftOpt=void 0===this._options.left?b.left:this._options.left,this._topOpt=void 0===this._options.top?b.top:this._options.top,this._moveWindowWithRecalc=k(this._moveWindow,this),this._dRender=new f,this._publish("onBeforeClose","onAfterClose","onMove","onAfterMove"),[["close",this.close],["ok",this.ok],["cancel",this.cancel],["maximize",this._maximizeWindow],["rebuildTitleBar",this._rebuildTitleBar]].forEach(function(t){n.declareCommand(this,t[0],t[1])}.bind(this)),void 0!==t.resizeable)this._options.resizable=t.resizeable;var i={left:parseInt(this._options.left,10),top:parseInt(this._options.top,10)};if(I.constants.browser.isMobileSafari&&!this._options.resizable&&this._options.maximize)this._absolutePosition=false,i.right=0;else this._absolutePosition=true;if(this._window=this._createControl().css(i),this.subscribe("onAfterLoad",function(){if(this._options.deprecated)this.close(),e(["SBIS3.CONTROLS/Utils/InformationPopupManager"],function(t){t.showMessageDialog({status:"error",message:rk("У Вас недостаточно прав для просмотра.")})});else if(this._options.visible)this.show()}),I.constants.browser.isIE)this.subscribe("onBatchFinished",function(){this._window.addClass("clear-box-shadow"),this._container.width(),this._window.removeClass("clear-box-shadow")});if(this._adjustWindowPositionSelf=this._mobileInput.bind(this),I.constants.compatibility.touch)w.Bus.globalChannel().subscribe("MobileInputFocus",this._adjustWindowPositionSelf),w.Bus.globalChannel().subscribe("MobileInputFocusOut",this._adjustWindowPositionSelf);if(this._isModal&&this._options.closeOnOverlayClick)this.subscribeTo(l,"onClick",function(t){if(this.isVisible()&&l.isShownForWindow(this))this._moveFocusToSelf(),t.setResult(true),this.close()}.bind(this));if(w.Bus.globalChannel().notify("onWindowCreated",this),this._checkOpener(),this._options.adjustPositionAfterResize)this._orientationChangeHandler=this._orientationChangeHandler.bind(this),window.addEventListener("orientationchange",this._orientationChangeHandler)},_checkOpener:function(){if(i()&&!this._options._openFromAction)I.IoC.resolve("ILogger").error("Window","Компонент открыт напрямую без использования хэлперов открытия. \n"+"Для правильной работы компонента окно должно быть открыто через action. \n"+"Подробности: https://wi.sbis.ru/doc/platform/developmentapl/interface-development/ws4/components/templates/open-compound-template/")},_mobileInput:function(t){var i="mobileinputfocus"===t.name;if(this._options.adjustPositionAfterResize&&(this._options.top||this._options.left))return;setTimeout(function(){if(!i)this._adjustWindowPosition()}.bind(this),350)},_activateParent:function(){return false},_templateInnerCallback:k(function(){return C.superclass._templateInnerCallback.apply(this,arguments)}),_getTemplateComponent:function(){return this.getChildControls(void 0,false)[0]},_templateInnerCallbackBeforeReady:function(){var t=parseInt(this._leftOpt,10),i=parseInt(this._topOpt,10),e;if(this._left=isNaN(t)?0:t,this._top=isNaN(i)?0:i,this._isCenteredV=isNaN(i),this._isCenteredH=isNaN(t),this._isMaximized=!!(void 0!==this._options.maximize?this._options.maximize:this._options.windowState&&"maximized"==this._options.windowState),this.getContainer().toggleClass("ws-window-maximized",this._isMaximized),this._createTitleBar(),this._options.resizable&&!(this._options.autoWidth&&this._options.autoHeight))this._resizeBtn=$("<div></div>").addClass("ws-window-resize").bind("mousedown touchstart",function(t){return this._isResizing=true,this._mouseDown(t)}.bind(this)).appendTo(this._window);if(this._container.append('<div style="clear: both;">'),this._isOptionDefault("height")&&this._options.autoHeight)e="auto";else if(this._haveTitle&&!this._haveContentTitleBlock)if(e=parseInt(this._height,10),!isNaN(e))e+=this._titleBar.height();else e=this._height;else e=this._height;this.setSize({width:this._isOptionDefault("width")&&this._options.autoWidth?"auto":this._width,height:e}),this._dRender.callback()},_setMinMaxSizes:function(){},_postUpdateResizer:function(t,i){},describe:function(){return"Window#"+this.getId()+" template: "+(this._currentTemplateInstance&&this._currentTemplateInstance.getName()||this._options.template)},_loadDescendents:function(){return this._loadTemplate()},_childrenLoadCallback:function(){},_setTemplateDimensions:function(t){if(t.width&&this._isOptionDefault("width"))this._width=t.width;if(t.height&&this._isOptionDefault("height"))this._height=t.height},_isAcceptKeyEvents:function(){return true},_keyboardHover:function(t){if(t.which in this._keysWeHandle){if(t.which==I.constants.key.esc)return this.close(),false;if(t.which==I.constants.key.left||t.which==I.constants.key.right)return this._switchingBetweenButtons(t);if(this.isEnabled())return C.superclass._keyboardHover.apply(this,arguments);else return true}return true},_switchingBetweenButtons:function(t){var i=r.getActiveWindow().getActiveChildControl(),e=this.getChildControls(),s=0,n=[],o,a;if(i&&!h.instanceOfModule(i,"Deprecated/Controls/Button/Button"))return true;for(o=0;o<e.length;o++)if(h.instanceOfModule(e[o],"Deprecated/Controls/Button/Button"))n.push(e[o]);for(o=0;o<n.length;o++)if(n[o].isActive()){s=o;break}if(t.which==I.constants.key.left)a=s-1;if(t.which==I.constants.key.right)a=s+1;if(n[a=(n.length+a)%n.length])n[s].setActive(false),n[a].setActive(true);return false},_createControl:function(){var t=this._isModal?"ws-modal":"",i=this._absolutePosition?"ws-absolute":"ws-fixed",e={opacity:0},o;if(this._absolutePosition)e.left=0,e.top=0;return o=$("<div></div>",{tabindex:0}).appendTo(document.body).css(e).addClass(i+" ws-window radius "+[t,this._options.cssClassName,this._options.className].join(" ")),this._windowContent=$("<div>",{style:"z-index: 0"}).addClass("ws-window-content radius").appendTo(o),this._container.prependTo(this._windowContent),this._container.css("z-index",0),p(o,function(t){var i=$(t.target,o),s=t.wheelDelta,e,n;if(!(i.toArray().concat(i.parentsUntil(o).toArray()).filter(function(t){var i=$(t),e=i.css("overflow-y");return("auto"===e||"scroll"===e)&&(s<0&&t.scrollHeight-i.scrollTop()>t.offsetHeight||s>0&&i.scrollTop()>0)}).length>0))if(t.stopPropagation(),!i.is("object"))t.preventDefault()}),o.get(0).wsControl=this,o},_setupTitleVisibility:function(){this._title.toggleClass("ws-hidden",0===this._title.html().trim().length)},_rebuildTitleBar:function(){var t;this._window.find(".ws-window-titlebar-custom.ws-window-titlebar").remove(),this._createTitleBar()},_createTitleBar:function(){var t=this._window.find(".ws-window-titlebar-custom").eq(0),i=this._container.find(".ws-Window__title-border").eq(0),e,s,n,o,a;if(this._haveContentTitleBlock=i.length>0,this._haveTitle=this._options.border||this._haveContentTitleBlock,this._haveTitle){if(this._haveContentTitleBlock)this._titleBar=i;else if(t.length>0)this._titleBar=t;else this._titleBar=$("<div></div>");if(e=this._haveContentTitleBlock?"radius":"ws-window-titlebar radius",o=function(t){if(!this._targetIsHeaderControl(t))t.preventDefault()}.bind(this),a=function(t){if(!this._targetIsHeaderControl(t))this._maximizeWindow()}.bind(this),this._titleBar.addClass(e).mousedown(o).dblclick(a).prependTo(this._window).append("<div>&nbsp;</div>"),!this._haveContentTitleBlock)this._title.addClass("ws-window-title").prependTo(this._titleBar),this._createTitleButtons(),this._applyDrag(this._titleBar);else if(this._title.detach(),(n=this._titleBar.find('div[sbisname="windowTitle"]')).length)this._applyDrag(n);if(this._options.draggable)this._window.addClass("ws-window-draggable");if(this._titleBar.removeClass("ws-hidden"),this._initKeyboardMonitor(this._titleBar),this._initKeyboardMonitor(this._window),s=void 0!==this._options.caption?this._options.caption:this._options.title)this.setTitle(s);this._setupTitleVisibility()}else if(this._titleBar)this._title.detach(),this._titleBar.remove(),this._titleBar=void 0,this._window.removeClass("ws-window-draggable")},_applyDrag:function(t){if(this._options.draggable)t.bind("mousedown touchstart",this._mouseDown.bind(this))},applyDrag:function(t){this._applyDrag(t)},_makeLoadErrorHandler:function(t){var i=C.superclass._makeLoadErrorHandler.call(this,t);return function(t){try{this._createTitleBar()}catch(t){}i.call(this,t)}},_createTitleButtons:function(){var t=this;if(!this._options.disableActions){if(this._options.resizable)this._maximizeBtn=$("<a></a>").addClass("ws-window-titlebar-action maximize").click(function(){t._maximizeWindow()}).prependTo(this._titleBar);$("<a></a>").addClass("ws-float-close ws-float-close-right").click(function(){return t._moveFocusToSelf(),t.close(),false}).prependTo(this._titleBar)}},_updateDocumentTitle:function(){var t=this.getTitle(),i=document.title,e=i?" - "+t:t,s=i.lastIndexOf(e),n=i.lastIndexOf(t);if(this._options.needSetDocumentTitle&&t&&(s!==i.length-e.length||i.length<e.length)&&(n!==i.length-t.length||i.length<t.length))document.title=document.title+e},_clearDocumentTitle:function(){var t=this.getTitle(),i=document.title,e=i?" - "+t:t,s=i.lastIndexOf(e),n=i.lastIndexOf(t),o;if(t&&(s===i.length-e.length||n===i.length-t.length))o=-1!==s?s:n,document.title=i.slice(0,-1!==o?o:i.length)},_setTitle:function(t){C.superclass._setTitle.apply(this,arguments),this._window.find('div[sbisname="windowTitle"] span').text(t),this._setupTitleVisibility()},getZIndex:function(){return this._zIndex},show:function(t){if(!this._isShow){if(I.detection.isIE)this._window.addClass("ws-invisible");this._dRender.addCallback(s.call(this._showRenderCallback.bind(this,t),this._notifyBatchDelayed.bind(this,"onAfterShow")))}},_showRenderCallback:function(t){if(k(function(){if(this._window.css("opacity",""),this._window.removeClass("ws-hidden"),this._notify("onBeforeShow"),this._updateDocumentTitle(),this._isShow=true,this._checkDelayedRecalk(),!t)this.moveToTop(),o(this._container);else r.setVisible(this._zIndex);if(this._isModal)l.adjust();this._notify("onAfterVisibilityChange",true)},this)(),I.detection.isIE)this._window.removeClass("ws-invisible")},_hideWindow:function(){this._window.addClass("ws-hidden"),this._isShow=false,r.popAndShowNext(this)},_restoreLastActiveOnHide:function(){if(I.detection.isMobileIOS)$(document.activeElement).trigger("blur");var t=r.getActiveWindow();if(t)t.onBringToFront()},_notifyMaximizedChange:function(t){_._setWindowMaximized(this,t)},hide:function(){if(!this._isShow)return;if(this._notifyMaximizedChange(false),this._hideWindow(),r.releaseZIndex(this._zIndex),this._clearDocumentTitle(),this._restoreLastActiveOnHide(),this._releaseZIndex(),this._isModal)l.adjust();this._notify("onAfterVisibilityChange",false)},isVisible:function(){return this._isShow},close:function(n){var e=this;function o(t){var i=new f;return i.addCallback(function(){var t=e._saving;return e._saving=void 0,e.finishChildPendingOperations(t)}),e.waitAllPendingOperations(i.addCallback(t))}return this._saving=n,this.getReadyDeferred().addCallback(a(function(){var t=this,i=this._notify("onBeforeClose",n),e=function(){t.hide(),t._notify("onAfterClose",n),t.destroy()},s=this.getActiveChildControl(void 0,true);while(s)s&&s.setActive(false),s=s.getParent();if(false!==i)if(this._animatedWindows&&!this._isAnimating)this._isAnimating=true,this._window.animate({top:"-="+this._window.height()+"px"},W,function(){this._isAnimating=false,o(e.bind(t))});else o(e)},this))},_removeContainer:function(){this._window.empty().remove()},_releaseZIndex:function(){if(0!=this._zIndex)r.releaseZIndex(this._zIndex),this._zIndex=0},destroy:function(){if(this._notifyMaximizedChange(false),this._window.get(0).wsControl=null,this._titleBar)this._titleBar.unbind(),this._window.find('div[sbisname="windowTitle"]').unbind(),this._titleBar.empty().remove(),this._titleBar=$();if(this._resizeUnsub&&this._resizeUnsub(),this._releaseZIndex(),I.constants.compatibility.touch)w.Bus.globalChannel().unsubscribe("MobileInputFocus",this._adjustWindowPositionSelf),w.Bus.globalChannel().unsubscribe("MobileInputFocusOut",this._adjustWindowPositionSelf);if(this._options.adjustPositionAfterResize)window.removeEventListener("orientationchange",this._orientationChangeHandler);if(C.superclass.destroy.apply(this,arguments),this._windowContent)this._windowContent.empty().remove(),this._windowContent=$();this.hide(),this._window=$()},ok:function(){return this.close(true)},cancel:function(){return this.close(false)},shadowsOff:function(){if(this._window.removeClass("radius"),this._windowContent.removeClass("radius"),this._titleBar)this._titleBar.removeClass("radius")},shadowsOn:function(){if(this._window.addClass("radius"),this._windowContent.addClass("radius"),this._titleBar)this._titleBar.addClass("radius")},_getResizerSize:function(t,i,e){return{width:Math.max(0,i+this._windowWidthStart-this._clientXstart-t.left),height:Math.max(0,e+this._windowHeightStart-this._clientYstart-t.top)}},_updateZIndex:function(){var t=r,i=this._zIndex;if(t.releaseZIndex(this._zIndex),this._zIndex=this._getNewZIndex(t),t.setVisible(this._zIndex),i!==this._zIndex)if(I.detection.isIE10)this._window.css("z-index",0),setTimeout(function(){this._window.css("z-index",this._zIndex),this._adjustModalOverlay()}.bind(this),0);else this._window.css("z-index",this._zIndex),this._adjustModalOverlay()},_getNewZIndex:function(t){return t.acquireZIndex(this._isModal,this._isMaximized)},_adjustModalOverlay:function(){if(this._isModal)l.adjust()},_moveWindow:function(t,i){this._isCenteredV=false,this._isCenteredH=false,this._isMaximized=false,this._left=t,this._top=i,this._updateZIndex()},moveWindow:function(t,i){this._moveWindowWithRecalc(t,i)},setSize:k(function(t){var i=parseInt(this._options.minWidth,10)||0,e=parseInt(this._options.minHeight,10)||0,s=parseInt(this._options.maxWidth,10)||1/0,n=parseInt(this._options.maxHeight,10)||1/0;if(this._width=Math.min(s,Math.max(i,parseInt(t.width,10))),isNaN(this._width))this._width="auto";if(this._height=Math.min(n,Math.max(e,parseInt(t.height,10))),isNaN(this._height))this._height="auto"}),moveWindowToCenter:k(function(){this._isCenteredV=true,this._isCenteredH=true,this._isMaximized=false,this._updateZIndex()}),_maximizeWindow:k(function(){var t=this._options.resizable;if(t)if(this._isMaximized=!this._isMaximized,this.getContainer().toggleClass("ws-window-maximized",this._isMaximized),this._updateZIndex(),this._isMaximized){if(this._maximizeBtn)this._maximizeBtn.addClass("fill");if(this._window.removeClass("ws-window-draggable"),this._resizeBtn)this._resizeBtn.hide()}else{if(this._maximizeBtn)this._maximizeBtn.removeClass("fill");if(this._options.draggable)this._window.addClass("ws-window-draggable");if(this._resizeBtn)this._resizeBtn.show()}return t}),moveToTop:function(t){if(this._isShow){var i;if(!t&&!r.pushUp(this))return-1;if(this._updateZIndex(),$(".ws-window-titlebar.active").removeClass("active"),this._titleBar)this._titleBar.addClass("active");return this._zIndex}else return-1},isMovableToTop:function(){return true},_targetIsHeaderControl:function(t){var i=".ws-window-titlebar-action, .ws-component:not(html), .ws-float-close",e=$(t.target).parents().add(t.target);return e.closest(i).length&&!e.closest('[sbisname="windowTitle"]').length},_mouseDown:function(t){if(this._isMaximized||this._targetIsHeaderControl(t))return true;_._hideUnnecessaryAreas(this),this.moveToTop();var i=this._window.offset(),e=m(t);if(this._clientXstart=e.x-i.left,this._clientYstart=e.y-i.top,this._windowWidthStart=this._window.width(),this._windowHeightStart=this._window.height(),this._mouseStarted=true,this._startCoords={left:this._left,top:this._top},this._isResizing){var s=this._window.offset();this._resizeBar=$("<div></div>").addClass("ws-window-resizebar").fadeTo(0,.8).appendTo(document.body).css({top:s.top-v,left:s.left-v,width:this._window.width(),height:this._window.height(),"z-index":r.getMaxZIndex()+10})}return I.constants.$doc.bind("mousemove touchmove",this._mouseMoveHandler).bind("mouseup touchend",this._mouseUpHandler),t.preventDefault()},_mouseMove:function(t){if(this._mouseStarted)if(this._isResizing){var i=m(t);this._resizeBar.css(this._getResizerSize(this._resizeBar.offset(),i.x,i.y))}else{var i=g(t);this._moveWindow(i.x-this._clientXstart,i.y-this._clientYstart),this._adjustWindowPosition()}if("touchmove"!==t.type)t.stopPropagation(),t.preventDefault()},_mouseUp:function(t){if(!I.constants.browser.isIE)this._window.fadeTo(0,1);if(this._window.removeClass("move"),I.constants.$doc.unbind("mousemove touchmove",this._mouseMoveHandler).unbind("mouseup touchend",this._mouseUpHandler),this._mouseStarted=false,this.onBringToFront(),this._isResizing){var i=this._resizeBar.offset();this._resizeBar.remove(),this._isResizing=false;var e=m(t);this.setSize(this._getResizerSize(i,e.x,e.y))}if(this._startCoords.left!==this._left||this._top!==this._startCoords.top)this._notify("onAfterMove")},canAcceptFocus:function(){return this.isShow()},_restoreSize:function(){},_onResizeHandler:function(){if(this._options.adjustPositionAfterResize)this._adjustWindowPosition();C.superclass._onResizeHandler.apply(this,arguments)},_orientationChangeHandler:function(){this._adjustWindowPosition()},_adjustWindowPosition:function(){if(this.isDestroyed())return;function t(t){var i=["width","height","max-width","max-height","min-width","min-height","margin-left","margin-right","margin-top","margin-bottom"];for(var e in t)if(t.hasOwnProperty(e)){var s=t[e];if(-1!==i.indexOf(e))t[e]="auto"===s||""===s?s:0!==s?s+"px":0}return t}if(this.isVisible())this._notifyMaximizedChange(this._isMaximized);var i=I.constants.browser.isMobileSafari,e=i?window.innerWidth:$(window).width(),s=i?window.innerHeight:$(window).height(),n=this._options.border?100:0,o,a=this._options.minHeight,h={},r=this._left,d=this._top,l=this._haveTitle?this._titleBar.height():0,_=this._haveContentTitleBlock?l:0,c=this._windowContent.outerHeight()-this._windowContent.height(),u={},f=this._window.offset(),w=Math.max(0,e),p=Math.max(0,s),m=Math.max(p-l-c,0),g,v,b,C,x;if(this._isAnimating)return true;if("auto"===this._height){if(this._isMaximized)this._container.css("height","auto"),h.height=this._container.height()<m?m:"auto";else if(this._options.task_1174068748){if(this._container.css("height","auto"),I.detection.firefox)this._container.resize();h.height=this._container.height()<m?"auto":m}else h.height="auto";h.minHeight=a?Math.max(0,a-_):""}else if(this._isMaximized)h.height=Math.max(0,p-l);else h.height=this._height-l;if("auto"===this._width){if(this._container.css({width:"auto","min-width":""}),this._isMaximized)this._container.css("width","auto"),h.width=this._container.width()<w?w:"auto";else if(h.width="auto",!this._options.task_1174068748)h.display="table";o=Math.max(this.isVisible()?this.getMinWidth():this._options.minWidth,n),h.minWidth=o||""}else if(this._isMaximized)h.width=w;else h.width=this._width;if(this._windowContent.css(t({"overflow-x":"hidden","overflow-y":"hidden","margin-top":l,"max-width":w,"max-height":m,width:""})),this._container.css(t({width:h.width,height:h.height,display:h.display,"min-height":h.minHeight,"min-width":h.minWidth,position:"relative",overflow:"visible"})),I.detection.isIE12)this._windowContent.css("width",h.width);if(b={},this._windowContent.prop("scrollHeight")>m+c)b["overflow-y"]="scroll",x=true;if(this._windowContent.css(b),b={},this._windowContent.prop("scrollWidth")>w)b["overflow-x"]="scroll",C=true;if(I.constants.compatibility.touch&&(C||x))b["-webkit-overflow-scrolling"]="touch";if(C&&x||this._isMaximized)b["width"]=w;if(this._windowContent.css(b),g=this._window.outerWidth(true),v=this._window.outerHeight(true),this._isMaximized)u={left:0,top:0};else u={top:this._isCenteredV?(s-v)/2:Math.min(Math.max(0,d),s-v),left:this._isCenteredH?(e-g)/2:Math.min(Math.max(0,r),e-g)};if(this._absolutePosition){var z=$(window).scrollTop(),y=$(window).scrollLeft();u.top+=z>=0?z:0,u.left+=y>=0?y:0}function M(){if(B._options.adjustPositionAfterResize&&B._options.top){var t=B._options.top,i=t+B._container[0].offsetHeight-window.innerHeight;if(i>0)t=Math.max(t-i,0);u.top=t}if(f.left!==u.left||f.top!==u.top)u.left=parseInt(u.left,10),u.top=parseInt(u.top,10),B._window.css(u),B._notify("onMove",u.left,u.top)}var B=this,T;if(this._animatedWindows&&!this._isAnimated&&!this._isAnimating)u.top=-this._window.height(),M(),this._window.animate({top:"+="+this._window.height()+"px"},W,k(function(){B._isAnimating=false,B._isAnimated=true},B)),this._isAnimating=true;else M()},_onSizeChangedBatch:function(){var t;if(C.superclass._onSizeChangedBatch.apply(this,arguments),!(I.constants.browser.isMobilePlatform&&$(document.activeElement).is('input[type="text"], textarea, *[contentEditable=true]'))&&this._options.needRecalcPositionOnSizeChange)this._adjustWindowPosition();return true},_subscribeToWindowResize:function(){var t=k(function(){},this);I.constants.$win.bind("resize",t),this._resizeUnsub=function(){I.constants.$win.unbind("resize",t)}},_templateOptionsFilter:function(){var t;return C.superclass._templateOptionsFilter.apply(this,arguments).concat("border","resizable","resizeable","caption","maximize","windowState","deprecated")},_resizeInner:function(){if(this.isVisible()&&this._options.needRecalcPositionOnSizeChange)k(function(){},this)()}});return C.setDefaultOptions=function(t){b=(t||{})["Lib/Control/Window/Window"]||{}},C});