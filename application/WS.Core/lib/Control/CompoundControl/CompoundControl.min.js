define("Lib/Control/CompoundControl/CompoundControl",["require","Core/helpers/Number/randomId","Core/core-instance","Core/moduleStubs","Core/Abstract.compatible","Lib/Control/Control.compatible","Lib/Control/AreaAbstract/AreaAbstract.compatible","Lib/Control/BaseCompatible/BaseCompatible","Core/EventBus","Core/ParallelDeferred","Lib/Control/AreaAbstract/AreaAbstract","Core/markup/parse","Core/helpers/Hcontrol/configStorage","Core/ContextBinder","View/Executor/Utils","Core/helpers/Hcontrol/getChildContainers","Core/helpers/Hcontrol/replaceContainer","Core/helpers/Hcontrol/makeInstanceCompatible","Core/library","Lib/Control/AttributeCfgParser/AttributeCfgParser","Lib/Control/Control","i18n!Lib/Control/CompoundControl/CompoundControl","View/decorators","Vdom/Vdom","Core/Context"],function(h,g,f,r,m,_,v,b,w,i,e,A,O,B,k,y,t,x,S){var n=function(){return this||(0,eval)("this")}(),L={};function a(e){if(e.node.removeAttribute)e.node.removeAttribute("config")}function s(e,t,n){var o=e.cfg,r=e.ctor,i=e.hasMarkup,a=this.getLinkedContext(),s,l;if(o.parent&&o.parent.isDestroyed())o.parent=null;if(o.parent&&o.parent._template)if(!o.parent._container||!o.parent.isGoodContainer()||!this._container||!this._container.attr||o.parent._container.find("#"+this._container.attr("id")).length>0)o.parent=null;var c="function"===typeof r.prototype._template;if(c&&f.instanceOfModule(this,"Lib/Control/SwitchableArea/SwitchableAreaItem"))o.parent=null;if(o.linkedContext=this.getLinkedContext(),o.parent=o.parent||this,c){if((l=e.instance||e.cfg)&&l._eventBusChannel&&l._eventBusChannel.isDestroyed())return void l.destroy();if(!l.isBuildVDom||l.isBuildVDom()&&!l._isRendered&&"true"!==l.getContainer().attr("hasmarkup")||l.containerIsComponent())l._waitWhileSetParent=true,l.render(),l._waitWhileSetParent=false;if(!l.setContext){var u=["_forceUpdate","_getMarkup","_notify"];for(var d in m)if(-1===u.indexOf(d))l[d]=m[d];for(var p in _)if(-1===u.indexOf(p))l[p]=_[p];for(var C in v)if(-1===u.indexOf(C))l[C]=v[C];for(var t in b)if(-1===u.indexOf(t))l[t]=b[t];l.deprecatedContr(l._options)}if(l.setContext(o.parent.getLinkedContext()),l.setParent(o.parent),!l.iWantVDOM)l.reviveSuperOldControls()}else{if(o&&o.element&&(o.element.wsControl||o.element[0]&&o.element[0].wsControl))return o.element.wsControl||o.element[0]&&o.element[0].wsControl;if(o.element&&o.parent&&o.parent._container)if(!jQuery.contains(document,o.element[0]||o.element)&&jQuery.contains(document,o.parent._container[0]))return;if(s=B.initBinderForControlConfig(o),!i)delete o.bindings,o=s.getConstructorOptions(a,r,o);var h=k.OptionsResolver.getDefaultOptions(r);if(k.OptionsResolver.resolveOptions(r,h,o,o.parent&&o.parent._moduleName?o.parent._moduleName:""),l=new r(o),a=this.getLinkedContext()||a,i)s.bindControl(l,a,"syncControl");else s.bindControl(l,a)}if("function"===typeof l.getReadyDeferred)this._dChildReady.push(l.getReadyDeferred());return l}function M(e,t,n,o,r){var i,a,s,l;if(i=o?o:e._moduleName,L[i])s=L[i];else{if((l=S.parse(i)).path.length)s=h(l.name),l.path.forEach(function(e){s=s[e]});else s=h(i);L[i]=s}if(e.eventBusId=e.name&&n[e.name]?n[e.name]:g(),s.prototype&&s.prototype._template)if(t.setAttribute("newconfig",r),e.parent=this,!e._thisIsInstance)if(e.container=window?$(e.element):e.element,e.linkedContext=this.getLinkedContext(),e.container[0]&&e.container[0].wsControl)e._container=window?$(e.element):e.element,e=(a=e.container[0].wsControl)._options;else{var c=B.initBinderForControlConfig(e),u=this.getLinkedContext();if(e.parent&&!("enabled"in e)&&!e.parent.isEnabled()&&false!==e.allowChangeEnable)e.enabled=e.parent.isEnabled(),e.enable=e.parent.isEnabled();var d=e.doNotSetParent;e.doNotSetParent=true;var p=k.OptionsResolver.getDefaultOptions(s);if(k.OptionsResolver.resolveOptions(s,p,e,e.parent&&e.parent._moduleName?e.parent._moduleName:""),s.prototype._template)if(e.VDOMReady)a=e;else if(e._options)if(e.setContainer)e.setContainer(e._options.element);else x(e),e.setContainer(e.element||e._options.element);else if(e.element.controlNodes&&e.element.controlNodes[0]&&e.element.controlNodes[0].control)a=e.element.controlNodes[0].control;else e.iWantBeWS3=true,a=s.createControl(s,e,e.element);else a=new s(e);e.doNotSetParent=d;var C={};C[r]=a,O.merge(C),u=this.getLinkedContext()||u,c.bindControl(a,u,"syncControl")}else e._container=window?$(e.element):e.element,(e=(a=e)._savedOptions?a._savedOptions:a._options).element=a._container,a._options=e;if(e.name&&!n[e.name])w.channel(e.eventBusId,{waitForPermit:true}),n[e.name]=e.eventBusId;return{cnstr:s,cfg:e,instance:a,cName:o}}var o=e.extend({_$isRelativeTemplate:true,_$autoHeight:true,_isCoreCompound:true,_moduleName:"Lib/Control/CompoundControl/CompoundControl",_createChildOnInitSelector:"",_childEventBusHashMap:null,_cleanupMarkupDataBinding:null,constructor:function e(t){this._childEventBusHashMap=this._childEventBusHashMap||{},e.superclass.constructor.call(this,t,true),this._prepareControlsConfig({selector:this._createChildOnInitSelector}),this._initInstance()},getEventBusOf:function(e){var t=null;if(this._childEventBusHashMap[e]){var n=this._childEventBusHashMap[e];if(w.hasChannel(n))t=w.channel(n)}if(null===t)throw new Error('Component with name "'+e+'" doesn`t exists in CompoundComponent with name "'+this.getName()+'"');else return t},_onSizeChangedBatch:function(){return this._haveAutoSize()&&("Stretch"!==this._horizontalAlignment||"Stretch"!==this._verticalAlignment)},_prepareControlsConfig:function(e){for(var t=(e=e||{}).selector,n=e.container||this._container,o="data-component",r=y(n,t||"["+o+"]"),i,a=[],s,l,c=this._childEventBusHashMap,u,d,p,C,h=null,f,m=0,_=r.length;m<_;m++)if(p=(i=r[m]).getAttribute(o),C=i.getAttribute("data-component"),f=i.getAttribute("config"),C){if(!f)f=i.getAttribute("newconfig")||g("cfg-"),i.setAttribute("config",f);if((u=A(i,null))&&u.__doubleconfig)f=(u=u[0]).__$config;l=M.call(this,u,i,c,C,f),a.push({ctor:l.cnstr,cfg:l.cfg,instance:l.instance,cName:l.cName,node:i,hasMarkup:"true"===i.getAttribute("hasMarkup")})}return a},reviveComponents:function(e){var t,n,o=this;return(n=(t=(t=this._prepareControlsConfig({container:e})).filter(function(e){return!e.node.wsControl||e.node.wsControl._template})).reduce(function(e,t){if(!t.ctor)e.push(r.require(t.cName).addCallback(function(e){return t.ctor=e[0],e}));return e},new i)).done(t).getResult().addCallback(function(e){return this._loadControlsFromConfigArray(new i,"",e,true).getResult().createDependent()}.bind(this))},_loadControls:function(e,t,n,o,r){return this._loadControlsBySelector(e,t,this._createChildOnInitSelector)},_loadControlsFromConfigArray:function(n,e,o,t){return this._runInBatchUpdate("_loadControls - "+this._id,function(){var e=o.map(s,this),t;return o.forEach(a,this),this._markupDataBinding(),n.done(e)})},_loadControlsBySelector:function(e,t,n){return this._loadControlsFromConfigArray(e,t,this._prepareControlsConfig({selector:n}))},rebuildMarkup:function(e){if(this._dotTplFn)if(e)t(this._container,this._buildMarkup(this._dotTplFn,this._getOptions(),void 0,void 0,this.getLinkedContext())),setTimeout(function(){this._removeControls(),this.reviveComponents()}.bind(this),0);else this._removeControls(),t(this._container,this._buildMarkup(this._dotTplFn,this._getOptions(),void 0,void 0,this.getLinkedContext())),this.reviveComponents()},_calcMinHeight:function(){return this._getOption("minHeight")},_calcMinWidth:function(){return this._getOption("minWidth")}});return o.beforeExtend=function(e,t,n){o.prototype._setCompatibleOptions(e,t,n)},o});