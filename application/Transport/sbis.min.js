define("Transport/sbis",["require","exports","tslib","Transport/fetch","Transport/Errors","Core/constants","Core/UserInfo","Core/EventBus","Transport/_utils","Transport/fetch/responseParser"],function(r,e,o,i,t,n,s,a,u,c){"use strict";var f={"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8",Accept:"application/json, text/javascript, */*; q=0.01"},h={method:"GET"},p="X-LastModification",E={},l=function(r){var e=o.__assign({},h,r),t=o.__assign({},f,r.headers);for(var n in t)if(t.hasOwnProperty(n)&&!t[n])delete t[n];if(E[e.url])t[p]=E[e.url];return e.headers=t,e},T=function(r){if(n.checkSessionCookie&&!s.isValid())return Promise.reject(new t.Auth(r));return Promise.resolve()},d=function(r){if(r instanceof t.Auth)a.channel("errors").notify("onAuthError");throw r},P=function(r){return E[r.url]=r.headers.get(p),r},v=function(r,e){if(void 0===e)e=c.RESPONSE_TYPE.TEXT;var t=l(r),n,o,s=T(t.url).then(function(){if(n=i(t),o)n.abort();return n}).then(P,d).then(function(r){return c.parse(r,e)});return u.getAbortedPromise(s,{abort:function(){n&&n.abort(),o=true}})};return Object.assign(v,{RESPONSE_TYPE:c.RESPONSE_TYPE})});