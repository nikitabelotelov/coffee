define("View/Builder/Tmpl/expressions/event",["View/Builder/Tmpl/expressions/process","View/Builder/Tmpl/modules/data/utils/functionStringCreator","View/Builder/Tmpl/expressions/types","View/Builder/Tmpl/handlers/error"],function(c,f,v,r){function d(e,n){var r;if(e&&isArray(e))return e.push(n),e;return(r=[n]).events=true,r}function p(e,n,r,t){return{name:e,args:n,value:r,fn:t}}function t(){var r=arguments;return function(e){for(var n=r.length-1;n>-1;n--)e=r[n].call(this,e);return e}}var i=function e(n){return n.data[0]},a=function e(n){return n.name.body},u=function e(n){return n[0]},s=function e(n){try{return n.expression.callee.name}catch(e){throw r('"'+n.string+'" is an invalid name for an event handler'),new Error("Event handler name is invalid",e)}},o=function e(n){var r;return t(u,a,i)(n)},m=function(e){var n;return t(s,o)(e)},e=function e(n,r,t,i){var a=c(n.data[0],t,this.calculators,this.filename),u=m(n),s=a.substring(0,a.indexOf(".apply")).replace("markupGenerator.escape(","").replace("data","this"+(u?"":"._children")),o=s.substring(0,s.indexOf(',"'))+"])",l=f.wrapAroundExec("(function(self){ "+"   var f = (function() { "+"     var event = arguments[0];"+"     var res = "+s+".apply("+(u?"this":o)+", arguments); "+"     event.result = res;"+"  });"+"  f = f.bind(self);"+"  f.control = self;"+"  f.isControlEvent = "+i+";"+"  return f;"+"})(viewController)");return d(void 0,p("event",a=f.wrapAroundExec(v.buildArgumentsArray.call(v,n.data[0].name.body[0].expression.arguments,t)),u,l))};return{embraceEventChain:d,createEvent:p,isEvent:function e(n){return/^(on:[A-z0-9])\w*$/.test(n)},getEventName:function(e){return e.slice(3).toLowerCase()},compose:t,processEventAttribute:e}});