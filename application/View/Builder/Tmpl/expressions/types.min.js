define("View/Builder/Tmpl/expressions/types",["View/Builder/Tmpl/modules/data/utils/functionStringCreator","View/Builder/Tmpl/modules/utils/common","View/Builder/Tmpl/decorators","View/Builder/Tmpl/handlers/error"],function(o,u,l,c){"use strict";var p="bind",f="mutable",i={rk:"thelpers.rk",debug:"debug","...":"thelpers.uniteScope(markupGenerator.getScope(data), {parent: undefined, element: undefined})(thelpers.plainMerge)",undefined:"undefined",null:"null"},d=["sanitize","unescape","money","highlight","colorMark","wrapURLs"],a="__setHTMLUnsafe";function s(e,t){var r=e;if("string"===typeof e)if("Literal"===t&&"null"!==e&&"undefined"!==e)r=e.replace(/^"/,"").replace(/"$/,"");else r=o.wrapAroundExec(e);return r}i[a]=a;var h=function e(t){return~t.indexOf(p)||~t.indexOf(f)},y=function e(t,r,n){if(i[t.name])return i[t.name];else if(r)return r+"["+o.wrapAroundQuotes(t.name)+"]";else if("context"===t.name)return'(!thelpers.getter(data, ["context"]) ? context : thelpers.getter(data, ["context"]))';else if(n)return"data";else return"thelpers.getter(data, ["+o.wrapAroundQuotes(t.name)+"])"},g=function e(t,r){var n="";if(t&&t.length>0){var i=t[0];n=this[i.type](i,r),this.escape=false,this.sanitize=false}return n},e;return{Identifier:function e(t,r){return y(t,r,false)},ExpressionStatement:function e(t,r){var n;return this[t.expression.type](t.expression,r)},LogicalExpression:function e(t,r){var n=this[t.left.type](t.left,r),i=this[t.right.type](t.right,r),a=n+" "+t+" "+i,s;function o(e,t,r){if(e)switch(e){case"||":return t+"||"+r;case"&&":return t+"&&"+r;default:c("Wrong conditional expression "+a,this.filename)}c("Wrong conditional expression "+a,this.filename)}return o(t.operator,n,i)},Literal:function e(t){if("string"===typeof t.value)return'"'+t.value.replace(/\\/g,"\\\\").replace(/"/g,'\\"')+'"';else{if(null===t.value)return"null";if(void 0===t.value)return"undefined";return t.value}},Brace:function e(t,r){var n;return"("+this[t.name.type](t.name,r)+")"},MemberExpression:function e(t,r){var n=t,i=[],a;if(n.property){while("MemberExpression"===n.type)i.unshift(n.computed?this[n.property.type](n.property):o.wrapAroundQuotes(n.property.name)),n=n.object;var s="";if("Identifier"===n.type){if("data"===(s=y(n,r,true)))i.unshift(o.wrapAroundQuotes(n.name))}else s=this[n.type](n,r);a="thelpers.getter("+s+", ["+i.join(",")+"])"}else a=this[n.object.type](n.object,r);return a},ConditionalExpression:function e(t,r){var n=void 0!==t.alternate?this[t.alternate.type](t.alternate,r):void 0,i;return i="("+this[t.test.type](t.test,r)+" ? "+this[t.consequent.type](t.consequent,r)+" : "+(n||"''")+")"},buildArgumentsArray:function(e,r){var t=function e(t){return this[t.type](t,r)};return"["+u.mapForLoop(e,t.bind(this)).toString()+"]"},CallExpression:function e(t,r){var n=this[t.callee.type](t.callee,r),i;if(n){if(n===a)i=g.call(this,t.arguments,r);else if(t.callee.object)i=n+".apply("+this[t.callee.object.type](t.callee.object)+", "+this.buildArgumentsArray(t.arguments,r)+")";else i=n+".apply(data, "+this.buildArgumentsArray(t.arguments,r)+")";return i}c('Call expression error. Object to call on is "'+t.callee.string+'" equals to '+n,this.filename)},BinaryExpression:function e(t,r){var n;function i(e,t,r){if(e)switch(e){case"*":return t+"*"+r;case"/":return t+"/"+r;case"%":return t+"%"+r;case"+":return t+"+"+r;case"-":return t+"-"+r;case"<":return t+"<"+r;case">":return t+">"+r;case"<=":return t+"<="+r;case">=":return t+">="+r;case"==":return t+"=="+r;case"!=":return t+"!="+r;case"===":return t+"==="+r;case"!==":return t+"!=="+r;default:c("Wrong binary expression "+t+" "+e+" "+r,this.filename)}c("Wrong binary expression "+t+" "+e+" "+r,this.filename)}return i(t.operator,this[t.left.type](t.left,r),this[t.right.type](t.right,r))},DecoratorChainCall:function e(t,r,n,i){var a=u.mapForLoop(t.argumentsDecorator||[],function e(t){return this[t.type](t,r)}.bind(this)),s;if(t.identifier===p||t.identifier===f)a.unshift(this.attributeName);if(~d.indexOf(t.identifier))this.escape=false;if(a.unshift(n),h(t.identifier))s=l[t.identifier].apply(void 0,a);else s='thelpers.getDecorators()["'+t.identifier+'"].apply(undefined, ['+a.toString()+"])";return s},DecoratorChainContext:function e(t,r,n,i){var a;if(t.entity)a=this[t.fn.type](t.fn,r,this[t.entity.type](t.entity,r,n,i),i);else a=this[t.fn.type](t.fn,r,n,i);return a},DecoratorCall:function e(t,r){var n=this[t.decorator.type](t.decorator,r,t.caller?this[t.caller.type](t.caller,r):void 0,t.caller);if((t.decorator.fn.identifier===p||t.decorator.fn.identifier===f)&&(this.isControl||h(t.decorator.string))){if(u.isString(this.configObject))this.configObject.bindings=JSON.stringify(u.bindingArrayHolder(this.configObject.bindings,n.binding));else this.configObject.bindings=u.bindingArrayHolder(this.configObject.bindings,n.binding);return n.value}return n},UnaryExpression:function e(t,r){var n=i(t.operator,this[t.argument.type](t.argument,r));function i(e,t){if(e)switch(e){case"+":return"+"+t;case"-":return"-"+t;case"!":return"!"+t;default:c("Wrong unary expression "+e+t,this.filename)}c("Wrong unary expression "+e+t,this.filename)}return t.value=n},ArrayExpression:function e(t,n){var r=u.mapForLoop(t.elements,function e(t){var r=this[t.type](t,n);return r=s(r,t.type)}.bind(this))||[];return o.getStr(r)},ObjectExpression:function e(t,n){var i={},r=u.mapForLoop(t.properties,function e(t){var r=this[t.key.type](t.key,n);if(r)r=s(r,t.key.type),i[r]=this[t.value.type](t.value,n),i[r]=s(i[r],t.value.type)}.bind(this))||{};return o.getStr(i)},EmptyStatement:function e(t,r){}}});