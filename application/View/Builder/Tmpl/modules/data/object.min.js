define("View/Builder/Tmpl/modules/data/object",["Core/helpers/Hcontrol/configStorage","Core/IoC","View/Builder/Tmpl/expressions/dirtyCheckingPatch","View/Builder/Tmpl/modules/utils/tag","View/Builder/Tmpl/modules/data/utils/dataTypesCreator","View/Builder/Tmpl/modules/utils/common","View/Builder/Tmpl/modules/data/utils/functionStringCreator","View/Builder/Tmpl/modules/utils/parse","text!View/Builder/Tmpl/modules/templates/templateFunctionTemplate.jstpl","text!View/Builder/Tmpl/modules/templates/templateObjectHtmlTemplate.jstpl","text!View/Builder/Tmpl/modules/templates/templateObjectHtmlTemplateNew.jstpl"],function e(E,_,H,I,k,M,G,U,Y,L,q){"use strict";function W(e,t){return"string"===typeof e&&"Array"!==t}function z(e){return e&&e[0]&&e[0].children}return Y=Y.replace(/\r/g,""),L=L.replace(/\r/g,""),q=q.replace(/\r/g,""),function e(t,o,s,c,r,i){var n={},l,a,p,u={},d,f,h,m,g,C=false,y=k.createHtmlDataObject([],s),b,T="content",w;function D(e,t,r,i,n,l){return e.call(this,t,r,i,n,l)}function v(e){return"ws:if"===e||"ws:else"===e||"ws:for"===e}function F(e,t,r,i,n){return D.call(this,r["Array"],{attribs:t.attribs,internal:t.internal,children:e,isControl:t.isControl,rootConfig:t.rootConfig},r,i,n,true)}function j(e,t,r,i,n){var l=r.length;if(t)if(1===l){var a=D.call(this,t,{attribs:r[p].attribs,internal:r[p].internal,children:r[p].children,isControl:i.isControl,rootConfig:i.rootConfig},n.types,n.scopeData,n.propertyName);if(W(a,e))a=k.createDataRepresentation(e,a,z(r));return a}return F.call(this,r,i,o,s,c)}function N(e,t,r,i,n){var l=n.propName?n.propName+"/"+e:e;return D.call(this,t.Object,{attribs:r[p].attribs,internal:r[p].internal,children:r[p].children,isControl:i.isControl,rootConfig:i.rootConfig||n.curatedScope,rPropName:e},t,n.scopeData,l)}function O(e){return e&&(!this._modules.hasOwnProperty(e)||"template"===e)&&!I.isTagRequirableBool.call(this,e,k.injectedDataTypes)&&!~k.injectedDataTypes.indexOf(e)}if(u=U.parseAttributesForData.call(this,{attribs:t.attribs,isControl:t.isControl,configObject:u,rootConfig:t.rootConfig},s,c,r),t.internal)t.internal=U.parseInternalForData.call(this,t.internal,s,c,t.isControl,t.rootConfig),b=t.internal;else b={};if(u&&u.createdscope)d=u.obj;else d=u;if((h=t).children)t=t.children;for(C=!(M.isArray(t)&&t.filter(function(e){return v(e&&e.name)}).length),p=0;p<t.length;p++)if(a=I.splitWs(t[p].name),t[p].children&&C){if(l=o[a],g=O.call(this,a),(c||l)&&!g)return j.call(this,a,l,t,h,{types:o,scopeData:s,propertyName:c});if(a&&!l&&g)n[a]=N.call(this,a,o,t,h,{types:o,scopeData:s,propName:c,curatedScope:d});else if(i)a=T,m=c?c+"/"+a:a,n[a]=D.call(this,o.Object,{attribs:h.attribs,internal:h.internal,children:t,isControl:h.isControl,rootConfig:h.rootConfig||d,rPropName:a},o,s,m);else return k.createDataRepresentation(a,this._processEntity(t[p],y.data))}else y.html.push(t[p]);if(void 0!==u)if(H.doDirtyCheckingSafety(b),u.createdscope)if(f=M.plainMergeAttrs(n,d),M.isEmpty(f))n=G.injectFunctionCall("thelpers.uniteScope",[u.createdscope,"{}"]);else n=G.injectFunctionCall("thelpers.uniteScope",[u.createdscope,G.getStr(f)]);else n=M.plainMergeAttrs(n,d);if(y.html.length>0){var S=i?T:h.rPropName;if(w=y.html,E.merge(this._controlsData),"string"===n.type){var f;if((f="₪("+this.getFunction(w,y.data,this.handlers,void 0,true).toString().replace(/\n/g," ")+")(Object.create(data), null, context)₪").indexOf("markupGenerator.createControl(")>-1)if("undefined"!==typeof window&&window.leakDetectedMode){var V=f.indexOf("thelpers.templateError("),x=f.indexOf(";",V+1);_.resolve("ILogger").error("Deprecated","Вы пытаетесь создать компонент внутри опции type=string. "+"PropertyName="+S+". ResultFunction="+f.substring(V,x))}return f}else if("function"===n.type)return G.functionTypeHanlder(this._processData.bind(this),w,void 0,U.parseAttributesForData);else{var A=Y.replace("/*#HTML_PROPERTY_NAME#*/",S).replace("/*#GENERATED_STRING#*/",this.getString(w,{},this.handlers,{},true)),B=new Function("data, attr, context, isVdom, sets",A);if(this.includedFunctions[S]=B,this.privateFn)this.privateFn.push(B);var R="";if(this.privateFn)R=this.privatePrefix+""+(this.privateFn.length-1);else R=B.toString().replace(/\n/g," ");var P="";if(t&&t.internal)H.doDirtyCheckingSafety(t.internal),P+=G.getStr(t.internal,S);else if(P+="{}",!this.includedFn)P+=";";if(this.includedFn)y.html=G.wrapAroundObject(q.replace(/\n/g," ").replace("/*#FUNC#*/",R).replace("/*#FUNCTOSTR#*/",R).replace("/*#DIRTY#*/",P?"isVdom?"+P+":{}":"{}"));else y.html=G.wrapAroundObject(L.replace(/\n/g," ").replace("/*#FUNC#*/",R).replace("/*#DIRTY#*/","this.func.internal = "+P));if(i)return n[T]=y.html,n;return y.html}}else if("string"===n.type)return n.value||"";return n}});