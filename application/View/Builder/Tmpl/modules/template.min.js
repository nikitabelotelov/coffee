define("View/Builder/Tmpl/modules/template",["View/Builder/Tmpl/handlers/error","Core/Deferred"],function t(a,l){"use strict";var e;return{parse:function t(i){function r(){var r=new l,n=new l;return this.traversingAST(i.children).addCallbacks(function t(e){r.callback(e),i.children=e,n.callback(i)},function t(e){n.errback(e),a(e,this.filename)}.bind(this)),{fake:r,real:n}}function e(){var t,e;try{e=i.attribs.name.trim()}catch(t){a("Something wrong with name attribute in ws:template tag",this.filename,t)}if(void 0===i.children||0===i.children.length)a("There is got to be a children in ws:template tag",this.filename);return t=r.call(this),this.includeStack[e]=t.fake,t.real}return function t(){return e.call(this)}},module:function t(n,e){var i=n.attribs.name;return function t(){var e;if(!this.includeStack[i])this.includeStack[i]=n.children;var r=this.getString(this.includeStack[i],{},this.handlers,{},true);if(delete this.includeStack[i],this.includedFn)return r='{ var key = attr&&attr.key||"_";'+"var forCounter = 0;"+"var templateCount = 0;"+"if (!attr.attributes){attr.attributes = {};}"+"thelpers.prepareAttrsForFocus(attr&&attr.attributes, data);"+"var defCollection = {id: [], def: undefined};"+'var viewController = thelpers.configResolver.calcParent(this, typeof currentPropertyName === "undefined" ? undefined : currentPropertyName, data);'+r+"}",this.includedFn[i]=r,"";return e='(function() { includedTemplates["'+i+'"] = (function (data,attr,context,isVdom) {'+r+"}.bind({ includedTemplates: includedTemplates })"+"); })(), \n"}}}});