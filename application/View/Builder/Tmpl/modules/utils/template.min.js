define("View/Builder/Tmpl/modules/utils/template",["View/Builder/Tmpl/modules/utils/names","View/Builder/Tmpl/modules/utils/loader","View/Builder/Tmpl/handlers/error","View/Builder/Tmpl/modules/data/utils/functionStringCreator","Core/Deferred","View/Builder/Tmpl/modules/utils/common"],function e(l,a,u,o,s,c){var d=function e(t){var r=" ";if(t.length>0)for(var n=0;n<t.length;n++)if(t[n].data!==r)return true;return false},f=function e(t,r,n){return new Error("Required template or control in file "+t+" did not return AST for"+r+". AST RESULT: "+n)},m=function e(r,n,i){var l=new s;if(void 0===this.includeStack[i])u('Requiring tag for "'+i+'" is not found!',this.filename),l.errback(new Error('Requiring tag for "'+i+'" is not found!'));else this.includeStack[i].addCallbacks(function e(t){if(t)if(r.children=t,n&&d(n))this.traversingAST(n,r.key,true).addCallbacks(function e(t){if(t)r.injectedData=t,l.callback(r);else l.errback(f(this.filename,i,t))}.bind(this),function e(t){l.errback(t)});else l.callback(r);else l.errback(f(this.filename,i,t));return t}.bind(this),function e(t){l.errback(t),u(t,this.filename)}.bind(this));return l},p=function e(t){var r="",n=t.data,i;if(n.length){if(1===n.length)return n[0].value;for(i=0;i<n.length;i++)r+=n[i].value;return r}return t},h=function e(t){var r='{ "data": data, "ctx": this, "pName": typeof currentPropertyName !== "undefined" ? currentPropertyName : undefined, "viewController": viewController, ';if(t)r+='"internal": '+t+", ";return r+="}"},b=function e(t){return{value:t,type:"optional"}},v=function e(t){return{value:t,type:"template"}},g=function e(t){return{value:t,type:"ws-control",simple:true}},k=function e(t){var r=c.splitModule(t);return{libPath:r,value:r.library+":"+r.module,type:"ws-module",simple:true}};return{syncRequireTemplateOrControl:function e(t,r,n,i){var l=p(i.attribs._wstemplatename),a=i.internal&&Object.keys(i.internal).length>0?o.getStr(i.internal):null;return o.injectFunctionCall("markupGenerator.createControl",['"resolver"',l.slice(1,-1),o.getStr(r),n,h(a),'(isVdom?context+"part_"+(templateCount++):context)',"depsLocal","includedTemplates","thelpers.config","{}","defCollection"])+", \n"},resolveTemplate:m,resolveInjectedTemplate:function e(r,t){var n=new s,i=r.attribs._wstemplatename.data;if(r.injectedTemplate=i[0],t&&d(t))this.traversingAST(t,r.key,true).addCallbacks(function e(t){if(t)r.injectedData=t,n.callback(r);else n.errback("Something wrong with template "+this.filename+".")}.bind(this),function e(t){n.errback(t)});else n.callback(r);return n},getTemplateCfg:h,checkRequirableTemplate:function e(t,r){var n=t.attribs._wstemplatename.data.value.trim(),i;if(l.isStringModules(n,this.config)){if(l.isControlString(n)||l.isSlashedControl(n)){if(c.isLibraryModuleString(n))i=k(n);else i=g(n);if(void 0===t.attribs)t.attribs={};t.attribs._wstemplatename=i.value}else if(l.isOptionalString(n))i=b(n);else i=v(n);if(!this.includeStack[i.value])this.includeStack[i.value]=a.call(this,i);return m.call(this,t,r,n)}return m.call(this,t,r,n)},reflector:function e(t){return t}}});