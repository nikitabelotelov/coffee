define("View/Executor/Expressions",["Core/helpers/Object/isPlainObject","Core/RightsManager","Core/DataContext","Core/IoC","require","exports"],function(n,s,i,o,a,e){Object.defineProperty(e,"__esModule",{value:true}),e["View/Executor/_Expressions/AttrHelper"]=true;var u=function(){"use strict";var e={},t=function(e,t){function r(e){return 0===e.indexOf("attr:")}function n(e){for(var t in e)if(r(t))return true;return false}Object.defineProperty(t,"__esModule",{value:true}),t.isAttr=r,t.checkAttr=n}(a,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),t=u;e["View/Executor/_Expressions/ContextResolver"]=true;var r,c=function(){"use strict";var e={},t=function(e,t,o,i){Object.defineProperty(t,"__esModule",{value:true});var a={"UserActivity/ActivityContextField":true,"Notes/VDOM/Context":true,"Controls/Application/AppData":true,"Controls/Container/Scroll/Context":true,"Controls/Context/TouchContextField":true,"Controls/StickyHeader/Context":true,"Controls/Container/Data/ContextOptions":true,"Controls/Selector/__ControllerContext":true,"Controls/Container/Filter/FilterContextField":true,"Controls/Container/Search/SearchContextField":true,"Controls/Filter/Button/Panel/Wrapper/_FilterPanelOptions":true,"Controls/Container/Suggest/Layout/_SuggestOptionsField":true,"WSTests/unit/tmpl/sync-tests/context/contextField":true,"WSTests/unit/tmpl/sync-tests/context/updateConsumers/ctxField":true,"WSTests/unit/tmpl/sync-tests/context/contextField2":true,"WSTests/unit/tmpl/sync-tests/context/dirtyCheckingUpdate/contextField":true};function u(){var e=0;for(var t in this)if(this.hasOwnProperty(t)&&this[t])if(this[t].getVersion)e+=this[t].getVersion();return e}function r(e,t){if(e&&e._getChildContext){t=Object.create(t);var r=e._getChildContext();for(var n in r)if(r.hasOwnProperty(n)){if(r[n]._moduleName&&!a[r[n]._moduleName])o.resolve("ILogger").error("Wrong context field",r[n]._moduleName+". Only allowed context fields: "+Object.keys(a));if(t[n]=r[n],r[n]&&r[n].getVersion===i.prototype.getVersion)for(var s in r[n])if(r[n].hasOwnProperty(s)&&r[n][s])if(r[n][s].getVersion)r[n].getVersion=u}}return t}function n(e,t,r){if("undefined"===typeof t)return{};var n=e.contextTypes?e.contextTypes():{},s={};if(!n)o.resolve("ILogger").error(null,"Context types are not defined");else for(var i in n)if(!(t[i]instanceof n[i]));else if(s[i]=t[i],r)s[i].registerConsumer(r);return s}t.wrapContext=r,t.resolveContext=n}(a,e,o,i);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["View/Executor/_Expressions/Event"]=true;var f=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r={mozmousepixelscroll:"MozMousePixelScroll"};function n(e){return/^(on:[A-z0-9])\w*$/.test(e)}function s(e){return e.slice(3).toLowerCase()}function i(e){var t;return r[e]||e}t.isEvent=n,t.getEventName=s,t.fixUppercaseDOMEventName=i}(a,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),l=f;e["View/Executor/_Expressions/Rights"]=true;var p,d=function(){"use strict";var e={},t=function(e,t,i,o,s){Object.defineProperty(t,"__esModule",{value:true});var r={object:{getMinAccessLevel:function(e,t){var r;if("undefined"!==typeof e["data-access-min-level"])r=e["data-access-min-level"];else if("undefined"!==typeof e["dataAccessMinLevel"])s.resolve("ILogger").info("entityHelpers","Для задания минимального уровня доступа для опции, используйте data-access-min-level вместо dataAccessMinLevel."),r=e["dataAccessMinLevel"];if("string"===typeof r)r=parseInt(r,10);if("number"!==typeof r||isNaN(r))r=t;return r},isAccessible:function(e,t){var r,n;if("undefined"===typeof t)t=1;if(n=t,"undefined"!==typeof e["data-access"])r=e["data-access"];else if("undefined"!==typeof e["dataAccess"])s.resolve("ILogger").info("entityHelpers","Для задания зоны доступа для опции, используйте data-access вместо dataAccess."),r=e["dataAccess"];if("string"===typeof r)n=i.checkAccessRights(r.split(","));return n>=t},iterate:function(e,t){for(var r in e)if(e.hasOwnProperty(r))t(e[r],r,e);return e},remove:function(e,t){var r=Object.getOwnPropertyDescriptor(e,t);if(r.configurable)delete e[t];else if(r.set)e[t]=void 0}},array:{getMinAccessLevel:function(e,t){return t},isAccessible:function(){return true},iterate:function(e,t){for(var r=e.length-1;r>=0;r--)t(e[r],r,e);return e},remove:function(e,t){e.splice(t,1)}}};function a(e){var t=false,r=[],n,s,i,o;if(e&&e.bindings&&e.bindings.length){for(var a=0,u=(s=e.bindings).length;a<u;a++){if(t=false,n=e,(i=s[a]).propPath&&i.propPath.length)o=i.propName.split("/");else o=[];if(o.length)for(var c=0,f=o.length;c<f;c++)if(n.hasOwnProperty(o[c])){if(n=n[o[c]],c+2===f)t=true}else break;else t=true;if(t)r.push(s[a])}e.bindings=r}}function u(e,n){var s;if(Array.isArray(e))s=r.array;else if(o(e))s=r.object;else return e;if(n=s.getMinAccessLevel(e,n),!s.isAccessible(e,n))return;return e=s.iterate(e,function(e,t,r){if(e&&e["__isRightsChecked"])return;if(o(e))Object.defineProperty(e,"__isRightsChecked",{enumerable:false,value:true});if(r[t]=u(e,n),void 0===r[t])s.remove(r,t)})}function n(e,t){var r=e&&(e["data-access"]||e["attr:data-access"]),n=i.rightsNeeded();if(r&&n)switch(i.checkAccessRights(r.split(","))){case 0:return false;case 1:var s;if(t["display"])t["readOnly"]=true,t["enabled"]=true,t["allowChangeEnable"]=false;else t["enabled"]=false,t["allowChangeEnable"]=false;return true}return u(t,1),a(t),true}t.removeBindCutOption=a,t.applyRightsToEntity=u,t.applyRights=n}(a,e,s,n,o);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["View/Executor/_Expressions/Scope"]=true;var v,w=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var n=["className"];function s(e,t,r){if(~n.indexOf(r)&&e&&t)e+=" "+t;else e=t;return e}function i(e,t){return e.hasOwnProperty(t)}function r(e,t){if(!e)e={};for(var r in t)if(i(t,r))e[r]=s(e[r],t[r],r);return e}function o(e,t){return e instanceof Function&&e.__$unite?e(t):e}t.propertyNameToIdentifyIsolatedScope="___$isolatedscope",t.controlPropMerge=r,t.calculateScope=o}(a,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["View/Executor/_Expressions/Subscriber"]=true;var h,y=function(){"use strict";var e={},t=function(e,t){function n(r,n){return function(){var e=[],t;for(t=0;t<arguments.length;t++)e.push(arguments[t]);for(t=0;t<n.length;t++)e.push(n[t]);r.apply(void 0,e)}}function r(e){var t={};for(var r in e)if(e.hasOwnProperty(r))if(0===r.indexOf("event:"))t[r]=e[r];return t}function s(e,t){for(var r in e)if(e.hasOwnProperty(r))for(var n=e[r],s=0;s<n.length;s++)t(r,n[s])}function i(r,e,t){s(t,function(e,t){if(t.fn)t.bindedFunc=n(t.fn,t.args),r.subscribe(e.split(":")[1],t.bindedFunc)})}function o(r,e,t){s(t,function(e,t){if(t.bindedFunc)r.unsubscribe(e.split(":")[1],t.bindedFunc)})}function a(e,t,r){i(e,t,r),e.once&&e.once("onDestroy",function(){o(e,t,r)})}Object.defineProperty(t,"__esModule",{value:true}),t.getBindFunc=n,t.getEventsListFromOptions=r,t.forEventObjects=s,t.subscribeEvents=i,t.unsubscribeEvents=o,t.applyEvents=a}(a,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["View/Executor/_Expressions/Decorate"]=true;var g,b=function(){"use strict";var e={},t=function(e,t,a){function r(e,t,r,n){var s={config:e,hasMarkup:t,"data-component":r};for(var i in n)if(n.hasOwnProperty(i))if("config"===i)s[i]=n[i]+","+s[i];else s[i]=n[i];if("undefined"!==typeof window){var o=a.checkAttr(s)?"attr:__config":"__config";if(s[o])s[o]+=","+s.config;else s[o]=s.config}return s}Object.defineProperty(t,"__esModule",{value:true}),t.createRootDecoratorObject=r}(a,e,u);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["View/Executor/_Expressions/Focus"]=true;var x=function(){"use strict";var e={},t=function(e,t,n){function r(e,t){while(e){if(e===t)return true;e=e.parentElement}return false}function c(e,t){if(!e)return;var r="";if(n.checkAttr(e)||n.checkAttr(t))r="attr:";if(e[r+"ws-creates-context"]=e[r+"ws-creates-context"]||"default",e[r+"ws-delegates-tabfocus"]=e[r+"ws-delegates-tabfocus"]||"default","true"===t[r+"ws-creates-context"])e[r+"ws-creates-context"]="true";if("true"===t[r+"ws-delegates-tabfocus"])e[r+"ws-delegates-tabfocus"]="true";if("true"===t[r+"ws-tab-cycling"])e[r+"ws-tab-cycling"]="true";if("true"===t[r+"ws-autofocus"])e[r+"ws-autofocus"]="true";if("true"===t[r+"ws-no-focus"])e[r+"ws-no-focus"]="true";if(t.hasOwnProperty(r+"tabindex"))e[r+"tabindex"]=t[r+"tabindex"]+""}function f(e){if("true"===e["ws-creates-context"])if(!e.hasOwnProperty("tabindex"))e.tabindex="0"}function l(e,t){if("default"===e["ws-creates-context"])e["ws-creates-context"]=t&&t["ws-creates-context"]||"true";if("default"===e["ws-delegates-tabfocus"])e["ws-delegates-tabfocus"]=t&&t["ws-delegates-tabfocus"]||"true";if("default"===e["attr:ws-creates-context"])e["attr:ws-creates-context"]=t&&t["attr:ws-creates-context"]||"true";if("default"===e["attr:ws-delegates-tabfocus"])e["attr:ws-delegates-tabfocus"]=t&&t["attr:ws-delegates-tabfocus"]||"true"}function s(e,t){var r=(e=e[0]?e[0]:e).attributes,n={},s=["ws-delegates-focus","ws-creates-context","ws-autofocus","tabindex","ws-no-focus"];for(var i in s){var o=s[i],a=r.getNamedItem(o);if(a)n[o]=a.value}for(var u in c(n,t),l(n,t),f(n),n)e.setAttribute(u,n[u])}Object.defineProperty(t,"__esModule",{value:true}),t.closest=r,t.prepareAttrsForFocus=c,t.prepareTabindex=f,t.resetDefaultValues=l,t.patchDom=s}(a,e,u);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),O=x;e["View/Executor/_Expressions/Attr"]=true;var P,_=function(){"use strict";var e={},t=function(e,t,s,c,f){Object.defineProperty(t,"__esModule",{value:true}),t.isAttr=c.isAttr,t.checkAttr=c.checkAttr;var i=/\s+/g;function o(e,t){var r=e.class||e["attr:class"],n=t.class||t["attr:class"],s=r?n+" "+r:n;if("string"===typeof s)s=s.replace(i," ").trim();return s}function l(e){var t={};for(var r in e)if(c.isAttr(r))t[r.split(":")[1]]=e[r];else if(s.isEvent(r))t[r]=e[r];return t}function p(e,t){var r={};for(var n in e)if(e.hasOwnProperty(n))r[n]=e[n];for(var n in t)if(t.hasOwnProperty(n)&&void 0!==t[n]&&"undefined"!==t[n])if("class"===n)r.class=o(r,t);else if(s.isEvent(n))r[n]=r[n]?t[n].concat(r[n]):t[n];else if(!r.hasOwnProperty(n))r[n]=t[n];for(n in r)if(r.hasOwnProperty(n)&&(void 0===r[n]||"undefined"===r[n]))delete r[n];return r}function r(e,t,r,n){e=e||{},t=t||{};var s=false,i=false;if(c.checkAttr(e))e=l(e),s=true;if(c.checkAttr(t))t=l(t),i=true;var o=p(e,t);if(!r&&(s||i)){var a={};for(var u in o)if(!n)a["attr:"+u]=o[u];else a[u]=o[u];return a}return f.resetDefaultValues(o,t),o}function n(e,t){e=e||{},t=t||{};var r={},n,s;for(s in e)if(e.hasOwnProperty(s)&&void 0!==e[s]&&"undefined"!==e[s]&&null!==e[s])r[s.replace("attr:","")]=""!==e[s]?e[s]:void 0;for(s in t)if(t.hasOwnProperty(s)&&void 0!==t[s]&&"undefined"!==t[s]&&null!==t[s])if("attr:class"===s||"class"===s)r.class=o(r,t);else if(n=s.replace("attr:",""),!r.hasOwnProperty(n)||("ws-creates-context"===n||"ws-delegates-tabfocus"===n)&&"default"===r[n])r[n]=t[s]?t[s]:void 0;return f.resetDefaultValues(r,t),r}function a(e,t){var r={},n;for(n in e)if(e.hasOwnProperty(n))r[n]=e[n];for(n in t)if(t.hasOwnProperty(n))r[n]=r[n]?t[n].concat(r[n]):t[n];return r}t.joinAttrs=p,t.processMergeAttributes=r,t.mergeAttrs=n,t.mergeEvents=a}(a,e,f,u,x);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["View/Executor/_Expressions/RawMarkupNode"]=true;var C,m=function(){"use strict";var e={},t=function(e,t,i){Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e,t,r,n){var s={};if(t.hasOwnProperty("attr:ws-creates-context"))s["ws-creates-context"]=t["attr:ws-creates-context"];if(t.hasOwnProperty("attr:ws-delegates-tabfocus"))s["ws-delegates-tabfocus"]=t["attr:ws-delegates-tabfocus"];if(t.hasOwnProperty("attr:ws-tab-cycling"))s["ws-tab-cycling"]=t["attr:ws-tab-cycling"];if(t.hasOwnProperty("attr:ws-no-focus"))s["ws-no-focus"]=t["attr:ws-no-focus"];i.resetDefaultValues(s),this.markup=e,this.dom=null,this.key=n,this.nodeProperties=s}return e.prototype.applyMarkup=function(e){e.innerHTML=this._getMarkup();var t=e.firstChild||document.createTextNode("");return this._setProperties(t),t},e.prototype._getMarkup=function(){if("string"!==typeof this.markup)return"";return this.markup.trim()},e.prototype._setProperties=function(t){Object.keys(this.nodeProperties).forEach(function(e){t[e]=this.nodeProperties[e]}.bind(this))},e}();t.default=r}(a,e,x);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();return e.Attr=_,e.AttrHelper=t,e.ContextResolver=c,e.Decorate=b,e.Event=l,e.Focus=O,e.RawMarkupNode=m.default,e.Rights=d,e.Scope=w,e.Subscriber=y,e});