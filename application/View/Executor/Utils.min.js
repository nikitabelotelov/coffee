define("View/Executor/Utils",["View/Runner/Vdom/third-party/inferno","View/Request","Core/core-merge","View/Logger","Core/helpers/Function/shallowClone","View/Executor/Expressions","Core/IoC","Core/helpers/Object/isPlainObject","Core/RightsManager","Core/constants","require","exports"],function(r,i,o,a,s,u,l,c,f,p,d,e){"use strict";Object.defineProperty(e,"__esModule",{value:true}),e["View/Executor/_Utils/Class"]=true;var t,n=function(){var e={},t=function(e,t){function n(e){for(var t=0;t<e.length;++t)for(var n=t+1;n<e.length;++n)if(e[t]===e[n])e.splice(n--,1);return e}function r(e){var t=e.split(/\s+/);return e=(t=n(t=t.filter(function(e){return""!=e}))).join(" ")}Object.defineProperty(t,"__esModule",{value:true}),t.removeClassDuplicates=r}(d,e);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["View/Executor/_Utils/OptionsResolver"]=true;var v=function(){var e={},t=function(e,t,a,o){function s(e,t){for(var n in t)if("undefined"===typeof e[n])e[n]=t[n]}function u(e,t,n,r){for(var i in n){var o=n[i].call(null,t[i]);if(o instanceof Error)return o.message='"'+i+'"'+" option error: "+o.message,a.resolve("ILogger").error(o,"\nIn component "+e.prototype._moduleName+"\nParent name "+r),false}return true}function n(e,t,n){var r;if(s(t,e.getDefaultOptions&&e.getDefaultOptions()),!o.isProduction){var i;return u(e,t,e.getOptionTypes&&e.getOptionTypes(),n)}else return true}function r(e,t,n,r){if(!e)return;var i=e._getInheritOptions&&e._getInheritOptions(e)||{};if(!t.inheritOptions)t.inheritOptions={};var o={};for(var a in t.inheritOptions)if(t.inheritOptions.hasOwnProperty(a)){if(void 0===n[a])n[a]=t.inheritOptions[a];o[a]=n[a]}for(var s in i)if(i.hasOwnProperty(s)&&!o.hasOwnProperty(s)&&!r){if(n.hasOwnProperty(s))i[s]=n[s];o[s]=i[s],n[s]=i[s]}else if(i.hasOwnProperty(s)&&!o.hasOwnProperty(s)&&r&&n&&n.hasOwnProperty(s))o[s]=n[s];t.inheritOptions=o}Object.defineProperty(t,"__esModule",{value:true}),t.resolveDefaultOptions=s,t.validateOptions=u,t.resolveOptions=n,t.resolveInheritOptions=r}(d,e,l,p);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),y=v;e["View/Executor/_Utils/RequireHelper"]=true;var g=function(){var e={},t=function(n,e){Object.defineProperty(e,"__esModule",{value:true});var r={};function i(e){return-1===e.indexOf("<")&&-1===e.indexOf(">")&&e.indexOf("/")>-1&&"."!==e}function t(e){var t=false;if("string"!==typeof e)return false;if(r[e])return true;else if(i(e))if(t=n.defined(e))r[e]=n(e);return t}function o(e){if(!r[e])r[e]=n(e);return r[e]}e.defined=t,e.require=o}(d,e);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),b=g;e["View/Executor/_Utils/Common"]=true;var h=function(){var e={},t=function(i,e,r,o,a,s,u,l){Object.defineProperty(e,"__esModule",{value:true});var n=function e(){return Object.__proto__},t=function e(t){return t&&t.prototype||n()},c=function e(t){return l.defined(t)&&l.require(t)},f=function e(t,n){if(K(t)){var r=te(t),i=n&&n[r.library]||c(r.library);return i&&i[r.module]}return null},p=function e(t,n,r){return n&&n[t]||r&&(r[t]||r["optional!"+t])||c(t)||f(t,r)},d=function e(t,n,r,i){if(i&&i.moduleMaxNameLength)if(t.length>i.moduleMaxNameLength)return false;return p(t,n,r)},v=function e(t,n,r,i){if(t&&t.length)return d(t,n,r,i)},y={object:{getMinAccessLevel:function(e,t){var n;if("undefined"!==typeof e["data-access-min-level"])n=e["data-access-min-level"];else if("undefined"!==typeof e["dataAccessMinLevel"])s.resolve("ILogger").info("entityHelpers","Для задания минимального уровня доступа для опции, используйте data-access-min-level вместо dataAccessMinLevel."),n=e["dataAccessMinLevel"];if("string"===typeof n)n=parseInt(n,10);if("number"!==typeof n||isNaN(n))n=t;return n},isAccessible:function(e,t){var n,r;if("undefined"===typeof t)t=1;if(r=t,"undefined"!==typeof e["data-access"])n=e["data-access"];else if("undefined"!==typeof e["dataAccess"])s.resolve("ILogger").info("entityHelpers","Для задания зоны доступа для опции, используйте data-access вместо dataAccess."),n=e["dataAccess"];if("string"===typeof n)r=o.checkAccessRights(n.split(","));return r>=t},iterate:function(e,t){for(var n in e)if(e.hasOwnProperty(n))t(e[n],n,e);return e},remove:function(e,t){delete e[t]}},array:{getMinAccessLevel:function(e,t){return t},isAccessible:function(){return true},iterate:function(e,t){for(var n=e.length-1;n>=0;n--)t(e[n],n,e);return e},remove:function(e,t){e.splice(t,1)}}};function g(e,t){var n=e.length,r=new Array(n),i;for(i=0;i<n;i++)r[i]=t(e[i],i,e);return r}function b(e,t){var n;for(n in e)if(e.hasOwnProperty(n))e[n]=t(e[n],n);return e}function h(e,t){var n;for(n=0;n<e.length;n++)if(e[n]===t)return true;return false}function O(){return"undefined"!==typeof global&&"[object process]"===Object.prototype.toString.call(global.process)}function m(e){return/^((?=\.\d|\d)(?:\d+)?(?:\.?\d*)(?:[eE][+-]?\d+)?)$/.test(e.trim())}function _(e){return"[object String]"===Object.prototype.toString.call(e)}function w(e){return"[object Object]"===Object.prototype.toString.call(e)}function C(e){return"[object Function]"===Object.prototype.toString.call(e)}function P(e){return"[object Array]"===Object.prototype.toString.call(e)}function x(e){return e.replace(/\s/g,"")}function S(e){return e||0===e||""===e||false===e}function R(e,t){return e&&void 0!==e[t]}function j(e){for(var t in e)if(e.hasOwnProperty(t))return false;return true}function E(e){function t(e,t,n){var r,i,o,a={};for(r in t)if(i=t[r],!(r in e)||e[r]!==i&&(!(r in a)||a[r]!==i))e[r]=n?n(i):i;return e}if(!e||"object"!=typeof e||"[object Function]"===Object.prototype.toString.call(e))return e;if(e.nodeType&&"cloneNode"in e)return e.cloneNode(true);if(e instanceof Date)return new Date(e.getTime());if(e instanceof RegExp)return new RegExp(e);var n,r,i;if(e instanceof Array){for(n=[],r=0,i=e.length;r<i;++r)if(r in e)n.push(E(e[r]))}else n=e.constructor?new e.constructor:{};return t(n,e,E)}function N(e,t){return T(e,t)}function A(e){if(e&&"string"===typeof e){var n={"<":"&lt;",">":"&gt;","'":"&apos;",'"':"&quot;","{{":"&lcub;&lcub;","}}":"&rcub;&rcub;"};return(e=e.replace(/&([^#])/g,function e(t,n){return"&amp;"+n})).replace(/({{)|(}})|([<>'"])/g,function e(t){return n[t]||t})}return e}function M(e){if(e&&"string"===typeof e){var n={"{{":"&lcub;&lcub;","}}":"&rcub;&rcub;"};return e.replace(/({{)|(}})/g,function e(t){return n[t]||t})}return e}function k(e){return{__rootScope:e}}function I(e,t){if(!e)e=[];return e.push(t),e}function F(e,t){return e===t}function L(e,t){for(var n in t)if(t.hasOwnProperty(n))return 0===e.indexOf(n)?n:void 0}function V(e,t){var n=L(e,t);if(n)return t[n]}function T(e,t,n){var r={},i;if(!e)e={};if(!t)t={};if(n){for(i in e)if(e.hasOwnProperty(i))r[i]=e[i]}else r=e;for(i in t)if(t.hasOwnProperty(i))r[i]=t[i];return r}function W(e,t){var n;if(!e)e={};if(!t)t={};var r=false,i;if(t.attributes&&2===Object.keys(t.attributes).length&&t.attributes["name"]===t.attributes["sbisname"]&&void 0!==t.attributes["sbisname"])t={};if(t.attributes&&t.attributes["attr:key"])i=t.attributes["attr:key"];return i=i||t.key||e.key,{inheritOptions:t.inheritOptions,context:e.context,internal:e.internal,systemOptions:{},domNodeProps:{},key:i,attributes:u.Attr.processMergeAttributes(e.attributes,t.attributes),events:u.Attr.processMergeAttributes(e.events,t.events)}}function q(e,t){if(!e)e={};if(!t)t={};var n;if(t.attributes&&t.attributes["attr:key"])n=t.attributes["attr:key"];return n=n||t.key||e.key,{attributes:t.attributes||{},events:t.events||{},inheritOptions:e.inheritOptions,internal:e.internal,context:e.context,key:n}}function D(e,t){var n=Array.prototype.slice.call(t);if(void 0===n[0])n[0]=void 0;if(void 0===n[1])n[1]=void 0;if(void 0===n[2])n[2]=void 0;return n[3]=n[3]&&!r.isBuildOnServer,n.push(e),n}function U(e){return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()}function $(e,t){return t&&~t.indexOf(e)}function B(e,t){var n=e&&e["data-access"],r=o.rightsNeeded();if(n&&r)switch(o.checkAccessRights(n.split(","))){case 0:return false;case 1:var i;if(t["display"])t["readOnly"]=true,t["enabled"]=true,t["allowChangeEnable"]=false;else t["enabled"]=false,t["allowChangeEnable"]=false;return true}return this.applyRightsToEntity(t,1),this.removeBindCutOption(t),true}function H(e,r){var i=this,o;if(Array.isArray(e))o=y.array;else if(a(e))o=y.object;else return e;if(r=o.getMinAccessLevel(e,r),!o.isAccessible(e,r))return;return e=o.iterate(e,function(e,t,n){if(e&&e["__isRightsChecked"])return;if(a(e))Object.defineProperty(e,"__isRightsChecked",{enumerable:false,value:true});if(n[t]=i.applyRightsToEntity(e,r),void 0===n[t])o.remove(n,t)})}function z(e){var t=false,n=[],r,i,o,a;if(e&&e.bindings&&e.bindings.length){for(var s=0,u=(i=e.bindings).length;s<u;s++){if(t=false,r=e,(o=i[s]).propPath&&o.propPath.length)a=o.propName.split("/");else a=[];if(a.length)for(var l=0,c=a.length;l<c;l++)if(r.hasOwnProperty(a[l])){if(r=r[a[l]],l+2===c)t=true}else break;else t=true;if(t)n.push(i[s])}e.bindings=n}}function J(e){return 0===e.indexOf("wml!")||0===e.indexOf("tmpl!")||0===e.indexOf("html!")||0===e.indexOf("optional!tmpl!")}function Y(e){return 0===e.indexOf("js!")}function G(e){return 0===e.indexOf("optional!")}function K(e){var t=0===e.indexOf("ws:")?ie(e):e;return t.indexOf(":")>=0&&-1===t.indexOf("<")&&-1===t.indexOf(" ")}function Q(e){return e.split("/").length>1&&!J(e)&&-1===e.indexOf("<")&&-1===e.indexOf(" ")}function X(e,t){return G(e)||J(e)||Y(e)||Q(e)||L(e,t&&t.resolvers)}function Z(e){var t=e&&e.prototype;if(t&&"undefined"!==typeof t)return t.$constructor||t._template||e.isWasaby;return false}function ee(e){return e&&e.library&&e.module}function te(e){var t,n=(0===e.indexOf("ws:")?ie(e):e).split(":");return{library:n[0],module:n[1]}}function ne(e){var t;return(t=e.split("optional!"))[1]}function re(e){var t;return(t=e.split("js!"))[1]}function ie(e){var t;if(void 0!==e&&0===e.indexOf("ws:"))return(t=e.split("ws:"))[1];return}function oe(e){var t=ie(e);if(t)return t;return e}function ae(e,t){var n=e&&e["js!"+t]||l.defined("js!"+t)?i("js!"+t):i(t);if(!n&&/optional!/.test(t)){var r=t.split("optional!")[1];if(l.defined(r))n=i(r)}return n}function se(e){return e.prototype.$constructor&&!e.prototype._template||e.prototype._dotTplFn||e.prototype._isCoreCompound}function ue(e){return!se(e)}function le(e){s.resolve("ILogger").error("ASYNC RENDER ERROR",e?e.toString():e,e)}function ce(e,t,n,r){var i=v(e,t,n,r);if(G(e)&&!i)i=v(ne(e));return i}function fe(e){var t;return e.xmlns||"http://www.w3.org/1999/xhtml"}function pe(){if(r.isNodePlatform)return!process.domain||process.domain.req&&false!==process.domain.req.compatible;else return r.compat}function de(e){return e&&e.name&&"_options"===e.name.string}e.mapForLoop=g,e.eachObject=b,e.inArray=h,e.isNode=O,e.isNumber=m,e.isString=_,e.isObject=w,e.isFunction=C,e.isArray=P,e.removeAllSpaces=x,e.notUndefOrNull=S,e.checkProp=R,e.isEmpty=j,e.clone=E,e.plainMergeAttrs=N,e.escape=A,e.escapeParenthesis=M,e.createNewScope=k,e.bindingArrayHolder=I,e.toEqual=F,e.hasResolver=L,e.findResolverInConfig=V,e.plainMerge=T,e.plainMergeAttr=W,e.plainMergeContext=q,e.addArgument=D,e.capitalize=U,e.findInArray=$,e.applyRights=B,e.applyRightsToEntity=H,e.removeBindCutOption=z,e.isTemplateString=J,e.isControlString=Y,e.isOptionalString=G,e.isLibraryModuleString=K,e.isSlashedControl=Q,e.isStringModules=X,e.isControlClass=Z,e.isLibraryModule=ee,e.splitModule=te,e.splitOptional=ne,e.splitJs=re,e.splitWs=ie,e.correctName=oe,e.getConstructor=ae,e.isCompound=se,e.isNewControl=ue,e.asyncRenderErrorLog=le,e.depsTemplateResolver=ce,e.getNamespace=fe,e.isCompat=pe,e.isOptionsExpression=de,e.componentOptsReArray=[{toFind:/\\/g,toReplace:"\\\\"},{toFind:/<\/(script)/gi,toReplace:"<\\/$1"},{toFind:/'/g,toReplace:"\\u0027"},{toFind:/\u2028/g,toReplace:"\\u000a"},{toFind:/\u2029/g,toReplace:"\\u000a"},{toFind:/\n/g,toReplace:"\\u000a"},{toFind:/\r/g,toReplace:"\\u000d"}]}(d,e,p,f,c,l,u,g);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),O=h;e["View/Executor/_Utils/Compatible"]=true;var m,_=function(){var e={},t=function(l,e,i,d,v,c,f,y){function g(e,t){var n,r=i(e);for(n in t)if(t.hasOwnProperty(n)&&-1===n.toString().indexOf("__dirtyCheckingVars_"))r[n]=t[n];return r}function p(e,t,n){var r;if(e.$constructor)r=g(t,n);else if(n&&n.logicParent)(r=t)._logicParent=n.logicParent,r._isSeparatedOptions=true;else r=g(t,{_isSeparatedOptions:true});return r}function t(e,t,n){n=n||{};var r=p(e.prototype,t,n),i,o,a,s=n.logicParent&&n.logicParent._moduleName;if(f.resolveOptions(e,r,s),n.parent&&n.parent._options&&n.parent._options.iWantBeWS3)r.iWantBeWS3=true;try{i=new e(r)}catch(e){i=new(a=l("Core/Control"))({iWantBeWS3:r.iWantBeWS3}),c.catchLifeCircleErrors("constructor",e)}if(r.mustCompatible||r.iWantBeWS3)try{var u;l("Core/helpers/Hcontrol/makeInstanceCompatible")(i)}catch(e){d.resolve("ILogger").error("WS3WS4","Please require Core/helpers/Hcontrol/makeInstanceCompatible manual")}if(n.logicParent&&n.logicParent._children&&t.name)n.logicParent._children[t.name]=i;if(i.isCompatibleLayout&&!i.isCompatibleLayout()&&false!==i.iWantVDOM)if(o=i._options,i._savedOptions)i._options=i._savedOptions;else i._options=r;else if(!i._options)i._options=r;if(v.compat)i._setInternalOptions(n);if(i.isCompatibleLayout&&!i.isCompatibleLayout()&&false!==i.iWantVDOM)i._savedOptions=i._options,i._options=o;else if(i._dotTplFn||false===i.iWantVDOM)r=i._options;return{instance:i,resolvedOptions:r}}function n(e,t,n,r,i,o,a,s,u){var l={},c=e.prototype&&e.prototype._moduleName,f;if(r.__vdomOptions={controlNode:s},l[c]=e,!(f=u.createWsControl("ws:"+c,r,{internal:s.controlInternalProperties,attributes:s.controlAttributes,events:s.controlEvents,key:s.key,context:s.context,inheritOptions:s.inheritOptions},void 0,l)))f="<span>Component "+c+" was building error</span>";if(!v.compat)d.resolve("ILogger").error("Building component","CompoundControl detected. Component name = "+c);var p=new y.RawMarkupNode(f,s.controlAttributes,c,s.key);return{control:e,controlClass:t,options:g(r,i),id:void 0,parent:a,key:o,element:void 0,markup:p,fullMarkup:p,childrenNodes:n,compound:true}}Object.defineProperty(e,"__esModule",{value:true}),e.createCombinedOptions=g,e.combineOptionsIfCompatible=p,e.createInstanceCompatible=t,e.createCompoundControlNode=n}(d,e,s,l,p,a,v,u);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["View/Executor/_Utils/ConfigResolver"]=true;var w,C=function(){var e={},t=function(e,t,s,u,l,c){function r(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}function i(e){if(e&&e.hasOwnProperty&&!e.global){if(e["__$$__originObject"])e=e["__$$__originObject"];if(r(e,"_options"))return e;else return i(Object.getPrototypeOf(e))}return null}function f(e,t,n){return e.viewController||("undefined"!==typeof t?n[t]&&r(n[t],"parent")&&r(n[t].parent,"_template")?n[t].parent:i(e):i(e))}function p(e,t,n,r,i){if(!u.compat)return true;var o=true;if(e)o=!e.isEnabled||e.isEnabled();else if(r){if(n&&r[n]){if(void 0!==r[n].enabled)o=r[n].enabled;else if(void 0!==r[n].parentEnabled)o=r[n].parentEnabled;else if(i&&i.internal&&i.internal.hasOwnProperty("parentEnabled"))o=i.internal.parentEnabled}else if(void 0!==r.enabled)o=r.enabled;else if(void 0!==r.parentEnabled)o=r.parentEnabled;else if(i&&i.internal&&i.internal.hasOwnProperty("parentEnabled"))o=i.internal.parentEnabled}else o=true;return o}function n(e,t,n){var r=t.internal||{},i,o=void 0,a=false;if(e=c.Scope.calculateScope(e,l.plainMerge),t.data&&t.data[c.Scope.propertyNameToIdentifyIsolatedScope]){if((i=t.data[t.data[c.Scope.propertyNameToIdentifyIsolatedScope]])&&"content"!==t.data[c.Scope.propertyNameToIdentifyIsolatedScope])delete i.enabled;if(i&&i.hasOwnProperty("enabled"))o=i.enabled;if(i&&!i.hasOwnProperty("parent")&&(!i.hasOwnProperty("element")||!i.element||0===i.element.length))e=s(e,i,{rec:!(t.viewController&&t.viewController._template),preferSource:true,ignoreRegExp:/(^on:|^content$)/gi})}if(r.logicParent=t.viewController,u.compat)r.parent=f(t.ctx,t.pName,t.data),r.parentEnabled=p(r.parent,t.ctx,t.pName,t.data,n)&&(void 0===o?true:o);return r.hasOldParent=n&&n.internal&&n.internal.isOldControl,{user:e,internal:r}}Object.defineProperty(t,"__esModule",{value:true}),t.calcParent=f,t.resolveControlCfg=n}(d,e,o,p,h,u);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["View/Executor/_Utils/Vdom"]=true;var P,x=function(){var e={},t=function(e,t,u,l,a,c,f,n){Object.defineProperty(t,"__esModule",{value:true});var r="",i="cfg-";function o(e){return(e+"").replace(i,"").split(",")[0]}function p(e,t,n){e._saveContextObject(n),e.saveFullContext(c.ContextResolver.wrapContext(e,t.context||{}))}function s(e,t,n,r){var i,o=u.getCurrent().stateReceiver;if(o&&o.register)o.register(e,{setState:function(e){i=e},getState:function(){return{}}});if(!i&&window["inline"+e])if(i=JSON.parse(window["inline"+e],r.deserialize),window["inline"+e])window["inline"+e]=void 0;var a=c.ContextResolver.resolveContext(t.constructor,n.context||{},t),s;try{s=i?t._beforeMount(n.controlProperties,a,i):t._beforeMount(n.controlProperties,a)}catch(e){l.catchLifeCircleErrors("_beforeMount",e)}if(s&&s.then)s.then(function(e){return p(t,n,a),e});else p(t,n,a);if(!n.inheritOptions)n.inheritOptions={};if(f.resolveInheritOptions(n.controlClass,n,n.controlProperties),t.saveInheritOptions(n.inheritOptions),o&&o.unregister)o.unregister(e);return s}function d(e,t,n,r,i){var o=a.createVNode(_(e),e,t&&t.attributes&&t.attributes.class||"",n,n&&n.length?r?8:4:0,t.attributes,r,i);return o.hprops=t,o}function v(e,t){return a.createTextVNode(e,t)}function y(e,t,n){return{controlClass:e,controlProperties:t,key:n,controlNodeIdx:-1}}function g(e){return e&&!n.isString(e.children)&&"number"!==typeof e.children&&e.hasOwnProperty("dom")}function b(e){return e&&(n.isString(e.children)||"number"===typeof e.children)&&e.hasOwnProperty("dom")}function h(e){return e&&"object"===typeof e&&"controlClass"in e}function O(e){return e&&"object"===typeof e&&"TemplateNode"===e.type}function m(e,t,n){var r=e.control,i=e.key?o(e.key):"";if(r._beforeMount)return s(i,r,t,n)}function _(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.getFlagsForElementVnode.apply(a,[].slice.call(arguments))}function w(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.patch.apply(a,[].slice.call(arguments))}function C(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.render.apply(a,[].slice.call(arguments))}function P(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a.createRenderer.apply(a,[].slice.call(arguments))}t.htmlNode=d,t.textNode=v,t.controlNode=y,t.isVNodeType=g,t.isTextNodeType=b,t.isControlVNodeType=h,t.isTemplateVNodeType=O,t.getReceivedState=m,t.getFlagsForElementVnode=_,t.patch=w,t.render=C,t.createRenderer=P}(d,e,i,a,r,u,v,h);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();return e.Class=n,e.Common=O,e.Compatible=_,e.ConfigResolver=C,e.OptionsResolver=y,e.RequireHelper=b,e.Vdom=x,e});