define("View/Executor/_Expressions/Rights",["require","exports","Core/RightsManager","Core/helpers/Object/isPlainObject","Core/IoC"],function(e,t,n,a,s){Object.defineProperty(t,"__esModule",{value:true});var i={object:{getMinAccessLevel:function(e,t){var i;if("undefined"!==typeof e["data-access-min-level"])i=e["data-access-min-level"];else if("undefined"!==typeof e["dataAccessMinLevel"])s.resolve("ILogger").info("entityHelpers","Для задания минимального уровня доступа для опции, используйте data-access-min-level вместо dataAccessMinLevel."),i=e["dataAccessMinLevel"];if("string"===typeof i)i=parseInt(i,10);if("number"!==typeof i||isNaN(i))i=t;return i},isAccessible:function(e,t){var i,r;if("undefined"===typeof t)t=1;if(r=t,"undefined"!==typeof e["data-access"])i=e["data-access"];else if("undefined"!==typeof e["dataAccess"])s.resolve("ILogger").info("entityHelpers","Для задания зоны доступа для опции, используйте data-access вместо dataAccess."),i=e["dataAccess"];if("string"===typeof i)r=n.checkAccessRights(i.split(","));return r>=t},iterate:function(e,t){for(var i in e)if(e.hasOwnProperty(i))t(e[i],i,e);return e},remove:function(e,t){var i=Object.getOwnPropertyDescriptor(e,t);if(i.configurable)delete e[t];else if(i.set)e[t]=void 0}},array:{getMinAccessLevel:function(e,t){return t},isAccessible:function(){return true},iterate:function(e,t){for(var i=e.length-1;i>=0;i--)t(e[i],i,e);return e},remove:function(e,t){e.splice(t,1)}}};function c(e){var t=false,i=[],r,s,n,a;if(e&&e.bindings&&e.bindings.length){for(var c=0,f=(s=e.bindings).length;c<f;c++){if(t=false,r=e,(n=s[c]).propPath&&n.propPath.length)a=n.propName.split("/");else a=[];if(a.length)for(var l=0,o=a.length;l<o;l++)if(r.hasOwnProperty(a[l])){if(r=r[a[l]],l+2===o)t=true}else break;else t=true;if(t)i.push(s[c])}e.bindings=i}}function f(e,r){var s;if(Array.isArray(e))s=i.array;else if(a(e))s=i.object;else return e;if(r=s.getMinAccessLevel(e,r),!s.isAccessible(e,r))return;return e=s.iterate(e,function(e,t,i){if(e&&e["__isRightsChecked"])return;if(a(e))Object.defineProperty(e,"__isRightsChecked",{enumerable:false,value:true});if(i[t]=f(e,r),void 0===i[t])s.remove(i,t)})}function r(e,t){var i=e&&(e["data-access"]||e["attr:data-access"]),r=n.rightsNeeded();if(i&&r)switch(n.checkAccessRights(i.split(","))){case 0:return false;case 1:var s;if(t["display"])t["readOnly"]=true,t["enabled"]=true,t["allowChangeEnable"]=false;else t["enabled"]=false,t["allowChangeEnable"]=false;return true}return f(t,1),c(t),true}return t.removeBindCutOption=c,t.applyRightsToEntity=f,t.applyRights=r,t});