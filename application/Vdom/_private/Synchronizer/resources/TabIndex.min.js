define("Vdom/_private/Synchronizer/resources/TabIndex",["require","exports","Vdom/_private/Utils/Functional"],function(e,t,w){"use strict";Object.defineProperty(t,"__esModule",{value:true});var s=1,y={a:true,link:true,button:true,input:true,select:true,textarea:true},f=1,c=2,d=4,b=8,m=16,g={hidden:f,disabled:c,"delegates-tabfocus":d,"creates-context":b,"tab-cycling":m};function h(e,t){return window.getComputedStyle(e)[t]}function n(e){var t=/\bws-(hidden|disabled)\b/g,n=e.getAttribute("class"),i,l,r,o,a,s,u;a=0;while(i=n&&t.exec(n))a|=g[i[1]];if("true"===e["ws-creates-context"]||"true"===e.getAttribute("ws-creates-context"))a|=g["creates-context"];if("true"===e["ws-delegates-tabfocus"]||"true"===e.getAttribute("ws-delegates-tabfocus"))a|=g["delegates-tabfocus"];if("true"===e["ws-tab-cycling"]||"true"===e.getAttribute("ws-tab-cycling"))a|=g["tab-cycling"];if(s=0===(a&(f|c)))s="none"!==h(e,"display")&&"invisible"!==h(e,"visibility");if(s)r=e.getAttribute("tabindex"),l=parseInt(r,10),u={enabled:true,tabStop:(o=!isNaN(l))&&l>=0||null===r&&y.hasOwnProperty(e.tagName.toLowerCase())||-1!==l&&e.hasAttribute("contenteditable"),createsContext:0!==(a&b),tabIndex:l||0,delegateFocusToChildren:0!==(a&d),tabCycling:0!==(a&m)};else u={enabled:false,tabStop:false,createsContext:false,tabIndex:0,delegateFocusToChildren:false,tabCycling:false};return u}function S(e){return e.firstElementChild&&"vdom-focus-in"!==e.firstElementChild.className?e.firstElementChild:e.firstElementChild&&e.firstElementChild.nextElementSibling&&"vdom-focus-out"!==e.firstElementChild.nextElementSibling.className?e.firstElementChild.nextElementSibling:null}function I(e){return e.lastElementChild&&"vdom-focus-out"!==e.lastElementChild.className?e.lastElementChild:e.lastElementChild&&e.lastElementChild.previousElementSibling&&"vdom-focus-in"!==e.lastElementChild.previousElementSibling.className?e.lastElementChild.previousElementSibling:null}function N(e){return e.previousElementSibling?e.previousElementSibling:null}function A(e){return e.nextElementSibling?e.nextElementSibling:null}function F(o,e,t,n,i){function l(e,t,n){var i;if(w.assert("number"===typeof e&&"number"===typeof t),e=0===e?1/0:e>0?e:-1,-1===(t=0===t?1/0:t>0?t:-1)&&-1!==e)return 1;if(-1===e&&-1!==t)return-1;if(e>t)i=n?-1:1;else if(e<t)i=n?1:-1;else i=0;return i}function r(e,t,n){var i,l,r;if(t.enabled&&!t.createsContext)l=n?I(e):S(e);if(!l)if(!(l=n?N(e):A(e))){r=e.parentNode;while(r!==o&&!l)if(!(l=n?N(r):A(r)))r=r.parentNode}return l||o}function a(e){return F(e,void 0,n?0:1,n,i)}function s(e){return n?I(e):S(e)}function u(e,t){if(t.delegateFocusToChildren&&e.childElementCount)if(e.wsControl&&e.wsControl.canAcceptFocus&&e.wsControl.canAcceptFocus())x=e;else x=a(e);return!!(!t.delegateFocusToChildren||y.hasOwnProperty(e.tagName.toLowerCase())||x)}w.assert(o&&(e||void 0!==t)&&i&&o!==e);var f,c,d,b,m,g,h=null,C,E=null,x,p;if(e)t=(g=i(e)).tabIndex,f=r(e,g,n);else f=(f=n?I(o):S(o))||o;var v=false;for(d=0;2!==d&&!b;d++){while(f!==o&&f!==e&&!b){if((c=i(f)).enabled&&c.tabStop)if(0===(m=l(c.tabIndex,t,n))&&0===d){if(u(f,c))b=f,p=x}else if(m>0)if(!b)if(0===d){if(null===h||l(c.tabIndex,h.tabIndex,n)<0)if(u(f,c))h=f,E=c.tabIndex,C=d,p=x}else if(null===h||l(c.tabIndex,h.tabIndex,n)<0||v&&l(c.tabIndex,h.tabIndex,n)<=0)if(u(f,c))h=f,E=c.tabIndex,C=d,p=x,v=false;if(-1===t&&h)b=h;if(!b)f=r(f,c,n)}if(f===o&&0===d)if(e&&(false===n&&t>0||true===n&&1!==t&&-1!==t))f=s(o);if(0===d)v=true}if(w.assert(!!b||f===e||f===o),!b&&h)if(E>=0)b=h;if(b&&p)b=p,w.assert(!!b);return b}function u(e,t,n){return F(e,void 0,t?0:1,t,n)}function i(r,e,t,o){function n(e){var t,n=null,i,l=e;while(l&&l!==r){if(!o(l).enabled)n=l;l=l.parentElement}if(!l)throw new Error("Узел fromElement должен лежать внутри узла rootElement");if((i=n||e)!==r){l=i.parentElement;while(l!==r&&!o(l).createsContext)l=l.parentElement;t=l}return{element:e,context:t}}function i(e,t){var n=e===document.documentElement||!!e.parentElement;if(!e||!e.ownerDocument||!n||e.nodeType!==s)throw new Error("Плохой параметр "+t)}i(e,"fromElement"),i(r,"rootElement");var l=n(e),a=l.element;if(a!==r)do{if(!(a=F(l.context,l.element,void 0,t,o)))if(o(l.context).tabCycling)break;else l=n(l.context)}while(!a&&l.element!==r);if(a===r)a=u(r,t,o);if(!a&&o(l.context||r).tabCycling)if(void 0===(a=u(l.context||r,t,o)))a=e;return a}function l(){var e=document.createElement("div");return e.innerHTML='<svg><foreignObject width="30" height="30">'+'<input type="text"/>'+"</foreignObject></svg>",e.firstChild.firstChild}function r(e){var t;if(!(e.ownerSVGElement||"svg"===e.nodeName.toLowerCase()))return false;var n=l();e.appendChild(n);var i=n.querySelector("input");return i.focus(),i.disabled=true,e.removeChild(n),true}function o(t){if(t.focus)t.focus();try{HTMLElement.prototype.focus.call(t)}catch(e){r(t)}}t.getElementProps=n,t.findFirstInContext=u,t.findWithContexts=i,t.focus=o});