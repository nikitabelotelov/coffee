define("Vdom/_private/Synchronizer/resources/Debug",["require","exports","Vdom/_private/Synchronizer/resources/VdomMarkup","View/Executor/Utils","Vdom/_private/Synchronizer/resources/DirtyChecking","View/Executor/TClosure","Core/helpers/Object/isEmpty"],function(e,r,i,f,s,y,u){"use strict";Object.defineProperty(r,"__esModule",{value:true});var l=20,g={0:"NONE",1:"VTEXT",2:"VNODE",3:"WIDGET",4:"PROPS",5:"ORDER",6:"INSERT",7:"REMOVE",8:"THUNK",VirtualNode:"VirtualNode"};function v(e,o){var l=/["'&<>]/,t={area:true,base:true,br:true,col:true,embed:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true};function r(e){var r=""+e,t=l.exec(r);if(!t)return r;var o,n="",i,u=0;for(i=t.index;i<r.length;i++){switch(r.charCodeAt(i)){case 34:o="&quot;";break;case 38:o="&amp;";break;case 39:o="&#39;";break;case 60:o="&lt;";break;case 62:o="&gt;";break;default:continue}if(u!==i)n+=r.substring(u,i);u=i+1,n+=o}return u!==i?n+r.substring(u,i):n}var n=u(function(e){return r(e)+'="'});function i(e){return(e=void 0!==e&&null!==e?e.toString():"").replace('"',"&quot;")}function a(e,r,t){if(t){if(null==r)return"";return n(e)+i(r)+'"'}return null}function u(r){var t={};return function(e){if(t.hasOwnProperty(e))return t[e];else return t[e]=r.call(this,e)}}function s(e){if(!e)return"";if(f.Vdom.isControlVNodeType(e))return y.getMarkupGenerator(false).createWsControl(e.controlClass,e.controlProperties,{internal:e.controlInternalProperties,attributes:e.controlAttributes,events:e.controlEvents,key:e.key,context:e.context,inheritOptions:e.inheritOptions},o);if(f.Vdom.isTemplateVNodeType(e))return y.getMarkupGenerator(false).createTemplate(e.template,e.attributes&&e.controlProperties,e.attributes,o);else if(f.Vdom.isVNodeType(e))return c(e)+d(e)+p(e);else if(f.Vdom.isTextNodeType(e))return String(e.children);else if(Array.isArray(e)){for(var r="",t=0;t<e.length;t++)r+=s(e[t]);return r}else if("string"===typeof e)return e;return""}function c(e){var r=e.hprops,t="<"+e.type.toLowerCase(),o,n,i,u;for(i in o=r["attributes"])if(o.hasOwnProperty(i)&&null!==o[i]&&void 0!==o[i]&&""!==o[i])t+=" "+a(i,o[i],true);for(u in n="",o=r["style"])if(o.hasOwnProperty(u)&&null!==o[u])n+=u+": "+o[u]+";";if(""!==n)t+=" "+a("style",n,true);return t+">"}function d(e){var r=e.properties&&e.properties.innerHTML;if(r)return r;else{var t="",o=e.children,n=o&&o.length||0,i,u;for(i=0;i!==n;i++)t+=s(u=o[i]);return t}}function p(e){var r=e.type.toLowerCase();return t[r]?"":"</"+r+">"}return s(e)}function h(t){return function(){var e=Date.now(),r;return{value:t.apply(this,arguments),time:Date.now()-e}}}function m(t,e){function r(e,r){if(r.length){console.group(e);try{r.forEach(function(e){N(t,e)})}finally{console.groupEnd()}}}var o=e.createdNodes.slice(0,l),n=e.updatedChangedNodes.slice(0,l),i=e.updatedUnchangedNodes.slice(0,l),u=e.destroyedNodes.slice(0,l);console.log("------------------"),r("Созданы",o),r("Обновлены - изменены по опциям",n),r("Обновлены - не изменены",i),r("Удалены",u)}function a(e,r,t){var o,n=[];if(f.Vdom.isControlVNodeType(t))N(e,t.controlNode);else{if(o=[f.Vdom.isVNodeType(t)?t.tagName:f.Vdom.isTextNodeType(t)?t.text:"???"],void 0!==t.key)o.push[t.key];if(n=[o.join("/")],f.Vdom.isVNodeType(t))n.push(u(t.properties)?"":t.properties);if(r){console.group.apply(console,n);try{i.getVNodeChidlren(t).forEach(a.bind(void 0,e,r))}finally{console.groupEnd()}}else console.log.apply(console,n)}}function N(e,r){var t=r.control,o=t.get("name"),n=r.markup,i,u=e[r.id]||s.DirtyKind.NONE,l=u===s.DirtyKind.NONE?[]:u===s.DirtyKind.DIRTY?["D"]:["C"],a;if(a=(o?[o]:[]).concat([t.describe()]),void 0!==r.key)a.push(r.key);a=a.concat(l),console.log(a.join("/"),r.id,t.getRawData())}function c(o,e,n,r,t,i){for(var u in t=t||{})if(t.hasOwnProperty(u)){var l=t[u],a,s=h(v.bind(void 0,l.value.a))(),c={};for(var d in l.value)if(l.value.hasOwnProperty(d)){var p=l.value[d],f="type"in p?g[p.type]:"????";if(f)c[f]=c.hasOwnProperty(f)?c[f]+1:1}console.group("PATCH: time = "+l.time,true),console.log(c,l.value),console.log("toHTML: time = ",s.time,s.value.length),console.groupEnd()}if(!i.silent&&e)e.forEach(function(e,r){var t=n[r];console.groupCollapsed("Старое",r);try{N(o,e)}finally{console.groupEnd()}console.groupCollapsed("Новое",r);try{N({},t)}finally{console.groupEnd()}}),m(o,r)}function t(o,n){return function(){var e=Date.now(),r,t;try{t=o.call(this,h)}finally{if(r=Date.now()-e,t)c(t.dirties,t.oldRoots,t.newRoots,t.rebuildChanges,t.applyResults,n);console.log("Время перестроения - ",r)}return t}}r.vdomToHTML=v,r.logRebuildChanges=m,r.logVNode=a,r.logControlNode=N,r.logRebuild=c,r.withLogRebuild=t});