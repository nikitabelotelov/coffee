define("Vdom/Vdom",["Core/helpers/Function/runDelayed","Core/core-extend","View/Executor/Markup","Core/helpers/isNewEnvironment","Core/helpers/Array/findIndex","Core/helpers/Array/uniq","Core/detection","Core/core-instance","Core/helpers/Array/flatten","Core/core-debug","View/Logger","Core/Serializer","Core/helpers/Function/shallowClone","View/Executor/Expressions","Core/constants","Core/helpers/Object/isEmpty","View/Executor/TClosure","View/Executor/Utils","require","exports","Core/IoC"],function(n,o,i,a,s,u,l,d,c,f,p,h,v,m,y,g,N,b,_,e,C){Object.defineProperty(e,"__esModule",{value:true}),e["Vdom/_private/Synchronizer/resources/SyntheticEvent"]=true;var w=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var n={blur:false,error:false,focus:false,load:false,mouseenter:false,mouseleave:false,resize:false,scroll:false,unload:false,click:true,change:true,compositionend:true,compositionstart:true,compositionupdate:true,dblclick:true,focusin:true,focusout:true,input:true,keydown:true,keypress:true,keyup:true,mousedown:true,mousemove:true,mouseout:true,mouseover:true,mouseup:true,select:true,wheel:true,touchstart:true,touchend:true,touchmove:true,contextmenu:true,swipe:true};function r(e,t){var r=e?e:t;this.nativeEvent=e?e:null,this.type=r.type,this.target=r.target,this._bubbling=e?n[r.type]:t&&t._bubbling,this.stopped=false}var o=(t.default=r).prototype;o.stopPropagation=function(){if(this.stopped=true,this.nativeEvent)this.nativeEvent.stopPropagation()},o.isStopped=function(){return this.stopped},o.isBubbling=function(){return this._bubbling},o.preventDefault=function(){if(this.nativeEvent)this.nativeEvent.preventDefault()},o.propagating=function(){return true===this._bubbling&&false===this.stopped},o.stopImmediatePropagation=function(){this.stopPropagation()}}(_,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),t=w;e["Vdom/_private/Synchronizer/resources/DirtyCheckingCompatible"]=true;var T=function(){"use strict";var e={},t=function(e,t,s,u){function r(e,t,r,n,o,i,a){return s.Compatible.createCompoundControlNode(e,t,[],r,n,o,i,a,u.getMarkupGenerator(false))}function n(e,t){if(e)delete e.editingTemplate,delete e.columns,delete e.itemContentTpl,delete e.dictionaries;for(var r in e)if(e.hasOwnProperty(r)&&!t.hasOwnProperty(r))delete e[r];return e}Object.defineProperty(t,"__esModule",{value:true}),t.createCompoundControlNode=r,t.clearNotChangedOptions=n}(_,e,b,N);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),r=T;e["Vdom/_private/Synchronizer/resources/Hooks"]=true;var k=function(){"use strict";var e={},t=function(e,t,l,a){function r(o){function e(e){var t,r=(e.nativeEvent&&e.nativeEvent.args||[]).concat(o.args);o.fn.apply(o.controlNode.control,[e].concat(r));var n=e.nativeEvent.result;if(n&&n.then)n.then(function(){o.controlNode.requestDirtyCheck()});else o.controlNode.requestDirtyCheck();return[o.controlNode.control,e]}if("event"===o.name)return e;else throw new Error("getEventHandlerBase: wrong event type")}Object.defineProperty(t,"__esModule",{value:true});var n=function(){function e(e){this.type="ControlNodeHook",this.controlNode=e}return e}();t.ControlNodeHook=n;var o=function(){function e(e,t){this.nameForNode=e,this.control=t}return e.hookName="named-hook",e.attributeName="name",e.restrictedTags={component:true,option:true},e}();t.NamedNodeHook=o;var i=function(){function e(e,t){this.propName=e,this.value=t}return e}();function s(e,t,r){var n=e&&e["controlNodes"]||[],o;if(r(n,n.indexOf(t)),e)e["controlNodes"]=n;for(var i=0;i<n.length;i++)if(n[i]["element"]=e,a.compat)n[i].control.saveOptions(n[i].control._options,n[i]);else n[i].control._container=e}function u(e){var t=e.slice(0);t.sort(function(e,t){var r=parseInt((e.id+"").replace("inst_",""),10),n=parseInt((t.id+"").replace("inst_",""),10);if(r>n)return-1;if(r<n)return 1;return 0}),t.unshift(t.length),t.unshift(0),e.splice.apply(e,t)}function d(e){return function(e,t,r,n,o,i){var a=function e(t){if(t){if(this.environment._destroyed)return;if(i)i(t);if(this.controlNode.markup&&"invisible-node"===this.controlNode.markup.type)v(this.controlNode,this.controlNode.events,this.controlNode.environment,t);s(t,this.controlNode,function(e,t){var r;if(!(-1!==t))e.push(this.controlNode),u(e)}.bind(this))}else s(this.controlNode.control._container[0],this.controlNode,function(e,t){var r;if(-1!==t)e.splice(t,1)}.bind(this))}.bind({controlNode:o,environment:o.environment});return[e,t,r,n,a?a:i]}}function c(e){var t=(e=e.arguments||e).length,r=new Array(t),n=t-1,o;if("number"!==typeof t)throw new Error("reverseArray - wrong arg");for(o=0;o!==t;o++)r[n]=e[o],n--;return r}function f(e,t){this.eventName=e,this.eventDescrArr=t,this.handlerFn=null}function p(e,t,r,n){this.eventName=e,this.environment=r,this.eventDescrArr=t.map(function(e){return e.controlNode=n,e})}function h(e,t){return e.filter(function(e){return t[0]&&t[0].value===e.value})}function v(t,e,r,n){var o;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i],s=l.Event.getEventName(i),u=a.map(function(e){return e.controlNode=t,e});if(!(a instanceof p)&&!(a instanceof f)){if(!n.eventProperties)n.eventProperties={},n.eventPropertiesCnt=0;if(n.eventProperties[i])if(o=h(n.eventProperties[i],u),n.eventProperties[i]&&0===o.length)u=u.concat(n.eventProperties[i]);n.eventProperties[i]=u,n.eventPropertiesCnt++,r.addCaptureEventHandler(s,n)}}}function m(a){return function(e,t,r,n,s,u){var o,i;if(Object.keys(t.events).length>0)i=function(e){var t;if(e){if(this.environment._destroyed)return;u(e),v(this.controlNode,this.events,this.environment,e)}else for(var r in u(),this.events)if(this.events.hasOwnProperty(r)){var n=this.events[r],o=l.Event.getEventName(r),i=n.map(function(e){return e.controlNode=s,e}),a;if(!(n instanceof p)&&!(n instanceof f))if(t=this.controlNode.control._container[0],this.environment.removeCaptureEventHandler(o,t),t&&t.eventProperties)if(delete t.eventProperties[this.eventName],t.eventPropertiesCnt--,0===t.eventPropertiesCnt)delete t.eventPropertiesCnt,delete t.eventProperties}}.bind({environment:a,controlNode:s,events:t.events});return[e,t,r,n,i?i:u]}}t.FocusPropsNodeHook=i,t.setControlNodeHook=d,f.prototype.type="BubblingPhaseEventHook",p.prototype.type="CapturePhaseEventHook",t.setEventHooks=m}(_,e,m,y);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),O=k;e["Vdom/_private/Synchronizer/resources/SwipeController"]=true;var E=function(){"use strict";var e={},t=function(e,t){var n;function o(){n={minSwipeDistance:50,deviationThreshold:25,maxSwipeDuration:600}}function r(e){if(!n||!n.target)o(),n.time=Date.now(),n.location=i(e),n.target=e.target}function i(e){var t=e.touches?e.touches[0]:e;return{x:t.clientX,y:t.clientY}}function a(e){var t=i(e),r;if(e.target===n.target&&n.time-Date.now()<n.maxSwipeDuration)if(Math.abs(n.location.x-t.x)>n.minSwipeDistance&&Math.abs(n.location.y-t.y)<n.deviationThreshold)r=n.location.x>t.x?"left":"right";else if(Math.abs(n.location.y-t.y)>n.minSwipeDistance&&Math.abs(n.location.x-t.x)<n.deviationThreshold)r=n.location.y>t.y?"top":"bottom";return r}function s(e){if(n.target){var t=a(e);if(t){var r=new Event("swipe");r.direction=t,e.target.dispatchEvent(r),o()}}}Object.defineProperty(t,"__esModule",{value:true}),t.resetSwipeState=o,t.initSwipeState=r,t.detectSwipe=s}(_,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),V=E;e["Vdom/_private/Synchronizer/resources/runDelayedRebuild"]=true;var D=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var n,o=function e(){var t=null;if("undefined"!==typeof document)if("undefined"!==typeof document.hidden)t="hidden";else if("undefined"!==typeof document.msHidden)t="msHidden";else if("undefined"!==typeof document.webkitHidden)t="webkitHidden";return t}();function i(e){if(o&&document[o])setTimeout(e,0);else r(e)}t.default=i}(_,e,n);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),M=D;e["Vdom/_private/Synchronizer/resources/Environment"]=true;var P=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var n=r.extend({constructor:function(e,t){this._controlStateChangedCallback=e,this._rebuildIgnoreId=null},destroy:function(){this._controlStateChangedCallback=null,this._destroyed=true}}),o=n.prototype;o.forceRebuild=function(e){if(this._rebuildIgnoreId!==e&&this._controlStateChangedCallback)this._controlStateChangedCallback(e)},o.setRebuildIgnoreId=function(e){this._rebuildIgnoreId=e},o.needWaitAsyncInit=function(){return false},o.setupControlNode=function(e){e.environment=this,e.control._saveEnvironment(this,e)},o.decorateRootNode=function(e){return this._rootMapper?this._rootMapper(e):e},t.default=n}(_,e,o);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),x=P;e["Vdom/_private/Utils/Functional"]=true;var I=function(){"use strict";var e={},t=function(e,t){function o(e){var t=e.length,r=new Array(t),n;if("number"!==typeof t)throw new Error("argumentsToArray - wrong arg");for(n=0;n!==t;n++)r[n]=e[n];return r}function n(e){var r=Array.isArray(e)?e:o(arguments),n=r.length;return function(){var e=r[n-1].apply(this,arguments),t;for(t=n-2;t>=0;t--)e=e instanceof Array?r[t].apply(this,e):r[t].call(this,e);return e}}function i(e,t,r,n){var o=e.prototype,i=n,a=[],s,u;while(o&&o.constructor){if(o.hasOwnProperty(t)&&"function"===typeof o[t])if(u=o[t])a.push(u);o=o.constructor.superclass}for(s=a.length-1;-1!==s;s--)i=r(i,a[s]);return i}function r(e,t){var r;return n(a(e,t))}function a(e,t){var r;return i(e,t,function(e,t){return e.unshift(t),e},[])}function s(e,t){var r;if(!e)throw r="function"==typeof t?t():t,new Error(r||"assert")}Object.defineProperty(t,"__esModule",{value:true}),t.argumentsToArray=o,t.composeWithResultApply=n,t.reduceHierarchyFunctions=i,t.composeHierarchyFunctions=r,t.getHierarchyFunctions=a,t.assert=s}(_,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),S=I;e["Vdom/_private/Utils/Monad"]=true;var R=function(){"use strict";var e={},t=function(e,t,r){function a(e,t,r,n){var o=r;if(null===e||void 0===e)e=[];for(var i in e)if(e.hasOwnProperty(i))o=t.call(n,o,e[i],i,e);return o}function n(e){return r.Common.asyncRenderErrorLog(e),e}function o(e,r,n){return n.join(e,function(t){return n.join(r,function(e){return n.pure(e.concat(t))})})}function i(t,e,r){if(e.then)return e.then(function(e){return o(t,e,r)},n);return o(t,e,r)}function s(e,t,r){if(e.then)return e.then(function(e){return i(e,t,r)},n);return i(e,t,r)}function u(e,n,o,i){var t;return a(e,function(e,t,r){return s(n.call(i,t,r),e,o)},o.pure([]))}function l(n){return{join:function(e,t){var r=t(e.value);return{value:r.value,memo:n.plus(r.memo,e.memo)}},pure:function(e){return{value:e,memo:n.zero}}}}Object.defineProperty(t,"__esModule",{value:true}),t.mapM=u,t.createWriterMonad=l,t.ArrayWriterMonad=l({plus:function(e,t){return e.concat(t)},zero:[]}),t.ListMonad={join:function(e,r){return a(e,function(e,t){return e.concat(r(t))},[])},pure:function(e){return[e]}}}(_,e,b);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),A=R;e["Vdom/_private/Synchronizer/resources/TabIndex"]=true;var L=function(){"use strict";var e={},t=function(e,t,C){Object.defineProperty(t,"__esModule",{value:true});var u=1,w={a:true,link:true,button:true,input:true,select:true,textarea:true},d=1,c=2,f=4,p=8,h=16,v={hidden:d,disabled:c,"delegates-tabfocus":f,"creates-context":p,"tab-cycling":h};function m(e,t){return window.getComputedStyle(e)[t]}function r(e){var t=/\bws-(hidden|disabled)\b/g,r=e.getAttribute("class"),n,o,i,a,s,u,l;s=0;while(n=r&&t.exec(r))s|=v[n[1]];if("true"===e["ws-creates-context"]||"true"===e.getAttribute("ws-creates-context"))s|=v["creates-context"];if("true"===e["ws-delegates-tabfocus"]||"true"===e.getAttribute("ws-delegates-tabfocus"))s|=v["delegates-tabfocus"];if("true"===e["ws-tab-cycling"]||"true"===e.getAttribute("ws-tab-cycling"))s|=v["tab-cycling"];if(u=0===(s&(d|c)))u="none"!==m(e,"display")&&"invisible"!==m(e,"visibility");if(u)i=e.getAttribute("tabindex"),o=parseInt(i,10),l={enabled:true,tabStop:(a=!isNaN(o))&&o>=0||null===i&&w.hasOwnProperty(e.tagName.toLowerCase())||-1!==o&&e.hasAttribute("contenteditable"),createsContext:0!==(s&p),tabIndex:o||0,delegateFocusToChildren:0!==(s&f),tabCycling:0!==(s&h)};else l={enabled:false,tabStop:false,createsContext:false,tabIndex:0,delegateFocusToChildren:false,tabCycling:false};return l}function T(e){return e.firstElementChild?e.firstElementChild:null}function k(e){return e.lastElementChild?e.lastElementChild:null}function O(e){return e.previousElementSibling?e.previousElementSibling:null}function E(e){return e.nextElementSibling?e.nextElementSibling:null}function V(a,e,t,r,n){function o(e,t,r){var n;if(C.assert("number"===typeof e&&"number"===typeof t),e=0===e?1/0:e>0?e:-1,-1===(t=0===t?1/0:t>0?t:-1)&&-1!==e)return 1;if(-1===e&&-1!==t)return-1;if(e>t)n=r?-1:1;else if(e<t)n=r?1:-1;else n=0;return n}function i(e,t,r){var n,o,i;if(t.enabled&&!t.createsContext)o=r?k(e):T(e);if(!o)if(!(o=r?O(e):E(e))){i=e.parentNode;while(i!==a&&!o)if(!(o=r?O(i):E(i)))i=i.parentNode}return o||a}function s(e){return V(e,void 0,r?0:1,r,n)}function u(e){return r?k(e):T(e)}function l(e,t){if(t.delegateFocusToChildren&&e.childElementCount)if(e.wsControl&&e.wsControl.canAcceptFocus&&e.wsControl.canAcceptFocus())N=e;else N=s(e);return!!(!t.delegateFocusToChildren||w.hasOwnProperty(e.tagName.toLowerCase())||N)}C.assert(a&&(e||void 0!==t)&&n&&a!==e);var d,c,f,p,h,v,m=null,y,g=null,N,b;if(e)t=(v=n(e)).tabIndex,d=i(e,v,r);else d=(d=r?k(a):T(a))||a;var _=false;for(f=0;2!==f&&!p;f++){while(d!==a&&d!==e&&!p){if((c=n(d)).enabled&&c.tabStop)if(0===(h=o(c.tabIndex,t,r))&&0===f){if(l(d,c))p=d,b=N}else if(h>0)if(!p)if(0===f){if(null===m||o(c.tabIndex,m.tabIndex,r)<0)if(l(d,c))m=d,g=c.tabIndex,y=f,b=N}else if(null===m||o(c.tabIndex,m.tabIndex,r)<0||_&&o(c.tabIndex,m.tabIndex,r)<=0)if(l(d,c))m=d,g=c.tabIndex,y=f,b=N,_=false;if(-1===t&&m)p=m;if(!p)d=i(d,c,r)}if(d===a&&0===f)if(e&&(false===r&&t>0||true===r&&1!==t&&-1!==t))d=u(a);if(0===f)_=true}if(C.assert(!!p||d===e||d===a),!p&&m)if(g>=0)p=m;if(p&&b)p=b,C.assert(!!p);return p}function l(e,t,r){return V(e,void 0,t?0:1,t,r)}function n(i,e,t,a){function r(e){var t,r=null,n,o=e;while(o&&o!==i){if(!a(o).enabled)r=o;o=o.parentElement}if(!o)throw new Error("Узел fromElement должен лежать внутри узла rootElement");if((n=r||e)!==i){o=n.parentElement;while(o!==i&&!a(o).createsContext)o=o.parentElement;t=o}return{element:e,context:t}}function n(e,t){var r=e===document.documentElement||!!e.parentElement;if(!e||!e.ownerDocument||!r||e.nodeType!==u)throw new Error("Плохой параметр "+t)}n(e,"fromElement"),n(i,"rootElement");var o=r(e),s=o.element;if(s!==i)do{if(!(s=V(o.context,o.element,void 0,t,a)))if(a(o.context).tabCycling)break;else o=r(o.context)}while(!s&&o.element!==i);if(s===i)s=l(i,t,a);if(!s&&a(o.context||i).tabCycling)if(void 0===(s=l(o.context||i,t,a)))s=e;return s}function o(){var e=document.createElement("div");return e.innerHTML='<svg><foreignObject width="30" height="30">'+'<input type="text"/>'+"</foreignObject></svg>",e.firstChild.firstChild}function i(e){var t;if(!(e.ownerSVGElement||"svg"===e.nodeName.toLowerCase()))return false;var r=o();e.appendChild(r);var n=r.querySelector("input");return n.focus(),n.disabled=true,e.removeChild(r),true}function a(t){if(t.focus)t.focus();else try{HTMLElement.prototype.focus.call(t)}catch(e){i(t)}}t.getElementProps=r,t.findFirstInContext=l,t.findWithContexts=n,t.focus=a}(_,e,I);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),F=L;e["Vdom/_private/Synchronizer/resources/VdomMarkup"]=true;var H=function(){"use strict";var e={},t=function(e,t,v,m,y,s,g){function N(e,t){if(t)return e.children||[];else return m.Vdom.isVNodeType(e)?null===e.children?[]:e.children:[]}function b(e,t,r,n,o,i){if(r.stopped)return r;if(n&&m.Vdom.isTemplateVNodeType(r)&&r.children&&r.children[0])return r.children[0]=b(e,t,r.children[0],n),r;if(m.Vdom.isVNodeType(r)){if(t.control&&"Controls/Decorator/Markup"===t.control._moduleName)if(r.children&&r.children[0])r.children[0].stopped=true;var a=e(r.type,r.hprops,r.children,r.key,t,r.ref,r),s=r.type===a[0]&&r.props===a[1]&&r.children===a[2]&&r.key===a[3];if(i){if(r.type=a[0],r.props=a[1],r.children=a[2],r.key=a[3],!r.hookedInvControlIds||-1===r.hookedInvControlIds.indexOf(t.id))if(r.ref=a[4],r.hookedInvControlIds)r.hookedInvControlIds.push(t.id)}else return s?r:m.Vdom.htmlNode.apply(m.Vdom,a)}else return r}function r(e){return Array.isArray(e)?e[0]:e}function n(r,e,n,o,i){function a(e){var t=o(e)?[n(e)]:[];return r?t.concat(s.ListMonad.join(N(e,i),a)):t}return s.ListMonad.join(N(e,i),a)}function o(e){return e}function _(e,t){return n(true,e,o,m.Vdom.isControlVNodeType,t)}function C(e){return n(true,e,o,m.Vdom.isTemplateVNodeType)}function w(e,t,r){var n={create:[],createTemplates:[],destroy:[],destroyTemplates:[],update:[],updateTemplates:[],vnodeChanged:false},o,i,a,s,u,l,y;function d(e,t){function r(e){if(e)for(var t=0,r=e.length;t!==r;t++)if(void 0!==e[t].key)return true;return false}function n(e){for(var t={},r=[],n=e.length,o=0;o<n;o++){var i,a=e[o].key;if(void 0!==a)t[a]=o;else r.push(o)}return{keys:t,free:r}}var o,i,a,s,u,l,d,c,f,p,h,v,m;if(r(e)&&r(t)){for(l=n(e),d=n(t),i=l.keys,h=e.length,a=d.keys,v=t.length,u=(s=d.free).length,f=0,o=new Array(length),c=0;c!==h;c++)if(void 0!==(m=e[c]).key)if(a.hasOwnProperty(m.key))o[c]=t[a[m.key]];else o[c]=null;else if(f!==u)o[c]=t[s[f]],f++;else o[c]=null;for(p=f!==u?s[f]:v,c=0;c!==v;c++)if(void 0!==(y=t[c]).key){if(!i.hasOwnProperty(y.key))o.push(y)}else if(c>=p)o.push(t[c])}else o=t;return o}function c(e,t){var r=e&&m.Vdom.isControlVNodeType(e),n=t&&m.Vdom.isControlVNodeType(t),o=e&&m.Vdom.isTemplateVNodeType(e),i,a=o===(t&&m.Vdom.isTemplateVNodeType(t)),s=r===n;if(s){if(r)s=e.controlClass===t.controlClass&&e.key===t.key;else if((s=e.type===t.type)&&m.Vdom.isVNodeType(e))s=e.tagName===t.tagName&&e.namespace===t.namespace&&e.key===t.key}else if(a)if(o)s=e.template===t.template&&e.key===t.key;else if((s=e.type===t.type&&e.compound===t.compound)&&m.Vdom.isVNodeType(e))s=e.tagName===t.tagName&&e.namespace===t.namespace&&e.key===t.key;return s}function f(e,t,r){e[t]=e[t].concat(r)}if(e!==t||r)if(v.checkAssertion(!!t,"newNode !== null"),c(e,t))if(m.Vdom.isControlVNodeType(t))if(-1===e.controlNodeIdx)n.create.push(t);else n.update.push({oldNode:e,newNode:t});else if(m.Vdom.isTemplateVNodeType(t))if(!t.children&&t===e)n.createTemplates.push(t);else n.updateTemplates.push({oldNode:e,newNode:t});else{a=d(i=N(e),N(t)),s=Math.max(i.length,a.length);var p=0,h=a!==t.children;if(i.length!==a.length)n.vnodeChanged=true;for(u=0;u!==s;u++){if((l=i[u])&&"vdom-focus-in"===l.key&&!h){p++;continue}if(y=a[u-p],l&&y)o=w(l,y,r),n.vnodeChanged=n.vnodeChanged||o,f(n,"create",o.create),f(n,"destroy",o.destroy),f(n,"update",o.update),f(n,"createTemplates",o.createTemplates),f(n,"destroyTemplates",o.destroyTemplates),f(n,"updateTemplates",o.updateTemplates);else if(l)if(m.Vdom.isControlVNodeType(l))f(n,"destroy",[l]);else if(m.Vdom.isTemplateVNodeType(t))f(n,"destroy",_(l,true));else f(n,"destroy",_(l,true));else if(m.Vdom.isControlVNodeType(y))f(n,"create",[y]);else if(m.Vdom.isTemplateVNodeType(y))f(n,"createTemplates",[y]);else f(n,"create",_(y)),f(n,"createTemplates",C(y))}}else{if(n.vnodeChanged=true,m.Vdom.isControlVNodeType(t))n.create.push(t);else if(m.Vdom.isTemplateVNodeType(t))n.createTemplates.push(t);else f(n,"create",_(t)),f(n,"createTemplates",C(t));if(e)if(m.Vdom.isControlVNodeType(e))n.destroy.push(e);else if(m.Vdom.isTemplateVNodeType(e))f(n,"destroy",_(e,true));else f(n,"destroy",_(e,true))}return n}function i(e,t){var r;for(r in t)if(t.hasOwnProperty(r))if(!e.hasOwnProperty(r)||e[r]!==t[r])return true;for(r in e)if(e.hasOwnProperty(r)&&!t.hasOwnProperty(r))return true;return false}function T(e,t){return i(e.attributes,t.attributes)||i(e.events,t.events)||i(e.hooks,t.hooks)}function k(r,n,o,e,t){var i,a,s,u,l,d,c,f=false;if(m.Vdom.isControlVNodeType(n)){if(o)return n;if((i=r[n.controlNodeIdx].fullMarkup)&&i.type&&"invisible-node"===i.type){if(t&&t.type){if(!t.hookedInvControlIds)t.hookedInvControlIds=[];b(g.setControlNodeHook(r[n.controlNodeIdx]),r[n.controlNodeIdx],t,true,false,true)}i=m.Vdom.textNode("",r[n.controlNodeIdx].key)}}else if(m.Vdom.isTemplateVNodeType(n)&&!n.children)i=n;else if(!m.Vdom.isTemplateVNodeType(n)&&!m.Vdom.isVNodeType(n)||!n.children||0===n.children.length)i=n;else{a=0,u=(s=m.Vdom.isTemplateVNodeType(n)?n.children:N(n)).length;while(a!==u){if((l=k(r,s[a],o,void 0,n)).changed)f=true;if(l!==s[a])break;a++}if(a===u){if(i=n,!f&&e)if(i.children&&e.children)if(i.children.length!==e.children.length)f=true;else for(var p=0;p<i.children.length;p++)if(i.children[p]!==e.children[p]||e.children[p]&&e.children[p].changed){f=true;break}}else{if(c=s.slice(a+1).map(function(e){var t=k(r,e,o,void 0,n);if(t.changed)f=true;return t}),c=y(c,true),d=s.slice(0,a).concat(Array.isArray(l)?l:[l]).concat(c),m.Vdom.isTemplateVNodeType(n)){var h={compound:false,children:d,childrenForDiff:n.children,template:n.template,controlProperties:n.controlProperties,parentControl:n.parentControl,attributes:n.attributes,context:n.context,changed:true,type:"TemplateNode",optionsVersions:n.optionsVersions,get count(){var e=0;if(this.children){for(var t=0;t<this.children.length;t++){var r;e+=this.children[t].count||0}return this.children.length+e}else return 0}};return Object.defineProperty(n,"count",{get:function(){return h.count},configurable:true}),h.children}if(e){if(!f)if(!e.children&&d||e.children.length!==d.length)f=true;else for(var p=0;p<e.children.length;p++)if(e.children[p]!==d[p]||d[p].changed){f=true;break}if(!f)f=T(n.hprops,e.hprops);if(f)(i=m.Vdom.htmlNode(n.type,n.hprops,d,n.key,n.ref)).changed=true;else i=e}else(i=m.Vdom.htmlNode(n.type,n.hprops,d,n.key,n.ref)).changed=true}}if(m.Vdom.isTemplateVNodeType(i))if(i.children)i=i.children;else m.Vdom.textNode("",i.attributes.key);if(f)i.changed=true;return i}function a(e,t){return m.Vdom.htmlNode("span",{},[m.Vdom.textNode(e,(t||"err_"+Math.trunc(1e3*Math.random()))+"_inner_text")],t||"err_"+Math.trunc(1e3*Math.random()))}function u(e,t){var r=e.control._getMarkup(e.key,t,{key:e.key,attributes:e.attributes,events:e.events,inheritOptions:e.inheritOptions,templateContext:e.templateContext,internal:e.internal,domNodeProps:e.domNodeProps}),n;if(m.Vdom.isVNodeType(r))n=b(e.markupDecorator,e,r);else if(m.Vdom.isControlVNodeType(r))n=b(e.markupDecorator,e,r);else n=r;if(!m.Vdom.isControlVNodeType(n)&&!m.Vdom.isVNodeType(n)&&!m.Vdom.isTemplateVNodeType(n))n=a("control._getMarkup должен отдавать dom-узел",e.key);return n}Object.defineProperty(t,"__esModule",{value:true}),t.getVNodeChidlren=N,t.mapVNode=b,t.getMarkupDiff=w,t.getFullMarkup=k,t.getDecoratedMarkup=u}(_,e,f,b,c,R,k);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),U=H;e["Vdom/_private/Utils/Focus"]=true;var q,j=function(){"use strict";var e={},t=function(e,t,r,n){function o(t){if(t)if(r.isIE&&t.setActive)try{t.setActive()}catch(e){n.focus(t)}else n.focus(t)}Object.defineProperty(t,"__esModule",{value:true}),t.focus=o}(_,e,l,L);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Vdom/_private/Synchronizer/resources/DOMEnvironment"]=true;var K=function(){"use strict";var e={},t=function(n,e,t,o,y,f,a,d,p,i,s,l,u,h,v,c,m,r,g){Object.defineProperty(e,"__esModule",{value:true});var N=t.checkAssertion,b=9,_=function e(t){return"SPAN"===t.tagName&&"warning-container"===t.getAttribute("id")&&t.nextElementSibling&&"BODY"===t.nextElementSibling.tagName},C=function e(t,r,n){if(_(t))t.setAttribute("data-vdomignore","true"),r=true;if(8===n)r=true;return r},w=function e(t){var r=t.nodeType,n=1===r&&t.getAttribute("data-vdomignore");return n||C(t,n,r)};function T(c){return function n(e,t,r,o,i,a){var s,u,l=c(e,t,r,o,i,a),d=l[2];if(-1!==(s=f(d,function e(t){var r;return t!==p.mapVNode(n,i,t)}))&&void 0!==s)u=d.slice(s).map(p.mapVNode.bind(self,n,i)),d=d.slice(0,s).concat(u),l=[l[0],l[1],d,l[3],l[4]];return l}}function k(e){function d(e){var t,r,n,o,i;if(e)if(i=(n=e.split(";")).length)for(o=0;o!==i;o++)if(2===(r=n[o].split(":")).length){if(!t)t={};t[r[0].trim()]=r[1].trim()}return t}function l(e){var t=e.attributes,r,n=t.length,o,i,a,s,u,l=null;for(r=0;r!==n;r++)if("key"===(a=t[r]).name)l=a.value;else if("style"===a.name)i=d(a.value);else{if(!o)o={};o[a.name]=a.value}if(s={properties:u={}},o)u.attributes=o;if(i)u.style=i;if(s.key=l,"input"===e.tagName.toLowerCase()){if(!u.attributes)u.attributes={};if(!u.attributes.hasOwnProperty("value"))u.attributes.value=void 0}return s}function c(e){var t=e.nodeType,r;if(!w(e))if(e.__WS={},1===t)return n(e);else if(3===t){if("\n"===e.data||""===e.data)return e.parentNode.removeChild(e),-1;return h.Vdom.textNode(e.nodeValue)}return null}function n(e){var t=e.tagName,r="http://www.w3.org/1999/xhtml"==e.namespaceURI?null:e.namespaceURI,n=l(e),o=[],i,a=e.childNodes.length;for(i=0;i!==a;i++){var s=c(e.childNodes[i]);if(-1===s)i--,a--;else if(s)o.push(s)}var u=n&&n.properties&&n.properties.attributes||{};return r=r||h.Common.getNamespace(u),v.GeneratorVdom.createTag(t.toLowerCase(),n.properties,o,{attributes:{"ws-creates-context":"true"}})}return c(e)}function O(e,t){return!(e&&t)}function E(e,t){return t.control}function V(e){return!e.reduce(O,true)}function D(e){return e.reduce(E,true)}function M(e){return(e=e.hasOwnProperty("length")?e[0]:e)===document.documentElement||e===document.body||null===e.offsetParent?false:document.body.contains(e)}function P(e){var t=e._container.length?e._container[0].controlNodes:e._container.controlNodes;for(var r in t)if(t[r].control===e)return t[r]}function x(e){var t;if(e)if(e&&!e._options)t="Control "+e._moduleName+" with name "+(e.getName&&e.getName())+" must have _options";if(t)y.resolve("ILogger").error("DOMEnvironment","Incorrect opener or parent is found! It seems that anybody set wrong opener option! "+t)}function I(e,t){var r=e.control;if(t[t.length-1]!==r)t.push(r);var n=r._options.opener||e.parent;if(n&&!n.control)if(n._container)x(n),n=P(n);else n=null;if(n)I(n,t);else if(x(n=r._options&&r._options.opener||r.getOpener&&r.getOpener()||r.getParent&&r.getParent()),n)S(n,t)}function S(e,t){if(t[t.length-1]!==e)t.push(e);var r=e._options&&e._options.opener||e.getOpener&&e.getOpener()||e.getParent&&e.getParent();if(x(r),r)if(r._template){var n;I((r._container.length?r._container[0]:r._container).controlNodes[0],t)}else S(r,t)}function R(e,t){if(t=t||[],e&&e.jquery)e=e[0];if(e)if(e.controlNodes&&e.controlNodes.length)I(e.controlNodes[0],t);else if(o.compat&&e.wsControl)S(e.wsControl,t);else R(e.parentNode,t);return t}function A(e,t){if(e&&e.length>0)for(var r=0;r<e.length;r++)if(t.id===e[r].id)return true;return false}var L=m.default.extend({constructor:function(e,t,r){if(N(e!==document,"Корневой контрол нельзя монтировать на document"),this._rootDOMNode=e,this._rootVNode=k(e),this._captureEventHandlers={},this._markupNodeDecorator=T(i.setEventHooks(this)),this.addCaptureProcessingHandler("focus",this._handleFocusEvent),this.addCaptureProcessingHandler("blur",this._handleBlurEvent),this.addCaptureProcessingHandler("mousedown",this._handleMouseDown),this.addCaptureProcessingHandler("click",this._handleClick),this.addCaptureProcessingHandler("touchstart",this._handleTouchstart),this.addCaptureProcessingHandler("touchmove",this._handleTouchmove),this.addCaptureProcessingHandler("touchend",this._handleTouchend),this._handleTabKey=this._handleTabKey.bind(this),this._clickState={detected:false,stage:"",timer:void 0,timeout:500,target:null,touchCount:0,timeStart:void 0},!a()&&"undefined"!==typeof window)document.body.tabIndex=0;m.default.call(this,t,r)},destroy:function(){this.removeTabListener(),this.removeCaptureEventHandler("focus"),this.removeCaptureEventHandler("blur"),this.removeCaptureEventHandler("mousedown"),this.removeCaptureEventHandler("click"),this.removeCaptureEventHandler("touchstart"),this.removeCaptureEventHandler("touchmove"),this.removeCaptureEventHandler("touchend"),this._rootDOMNode=void 0,this._rootVNode=void 0,this._captureEventHandlers={},this._handleTabKey=void 0,L.superclass.destroy.call(this)}}),F=L.prototype;function H(e){try{if(e.control._afterMount&&e.control._afterMount(e.options,e.context),e.control._mounted=true,e.control._$needForceUpdate)delete e.control._$needForceUpdate,e.control._forceUpdate()}catch(e){g.catchLifeCircleErrors("_afterMount",e)}}function U(e,t){e.forEach(function(e){if(e.childrenNodes&&e.childrenNodes.length>0)U(e.childrenNodes,t);if(~t.indexOf(e.id))if(!e.control._mounted&&!e.control._unmounted)if(e.hasCompound)d.default(function(){H(e)});else H(e);else try{e.control._afterUpdate&&e.control._afterUpdate(e.oldOptions||e.options,e.oldContext)}catch(e){g.catchLifeCircleErrors("_afterUpdate",e)}})}function q(e){var t=e.target._cachedValue,r=e.target.value;if(void 0!==t&&t!==r){if(c.isIE12)var n=new Event("change");else{var n;(n=document.createEvent("Event")).initEvent("change",true,true)}n._dispatchedForIE=true,e.target.dispatchEvent(n)}e.target._cachedValue=void 0}function j(e){if(c.isIE)e._cachedValue=e.value}function K(e){if(!e)return false;if(e.classList.contains("vdom-focus-in")||e.classList.contains("vdom-focus-out"))return false;return e.parentElement===document.body&&!e.firstChild||c.isIE&&e===document.body}function z(e,t,r){var n=R(e),o=R(t),i=n.find(function(e){return-1!==o.indexOf(e)});o.find(function(e){if(e!==i)return e._notify("deactivated",[{isTabPressed:!!r,isShiftKey:r&&r.isShiftKey}]),e._active=false;else return true}),n.find(function(e){if(e!==i)return e._notify("activated",[{_$to:n[0],isTabPressed:!!r,isShiftKey:r&&r.isShiftKey}]),e._active=true,false;else return true})}F._handleTabKey=function(e){if(!this._rootDOMNode)return;var t,r;if(e.keyCode===b)if(t=l.findWithContexts(this._rootDOMNode,e.target,!!e.shiftKey,l.getElementProps),this._isTabPressed={isShiftKey:!!e.shiftKey},setTimeout(function(){this._isTabPressed=null}.bind(this),0),t){if(t.wsControl&&t.wsControl.setActive)t.wsControl.setActive(true);else l.focus(t);e.preventDefault(),e.stopImmediatePropagation()}else{if(this._rootDOMNode.wsControl)r=this._rootDOMNode.wsControl._oldKeyboardHover(e);if(false!==r);else e.preventDefault(),e.stopImmediatePropagation()}},F.addTabListener=function(){if(this._rootDOMNode)this._rootDOMNode.addEventListener("keydown",this._handleTabKey,false)},F.removeTabListener=function(){if(this._rootDOMNode)this._rootDOMNode.removeEventListener("keydown",this._handleTabKey)},F.autofocusChanges=function e(t){function o(e,t){var r;if(A(e.controlNodes,t))return e;if(e.children&&e.children.length>0){r=e.children;for(var n=0;n<r.length;n++)if(r[n].controlNodes){if(A(r[n].controlNodes,t))return i=r[n];o(r[n],t)}}return i}function r(e){var t=l.getElementProps(e);return t.tabStop="true"===e.getAttribute("ws-autofocus"),t}var i,n,a=t.control,s=t.environment,u;if(a.__$focusing&&s._rootDOMNode){if(i=o(s._rootDOMNode,t))if(n=l.findFirstInContext(i,void 0,r))l.focus(n);else l.focus(i);a.__$focusing=false}},F._handleFocusEvent=function e(t){if(j(t.target),this._rootDOMNode&&u.Focus.closest(t.target,this._rootDOMNode)&&!K(t.target)){var r=!K(t.relatedTarget)&&t.relatedTarget||this._savedFocusedElement;if(this._savedFocusedElement=t.target,z(t.target,r,this._isTabPressed),o.compat&&this._rootDOMNode&&this._rootDOMNode.controlNodes)if(this._rootDOMNode.controlNodes[0]&&this._rootDOMNode.controlNodes[0].control.isActive)if(this._rootDOMNode.controlNodes[0].control.isActive())this._rootDOMNode.controlNodes[0].control._callOnFocusInside();else n("Lib/Control/AreaAbstract/AreaAbstract.compatible")._storeActiveChildInner.apply(this._rootDOMNode.controlNodes[0].control);this._focused=true}ie.call(this,t)},F._handleBlurEvent=function e(t){var r,n;if(c.isIE)if(q(t),null===t.relatedTarget)n=document.body;if(r=t.target,n=n||t.relatedTarget,!a()&&n){var o,i;if(!R(n).find(function(e){return e._template}))z(null,r,this._isTabPressed)}ie.call(this,t)},F._handleMouseDown=function e(t){var r=t.target,n=document.documentElement;while(r!==n)if(r["ws-no-focus"]||r.getAttribute("ws-no-focus")){t.preventDefault();break}else r=r.parentNode;ie.call(this,t)};var B=[];function W(e,t){while(e.parentNode)if((e=e.parentNode)===t)return true;return false}function Y(e){if(!this._rootDOMNode)return;var t=e.relatedTarget||document.body,r=e.target,n=document.createEvent("Events");n.initEvent("keydown",true,true);var o=false;if("vdom-focus-in"===r.className)if(W(t,this._rootDOMNode))if(!(t.classList.contains("vdom-focus-out")&&"true"===this._rootDOMNode["ws-tab-cycling"]))o=true;if("vdom-focus-out"===r.className)if(!W(t,this._rootDOMNode))o=true;n.view=window,n.altKey=false,n.ctrlKey=false,n.shiftKey=o,n.metaKey=false,n.keyCode=9,r.dispatchEvent(n)}function G(e){if(!Array.isArray(e))return null;return e.find(function(e){return!!e})}function X(t,e){var r=G(e.children),n=function(e){Y.call(t,e)},o=function e(t){if(t)t.addEventListener("focus",n)};if(r&&"vdom-focus-in"!==r.key){var i=h.Vdom.htmlNode("a",{attributes:{class:"vdom-focus-in",tabindex:"1"}},[],"vdom-focus-in",o),a=h.Vdom.htmlNode("a",{attributes:{class:"vdom-focus-out",tabindex:"0"}},[],"vdom-focus-out",o);return e.children=[].concat(i,e.children,a),true}return false}function Q(e,t){return Array.prototype.filter.call(e.children,function(e){return e.matches(t)})}function J(e){var t=e.firstChild;if(t&&t.classList&&!t.classList.contains("vdom-focus-in")){var r=Q(e,".vdom-focus-in"),n=Q(e,".vdom-focus-out"),o=r.length?r[0]:document.createElement("a");o.classList.add("vdom-focus-in"),o.tabIndex=1;var i=n.length?n[0]:document.createElement("a");return i.classList.add("vdom-focus-out"),i.tabIndex=0,e.insertBefore(o,t),e.appendChild(i),true}return false}function Z(e,t){return e&&e.args&&e.args.length===t.length}function ee(e,t,r){return e&&e.events&&e.events[t]&&e.events[t][r]}function te(t,e,r,n,o){var i,a=false,s="on:"+t.type.toLowerCase(),u,l,d,c,f,p;if(o)u=t.target===window||t.target===document?document.body:t.target;else u=e.element;u=o?u:e.element;while(!a){if((i=u.eventProperties)&&i[s])for(var h=r;h<i[s].length&&!a;h++){l=i[s][h].fn,d=i[s][h].args,f=Z(ee(e,s,h),d)?e.events[s][h].args:d;try{if(!n.concat)throw new Error("Аргументы обработчика события "+s.slice(3)+" должны быть массивом.");if(p=f.concat(n),p=[t].concat(p),t.currentTarget=u,!l.control._destroyed&&(!e||l.control!==e.control))l.apply(l.control,p);if(p=[],t.currentTarget=void 0,!t.propagating()){var v;if(!(!t.isStopped()&&i[s][h+1]&&(i[s][h+1].toPartial||i[s][h+1].fn.controlDestination===i[s][h].fn.controlDestination)))a=true}}catch(e){var m;if(!l.control){if("undefined"!==typeof window)window["console"].error("Error calculating the logical parent for the function ",l);m=new Error(t.type+" event handle error")}else m=new Error(t.type+" event handle error in "+l.control._moduleName);y.resolve("ILogger").error(u,m,e)}if(c=t.result,!e||!e.control._destroyed)if(c&&c.then)c.then(function(t){return function(e){return t.control._forceUpdate(),e}}(l));else l.control._forceUpdate();c=void 0}if(null===(u=u.parentNode)||void 0===u||!t.propagating())a=true;if(0!==r)r=0}}function re(e,t){var r=e.element.eventProperties,n=e.element.controlNodes,o=0,i=0,a="on:"+t,s=true,u;if(r&&r[a]){u=r[a][0].fn.control;while(s&&i<n.length){if(n[i].control===u)if(++o<r[a].length)u=r[a][o].fn.control;if(n[i].control===e.control)s=false;i++}}return o}function ne(e,t){function r(e){return"text"===e.type||"password"===e.type}if(!e._rootDOMNode)return false;else if(!(t.currentTarget===window&&"scroll"===t.type||t.currentTarget===window&&"resize"===t.type)&&1!==t.eventPhase)return false;else if(c.isIE&&"change"===t.type&&!t._dispatchedForIE&&r(t.target))return false;else if(!oe(e,t))return false;return true}function oe(e,t){var r=t.target;if(r===window||r===document)return true;while(r){if(r===e._rootDOMNode)return true;if(r.controlNodes&&r.controlNodes[0]&&r.controlNodes[0].environment===e)return true;else if(r.controlNodes&&r.controlNodes[0]&&r.controlNodes[0].environment!==e)return false;if(r===document.body)r=document.documentElement;else if(r===document.documentElement)r=document;else r=r.parentNode}return false}function ie(e){if(ne(this,e)){var t;te(new s.default(e),null,0,[],true)}}F._handleClick=function e(t){if(this._shouldUseClickByTap())if(B.indexOf(t.target)>-1)B.splice(B.indexOf(t.target),1);if(2===t.button)return void t.stopPropagation();var r=window.getSelection?window.getSelection():null,n=r&&r.toString().length&&t.target.contains(r.focusNode),o=window.getComputedStyle?"none"===window.getComputedStyle(t.target)["user-select"]:true;if(n&&!o)return void t.stopPropagation();ie.call(this,t)},F._handleTouchstart=function e(t){if(this._shouldUseClickByTap())B.push(t.target);r.initSwipeState(t),ie.call(this,t)},F._handleTouchmove=function e(t){if(this._shouldUseClickByTap())if(this._clickState.touchCount++,this._clickState.touchCount>3)B.splice(B.indexOf(t.target),1);r.detectSwipe(t),ie.call(this,t)},F._handleTouchend=function e(t){if(this._shouldUseClickByTap())this._clickState.touchCount=0,setTimeout(function(){if(B.indexOf(t.target)>-1)t.target.click()},this._clickState.timeout);r.resetSwipeState(),ie.call(this,t)},F._shouldUseClickByTap=function e(){return o.browser.retailOffline||o.compatibility.touch&&o.browser.chrome&&navigator&&navigator.userAgent.indexOf("Windows")>-1},F.applyNewVNode=function(e,t,r){if(!this._rootDOMNode)return;var n=this.decorateRootNode(e),o,i,a,s;if("HTML"!==this._rootDOMNode.tagName){if(n&&X(this,n))if(this._rootVNode&&X(this,this._rootVNode))J(this._rootDOMNode)}else if(n&&n.children[1]){var u=n.children[1];if(this._rootVNode&&X(this,u)){var l=this._rootDOMNode.getElementsByTagName("body");if(l.length)J(l=l[0])}}if(this._rootDOMNode.isRoot=true,this._rootDOMNode.hasOwnProperty("$V")||!this._rootDOMNode.firstChild)a=this._rootVNode?h.Vdom.render(n,this._rootDOMNode,void 0,void 0,true):null;else a=this._rootVNode?h.Vdom.hydrate(n,this._rootDOMNode,true,true):null;if(this._rootVNode=n,o=V([r])){if(i=D([r]),s)i._container=window.$?$(s):s;d.default(function(){r.environment._haveRebuildRequest=false,i.reviveSuperOldControls&&i.reviveSuperOldControls(),U([r],t),r.environment._rebuildRequestStarted=false,r.environment.runQueue()})}else r.environment._haveRebuildRequest=false,U([r],t),r.environment._rebuildRequestStarted=false,r.environment.runQueue();return a},F.decorateFullMarkup=function(e,t){if(Array.isArray(e))e=e[0];return p.mapVNode(i.setControlNodeHook(t),t,e,true)},F.getMarkupNodeDecorator=function(){return this._markupNodeDecorator},F.getDOMNode=function(){return this._rootDOMNode},F.runQueue=function(){if(this.queue)for(var e=0;e<this.queue.length;e++)this.forceRebuild(this.queue[e]);this.queue=null,this.queueIds={}},F.startEvent=function(e,t){var r=t[0].toLowerCase(),n=t[1]||[],o=t[2],i={},a;if(i._bubbling=o&&void 0!==o.bubbling?o.bubbling:false,i.type=r,i.target=e.element,!i.target){if(!(e.fullMarkup instanceof u.RawMarkupNode)&&!(e.fullMarkup&&"invisible-node"===e.fullMarkup.type))y.resolve("ILogger").error("Event "+r+" has emited before mounting to DOM");return}return te(a=new s.default(null,i),e,re(e,r),n,false),a.result},F.addCaptureEventHandler=function(e,t){var r=this._captureEventHandlers;if(this._rootDOMNode.parentNode)if(t.tagName&&"body"===t.tagName.toLowerCase()&&("scroll"===e||"resize"===e))if(void 0===r[e+"body"])r[e+"body"]={handler:ie.bind(this),count:1},window.addEventListener(e,r[e+"body"].handler);else r[e+"body"].count++;else if(void 0===r[e]){r[e]={handler:ie.bind(this),count:1};var n=u.Event.fixUppercaseDOMEventName(e);this._rootDOMNode.parentNode.addEventListener(n,r[e].handler,true)}else r[e].count++},F.addCaptureProcessingHandler=function e(t,r){var n=this._captureEventHandlers;if(void 0===n[t]){if(this._rootDOMNode.parentNode)n[t]={handler:function(e){if(!oe(this,e))return;r.apply(this,arguments)}.bind(this),count:1},this._rootDOMNode.parentNode.addEventListener(t,n[t].handler,true)}else n[t].count++},F.removeCaptureEventHandler=function(e,t){var r=this._captureEventHandlers;if(t&&t.tagName&&"body"===t.tagName.toLowerCase()&&("scroll"===e||"resize"===e)){if(r[e+"body"].count--,0===r[e+"body"])window.removeEventListener(e,r[e+"body"].handler)}else{var n=r[e];if(n)if(n.count--,0===n.count){if(this._rootDOMNode.parentNode)this._rootDOMNode.parentNode.removeEventListener(e,n.handler,true);delete r[e]}}},F._canDestroy=function(t){return!this._rootDOMNode||!this._rootDOMNode.controlNodes||!this._rootDOMNode.controlNodes.find(function(e){return!e.parent&&e.control!==t})},L._goUpByControlTree=R,e.default=L}(_,e,f,y,C,s,a,D,H,k,w,L,m,b,i,l,P,E,p);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),z=K;e["Vdom/_private/Synchronizer/resources/DirtyChecking"]=true;var B=function(){"use strict";var e={},t=function(e,A,L,F,o,r,H,U,q,t,j,n,K,C){Object.defineProperty(A,"__esModule",{value:true});var z=new n,B;if(L.compat)B=C;function W(e){if(e.control&&e.control._getInternalOption&&e.control._getInternalOption("parent")){var t=r.Subscriber.getEventsListFromOptions(e.options);r.Subscriber.applyEvents(e.control,e.control._getInternalOption("parent"),t)}}function w(e,t,r){e.parent=e.parent||r&&r.control||t.parent||null,e.logicParent=e.logicParent||r&&r.control&&r.control.logicParent||t.logicParent||null}function T(e){return"function"===typeof e?e:e["constructor"]}A.DirtyKind={NONE:0,DIRTY:1,CHILD_DIRTY:2};var Y=[],G={plus:function(e,t){return{createdNodes:e.createdNodes.concat(t.createdNodes),destroyedNodes:e.destroyedNodes.concat(t.destroyedNodes),updatedNodes:e.updatedNodes.concat(t.updatedNodes),createdTemplateNodes:e.createdTemplateNodes.concat(t.createdTemplateNodes),updatedTemplateNodes:e.updatedTemplateNodes.concat(t.updatedTemplateNodes),updatedChangedNodes:e.updatedChangedNodes.concat(t.updatedChangedNodes),updatedChangedTemplateNodes:e.updatedChangedTemplateNodes.concat(t.updatedChangedTemplateNodes),updatedUnchangedNodes:e.updatedUnchangedNodes.concat(t.updatedUnchangedNodes),selfDirtyNodes:e.selfDirtyNodes.concat(t.selfDirtyNodes)}},zero:{createdNodes:[],destroyedNodes:[],updatedNodes:[],createdTemplateNodes:[],updatedTemplateNodes:[],updatedUnchangedNodes:[],updatedChangedNodes:[],updatedChangedTemplateNodes:[],selfDirtyNodes:[]}};function X(e,t){var r;for(r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}function Q(e){var t={};for(var r in e)if(e.hasOwnProperty(r))if(e[r]&&e[r].getVersion)t[r]=e[r].getVersion();return t}function h(e){return e&&e.internal?e.internal:{}}function v(e,t){return"object"===typeof e&&e&&t&&e.getVersion}function J(e,t,r,n,o){var i,a,s=false,u={},l,d;for(i in t){if(r&&i&&i.indexOf("__dirtyCheckingVars_")>-1)continue;if(l=t.hasOwnProperty(i)||o&&void 0!==t[i])if(d=e.hasOwnProperty(i)||void 0!==e[i]){if("function"===typeof e[i]&&"function"===typeof t[i]||"number"===typeof e[i]&&"number"===typeof t[i]&&isNaN(e[i])&&isNaN(t[i]))continue;if(e[i]===t[i]){if(v(e[i],n)){var c=e[i].getVersion();if(n[i]!==c)n[i]=c,s=true,u[i]=e[i];else if(Array.isArray(e[i])&&e[i])if(!e[i].isDataArray)s=true,u[i]=e[i]}}else if(Array.isArray(e[i])&&e[i])if(!e[i].isDataArray)s=true,u[i]=e[i];else{if(!t[i]){s=true,u[i]=e[i];continue}for(var f=0;f<e[i].length;f++){var p;if(J(h(e[i][f]),h(t[i][f]),false,n,o)){s=true,u[i]=e[i];break}}}else if(s=true,u[i]=e[i],v(e[i],n))n[i]=e[i].getVersion()}}return s?u:null}function i(e){return(e=e||[]).reduce(function(e,t){return e.concat(Array.isArray(t)?i(t):t)},[])}function k(e,t,r){var n;return{markupDecorator:o.composeWithResultApply.call(void 0,[r.getMarkupNodeDecorator()]).bind(e),defaultOptions:{}}}function Z(e,t,r){var n=e.parentControl?e.template.call(e.parentControl,e.controlProperties,e.attributes,e.context,true):e.template(e.controlProperties,e.attributes,e.context,true),o=[],i;if(!Array.isArray(n))n=[n];for(i=0;i<n.length;i++){var a=H.getFullMarkup(t,n[i],true);o=o.concat(Array.isArray(a)?a:[a])}for(i=0;i<o.length;i++)o[i]=H.mapVNode(r.getMarkupNodeDecorator(),t,o[i]);return n=o}function ee(e,t,r,n,o,i,a){var s=T(e),u=a&&a.compound,l=i&&i.state||{vdomCORE:true},d=t.user,c=t.internal||{},f;if(w(c,d,o),!r)r="_";if(u){if(!B)B=C;f=B.createCompoundControlNode(e,s,d,c,r,o,a)}else{var p=a&&a.invisible,h=l?X(d,l):d,v,m,y,g,N,b,_;if("function"===typeof e)y=(b=U.Compatible.createInstanceCompatible(s,h,c)).instance,h=b.resolvedOptions,_=b.defaultOptions;else if(y=e,_=U.OptionsResolver.getDefaultOptions(e),L.compat)if(h=U.Compatible.combineOptionsIfCompatible(s.prototype,h,c),y._setInternalOptions)y._options.doNotSetParent=true,y._setInternalOptions(c||{});v=Q(h),m=Q(N=a&&a.context||{}),g=k(y,s,n),f={attributes:t.attributes,events:t.events,control:y,errors:i&&i.errors,controlClass:s,options:h,internalOptions:c,optionsVersions:v,id:y._instId||0,parent:o,key:r,defaultOptions:_,markup:p?U.Vdom.textNode(""):void 0,fullMarkup:void 0,childrenNodes:Y,markupDecorator:g&&g.markupDecorator,serializedChildren:i&&i.childrenNodes,hasCompound:false,receivedState:void 0,invisible:p,contextVersions:m,context:a&&a.context||{},inheritOptions:a&&a.inheritOptions||{}},n.setupControlNode(f)}return f}function a(e){return t(e)}function te(r,n,o,i,a){if(o.receivedState&&o.receivedState.then)return o.receivedState.then(function e(t){return o.receivedState=t,s(r,n,o,i,a)},function(e){return U.Common.asyncRenderErrorLog(e),o.receivedState=null,s(r,n,o,i,a)});else return s(r,n,o,i,a)}function re(e,t){if(!e)return;try{if(t.setRebuildIgnoreId(e.id),e.compound){var r=e.options,n=r.__vdomOptions&&r.__vdomOptions.controlNode.instance;if(n)j.default(function(){n.destroy()})}else{for(var o=0;o<e.childrenNodes.length;o++)re(e.childrenNodes[o],t);if(e.control.__$destroyFromDirtyChecking=true,e.control.destroy(),e.control._logicParent&&e.control._logicParent._template&&e.control._options.name)delete e.control._logicParent._children[e.control._options.name]}}finally{t.setRebuildIgnoreId(e.id)}}function ne(e){if(e.fullMarkup)e.fullMarkup.changed=true;if(e.parent&&e.parent.fullMarkup&&!e.parent.fullMarkup.changed)ne(e.parent)}function oe(e,t){if(e.children)for(var r=0;r<e.children.length;r++)if(U.Vdom.isControlVNodeType(e.children[r]))t.push(e.children[r]);else if(U.Vdom.isTemplateVNodeType(e.children[r])||U.Vdom.isVNodeType(e.children[r]))oe(e.children[r],t)}function s(O,E,e,t,r){var n=e.id,o,i=E[n]||A.DirtyKind.NONE,a=i!==A.DirtyKind.NONE||t,s=!!(i&A.DirtyKind.DIRTY)||t,u=e.markup,l,d=false,y,V,c,f,p,h,v,m,g,N=[],b,_,C,w,T,k,D,M,P,x,I;if(a){if(x=(y=e).context,I=q.ContextResolver.resolveContext(y.controlClass,x,y.control),!y.compound){if(s&&y.control._mounted&&!t){try{y.control._beforeUpdate(y.options,I)}catch(e){K.catchLifeCircleErrors("_beforeUpdate",e)}try{l=y.control._shouldUpdate(y.options,I)}catch(e){K.catchLifeCircleErrors("_shouldUpdate",e)}s=s&&l}if(s){if(K.log("DirtyChecking",["requestRebuild "+n,y.control,y]),(V=y).control.saveFullContext(q.ContextResolver.wrapContext(y.control,y.context||{})),!y.inheritOptions)y.inheritOptions={};if(U.OptionsResolver.resolveInheritOptions(y.controlClass,y,y.options),y.control.saveInheritOptions(y.inheritOptions),y.markup=H.getDecoratedMarkup(y,r),c=H.getMarkupDiff(u,y.markup),K.log("DirtyChecking (diff)",["","",c]),c.destroy.length||c.vnodeChanged)ne(y),d=true;while(c.createTemplates.length>0||c.updateTemplates.length>0){var S={create:[],createTemplates:[],destroy:[],destroyTemplates:[],update:[],updateTemplates:[]};p=c.createTemplates.map(function e(t){K.log("DirtyChecking (create template)",["","",t]),t.optionsVersions=Q(t.controlProperties),t.contextVersions=Q(t.context),t.children=Z(t,y,O);for(var r=0;r<t.children.length;r++){var n=H.getMarkupDiff(null,t.children[r]);S.create=S.create.concat(n.create),S.createTemplates=S.createTemplates.concat(n.createTemplates),S.update=S.update.concat(n.update),S.updateTemplates=S.updateTemplates.concat(n.updateTemplates)}return t}),c.createTemplates=S.createTemplates,c.updateTemplates=c.updateTemplates.concat(S.updateTemplates),S.createTemplates=[],S.updateTemplates=[],v=c.updateTemplates.map(function e(t){K.log("DirtyChecking (update template)",["","",t]);var r=t.newNode,n=t.oldNode,o=n.controlProperties,i,a=J(r.controlProperties,o,false,n.optionsVersions),s=n.attributes.attributes,u,l=J(r.attributes.attributes,s,false,{}),d=n.template!==r.template,c,f;if(a||l||d){K.log("DirtyChecking (update template with changed options)",["","",a]);var p=n.children;r.children=Z(r,y,O);var h=r.children.length>p.length?r.children.length:p.length;for(f=0;f<h;f++){var v=p[f],m=r.children[f];if(m)c=H.getMarkupDiff(v,m,true),S.create=S.create.concat(c.create),S.createTemplates=S.createTemplates.concat(c.createTemplates),S.update=S.update.concat(c.update),S.updateTemplates=S.updateTemplates.concat(c.updateTemplates),S.destroy=S.destroy.concat(c.destroy);else if(v)if(U.Vdom.isControlVNodeType(v))S.destroy.push(v);else if(U.Vdom.isTemplateVNodeType(v)||U.Vdom.isVNodeType(v))oe(v,S.destroy)}}else for(r.children=n.children,f=0;f<r.children.length;f++)c=H.getMarkupDiff(n.children[f],r.children[f],true),S.create=S.create.concat(c.create),S.createTemplates=S.createTemplates.concat(c.createTemplates),S.update=S.update.concat(c.update),S.updateTemplates=S.updateTemplates.concat(c.updateTemplates),S.destroy=S.destroy.concat(c.destroy);return r.optionsVersions=n.optionsVersions,r}),c.updateTemplates=S.updateTemplates,c.create=c.create.concat(S.create),c.destroy=c.destroy.concat(S.destroy),c.update=c.update.concat(S.update),c.createTemplates=c.createTemplates.concat(S.createTemplates)}if(_=c.destroy.map(function e(t){var r=t.controlNodeIdx,n=V.childrenNodes[r];return re(n,O),n}),M=new Array(c.create.length+c.update.length),P=new Array(c.createTemplates.length+c.updateTemplates.length),D=c.update.length,p=[],v=[],f=c.create.map(function e(t,r){var n=D+r,o=V.serializedChildren,i=o&&o[n],a,s,u;if(K.log("DirtyChecking (create node)",["","",r,t]),d=true,!t.compound){if(a=t.controlProperties,!(u=ee(t.controlClass,{user:a,internal:t.controlInternalProperties,attributes:t.controlAttributes,events:t.controlEvents},t.key,O,V,i,t)).control._mounted&&!u.control._unmounted){if(s=U.Vdom.getReceivedState(u,t,z))u.receivedState=s;if(u.control.saveOptions)u.control.saveOptions(u.options,u);else if(u.control._options=u.options,u.control._container=u.element,u.control._setInternalOptions(t.controlInternalProperties||{}),L.compat)u.control._container=$(u.element)}if(L.compat&&(!u.control.hasCompatible||u.control.hasCompatible()))W(u)}else u=ee(t.controlClass,{user:X(t.controlProperties,t.controlInternalProperties),attributes:t.controlAttributes,events:t.controlEvents},t.key,O,V,i,t);return t.controlNodeIdx=n,M[t.controlNodeIdx]=true,u}),k=(h=c.update.map(function e(t,r){K.log("DirtyChecking (update node)",["","",t]);var n=t.newNode,o=t.oldNode.controlNodeIdx,i=V.childrenNodes[o],a=i.control,s=true,u=n.compound?U.Compatible.createCombinedOptions(n.controlProperties,n.controlInternalProperties):n.controlProperties,l=i.options,d=i.optionsVersions,c=n.context||{},f=i.context,p=i.contextVersions,h=J(u,l,n.compound,d),v=J(c,f,false,p),m=v?v:J(c,f,false,p,true),y=i.controlAttributes||i.attributes,g=J(n.controlAttributes,y,n.compound),N;if(n.compound){if(u.__vdomOptions=l.__vdomOptions,h){var b=l.__vdomOptions&&l.__vdomOptions.controlNode.instance;if(b&&!b.__$$blockSetProperties){var _=J(u,b._options||{},n.compound);if(_)b.__$$blockSetProperties=true,h=B.clearNotChangedOptions(h,_),b.setProperties(h),j.default(function(){b.__$$blockSetProperties=false})}}i.options=u}else if(N=J(n.controlInternalProperties,i.internalOptions),h||N||g||v)try{var C;K.log("DirtyChecking (update node with changed)",["","",h||N||g||v]),O.setRebuildIgnoreId(i.id),U.OptionsResolver.resolveInheritOptions(i.controlClass,i,u),a.saveInheritOptions(i.inheritOptions),C=q.ContextResolver.resolveContext(i.controlClass,c,i.control),U.OptionsResolver.resolveOptions(i.controlClass,i.defaultOptions,u,i.parent.control._moduleName),a._beforeUpdate&&a._beforeUpdate(u,C),a._options=u,s=(a._shouldUpdate?a._shouldUpdate(u,C):true)||N,a._setInternalOptions(N||{}),i.oldOptions=l,i.oldContext=f,i.attributes=n.controlAttributes,i.events=n.controlEvents,a._saveContextObject(C),a.saveFullContext(q.ContextResolver.wrapContext(a,a._context))}finally{var w=a._shouldUpdate?a._shouldUpdate(u,c)||N:true;if(a._setInternalOptions(N||{}),w)O.setRebuildIgnoreId(null);if(i.options=u,i.context=c,!n.compound)i.internalOptions=n.controlInternalProperties}else if(m)for(var T=i.childrenNodes,k=0;k<T.length;k++)E[T[k].id]|=A.DirtyKind.CHILD_DIRTY;return M[r]=(!!h||!!N||!!v||!!g)&&s,n.controlNodeIdx=r,i.events=n.controlEvents,i})).concat(f),b=g=m=Y,h.forEach(function(e,t){if(M[t]){if(g===Y)g=[];g.push(e)}else{if(m===Y)m=[];m.push(e)}}),g.length||f.length)ne(y),d=true;if(-1===k.indexOf(y)){if(b===Y)b=[];b.push(y)}}else k=e.childrenNodes,b=_=N=g=m=h=p=f=Y}else if(k=e.childrenNodes,b=_=N=g=m=h=p=f=Y,y.compound)y.parent.hasCompound=true;if((T=F.mapM(k,function(e,t){if(M&&M[t])ne(e);return te(O,E,e,M&&M[t])},A.RebuildResultWriter)).then)return T.then(function(e){if(y.childrenNodes=e.value,d||!y.fullMarkup||y.fullMarkup.changed||s){var t=y.fullMarkup&&y.fullMarkup.changed;if(y.fullMarkup=O.decorateFullMarkup(H.getFullMarkup(y.childrenNodes,y.markup,void 0,d||s?void 0:y.fullMarkup),y),y.fullMarkup.changed=t||y.fullMarkup.changed||d||s,y.fullMarkup.changed)ne(y)}return{value:y,memo:G.plus(e.memo,{createdNodes:f,updatedNodes:h,destroyedNodes:_,updatedChangedNodes:g,updatedChangedTemplateNodes:N,updatedUnchangedNodes:m,selfDirtyNodes:b,createdTemplateNodes:p,updatedTemplateNodes:v,destroyedTemplateNodes:C})}},function(e){return U.Common.asyncRenderErrorLog(e),e});else{if(y.childrenNodes=T.value,d||!y.fullMarkup||y.fullMarkup.changed||s){var R=y.fullMarkup&&y.fullMarkup.changed;if(y.fullMarkup=O.decorateFullMarkup(H.getFullMarkup(y.childrenNodes,y.markup,void 0,d||s?void 0:y.fullMarkup),y),y.fullMarkup.changed=R||y.fullMarkup.changed||d||s,y.fullMarkup.changed)ne(y)}w={value:y,memo:G.plus(T.memo,{createdNodes:f,updatedNodes:h,destroyedNodes:_,updatedChangedNodes:g,updatedChangedTemplateNodes:N,updatedUnchangedNodes:m,selfDirtyNodes:b,createdTemplateNodes:p,updatedTemplateNodes:v,destroyedTemplateNodes:C})}}}else w={value:e,memo:G.zero};return w}A.RebuildResultWriter=F.createWriterMonad(G),A.createNode=ee,A.destroyReqursive=re,A.rebuildNode=s}(_,e,y,R,I,m,H,b,m,v,D,h,p,T);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),W=B;e["Vdom/_private/Synchronizer/resources/Debug"]=true;var Y=function(){"use strict";var e={},t=function(e,t,i,p,l,h,a){Object.defineProperty(t,"__esModule",{value:true});var s=20,v={0:"NONE",1:"VTEXT",2:"VNODE",3:"WIDGET",4:"PROPS",5:"ORDER",6:"INSERT",7:"REMOVE",8:"THUNK",VirtualNode:"VirtualNode"};function m(e,n){var s=/["'&<>]/,r={area:true,base:true,br:true,col:true,embed:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true};function t(e){var t=""+e,r=s.exec(t);if(!r)return t;var n,o="",i,a=0;for(i=r.index;i<t.length;i++){switch(t.charCodeAt(i)){case 34:n="&quot;";break;case 38:n="&amp;";break;case 39:n="&#39;";break;case 60:n="&lt;";break;case 62:n="&gt;";break;default:continue}if(a!==i)o+=t.substring(a,i);a=i+1,o+=n}return a!==i?o+t.substring(a,i):o}var o=a(function(e){return t(e)+'="'});function i(e){return(e=void 0!==e&&null!==e?e.toString():"").replace('"',"&quot;")}function u(e,t,r){if(r){if(null==t)return"";return o(e)+i(t)+'"'}return null}function a(t){var r={};return function(e){if(r.hasOwnProperty(e))return r[e];else return r[e]=t.call(this,e)}}function l(e){if(!e)return"";if(p.Vdom.isControlVNodeType(e))return h.getMarkupGenerator(false).createWsControl(e.controlClass,e.controlProperties,{internal:e.controlInternalProperties,attributes:e.controlAttributes,events:e.controlEvents,key:e.key,context:e.context,inheritOptions:e.inheritOptions},n);if(p.Vdom.isTemplateVNodeType(e))return h.getMarkupGenerator(false).createTemplate(e.template,e.attributes&&e.controlProperties,e.attributes,n);else if(p.Vdom.isVNodeType(e))return d(e)+c(e)+f(e);else if(p.Vdom.isTextNodeType(e))return String(e.children);else if(Array.isArray(e)){for(var t="",r=0;r<e.length;r++)t+=l(e[r]);return t}else if("string"===typeof e)return e;return""}function d(e){var t=e.hprops,r="<"+e.type.toLowerCase(),n,o,i,a;for(i in n=t["attributes"])if(n.hasOwnProperty(i)&&null!==n[i]&&void 0!==n[i]&&""!==n[i])r+=" "+u(i,n[i],true);for(a in o="",n=t["style"])if(n.hasOwnProperty(a)&&null!==n[a])o+=a+": "+n[a]+";";if(""!==o)r+=" "+u("style",o,true);return r+">"}function c(e){var t=e.properties&&e.properties.innerHTML;if(t)return t;else{var r="",n=e.children,o=n&&n.length||0,i,a;for(i=0;i!==o;i++)r+=l(a=n[i]);return r}}function f(e){var t=e.type.toLowerCase();return r[t]?"":"</"+t+">"}return l(e)}function y(r){return function(){var e=Date.now(),t;return{value:r.apply(this,arguments),time:Date.now()-e}}}function g(r,e){function t(e,t){if(t.length){console.group(e);try{t.forEach(function(e){N(r,e)})}finally{console.groupEnd()}}}var n=e.createdNodes.slice(0,s),o=e.updatedChangedNodes.slice(0,s),i=e.updatedUnchangedNodes.slice(0,s),a=e.destroyedNodes.slice(0,s);console.log("------------------"),t("Созданы",n),t("Обновлены - изменены по опциям",o),t("Обновлены - не изменены",i),t("Удалены",a)}function u(e,t,r){var n,o=[];if(p.Vdom.isControlVNodeType(r))N(e,r.controlNode);else{if(n=[p.Vdom.isVNodeType(r)?r.tagName:p.Vdom.isTextNodeType(r)?r.text:"???"],void 0!==r.key)n.push[r.key];if(o=[n.join("/")],p.Vdom.isVNodeType(r))o.push(a(r.properties)?"":r.properties);if(t){console.group.apply(console,o);try{i.getVNodeChidlren(r).forEach(u.bind(void 0,e,t))}finally{console.groupEnd()}}else console.log.apply(console,o)}}function N(e,t){var r=t.control,n=r.get("name"),o=t.markup,i,a=e[t.id]||l.DirtyKind.NONE,s=a===l.DirtyKind.NONE?[]:a===l.DirtyKind.DIRTY?["D"]:["C"],u;if(u=(n?[n]:[]).concat([r.describe()]),void 0!==t.key)u.push(t.key);u=u.concat(s),console.log(u.join("/"),t.id,r.getRawData())}function d(n,e,o,t,r,i){for(var a in r=r||{})if(r.hasOwnProperty(a)){var s=r[a],u,l=y(m.bind(void 0,s.value.a))(),d={};for(var c in s.value)if(s.value.hasOwnProperty(c)){var f=s.value[c],p="type"in f?v[f.type]:"????";if(p)d[p]=d.hasOwnProperty(p)?d[p]+1:1}console.group("PATCH: time = "+s.time,true),console.log(d,s.value),console.log("toHTML: time = ",l.time,l.value.length),console.groupEnd()}if(!i.silent&&e)e.forEach(function(e,t){var r=o[t];console.groupCollapsed("Старое",t);try{N(n,e)}finally{console.groupEnd()}console.groupCollapsed("Новое",t);try{N({},r)}finally{console.groupEnd()}}),g(n,t)}function r(n,o){return function(){var e=Date.now(),t,r;try{r=n.call(this,y)}finally{if(t=Date.now()-e,r)d(r.dirties,r.oldRoots,r.newRoots,r.rebuildChanges,r.applyResults,o);console.log("Время перестроения - ",t)}return r}}t.vdomToHTML=m,t.logRebuildChanges=g,t.logVNode=u,t.logControlNode=N,t.logRebuild=d,t.withLogRebuild=r}(_,e,H,b,B,N,g);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),G=Y;e["Vdom/_private/Utils/DefaultOpenerFinder"]=true;var X,Q=function(){"use strict";var e={},t=function(e,t,n,o,r){Object.defineProperty(t,"__esModule",{value:true});var i=r.default._goUpByControlTree;function a(e){var t,r;if(n.instanceOfModule(e,"Core/Control"))t=e._container;else if(e instanceof Element)t=e;else o.resolve("ILogger").error("DOMEnvironment",rk("The arguments should be control or node element"));return i(t).find(function(e){return e._options.isDefaultOpener})}t.find=a}(_,e,d,C,K);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Vdom/_private/Synchronizer/Synchronizer"]=true;var J,Z=function(){"use strict";var e={},t=function(o,e,t,c,f,p,r,i,h,v,m,a){var s;Object.defineProperty(e,"__esModule",{value:true});var u=50,l=2,d=false;if(d)s=t;function y(e,t){var r=e.parent;while(r)t(r),r=r.parent}function g(e,r){return e.map(function(t){var e=r.filter(function(e){return t.id===e.id});if(e.length)return e[0];return t})}function N(e){return e.control&&e.control._parent&&e.control._parent.isDestroyed&&e.control._parent.isDestroyed()}function b(e){if("[object String]"===Object.prototype.toString.call(e))return o(e);return e}function _(e){return e.map(function e(t){return t.id})}var C=[],w=[],T={},k={},n={_rebuild:function(){function e(u){var l=k;if(0===Object.keys(l).length)return{dirties:l,oldRoots:C,newRoots:C,rebuildChanges:null,applyResults:null};k={},C.splice(w.length);var d=C,e=c.mapM(d,function e(t,r){return t.requestDirtyCheck=O.bind(t),f.rebuildNode(w[r],l,t,void 0,true)},f.RebuildResultWriter,this);if(e.then)e.then(function(e){var r=e.value.filter(function(e){if(N(e))return false;return true}),t=e.memo,n=_(r),o={createdNodes:true,updatedChangedNodes:true,selfDirtyNodes:true,createdTemplateNodes:true,updatedChangedTemplateNodes:true},i;for(var a in o)if(t[a].length>0)n=n.concat(_(t[a]));n=h(n);var s=function(e,t){return r[t]&&r[t].fullMarkup?e.applyNewVNode(r[t].fullMarkup,n,r[t]):null};if(u)s=u(s);if(t.createdNodes.forEach(function(e){e.requestDirtyCheck=O.bind(e),T[e.id]=e},this),t.destroyedNodes.forEach(function(e){delete T[e.id]},this),i=w.map(s),C.length>r.length)C=g(C,r);else C=r;return{dirties:l,oldRoots:d,newRoots:r,rebuildChanges:t,applyResults:i}},function(e){return m.Common.asyncRenderErrorLog(e),e});else{var r=e.value.filter(function(e){return-1!==w.indexOf(e.environment)}),t=e.memo,n=_(r).map(function(e){return l[e]&f.DirtyKind.DIRTY?e:void 0}),o={createdNodes:true,updatedChangedNodes:true,selfDirtyNodes:true,createdTemplateNodes:true,updatedChangedTemplateNodes:true},i;for(var a in o)if(t[a].length>0)n=n.concat(_(t[a]));n=h(n);var s=function(e,t){return r[t]&&r[t].fullMarkup?e.applyNewVNode(r[t].fullMarkup,n,r[t]):null};if(u)s=u(s);return t.createdNodes.forEach(function(e){e.requestDirtyCheck=O.bind(e),T[e.id]=e},this),t.destroyedNodes.forEach(function(e){delete T[e.id]},this),i=w.map(s),{dirties:l,oldRoots:d,newRoots:C=r,rebuildChanges:t,applyResults:i}}}var t=d?s.withLogRebuild(e,{silent:true}):e,r;for(r=0;r!==u;r++)if(t.call(this),i(k))break;if(r===u){var n;for(a.setLoggerStatus(true,true),n=1;n<=l;n++)a.log("MAX_REBUILD error",["Logged iteration "+n]),t.call(this);throw a.setLoggerStatus(false,true),new Error("SBIS3.CORE.VDOM.Synchronizer: i === MAX_REBUILD")}},controlStateChangedCallback:function(e){n.requestRebuild(e)},mountControlToDOM:function(a,s,u,l,e){l=l[0]?l[0]:l;var t,d=e||{},c=l.getAttribute("data-component-root-id"),r=c&&window.vdomJsModules[c];if(!e)d["data-component"]=l.getAttribute("data-component");s=b(s);var n=function e(){var r,t,n,o=new v,i;if(t=new p.default(l,this.controlStateChangedCallback,d,c),(r=f.createNode(a,{user:u},void 0,t,null,n)).requestDirtyCheck=O.bind(r),d)r.attributes=d;if(T[r.id]=r,w.push(t),C.push(r),r.control._saveEnvironment(t,r),!a._mounted&&!a._unmounted&&!a._beforeMountCalled)i=m.Vdom.getReceivedState(r,{controlProperties:u,controlClass:s},o);if(r["element"]=l,r.control.saveOptions)r.control.saveOptions(r.options,r);else r.control._options=r.options,r.control._container=$(r.element);if(i)i.then(function e(t){return r.receivedState=t,this.requestRebuild(r.id),t}.bind(this),function e(t){return m.Common.asyncRenderErrorLog(t),t});else this.requestRebuild(r.id)}.bind(this);if(t=w.some(function(e){return e instanceof p.default&&e.getDOMNode()===l}))throw new Error("На этом DOM-элементе уже есть смонтированный корневой компонент");if(r&&r.length>0)o(r,n);else n()},cleanControlDomLink:function(e){if(!e)return;var t=e[0]?e[0]:e;if(t.controlNodes)for(var r=0;r<t.controlNodes.length;r++)if(!t.controlNodes[r].control||t.controlNodes[r].control._destroyed)if(delete T[t.controlNodes[r].id],t.controlNodes.length>0)if(t.controlNodes.length>1||!t.controlNodes[0].parent)t.controlNodes.splice(r,1),r--},unMountControlFromDOM:function e(t,r){for(var n=r[0]?r[0]:r,o,i,a=C.length-1;a>=0;a--){var s=C[a].environment._rootDOMNode;if(n===s&&C[a].environment._canDestroy(t)||!s){var u=C[a].id,l=w.splice(a,1)[0];if(T[u])i=T[u],delete T[u];if(C.splice(a,1),n===s)o=l;else l.destroy()}}if(o){if(!t._destroyed)t.destroy();if(i)f.destroyReqursive(i,o);t._mounted=false,t._unmounted=true,o.destroy()}},queue:null,requestRebuild:function(e){var n=T[e],t=k,o=this;if(n&&!n.environment._rebuildRequestStarted){if(t[e]|=f.DirtyKind.DIRTY,y(n,function(e){t[e.id]|=f.DirtyKind.CHILD_DIRTY}),!n.environment._haveRebuildRequest)n.environment._haveRebuildRequest=true,r.default(function e(){if(n.environment._rebuildRequestStarted=true,this._savedActiveElement!==document.activeElement){var t=document.activeElement;while(t&&t.parentElement){if(t.controlNodes&&t.controlNodes[0]){this._savedControlNode=t.controlNodes[0];break}t=t.parentElement}}var r;if(this._savedActiveElement=document.activeElement,o._rebuild(),n.environment.addTabListener(),n.control.__$focusing)r=n;if(r)n.environment.autofocusChanges.call(this,r)}.bind(this))}else if(n&&n.environment){if(!n.environment.queue)n.environment.queue=[];if(!n.environment.queueIds)n.environment.queueIds={};if(!n.environment.queueIds[e])n.environment.queue.push(e);n.environment.queueIds[e]=1}},setDebugMode:function(e){d=e}};function O(){n.requestRebuild(this.id)}e.default=n}(_,e,Y,R,B,K,D,g,u,h,b,p);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();function ee(e,t){C.resolve("ILogger").warn("Vdom/Vdom",'"'+e+'" wrapper is deprecated and will be removed. Require '+'"Vdom/Vdom" and use '+t+" from it instead.")}return e.Debug=G,e.DirtyChecking=W,e.DirtyCheckingCompatible=r,e.Hooks=O,e.SwipeController=V,e.TabIndex=F,e.VdomMarkup=U,e.DefaultOpenerFinder=Q,e.Focus=j,e.Functional=S,e.Monad=A,e.Synchronizer=Z.default,e.DOMEnvironment=z.default,e.Environment=x.default,e.runDelayedRebuild=M.default,e.SyntheticEvent=t.default,e.logDeprecatedWrapper=ee,e});