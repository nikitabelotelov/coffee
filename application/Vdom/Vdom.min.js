define("Vdom/Vdom",["Core/helpers/Function/runDelayed","Core/core-extend","View/Executor/Markup","Core/helpers/isNewEnvironment","Core/helpers/Array/findIndex","Core/helpers/Array/uniq","Core/detection","Core/core-instance","Core/helpers/Array/flatten","Core/core-debug","View/Logger","Core/Serializer","Core/helpers/Function/shallowClone","View/Executor/Expressions","Core/constants","Core/helpers/Object/isEmpty","View/Executor/TClosure","View/Executor/Utils","require","exports","Core/IoC"],function(r,o,i,a,s,l,u,d,c,f,p,h,v,m,y,g,N,b,_,e,C){"use strict";Object.defineProperty(e,"__esModule",{value:true}),e["Vdom/_private/Utils/Focus"]=true;var t,n=function(){var e={},t=function(e,t,n){function r(t){if(t)if(n.isIE&&t.setActive)try{t.setActive()}catch(e){t.focus()}else t.focus()}Object.defineProperty(t,"__esModule",{value:true}),t.focus=r}(_,e,u);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Vdom/_private/Synchronizer/resources/SyntheticEvent"]=true;var w=function(){var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r={blur:false,error:false,focus:false,load:false,mouseenter:false,mouseleave:false,resize:false,scroll:false,unload:false,click:true,change:true,compositionend:true,compositionstart:true,compositionupdate:true,dblclick:true,focusin:true,focusout:true,input:true,keydown:true,keypress:true,keyup:true,mousedown:true,mousemove:true,mouseout:true,mouseover:true,mouseup:true,select:true,wheel:true,touchstart:true,touchend:true,touchmove:true,contextmenu:true,swipe:true};function n(e,t){var n=e?e:t;this.nativeEvent=e?e:null,this.type=n.type,this.target=n.target,this._bubbling=e?r[n.type]:t&&t._bubbling,this.stopped=false}var o=(t.default=n).prototype;o.stopPropagation=function(){if(this.stopped=true,this.nativeEvent)this.nativeEvent.stopPropagation()},o.isStopped=function(){return this.stopped},o.isBubbling=function(){return this._bubbling},o.preventDefault=function(){if(this.nativeEvent)this.nativeEvent.preventDefault()},o.propagating=function(){return true===this._bubbling&&false===this.stopped},o.stopImmediatePropagation=function(){this.stopPropagation()}}(_,e);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),T=w;e["Vdom/_private/Synchronizer/resources/DirtyCheckingCompatible"]=true;var k=function(){var e={},t=function(e,t,s,l){function n(e,t,n,r,o,i,a){return s.Compatible.createCompoundControlNode(e,t,[],n,r,o,i,a,l.getMarkupGenerator(false))}function r(e,t){if(e)delete e.editingTemplate,delete e.columns,delete e.itemContentTpl,delete e.dictionaries;for(var n in e)if(e.hasOwnProperty(n)&&!t.hasOwnProperty(n))delete e[n];return e}Object.defineProperty(t,"__esModule",{value:true}),t.createCompoundControlNode=n,t.clearNotChangedOptions=r}(_,e,b,N);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),O=k;e["Vdom/_private/Synchronizer/resources/Hooks"]=true;var E=function(){var e={},t=function(e,t,u,a){function n(o){function e(e){var t,n=(e.nativeEvent&&e.nativeEvent.args||[]).concat(o.args);o.fn.apply(o.controlNode.control,[e].concat(n));var r=e.nativeEvent.result;if(r&&r.then)r.then(function(){o.controlNode.requestDirtyCheck()});else o.controlNode.requestDirtyCheck();return[o.controlNode.control,e]}if("event"===o.name)return e;else throw new Error("getEventHandlerBase: wrong event type")}Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e){this.type="ControlNodeHook",this.controlNode=e}return e}();t.ControlNodeHook=r;var o=function(){function e(e,t){this.nameForNode=e,this.control=t}return e.hookName="named-hook",e.attributeName="name",e.restrictedTags={component:true,option:true},e}();t.NamedNodeHook=o;var i=function(){function e(e,t){this.propName=e,this.value=t}return e}();function s(e,t,n){var r=e&&e["controlNodes"]||[],o;if(n(r,r.indexOf(t)),e)e["controlNodes"]=r;for(var i=0;i<r.length;i++)if(r[i]["element"]=e,a.compat)r[i].control.saveOptions(r[i].control._options,r[i]);else r[i].control._container=e}function l(e){var t=e.slice(0);t.sort(function(e,t){var n=parseInt((e.id+"").replace("inst_",""),10),r=parseInt((t.id+"").replace("inst_",""),10);if(n>r)return-1;if(n<r)return 1;return 0}),t.unshift(t.length),t.unshift(0),e.splice.apply(e,t)}function d(e){return function(e,t,n,r,o,i){var a=function e(t){if(t){if(this.environment._destroyed)return;if(i)i(t);if(this.controlNode.markup&&"invisible-node"===this.controlNode.markup.type)v(this.controlNode,this.controlNode.events,this.controlNode.environment,t);s(t,this.controlNode,function(e,t){var n;if(!(-1!==t))e.push(this.controlNode),l(e)}.bind(this))}else s(this.controlNode.control._container[0],this.controlNode,function(e,t){var n;if(-1!==t)e.splice(t,1)}.bind(this))}.bind({controlNode:o,environment:o.environment});return[e,t,n,r,a?a:i]}}function c(e){var t=(e=e.arguments||e).length,n=new Array(t),r=t-1,o;if("number"!==typeof t)throw new Error("reverseArray - wrong arg");for(o=0;o!==t;o++)n[r]=e[o],r--;return n}function f(e,t){this.eventName=e,this.eventDescrArr=t,this.handlerFn=null}function p(e,t,n,r){this.eventName=e,this.environment=n,this.eventDescrArr=t.map(function(e){return e.controlNode=r,e})}function h(e,t){return e.filter(function(e){return t[0]&&t[0].value===e.value})}function v(t,e,n,r){var o;for(var i in e)if(e.hasOwnProperty(i)){var a=e[i],s=u.Event.getEventName(i),l=a.map(function(e){return e.controlNode=t,e});if(!(a instanceof p)&&!(a instanceof f)){if(!r.eventProperties)r.eventProperties={},r.eventPropertiesCnt=0;if(r.eventProperties[i])if(o=h(r.eventProperties[i],l),r.eventProperties[i]&&0===o.length)l=l.concat(r.eventProperties[i]);r.eventProperties[i]=l,r.eventPropertiesCnt++,n.addCaptureEventHandler(s,r)}}}function m(a){return function(e,t,n,r,s,l){var o,i;if(Object.keys(t.events).length>0)i=function(e){var t;if(e){if(this.environment._destroyed)return;l(e),v(this.controlNode,this.events,this.environment,e)}else for(var n in l(),this.events)if(this.events.hasOwnProperty(n)){var r=this.events[n],o=u.Event.getEventName(n),i=r.map(function(e){return e.controlNode=s,e}),a;if(!(r instanceof p)&&!(r instanceof f))if(t=this.controlNode.control._container[0],this.environment.removeCaptureEventHandler(o,t),t&&t.eventProperties)if(delete t.eventProperties[this.eventName],t.eventPropertiesCnt--,0===t.eventPropertiesCnt)delete t.eventPropertiesCnt,delete t.eventProperties}}.bind({environment:a,controlNode:s,events:t.events});return[e,t,n,r,i?i:l]}}t.FocusPropsNodeHook=i,t.setControlNodeHook=d,f.prototype.type="BubblingPhaseEventHook",p.prototype.type="CapturePhaseEventHook",t.setEventHooks=m}(_,e,m,y);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),V=E;e["Vdom/_private/Synchronizer/resources/SwipeController"]=true;var D=function(){var e={},t=function(e,t){var r;function o(){r={minSwipeDistance:50,deviationThreshold:25,maxSwipeDuration:600}}function n(e){if(!r||!r.target)o(),r.time=Date.now(),r.location=i(e),r.target=e.target}function i(e){var t=e.touches?e.touches[0]:e;return{x:t.clientX,y:t.clientY}}function a(e){var t=i(e),n;if(e.target===r.target&&r.time-Date.now()<r.maxSwipeDuration)if(Math.abs(r.location.x-t.x)>r.minSwipeDistance&&Math.abs(r.location.y-t.y)<r.deviationThreshold)n=r.location.x>t.x?"left":"right";else if(Math.abs(r.location.y-t.y)>r.minSwipeDistance&&Math.abs(r.location.x-t.x)<r.deviationThreshold)n=r.location.y>t.y?"top":"bottom";return n}function s(e){if(r.target){var t=a(e);if(t){var n=new Event("swipe");n.direction=t,e.target.dispatchEvent(n),o()}}}Object.defineProperty(t,"__esModule",{value:true}),t.resetSwipeState=o,t.initSwipeState=n,t.detectSwipe=s}(_,e);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),M=D;e["Vdom/_private/Synchronizer/resources/runDelayedRebuild"]=true;var P=function(){var e={},t=function(e,t,n){Object.defineProperty(t,"__esModule",{value:true});var r,o=function e(){var t=null;if("undefined"!==typeof document)if("undefined"!==typeof document.hidden)t="hidden";else if("undefined"!==typeof document.msHidden)t="msHidden";else if("undefined"!==typeof document.webkitHidden)t="webkitHidden";return t}();function i(e){if(o&&document[o])setTimeout(e,0);else n(e)}t.default=i}(_,e,r);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),x=P;e["Vdom/_private/Synchronizer/resources/Environment"]=true;var I=function(){var e={},t=function(e,t,n){Object.defineProperty(t,"__esModule",{value:true});var r=n.extend({constructor:function(e,t){this._controlStateChangedCallback=e,this._rebuildIgnoreId=null},destroy:function(){this._controlStateChangedCallback=null,this._destroyed=true}}),o=r.prototype;o.forceRebuild=function(e){if(this._rebuildIgnoreId!==e&&this._controlStateChangedCallback)this._controlStateChangedCallback(e)},o.setRebuildIgnoreId=function(e){this._rebuildIgnoreId=e},o.needWaitAsyncInit=function(){return false},o.setupControlNode=function(e){e.environment=this,e.control._saveEnvironment(this,e)},o.decorateRootNode=function(e){return this._rootMapper?this._rootMapper(e):e},t.default=r}(_,e,o);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),S=I;e["Vdom/_private/Utils/Monad"]=true;var R=function(){var e={},t=function(e,t,n){function a(e,t,n,r){var o=n;if(null===e||void 0===e)e=[];for(var i in e)if(e.hasOwnProperty(i))o=t.call(r,o,e[i],i,e);return o}function r(e){return n.Common.asyncRenderErrorLog(e),e}function o(e,n,r){return r.join(e,function(t){return r.join(n,function(e){return r.pure(e.concat(t))})})}function i(t,e,n){if(e.then)return e.then(function(e){return o(t,e,n)},r);return o(t,e,n)}function s(e,t,n){if(e.then)return e.then(function(e){return i(e,t,n)},r);return i(e,t,n)}function l(e,r,o,i){var t;return a(e,function(e,t,n){return s(r.call(i,t,n),e,o)},o.pure([]))}function u(r){return{join:function(e,t){var n=t(e.value);return{value:n.value,memo:r.plus(n.memo,e.memo)}},pure:function(e){return{value:e,memo:r.zero}}}}Object.defineProperty(t,"__esModule",{value:true}),t.mapM=l,t.createWriterMonad=u,t.ArrayWriterMonad=u({plus:function(e,t){return e.concat(t)},zero:[]}),t.ListMonad={join:function(e,n){return a(e,function(e,t){return e.concat(n(t))},[])},pure:function(e){return[e]}}}(_,e,b);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),A=R;e["Vdom/_private/Utils/Functional"]=true;var L=function(){var e={},t=function(e,t){function o(e){var t=e.length,n=new Array(t),r;if("number"!==typeof t)throw new Error("argumentsToArray - wrong arg");for(r=0;r!==t;r++)n[r]=e[r];return n}function r(e){var n=Array.isArray(e)?e:o(arguments),r=n.length;return function(){var e=n[r-1].apply(this,arguments),t;for(t=r-2;t>=0;t--)e=e instanceof Array?n[t].apply(this,e):n[t].call(this,e);return e}}function i(e,t,n,r){var o=e.prototype,i=r,a=[],s,l;while(o&&o.constructor){if(o.hasOwnProperty(t)&&"function"===typeof o[t])if(l=o[t])a.push(l);o=o.constructor.superclass}for(s=a.length-1;-1!==s;s--)i=n(i,a[s]);return i}function n(e,t){var n;return r(a(e,t))}function a(e,t){var n;return i(e,t,function(e,t){return e.unshift(t),e},[])}function s(e,t){var n;if(!e)throw n="function"==typeof t?t():t,new Error(n||"assert")}Object.defineProperty(t,"__esModule",{value:true}),t.argumentsToArray=o,t.composeWithResultApply=r,t.reduceHierarchyFunctions=i,t.composeHierarchyFunctions=n,t.getHierarchyFunctions=a,t.assert=s}(_,e);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),F=L;e["Vdom/_private/Synchronizer/resources/VdomMarkup"]=true;var H=function(){var e={},t=function(e,t,v,m,y,s,g){function N(e,t){if(t)return e.children||[];else return m.Vdom.isVNodeType(e)?null===e.children?[]:e.children:[]}function b(e,t,n,r,o,i){if(n.stopped)return n;if(r&&m.Vdom.isTemplateVNodeType(n)&&n.children&&n.children[0])return n.children[0]=b(e,t,n.children[0],r),n;if(m.Vdom.isVNodeType(n)){if(t.control&&"Controls/Decorator/Markup"===t.control._moduleName)if(n.children&&n.children[0])n.children[0].stopped=true;var a=e(n.type,n.hprops,n.children,n.key,t,n.ref,n),s=n.type===a[0]&&n.props===a[1]&&n.children===a[2]&&n.key===a[3];if(i){if(n.type=a[0],n.props=a[1],n.children=a[2],n.key=a[3],!n.hookedInvControlIds||-1===n.hookedInvControlIds.indexOf(t.id))if(n.ref=a[4],n.hookedInvControlIds)n.hookedInvControlIds.push(t.id)}else return s?n:m.Vdom.htmlNode.apply(m.Vdom,a)}else return n}function n(e){return Array.isArray(e)?e[0]:e}function r(n,e,r,o,i){function a(e){var t=o(e)?[r(e)]:[];return n?t.concat(s.ListMonad.join(N(e,i),a)):t}return s.ListMonad.join(N(e,i),a)}function o(e){return e}function _(e,t){return r(true,e,o,m.Vdom.isControlVNodeType,t)}function C(e){return r(true,e,o,m.Vdom.isTemplateVNodeType)}function w(e,t,n){var r={create:[],createTemplates:[],destroy:[],destroyTemplates:[],update:[],updateTemplates:[],vnodeChanged:false},o,i,a,s,l,u,y;function d(e,t){function n(e){if(e)for(var t=0,n=e.length;t!==n;t++)if(void 0!==e[t].key)return true;return false}function r(e){for(var t={},n=[],r=e.length,o=0;o<r;o++){var i,a=e[o].key;if(void 0!==a)t[a]=o;else n.push(o)}return{keys:t,free:n}}var o,i,a,s,l,u,d,c,f,p,h,v,m;if(n(e)&&n(t)){for(u=r(e),d=r(t),i=u.keys,h=e.length,a=d.keys,v=t.length,l=(s=d.free).length,f=0,o=new Array(length),c=0;c!==h;c++)if(void 0!==(m=e[c]).key)if(a.hasOwnProperty(m.key))o[c]=t[a[m.key]];else o[c]=null;else if(f!==l)o[c]=t[s[f]],f++;else o[c]=null;for(p=f!==l?s[f]:v,c=0;c!==v;c++)if(void 0!==(y=t[c]).key){if(!i.hasOwnProperty(y.key))o.push(y)}else if(c>=p)o.push(t[c])}else o=t;return o}function c(e,t){var n=e&&m.Vdom.isControlVNodeType(e),r=t&&m.Vdom.isControlVNodeType(t),o=e&&m.Vdom.isTemplateVNodeType(e),i,a=o===(t&&m.Vdom.isTemplateVNodeType(t)),s=n===r;if(s){if(n)s=e.controlClass===t.controlClass&&e.key===t.key;else if((s=e.type===t.type)&&m.Vdom.isVNodeType(e))s=e.tagName===t.tagName&&e.namespace===t.namespace&&e.key===t.key}else if(a)if(o)s=e.template===t.template&&e.key===t.key;else if((s=e.type===t.type&&e.compound===t.compound)&&m.Vdom.isVNodeType(e))s=e.tagName===t.tagName&&e.namespace===t.namespace&&e.key===t.key;return s}function f(e,t,n){e[t]=e[t].concat(n)}if(e!==t||n)if(v.checkAssertion(!!t,"newNode !== null"),c(e,t))if(m.Vdom.isControlVNodeType(t))if(-1===e.controlNodeIdx)r.create.push(t);else r.update.push({oldNode:e,newNode:t});else if(m.Vdom.isTemplateVNodeType(t))if(!t.children&&t===e)r.createTemplates.push(t);else r.updateTemplates.push({oldNode:e,newNode:t});else{a=d(i=N(e),N(t)),s=Math.max(i.length,a.length);var p=0,h=a!==t.children;if(i.length!==a.length)r.vnodeChanged=true;for(l=0;l!==s;l++){if((u=i[l])&&"vdom-focus-in"===u.key&&!h){p++;continue}if(y=a[l-p],u&&y)o=w(u,y,n),r.vnodeChanged=r.vnodeChanged||o,f(r,"create",o.create),f(r,"destroy",o.destroy),f(r,"update",o.update),f(r,"createTemplates",o.createTemplates),f(r,"destroyTemplates",o.destroyTemplates),f(r,"updateTemplates",o.updateTemplates);else if(u)if(m.Vdom.isControlVNodeType(u))f(r,"destroy",[u]);else if(m.Vdom.isTemplateVNodeType(t))f(r,"destroy",_(u,true));else f(r,"destroy",_(u,true));else if(m.Vdom.isControlVNodeType(y))f(r,"create",[y]);else if(m.Vdom.isTemplateVNodeType(y))f(r,"createTemplates",[y]);else f(r,"create",_(y)),f(r,"createTemplates",C(y))}}else{if(r.vnodeChanged=true,m.Vdom.isControlVNodeType(t))r.create.push(t);else if(m.Vdom.isTemplateVNodeType(t))r.createTemplates.push(t);else f(r,"create",_(t)),f(r,"createTemplates",C(t));if(e)if(m.Vdom.isControlVNodeType(e))r.destroy.push(e);else if(m.Vdom.isTemplateVNodeType(e))f(r,"destroy",_(e,true));else f(r,"destroy",_(e,true))}return r}function i(e,t){var n;for(n in t)if(t.hasOwnProperty(n))if(!e.hasOwnProperty(n)||e[n]!==t[n])return true;for(n in e)if(e.hasOwnProperty(n)&&!t.hasOwnProperty(n))return true;return false}function T(e,t){return i(e.attributes,t.attributes)||i(e.events,t.events)||i(e.hooks,t.hooks)}function k(n,r,o,e,t){var i,a,s,l,u,d,c,f=false;if(m.Vdom.isControlVNodeType(r)){if(o)return r;if((i=n[r.controlNodeIdx].fullMarkup)&&i.type&&"invisible-node"===i.type){if(t&&t.type){if(!t.hookedInvControlIds)t.hookedInvControlIds=[];b(g.setControlNodeHook(n[r.controlNodeIdx]),n[r.controlNodeIdx],t,true,false,true)}i=m.Vdom.textNode("",n[r.controlNodeIdx].key)}}else if(m.Vdom.isTemplateVNodeType(r)&&!r.children)i=r;else if(!m.Vdom.isTemplateVNodeType(r)&&!m.Vdom.isVNodeType(r)||!r.children||0===r.children.length)i=r;else{a=0,l=(s=m.Vdom.isTemplateVNodeType(r)?r.children:N(r)).length;while(a!==l){if((u=k(n,s[a],o,void 0,r)).changed)f=true;if(u!==s[a])break;a++}if(a===l){if(i=r,!f&&e)if(i.children&&e.children)if(i.children.length!==e.children.length)f=true;else for(var p=0;p<i.children.length;p++)if(i.children[p]!==e.children[p]||e.children[p]&&e.children[p].changed){f=true;break}}else{if(c=s.slice(a+1).map(function(e){var t=k(n,e,o,void 0,r);if(t.changed)f=true;return t}),c=y(c,true),d=s.slice(0,a).concat(Array.isArray(u)?u:[u]).concat(c),m.Vdom.isTemplateVNodeType(r)){var h={compound:false,children:d,childrenForDiff:r.children,template:r.template,controlProperties:r.controlProperties,parentControl:r.parentControl,attributes:r.attributes,context:r.context,changed:true,type:"TemplateNode",optionsVersions:r.optionsVersions,get count(){var e=0;if(this.children){for(var t=0;t<this.children.length;t++){var n;e+=this.children[t].count||0}return this.children.length+e}else return 0}};return Object.defineProperty(r,"count",{get:function(){return h.count},configurable:true}),h.children}if(e){if(!f)if(!e.children&&d||e.children.length!==d.length)f=true;else for(var p=0;p<e.children.length;p++)if(e.children[p]!==d[p]||d[p].changed){f=true;break}if(!f)f=T(r.hprops,e.hprops);if(f)(i=m.Vdom.htmlNode(r.type,r.hprops,d,r.key,r.ref)).changed=true;else i=e}else(i=m.Vdom.htmlNode(r.type,r.hprops,d,r.key,r.ref)).changed=true}}if(m.Vdom.isTemplateVNodeType(i))if(i.children)i=i.children;else m.Vdom.textNode("",i.attributes.key);if(f)i.changed=true;return i}function a(e,t){return m.Vdom.htmlNode("span",{},[m.Vdom.textNode(e,(t||"err_"+Math.trunc(1e3*Math.random()))+"_inner_text")],t||"err_"+Math.trunc(1e3*Math.random()))}function l(e,t){var n=e.control._getMarkup(e.key,t,{key:e.key,attributes:e.attributes,events:e.events,inheritOptions:e.inheritOptions,templateContext:e.templateContext,internal:e.internal,domNodeProps:e.domNodeProps}),r;if(m.Vdom.isVNodeType(n))r=b(e.markupDecorator,e,n);else if(m.Vdom.isControlVNodeType(n))r=b(e.markupDecorator,e,n);else r=n;if(!m.Vdom.isControlVNodeType(r)&&!m.Vdom.isVNodeType(r)&&!m.Vdom.isTemplateVNodeType(r))r=a("control._getMarkup должен отдавать dom-узел",e.key);return r}Object.defineProperty(t,"__esModule",{value:true}),t.getVNodeChidlren=N,t.mapVNode=b,t.getMarkupDiff=w,t.getFullMarkup=k,t.getDecoratedMarkup=l}(_,e,f,b,c,R,E);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),U=H;e["Vdom/_private/Synchronizer/resources/TabIndex"]=true;var q=function(){var e={},t=function(e,t,C){Object.defineProperty(t,"__esModule",{value:true});var l=1,w={a:true,link:true,button:true,input:true,select:true,textarea:true},d=1,c=2,f=4,p=8,h=16,v={hidden:d,disabled:c,"delegates-tabfocus":f,"creates-context":p,"tab-cycling":h};function m(e,t){return window.getComputedStyle(e)[t]}function n(e){var t=/\bws-(hidden|disabled)\b/g,n=e.getAttribute("class"),r,o,i,a,s,l,u;s=0;while(r=n&&t.exec(n))s|=v[r[1]];if("true"===e["ws-creates-context"]||"true"===e.getAttribute("ws-creates-context"))s|=v["creates-context"];if("true"===e["ws-delegates-tabfocus"]||"true"===e.getAttribute("ws-delegates-tabfocus"))s|=v["delegates-tabfocus"];if("true"===e["ws-tab-cycling"]||"true"===e.getAttribute("ws-tab-cycling"))s|=v["tab-cycling"];if(l=0===(s&(d|c)))l="none"!==m(e,"display")&&"invisible"!==m(e,"visibility");if(l)i=e.getAttribute("tabindex"),o=parseInt(i,10),u={enabled:true,tabStop:(a=!isNaN(o))&&o>=0||null===i&&w.hasOwnProperty(e.tagName.toLowerCase())||-1!==o&&e.hasAttribute("contenteditable"),createsContext:0!==(s&p),tabIndex:o||0,delegateFocusToChildren:0!==(s&f),tabCycling:0!==(s&h)};else u={enabled:false,tabStop:false,createsContext:false,tabIndex:0,delegateFocusToChildren:false,tabCycling:false};return u}function T(e){return e.firstElementChild&&"vdom-focus-in"!==e.firstElementChild.className?e.firstElementChild:e.firstElementChild&&e.firstElementChild.nextElementSibling&&"vdom-focus-out"!==e.firstElementChild.nextElementSibling.className?e.firstElementChild.nextElementSibling:null}function k(e){return e.lastElementChild&&"vdom-focus-out"!==e.lastElementChild.className?e.lastElementChild:e.lastElementChild&&e.lastElementChild.previousElementSibling&&"vdom-focus-in"!==e.lastElementChild.previousElementSibling.className?e.lastElementChild.previousElementSibling:null}function O(e){return e.previousElementSibling?e.previousElementSibling:null}function E(e){return e.nextElementSibling?e.nextElementSibling:null}function V(a,e,t,n,r){function o(e,t,n){var r;if(C.assert("number"===typeof e&&"number"===typeof t),e=0===e?1/0:e>0?e:-1,-1===(t=0===t?1/0:t>0?t:-1)&&-1!==e)return 1;if(-1===e&&-1!==t)return-1;if(e>t)r=n?-1:1;else if(e<t)r=n?1:-1;else r=0;return r}function i(e,t,n){var r,o,i;if(t.enabled&&!t.createsContext)o=n?k(e):T(e);if(!o)if(!(o=n?O(e):E(e))){i=e.parentNode;while(i!==a&&!o)if(!(o=n?O(i):E(i)))i=i.parentNode}return o||a}function s(e){return V(e,void 0,n?0:1,n,r)}function l(e){return n?k(e):T(e)}function u(e,t){if(t.delegateFocusToChildren&&e.childElementCount)if(e.wsControl&&e.wsControl.canAcceptFocus&&e.wsControl.canAcceptFocus())N=e;else N=s(e);return!!(!t.delegateFocusToChildren||w.hasOwnProperty(e.tagName.toLowerCase())||N)}C.assert(a&&(e||void 0!==t)&&r&&a!==e);var d,c,f,p,h,v,m=null,y,g=null,N,b;if(e)t=(v=r(e)).tabIndex,d=i(e,v,n);else d=(d=n?k(a):T(a))||a;var _=false;for(f=0;2!==f&&!p;f++){while(d!==a&&d!==e&&!p){if((c=r(d)).enabled&&c.tabStop)if(0===(h=o(c.tabIndex,t,n))&&0===f){if(u(d,c))p=d,b=N}else if(h>0)if(!p)if(0===f){if(null===m||o(c.tabIndex,m.tabIndex,n)<0)if(u(d,c))m=d,g=c.tabIndex,y=f,b=N}else if(null===m||o(c.tabIndex,m.tabIndex,n)<0||_&&o(c.tabIndex,m.tabIndex,n)<=0)if(u(d,c))m=d,g=c.tabIndex,y=f,b=N,_=false;if(-1===t&&m)p=m;if(!p)d=i(d,c,n)}if(d===a&&0===f)if(e&&(false===n&&t>0||true===n&&1!==t&&-1!==t))d=l(a);if(0===f)_=true}if(C.assert(!!p||d===e||d===a),!p&&m)if(g>=0)p=m;if(p&&b)p=b,C.assert(!!p);return p}function u(e,t,n){return V(e,void 0,t?0:1,t,n)}function r(i,e,t,a){function n(e){var t,n=null,r,o=e;while(o&&o!==i){if(!a(o).enabled)n=o;o=o.parentElement}if(!o)throw new Error("Узел fromElement должен лежать внутри узла rootElement");if((r=n||e)!==i){o=r.parentElement;while(o!==i&&!a(o).createsContext)o=o.parentElement;t=o}return{element:e,context:t}}function r(e,t){var n=e===document.documentElement||!!e.parentElement;if(!e||!e.ownerDocument||!n||e.nodeType!==l)throw new Error("Плохой параметр "+t)}r(e,"fromElement"),r(i,"rootElement");var o=n(e),s=o.element;if(s!==i)do{if(!(s=V(o.context,o.element,void 0,t,a)))if(a(o.context).tabCycling)break;else o=n(o.context)}while(!s&&o.element!==i);if(s===i)s=u(i,t,a);if(!s&&a(o.context||i).tabCycling)if(void 0===(s=u(o.context||i,t,a)))s=e;return s}function o(){var e=document.createElement("div");return e.innerHTML='<svg><foreignObject width="30" height="30">'+'<input type="text"/>'+"</foreignObject></svg>",e.firstChild.firstChild}function i(e){var t;if(!(e.ownerSVGElement||"svg"===e.nodeName.toLowerCase()))return false;var n=o();e.appendChild(n);var r=n.querySelector("input");return r.focus(),r.disabled=true,e.removeChild(n),true}function a(t){if(t.focus)t.focus();try{HTMLElement.prototype.focus.call(t)}catch(e){i(t)}}t.getElementProps=n,t.findFirstInContext=u,t.findWithContexts=r,t.focus=a}(_,e,L);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),j=q;e["Vdom/_private/Synchronizer/resources/DirtyChecking"]=true;var K=function(){var e={},t=function(e,A,L,F,o,n,H,U,q,t,j,r,K,_){Object.defineProperty(A,"__esModule",{value:true});var z=new r,B;if(L.compat)B=_;function W(e){if(e.control&&e.control._getInternalOption&&e.control._getInternalOption("parent")){var t=n.Subscriber.getEventsListFromOptions(e.options);n.Subscriber.applyEvents(e.control,e.control._getInternalOption("parent"),t)}}function C(e,t,n){e.parent=e.parent||n&&n.control||t.parent||null,e.logicParent=e.logicParent||n&&n.control&&n.control.logicParent||t.logicParent||null}function w(e){return"function"===typeof e?e:e["constructor"]}A.DirtyKind={NONE:0,DIRTY:1,CHILD_DIRTY:2};var Y=[],G={plus:function(e,t){return{createdNodes:e.createdNodes.concat(t.createdNodes),destroyedNodes:e.destroyedNodes.concat(t.destroyedNodes),updatedNodes:e.updatedNodes.concat(t.updatedNodes),createdTemplateNodes:e.createdTemplateNodes.concat(t.createdTemplateNodes),updatedTemplateNodes:e.updatedTemplateNodes.concat(t.updatedTemplateNodes),updatedChangedNodes:e.updatedChangedNodes.concat(t.updatedChangedNodes),updatedChangedTemplateNodes:e.updatedChangedTemplateNodes.concat(t.updatedChangedTemplateNodes),updatedUnchangedNodes:e.updatedUnchangedNodes.concat(t.updatedUnchangedNodes),selfDirtyNodes:e.selfDirtyNodes.concat(t.selfDirtyNodes)}},zero:{createdNodes:[],destroyedNodes:[],updatedNodes:[],createdTemplateNodes:[],updatedTemplateNodes:[],updatedUnchangedNodes:[],updatedChangedNodes:[],updatedChangedTemplateNodes:[],selfDirtyNodes:[]}};function X(e,t){var n;for(n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}function Q(e){var t={};for(var n in e)if(e.hasOwnProperty(n))if(e[n]&&e[n].getVersion)t[n]=e[n].getVersion();return t}function h(e){return e&&e.internal?e.internal:{}}function v(e,t){return"object"===typeof e&&e&&t&&e.getVersion}function J(e,t,n,r,o){var i,a,s=false,l={},u,d;for(i in t){if(n&&i&&i.indexOf("__dirtyCheckingVars_")>-1)continue;if(u=t.hasOwnProperty(i)||o&&void 0!==t[i])if(d=e.hasOwnProperty(i)||void 0!==e[i]){if("function"===typeof e[i]&&"function"===typeof t[i]||"number"===typeof e[i]&&"number"===typeof t[i]&&isNaN(e[i])&&isNaN(t[i]))continue;if(e[i]===t[i]){if(v(e[i],r)){var c=e[i].getVersion();if(r[i]!==c)r[i]=c,s=true,l[i]=e[i];else if(Array.isArray(e[i])&&e[i])if(!e[i].isDataArray)s=true,l[i]=e[i]}}else if(Array.isArray(e[i])&&e[i])if(!e[i].isDataArray)s=true,l[i]=e[i];else{if(!t[i]){s=true,l[i]=e[i];continue}for(var f=0;f<e[i].length;f++){var p;if(J(h(e[i][f]),h(t[i][f]),false,r,o)){s=true,l[i]=e[i];break}}}else if(s=true,l[i]=e[i],v(e[i],r))r[i]=e[i].getVersion()}}return s?l:null}function i(e){return(e=e||[]).reduce(function(e,t){return e.concat(Array.isArray(t)?i(t):t)},[])}function T(e,t,n){var r;return{markupDecorator:o.composeWithResultApply.call(void 0,[n.getMarkupNodeDecorator()]).bind(e),defaultOptions:{}}}function Z(e,t,n){var r=e.parentControl?e.template.call(e.parentControl,e.controlProperties,e.attributes,e.context,true):e.template(e.controlProperties,e.attributes,e.context,true),o=[],i;if(!Array.isArray(r))r=[r];for(i=0;i<r.length;i++){var a=H.getFullMarkup(t,r[i],true);o=o.concat(Array.isArray(a)?a:[a])}for(i=0;i<o.length;i++)o[i]=H.mapVNode(n.getMarkupNodeDecorator(),t,o[i]);return r=o}function ee(e,t,n,r,o,i,a){var s=w(e),l=a&&a.compound,u=i&&i.state||{vdomCORE:true},d=t.user,c=t.internal||{},f;if(C(c,d,o),!n)n="_";if(l){if(!B)B=_;f=B.createCompoundControlNode(e,s,d,c,n,o,a)}else{var p=a&&a.invisible,h=u?X(d,u):d,v,m,y,g,N,b;if("function"===typeof e)y=(b=U.Compatible.createInstanceCompatible(s,h,c)).instance,h=b.resolvedOptions;else if(y=e,L.compat)if(h=U.Compatible.combineOptionsIfCompatible(s.prototype,h,c),y._setInternalOptions)y._options.doNotSetParent=true,y._setInternalOptions(c||{});v=Q(h),m=Q(N=a&&a.context||{}),g=T(y,s,r),f={attributes:t.attributes,events:t.events,control:y,errors:i&&i.errors,controlClass:s,options:h,internalOptions:c,optionsVersions:v,id:y._instId||0,parent:o,key:n,defaultOptions:g&&g.defaultOptions,markup:p?U.Vdom.textNode(""):void 0,fullMarkup:void 0,childrenNodes:Y,markupDecorator:g&&g.markupDecorator,serializedChildren:i&&i.childrenNodes,hasCompound:false,receivedState:void 0,invisible:p,contextVersions:m,context:a&&a.context||{},inheritOptions:a&&a.inheritOptions||{}},r.setupControlNode(f)}return f}function a(e){return t(e)}function te(n,r,o,i,a){if(o.receivedState&&o.receivedState.then)return o.receivedState.then(function e(t){return o.receivedState=t,s(n,r,o,i,a)},function(e){return U.Common.asyncRenderErrorLog(e),o.receivedState=null,s(n,r,o,i,a)});else return s(n,r,o,i,a)}function ne(e,t){if(!e)return;try{if(t.setRebuildIgnoreId(e.id),e.compound){var n=e.options,r=n.__vdomOptions&&n.__vdomOptions.controlNode.instance;if(r)j.default(function(){r.destroy()})}else{for(var o=0;o<e.childrenNodes.length;o++)ne(e.childrenNodes[o],t);if(e.control.__$destroyFromDirtyChecking=true,e.control.destroy(),e.control._logicParent&&e.control._logicParent._template&&e.control._options.name)delete e.control._logicParent._children[e.control._options.name]}}finally{t.setRebuildIgnoreId(e.id)}}function re(e){if(e.fullMarkup)e.fullMarkup.changed=true;if(e.parent&&e.parent.fullMarkup&&!e.parent.fullMarkup.changed)re(e.parent)}function oe(e,t){if(e.children)for(var n=0;n<e.children.length;n++)if(U.Vdom.isControlVNodeType(e.children[n]))t.push(e.children[n]);else if(U.Vdom.isTemplateVNodeType(e.children[n])||U.Vdom.isVNodeType(e.children[n]))oe(e.children[n],t)}function s(O,E,e,t,n){var r=e.id,o,i=E[r]||A.DirtyKind.NONE,a=i!==A.DirtyKind.NONE||t,s=!!(i&A.DirtyKind.DIRTY)||t,l=e.markup,u,d=false,y,V,c,f,p,h,v,m,g,N=[],b,_,C,w,T,k,D,M,P,x,I;if(a){if(x=(y=e).context,I=q.ContextResolver.resolveContext(y.controlClass,x,y.control),!y.compound){if(s&&y.control._mounted&&!t){try{y.control._beforeUpdate(y.options,I)}catch(e){K.catchLifeCircleErrors("_beforeUpdate",e)}try{u=y.control._shouldUpdate(y.options,I)}catch(e){K.catchLifeCircleErrors("_shouldUpdate",e)}s=s&&u}if(s){if(K.log("DirtyChecking",["requestRebuild "+r,y.control,y]),(V=y).control.saveFullContext(q.ContextResolver.wrapContext(y.control,y.context||{})),!y.inheritOptions)y.inheritOptions={};if(U.OptionsResolver.resolveInheritOptions(y.controlClass,y,y.options),y.control.saveInheritOptions(y.inheritOptions),y.markup=H.getDecoratedMarkup(y,n),c=H.getMarkupDiff(l,y.markup),K.log("DirtyChecking (diff)",["","",c]),c.destroy.length||c.vnodeChanged)re(y),d=true;while(c.createTemplates.length>0||c.updateTemplates.length>0){var S={create:[],createTemplates:[],destroy:[],destroyTemplates:[],update:[],updateTemplates:[]};p=c.createTemplates.map(function e(t){K.log("DirtyChecking (create template)",["","",t]),t.optionsVersions=Q(t.controlProperties),t.contextVersions=Q(t.context),t.children=Z(t,y,O);for(var n=0;n<t.children.length;n++){var r=H.getMarkupDiff(null,t.children[n]);S.create=S.create.concat(r.create),S.createTemplates=S.createTemplates.concat(r.createTemplates),S.update=S.update.concat(r.update),S.updateTemplates=S.updateTemplates.concat(r.updateTemplates)}return t}),c.createTemplates=S.createTemplates,c.updateTemplates=c.updateTemplates.concat(S.updateTemplates),S.createTemplates=[],S.updateTemplates=[],v=c.updateTemplates.map(function e(t){K.log("DirtyChecking (update template)",["","",t]);var n=t.newNode,r=t.oldNode,o=r.controlProperties,i,a=J(n.controlProperties,o,false,r.optionsVersions),s=r.attributes.attributes,l,u=J(n.attributes.attributes,s,false,{}),d=r.template!==n.template,c,f;if(a||u||d){K.log("DirtyChecking (update template with changed options)",["","",a]);var p=r.children;n.children=Z(n,y,O);var h=n.children.length>p.length?n.children.length:p.length;for(f=0;f<h;f++){var v=p[f],m=n.children[f];if(m)c=H.getMarkupDiff(v,m,true),S.create=S.create.concat(c.create),S.createTemplates=S.createTemplates.concat(c.createTemplates),S.update=S.update.concat(c.update),S.updateTemplates=S.updateTemplates.concat(c.updateTemplates),S.destroy=S.destroy.concat(c.destroy);else if(v)if(U.Vdom.isControlVNodeType(v))S.destroy.push(v);else if(U.Vdom.isTemplateVNodeType(v)||U.Vdom.isVNodeType(v))oe(v,S.destroy)}}else for(n.children=r.children,f=0;f<n.children.length;f++)c=H.getMarkupDiff(r.children[f],n.children[f],true),S.create=S.create.concat(c.create),S.createTemplates=S.createTemplates.concat(c.createTemplates),S.update=S.update.concat(c.update),S.updateTemplates=S.updateTemplates.concat(c.updateTemplates),S.destroy=S.destroy.concat(c.destroy);return n.optionsVersions=r.optionsVersions,n}),c.updateTemplates=S.updateTemplates,c.create=c.create.concat(S.create),c.destroy=c.destroy.concat(S.destroy),c.update=c.update.concat(S.update),c.createTemplates=c.createTemplates.concat(S.createTemplates)}if(_=c.destroy.map(function e(t){var n=t.controlNodeIdx,r=V.childrenNodes[n];return ne(r,O),r}),M=new Array(c.create.length+c.update.length),P=new Array(c.createTemplates.length+c.updateTemplates.length),D=c.update.length,p=[],v=[],f=c.create.map(function e(t,n){var r=D+n,o=V.serializedChildren,i=o&&o[r],a,s,l;if(K.log("DirtyChecking (create node)",["","",n,t]),d=true,!t.compound){if(a=t.controlProperties,!(l=ee(t.controlClass,{user:a,internal:t.controlInternalProperties,attributes:t.controlAttributes,events:t.controlEvents},t.key,O,V,i,t)).control._mounted&&!l.control._unmounted){if(s=U.Vdom.getReceivedState(l,t,z))l.receivedState=s;if(l.control.saveOptions)l.control.saveOptions(l.options,l);else if(l.control._options=l.options,l.control._container=l.element,l.control._setInternalOptions(t.controlInternalProperties||{}),L.compat)l.control._container=$(l.element)}if(L.compat&&(!l.control.hasCompatible||l.control.hasCompatible()))W(l)}else l=ee(t.controlClass,{user:X(t.controlProperties,t.controlInternalProperties),attributes:t.controlAttributes,events:t.controlEvents},t.key,O,V,i,t);return t.controlNodeIdx=r,M[t.controlNodeIdx]=true,l}),k=(h=c.update.map(function e(t,n){K.log("DirtyChecking (update node)",["","",t]);var r=t.newNode,o=t.oldNode.controlNodeIdx,i=V.childrenNodes[o],a=i.control,s=true,l=r.compound?U.Compatible.createCombinedOptions(r.controlProperties,r.controlInternalProperties):r.controlProperties,u=i.options,d=i.optionsVersions,c=r.context||{},f=i.context,p=i.contextVersions,h=J(l,u,r.compound,d),v=J(c,f,false,p),m=v?v:J(c,f,false,p,true),y=i.controlAttributes||i.attributes,g=J(r.controlAttributes,y,r.compound),N;if(r.compound){if(l.__vdomOptions=u.__vdomOptions,h){var b=u.__vdomOptions&&u.__vdomOptions.controlNode.instance;if(b&&!b.__$$blockSetProperties){var _=J(l,b._options||{},r.compound);if(_)b.__$$blockSetProperties=true,h=B.clearNotChangedOptions(h,_),b.setProperties(h),j.default(function(){b.__$$blockSetProperties=false})}}i.options=l}else if(N=J(r.controlInternalProperties,i.internalOptions),h||N||g||v)try{var C;K.log("DirtyChecking (update node with changed)",["","",h||N||g||v]),O.setRebuildIgnoreId(i.id),U.OptionsResolver.resolveInheritOptions(i.controlClass,i,l),a.saveInheritOptions(i.inheritOptions),C=q.ContextResolver.resolveContext(i.controlClass,c,i.control),a._beforeUpdate&&a._beforeUpdate(l,C),a._options=l,s=(a._shouldUpdate?a._shouldUpdate(l,C):true)||N,a._setInternalOptions(N||{}),i.oldOptions=u,i.oldContext=f,i.attributes=r.controlAttributes,i.events=r.controlEvents,a._saveContextObject(C),a.saveFullContext(q.ContextResolver.wrapContext(a,a._context))}finally{var w=a._shouldUpdate?a._shouldUpdate(l,c)||N:true;if(a._setInternalOptions(N||{}),w)O.setRebuildIgnoreId(null);if(i.options=l,i.context=c,!r.compound)i.internalOptions=r.controlInternalProperties}else if(m)for(var T=i.childrenNodes,k=0;k<T.length;k++)E[T[k].id]|=A.DirtyKind.CHILD_DIRTY;return M[n]=(!!h||!!N||!!v||!!g)&&s,r.controlNodeIdx=n,i.events=r.controlEvents,i})).concat(f),b=g=m=Y,h.forEach(function(e,t){if(M[t]){if(g===Y)g=[];g.push(e)}else{if(m===Y)m=[];m.push(e)}}),g.length||f.length)re(y),d=true;if(-1===k.indexOf(y)){if(b===Y)b=[];b.push(y)}}else k=e.childrenNodes,b=_=N=g=m=h=p=f=Y}else if(k=e.childrenNodes,b=_=N=g=m=h=p=f=Y,y.compound)y.parent.hasCompound=true;if((T=F.mapM(k,function(e,t){if(M&&M[t])re(e);return te(O,E,e,M&&M[t])},A.RebuildResultWriter)).then)return T.then(function(e){if(y.childrenNodes=e.value,d||!y.fullMarkup||y.fullMarkup.changed||s){var t=y.fullMarkup&&y.fullMarkup.changed;if(y.fullMarkup=O.decorateFullMarkup(H.getFullMarkup(y.childrenNodes,y.markup,void 0,d||s?void 0:y.fullMarkup),y),y.fullMarkup.changed=t||y.fullMarkup.changed||d||s,y.fullMarkup.changed)re(y)}return{value:y,memo:G.plus(e.memo,{createdNodes:f,updatedNodes:h,destroyedNodes:_,updatedChangedNodes:g,updatedChangedTemplateNodes:N,updatedUnchangedNodes:m,selfDirtyNodes:b,createdTemplateNodes:p,updatedTemplateNodes:v,destroyedTemplateNodes:C})}},function(e){return U.Common.asyncRenderErrorLog(e),e});else{if(y.childrenNodes=T.value,d||!y.fullMarkup||y.fullMarkup.changed||s){var R=y.fullMarkup&&y.fullMarkup.changed;if(y.fullMarkup=O.decorateFullMarkup(H.getFullMarkup(y.childrenNodes,y.markup,void 0,d||s?void 0:y.fullMarkup),y),y.fullMarkup.changed=R||y.fullMarkup.changed||d||s,y.fullMarkup.changed)re(y)}w={value:y,memo:G.plus(T.memo,{createdNodes:f,updatedNodes:h,destroyedNodes:_,updatedChangedNodes:g,updatedChangedTemplateNodes:N,updatedUnchangedNodes:m,selfDirtyNodes:b,createdTemplateNodes:p,updatedTemplateNodes:v,destroyedTemplateNodes:C})}}}else w={value:e,memo:G.zero};return w}A.RebuildResultWriter=F.createWriterMonad(G),A.createNode=ee,A.destroyReqursive=ne,A.rebuildNode=s}(_,e,y,R,L,m,H,b,m,v,P,h,p,k);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),z=K;e["Vdom/_private/Synchronizer/resources/DOMEnvironment"]=true;var B=function(){var e={},t=function(r,e,t,o,y,f,a,d,p,i,s,u,l,h,v,c,m,n,g){Object.defineProperty(e,"__esModule",{value:true});var N=t.checkAssertion,b=9,_=function e(t){return"SPAN"===t.tagName&&"warning-container"===t.getAttribute("id")&&t.nextElementSibling&&"BODY"===t.nextElementSibling.tagName},C=function e(t,n,r){if(_(t))t.setAttribute("data-vdomignore","true"),n=true;if(8===r)n=true;return n},w=function e(t){var n=t.nodeType,r=1===n&&t.getAttribute("data-vdomignore");return r||C(t,r,n)};function T(c){return function r(e,t,n,o,i,a){var s,l,u=c(e,t,n,o,i,a),d=u[2];if(-1!==(s=f(d,function e(t){var n;return t!==p.mapVNode(r,i,t)}))&&void 0!==s)l=d.slice(s).map(p.mapVNode.bind(self,r,i)),d=d.slice(0,s).concat(l),u=[u[0],u[1],d,u[3],u[4]];return u}}function k(e){function d(e){var t,n,r,o,i;if(e)if(i=(r=e.split(";")).length)for(o=0;o!==i;o++)if(2===(n=r[o].split(":")).length){if(!t)t={};t[n[0].trim()]=n[1].trim()}return t}function u(e){var t=e.attributes,n,r=t.length,o,i,a,s,l,u=null;for(n=0;n!==r;n++)if("key"===(a=t[n]).name)u=a.value;else if("style"===a.name)i=d(a.value);else{if(!o)o={};o[a.name]=a.value}if(s={properties:l={}},o)l.attributes=o;if(i)l.style=i;if(s.key=u,"input"===e.tagName.toLowerCase()){if(!l.attributes)l.attributes={};if(!l.attributes.hasOwnProperty("value"))l.attributes.value=void 0}return s}function c(e){var t=e.nodeType,n;if(!w(e))if(e.__WS={},1===t)return r(e);else if(3===t){if("\n"===e.data||""===e.data)return e.parentNode.removeChild(e),-1;return h.Vdom.textNode(e.nodeValue)}return null}function r(e){var t=e.tagName,n="http://www.w3.org/1999/xhtml"==e.namespaceURI?null:e.namespaceURI,r=u(e),o=[],i,a=e.childNodes.length;for(i=0;i!==a;i++){var s=c(e.childNodes[i]);if(-1===s)i--,a--;else if(s)o.push(s)}var l=r&&r.properties&&r.properties.attributes||{};return n=n||h.Common.getNamespace(l),v.GeneratorVdom.createTag(t.toLowerCase(),r.properties,o,{attributes:{"ws-creates-context":"true"}})}return c(e)}function O(e,t){return!(e&&t)}function E(e,t){return t.control}function V(e){return!e.reduce(O,true)}function D(e){return e.reduce(E,true)}function M(e){return(e=e.hasOwnProperty("length")?e[0]:e)===document.documentElement||e===document.body||null===e.offsetParent?false:document.body.contains(e)}function P(e){var t=e._container.length?e._container[0].controlNodes:e._container.controlNodes;for(var n in t)if(t[n].control===e)return t[n]}function x(e){var t;if(e)if(e&&!e._options)t="Control "+e._moduleName+" with name "+(e.getName&&e.getName())+" must have _options";if(t)y.resolve("ILogger").error("DOMEnvironment","Incorrect opener or parent is found! It seems that anybody set wrong opener option! "+t)}function I(e,t){var n=e.control;if(t[t.length-1]!==n)t.push(n);var r=n._options.opener||e.parent;if(r&&!r.control)if(r._container)x(r),r=P(r);else r=null;if(r)I(r,t);else if(x(r=n._options&&n._options.opener||n.getOpener&&n.getOpener()||n.getParent&&n.getParent()),r)S(r,t)}function S(e,t){if(t[t.length-1]!==e)t.push(e);var n=e._options&&e._options.opener||e.getOpener&&e.getOpener()||e.getParent&&e.getParent();if(x(n),n)if(n._template){var r;I((n._container.length?n._container[0]:n._container).controlNodes[0],t)}else S(n,t)}function R(e,t){if(t=t||[],e&&e.jquery)e=e[0];if(e)if(e.controlNodes&&e.controlNodes.length)I(e.controlNodes[0],t);else if(o.compat&&e.wsControl)S(e.wsControl,t);else R(e.parentNode,t);return t}function A(e,t){if(e&&e.length>0)for(var n=0;n<e.length;n++)if(t.id===e[n].id)return true;return false}var L=m.default.extend({constructor:function(e,t,n){if(N(e!==document,"Корневой контрол нельзя монтировать на document"),this._rootDOMNode=e,this._rootVNode=k(e),this._captureEventHandlers={},this._markupNodeDecorator=T(i.setEventHooks(this)),this.addCaptureProcessingHandler("focus",this._handleFocusEvent),this.addCaptureProcessingHandler("blur",this._handleBlurEvent),this.addCaptureProcessingHandler("mousedown",this._handleMouseDown),this.addCaptureProcessingHandler("click",this._handleClick),this.addCaptureProcessingHandler("touchstart",this._handleTouchstart),this.addCaptureProcessingHandler("touchmove",this._handleTouchmove),this.addCaptureProcessingHandler("touchend",this._handleTouchend),this._handleTabKey=this._handleTabKey.bind(this),this._clickState={detected:false,stage:"",timer:void 0,timeout:500,target:null,touchCount:0,timeStart:void 0},!a()&&"undefined"!==typeof window)document.body.tabIndex=0;m.default.call(this,t,n)},destroy:function(){this.removeTabListener(),this.removeCaptureEventHandler("focus"),this.removeCaptureEventHandler("blur"),this.removeCaptureEventHandler("mousedown"),this.removeCaptureEventHandler("click"),this.removeCaptureEventHandler("touchstart"),this.removeCaptureEventHandler("touchmove"),this.removeCaptureEventHandler("touchend"),this._rootDOMNode=void 0,this._rootVNode=void 0,this._captureEventHandlers={},this._handleTabKey=void 0,L.superclass.destroy.call(this)}}),F=L.prototype;function H(e){try{if(e.control._afterMount&&e.control._afterMount(e.options,e.context),e.control._mounted=true,e.control._$needForceUpdate)delete e.control._$needForceUpdate,e.control._forceUpdate()}catch(e){g.catchLifeCircleErrors("_afterMount",e)}}function U(e,t){e.forEach(function(e){if(e.childrenNodes&&e.childrenNodes.length>0)U(e.childrenNodes,t);if(~t.indexOf(e.id))if(!e.control._mounted&&!e.control._unmounted)if(e.hasCompound)d.default(function(){H(e)});else H(e);else try{e.control._afterUpdate&&e.control._afterUpdate(e.oldOptions||e.options,e.oldContext)}catch(e){g.catchLifeCircleErrors("_afterUpdate",e)}})}function q(e){var t=e.target._cachedValue,n=e.target.value;if(void 0!==t&&t!==n){if(c.isIE12)var r=new Event("change");else{var r;(r=document.createEvent("Event")).initEvent("change",true,true)}r._dispatchedForIE=true,e.target.dispatchEvent(r)}e.target._cachedValue=void 0}function j(e){if(c.isIE)e._cachedValue=e.value}function K(e){if(!e)return false;if(e.classList.contains("vdom-focus-in")||e.classList.contains("vdom-focus-out"))return false;return e.parentElement===document.body&&!e.firstChild||c.isIE&&e===document.body}function z(e,t,n){var r=R(e),o=R(t),i=r.find(function(e){return-1!==o.indexOf(e)});o.find(function(e){if(e!==i)return e._notify("deactivated",[{isTabPressed:!!n,isShiftKey:n&&n.isShiftKey}]),e._active=false;else return true}),r.find(function(e){if(e!==i)return e._notify("activated",[{_$to:r[0],isTabPressed:!!n,isShiftKey:n&&n.isShiftKey}]),e._active=true,false;else return true})}F._handleTabKey=function(e){if(!this._rootDOMNode)return;var t,n;if(e.keyCode===b)if(t=u.findWithContexts(this._rootDOMNode,e.target,!!e.shiftKey,u.getElementProps),this._isTabPressed={isShiftKey:!!e.shiftKey},setTimeout(function(){this._isTabPressed=null}.bind(this),0),t){if(t.wsControl&&t.wsControl.setActive)t.wsControl.setActive(true);else u.focus(t);e.preventDefault(),e.stopImmediatePropagation()}else{if(this._rootDOMNode.wsControl)n=this._rootDOMNode.wsControl._oldKeyboardHover(e);if(false!==n);else e.preventDefault(),e.stopImmediatePropagation()}},F.addTabListener=function(){if(this._rootDOMNode)this._rootDOMNode.addEventListener("keydown",this._handleTabKey,false)},F.removeTabListener=function(){if(this._rootDOMNode)this._rootDOMNode.removeEventListener("keydown",this._handleTabKey)},F.autofocusChanges=function e(t){function o(e,t){var n;if(A(e.controlNodes,t))return e;if(e.children&&e.children.length>0){n=e.children;for(var r=0;r<n.length;r++)if(n[r].controlNodes){if(A(n[r].controlNodes,t))return i=n[r];o(n[r],t)}}return i}function n(e){var t=u.getElementProps(e);return t.tabStop="true"===e.getAttribute("ws-autofocus"),t}var i,r,a=t.control,s=t.environment,l;if(a.__$focusing&&s._rootDOMNode){if(i=o(s._rootDOMNode,t))if(r=u.findFirstInContext(i,void 0,n))u.focus(r);else u.focus(i);a.__$focusing=false}},F._handleFocusEvent=function e(t){if(j(t.target),this._rootDOMNode&&l.Focus.closest(t.target,this._rootDOMNode)&&!K(t.target)){var n=!K(t.relatedTarget)&&t.relatedTarget||this._savedFocusedElement;if(this._savedFocusedElement=t.target,z(t.target,n,this._isTabPressed),o.compat&&this._rootDOMNode&&this._rootDOMNode.controlNodes)if(this._rootDOMNode.controlNodes[0]&&this._rootDOMNode.controlNodes[0].control.isActive)if(this._rootDOMNode.controlNodes[0].control.isActive())this._rootDOMNode.controlNodes[0].control._callOnFocusInside();else r("Lib/Control/AreaAbstract/AreaAbstract.compatible")._storeActiveChildInner.apply(this._rootDOMNode.controlNodes[0].control);this._focused=true}ae.call(this,t)},F._handleBlurEvent=function e(t){var n,r;if(c.isIE)if(q(t),null===t.relatedTarget)r=document.body;if(n=t.target,r=r||t.relatedTarget,!a()&&r){var o,i;if(!R(r).find(function(e){return e._template}))z(null,n,this._isTabPressed)}ae.call(this,t)},F._handleMouseDown=function e(t){var n=t.target,r=document.documentElement;while(n!==r)if(n["ws-no-focus"]||n.getAttribute("ws-no-focus")){t.preventDefault();break}else n=n.parentNode;ae.call(this,t)};var B=[];function W(e,t){while(e.parentNode)if((e=e.parentNode)===t)return true;return false}function Y(e){if(!this._rootDOMNode)return;var t=e.relatedTarget||document.body,n=e.target,r=document.createEvent("Events");r.initEvent("keydown",true,true);var o=false;if("vdom-focus-in"===n.className)if(W(t,this._rootDOMNode))o=true;if("vdom-focus-out"===n.className)if(!W(t,this._rootDOMNode))o=true;r.view=window,r.altKey=false,r.ctrlKey=false,r.shiftKey=o,r.metaKey=false,r.keyCode=9,n.dispatchEvent(r)}F._handleClick=function e(t){if(this._shouldUseClickByTap())if(B.indexOf(t.target)>-1)B.splice(B.indexOf(t.target),1);if(2===t.button)return void t.stopPropagation();var n=window.getSelection?window.getSelection():null,r=n&&n.toString().length&&t.target.contains(n.focusNode),o=window.getComputedStyle?"none"===window.getComputedStyle(t.target)["user-select"]:true;if(r&&!o)return void t.stopPropagation();ae.call(this,t)},F._handleTouchstart=function e(t){if(this._shouldUseClickByTap())B.push(t.target);n.initSwipeState(t),ae.call(this,t)},F._handleTouchmove=function e(t){if(this._shouldUseClickByTap())if(this._clickState.touchCount++,this._clickState.touchCount>3)B.splice(B.indexOf(t.target),1);n.detectSwipe(t),ae.call(this,t)},F._handleTouchend=function e(t){if(this._shouldUseClickByTap())this._clickState.touchCount=0,setTimeout(function(){if(B.indexOf(t.target)>-1)t.target.click()},this._clickState.timeout);n.resetSwipeState(),ae.call(this,t)},F._shouldUseClickByTap=function e(){return o.browser.retailOffline||o.compatibility.touch&&o.browser.chrome&&navigator&&navigator.userAgent.indexOf("Windows")>-1};var G=function(t){this.fireTab=function(e){Y.call(t,e)}};function X(e){if(!Array.isArray(e))return null;return e.find(function(e){return!!e})}function Q(e,t){var n=X(t.children);if(n&&"vdom-focus-in"!==n.key){var r=h.Vdom.htmlNode("a",{attributes:{class:"vdom-focus-in",tabindex:"1"},focusHook:new G(e)},[],"vdom-focus-in"),o=h.Vdom.htmlNode("a",{attributes:{class:"vdom-focus-out",tabindex:"0"},focusHook:new G(e)},[],"vdom-focus-out");return t.children=[].concat(r,t.children,o),true}return false}function J(e,t){return Array.prototype.filter.call(e.children,function(e){return e.matches(t)})}function Z(e){var t=e.firstChild;if(t&&t.classList&&!t.classList.contains("vdom-focus-in")){var n=J(e,".vdom-focus-in"),r=J(e,".vdom-focus-out"),o=n.length?n[0]:document.createElement("a");o.classList.add("vdom-focus-in"),o.tabIndex=1;var i=r.length?r[0]:document.createElement("a");return i.classList.add("vdom-focus-out"),i.tabIndex=0,e.insertBefore(o,t),e.appendChild(i),true}return false}function ee(e,t){return e&&e.args&&e.args.length===t.length}function te(e,t,n){return e&&e.events&&e.events[t]&&e.events[t][n]}function ne(t,e,n,r,o){var i,a=false,s="on:"+t.type.toLowerCase(),l,u,d,c,f,p;if(o)l=t.target===window||t.target===document?document.body:t.target;else l=e.element;l=o?l:e.element;while(!a){if((i=l.eventProperties)&&i[s])for(var h=n;h<i[s].length&&!a;h++){u=i[s][h].fn,d=i[s][h].args,f=ee(te(e,s,h),d)?e.events[s][h].args:d;try{if(!r.concat)throw new Error("Аргументы обработчика события "+s.slice(3)+" должны быть массивом.");if(p=f.concat(r),p=[t].concat(p),t.currentTarget=l,!u.control._destroyed&&(!e||u.control!==e.control))u.apply(u.control,p);if(p=[],t.currentTarget=void 0,!t.propagating()){var v;if(!(!t.isStopped()&&i[s][h+1]&&(i[s][h+1].toPartial||i[s][h+1].fn.controlDestination===i[s][h].fn.controlDestination)))a=true}}catch(e){var m;if(!u.control){if("undefined"!==typeof window)window["console"].error("Error calculating the logical parent for the function ",u);m=new Error(t.type+" event handle error")}else m=new Error(t.type+" event handle error in "+u.control._moduleName);y.resolve("ILogger").error(l,m,e)}if(c=t.result,!e||!e.control._destroyed)if(c&&c.then)c.then(function(t){return function(e){return t.control._forceUpdate(),e}}(u));else u.control._forceUpdate();c=void 0}if(null===(l=l.parentNode)||void 0===l||!t.propagating())a=true;if(0!==n)n=0}}function re(e,t){var n=e.element.eventProperties,r=e.element.controlNodes,o=0,i=0,a="on:"+t,s=true,l;if(n&&n[a]){l=n[a][0].fn.control;while(s&&i<r.length){if(r[i].control===l)if(++o<n[a].length)l=n[a][o].fn.control;if(r[i].control===e.control)s=false;i++}}return o}function oe(e,t){function n(e){return"text"===e.type||"password"===e.type}if(!e._rootDOMNode)return false;else if(!(t.currentTarget===window&&"scroll"===t.type||t.currentTarget===window&&"resize"===t.type)&&1!==t.eventPhase)return false;else if(c.isIE&&"change"===t.type&&!t._dispatchedForIE&&n(t.target))return false;else if(!ie(e,t))return false;return true}function ie(e,t){var n=t.target;if(n===window||n===document)return true;while(n){if(n===e._rootDOMNode)return true;if(n.controlNodes&&n.controlNodes[0]&&n.controlNodes[0].environment===e)return true;else if(n.controlNodes&&n.controlNodes[0]&&n.controlNodes[0].environment!==e)return false;if(n===document.body)n=document.documentElement;else if(n===document.documentElement)n=document;else n=n.parentNode}return false}function ae(e){if(oe(this,e)){var t;ne(new s.default(e),null,0,[],true)}}G.prototype.hook=function(e){e.addEventListener("focus",this.fireTab)},G.prototype.unhook=function(e){e.removeEventListener("focus",this.fireTab)},F.applyNewVNode=function(e,t,n){if(!this._rootDOMNode)return;var r=this.decorateRootNode(e),o,i,a,s;if("HTML"!==this._rootDOMNode.tagName){if(r&&Q(this,r))if(this._rootVNode&&Q(this,this._rootVNode))Z(this._rootDOMNode)}else if(r&&r.children[1]){var l=r.children[1];if(this._rootVNode&&Q(this,l)){var u=this._rootDOMNode.getElementsByTagName("body");if(u.length)Z(u=u[0])}}if(this._rootDOMNode.isRoot=true,a=this._rootVNode?h.Vdom.render(r,this._rootDOMNode,true,true):null,this._rootVNode=r,o=V([n])){if(i=D([n]),s)i._container=window.$?$(s):s;d.default(function(){n.environment._haveRebuildRequest=false,i.reviveSuperOldControls&&i.reviveSuperOldControls(),U([n],t),n.environment._rebuildRequestStarted=false,n.environment.runQueue()})}else n.environment._haveRebuildRequest=false,U([n],t),n.environment._rebuildRequestStarted=false,n.environment.runQueue();return a},F.decorateFullMarkup=function(e,t){if(Array.isArray(e))e=e[0];return p.mapVNode(i.setControlNodeHook(t),t,e,true)},F.getMarkupNodeDecorator=function(){return this._markupNodeDecorator},F.getDOMNode=function(){return this._rootDOMNode},F.runQueue=function(){if(this.queue)for(var e=0;e<this.queue.length;e++)this.forceRebuild(this.queue[e]);this.queue=null,this.queueIds={}},F.startEvent=function(e,t){var n=t[0].toLowerCase(),r=t[1]||[],o=t[2],i={},a;if(i._bubbling=o&&void 0!==o.bubbling?o.bubbling:false,i.type=n,i.target=e.element,!i.target){if(!(e.fullMarkup instanceof l.RawMarkupNode)&&!(e.fullMarkup&&"invisible-node"===e.fullMarkup.type))y.resolve("ILogger").error("Event "+n+" has emited before mounting to DOM");return}return ne(a=new s.default(null,i),e,re(e,n),r,false),a.result},F.addCaptureEventHandler=function(e,t){var n=this._captureEventHandlers;if(this._rootDOMNode.parentNode)if(t.tagName&&"body"===t.tagName.toLowerCase()&&("scroll"===e||"resize"===e))if(void 0===n[e+"body"])n[e+"body"]={handler:ae.bind(this),count:1},window.addEventListener(e,n[e+"body"].handler);else n[e+"body"].count++;else if(void 0===n[e]){n[e]={handler:ae.bind(this),count:1};var r=l.Event.fixUppercaseDOMEventName(e);this._rootDOMNode.parentNode.addEventListener(r,n[e].handler,true)}else n[e].count++},F.addCaptureProcessingHandler=function e(t,n){var r=this._captureEventHandlers;if(void 0===r[t]){if(this._rootDOMNode.parentNode)r[t]={handler:function(e){if(!ie(this,e))return;n.apply(this,arguments)}.bind(this),count:1},this._rootDOMNode.parentNode.addEventListener(t,r[t].handler,true)}else r[t].count++},F.removeCaptureEventHandler=function(e,t){var n=this._captureEventHandlers;if(t&&t.tagName&&"body"===t.tagName.toLowerCase()&&("scroll"===e||"resize"===e)){if(n[e+"body"].count--,0===n[e+"body"])window.removeEventListener(e,n[e+"body"].handler)}else{var r=n[e];if(r)if(r.count--,0===r.count){if(this._rootDOMNode.parentNode)this._rootDOMNode.parentNode.removeEventListener(e,r.handler,true);delete n[e]}}},F._canDestroy=function(t){return!this._rootDOMNode||!this._rootDOMNode.controlNodes||!this._rootDOMNode.controlNodes.find(function(e){return!e.parent&&e.control!==t})},L._goUpByControlTree=R,e.default=L}(_,e,f,y,C,s,a,P,H,E,w,q,m,b,i,u,I,D,p);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),W=B;e["Vdom/_private/Synchronizer/resources/Debug"]=true;var Y=function(){var e={},t=function(e,t,i,p,u,h,a){Object.defineProperty(t,"__esModule",{value:true});var s=20,v={0:"NONE",1:"VTEXT",2:"VNODE",3:"WIDGET",4:"PROPS",5:"ORDER",6:"INSERT",7:"REMOVE",8:"THUNK",VirtualNode:"VirtualNode"};function m(e,r){var s=/["'&<>]/,n={area:true,base:true,br:true,col:true,embed:true,hr:true,img:true,input:true,keygen:true,link:true,meta:true,param:true,source:true,track:true,wbr:true};function t(e){var t=""+e,n=s.exec(t);if(!n)return t;var r,o="",i,a=0;for(i=n.index;i<t.length;i++){switch(t.charCodeAt(i)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#39;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}if(a!==i)o+=t.substring(a,i);a=i+1,o+=r}return a!==i?o+t.substring(a,i):o}var o=a(function(e){return t(e)+'="'});function i(e){return(e=void 0!==e&&null!==e?e.toString():"").replace('"',"&quot;")}function l(e,t,n){if(n){if(null==t)return"";return o(e)+i(t)+'"'}return null}function a(t){var n={};return function(e){if(n.hasOwnProperty(e))return n[e];else return n[e]=t.call(this,e)}}function u(e){if(!e)return"";if(p.Vdom.isControlVNodeType(e))return h.getMarkupGenerator(false).createWsControl(e.controlClass,e.controlProperties,{internal:e.controlInternalProperties,attributes:e.controlAttributes,events:e.controlEvents,key:e.key,context:e.context,inheritOptions:e.inheritOptions},r);if(p.Vdom.isTemplateVNodeType(e))return h.getMarkupGenerator(false).createTemplate(e.template,e.attributes&&e.controlProperties,e.attributes,r);else if(p.Vdom.isVNodeType(e))return d(e)+c(e)+f(e);else if(p.Vdom.isTextNodeType(e))return String(e.children);else if(Array.isArray(e)){for(var t="",n=0;n<e.length;n++)t+=u(e[n]);return t}else if("string"===typeof e)return e;return""}function d(e){var t=e.hprops,n="<"+e.type.toLowerCase(),r,o,i,a;for(i in r=t["attributes"])if(r.hasOwnProperty(i)&&null!==r[i]&&void 0!==r[i]&&""!==r[i])n+=" "+l(i,r[i],true);for(a in o="",r=t["style"])if(r.hasOwnProperty(a)&&null!==r[a])o+=a+": "+r[a]+";";if(""!==o)n+=" "+l("style",o,true);return n+">"}function c(e){var t=e.properties&&e.properties.innerHTML;if(t)return t;else{var n="",r=e.children,o=r&&r.length||0,i,a;for(i=0;i!==o;i++)n+=u(a=r[i]);return n}}function f(e){var t=e.type.toLowerCase();return n[t]?"":"</"+t+">"}return u(e)}function y(n){return function(){var e=Date.now(),t;return{value:n.apply(this,arguments),time:Date.now()-e}}}function g(n,e){function t(e,t){if(t.length){console.group(e);try{t.forEach(function(e){N(n,e)})}finally{console.groupEnd()}}}var r=e.createdNodes.slice(0,s),o=e.updatedChangedNodes.slice(0,s),i=e.updatedUnchangedNodes.slice(0,s),a=e.destroyedNodes.slice(0,s);console.log("------------------"),t("Созданы",r),t("Обновлены - изменены по опциям",o),t("Обновлены - не изменены",i),t("Удалены",a)}function l(e,t,n){var r,o=[];if(p.Vdom.isControlVNodeType(n))N(e,n.controlNode);else{if(r=[p.Vdom.isVNodeType(n)?n.tagName:p.Vdom.isTextNodeType(n)?n.text:"???"],void 0!==n.key)r.push[n.key];if(o=[r.join("/")],p.Vdom.isVNodeType(n))o.push(a(n.properties)?"":n.properties);if(t){console.group.apply(console,o);try{i.getVNodeChidlren(n).forEach(l.bind(void 0,e,t))}finally{console.groupEnd()}}else console.log.apply(console,o)}}function N(e,t){var n=t.control,r=n.get("name"),o=t.markup,i,a=e[t.id]||u.DirtyKind.NONE,s=a===u.DirtyKind.NONE?[]:a===u.DirtyKind.DIRTY?["D"]:["C"],l;if(l=(r?[r]:[]).concat([n.describe()]),void 0!==t.key)l.push(t.key);l=l.concat(s),console.log(l.join("/"),t.id,n.getRawData())}function d(r,e,o,t,n,i){for(var a in n=n||{})if(n.hasOwnProperty(a)){var s=n[a],l,u=y(m.bind(void 0,s.value.a))(),d={};for(var c in s.value)if(s.value.hasOwnProperty(c)){var f=s.value[c],p="type"in f?v[f.type]:"????";if(p)d[p]=d.hasOwnProperty(p)?d[p]+1:1}console.group("PATCH: time = "+s.time,true),console.log(d,s.value),console.log("toHTML: time = ",u.time,u.value.length),console.groupEnd()}if(!i.silent&&e)e.forEach(function(e,t){var n=o[t];console.groupCollapsed("Старое",t);try{N(r,e)}finally{console.groupEnd()}console.groupCollapsed("Новое",t);try{N({},n)}finally{console.groupEnd()}}),g(r,t)}function n(r,o){return function(){var e=Date.now(),t,n;try{n=r.call(this,y)}finally{if(t=Date.now()-e,n)d(n.dirties,n.oldRoots,n.newRoots,n.rebuildChanges,n.applyResults,o);console.log("Время перестроения - ",t)}return n}}t.vdomToHTML=m,t.logRebuildChanges=g,t.logVNode=l,t.logControlNode=N,t.logRebuild=d,t.withLogRebuild=n}(_,e,H,b,K,N,g);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),G=Y;e["Vdom/_private/Utils/DefaultOpenerFinder"]=true;var X,Q=function(){var e={},t=function(e,t,r,o,n){Object.defineProperty(t,"__esModule",{value:true});var i=n.default._goUpByControlTree;function a(e){var t,n;if(r.instanceOfModule(e,"Core/Control"))t=e._container;else if(e instanceof Element)t=e;else o.resolve("ILogger").error("DOMEnvironment",rk("The arguments should be control or node element"));return i(t).find(function(e){return e._options.isDefaultOpener})}t.find=a}(_,e,d,C,B);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Vdom/_private/Synchronizer/Synchronizer"]=true;var J,Z=function(){var e={},t=function(o,e,t,c,f,p,n,i,h,v,m,a){var s;Object.defineProperty(e,"__esModule",{value:true});var l=50,u=2,d=false;if(d)s=t;function y(e,t){var n=e.parent;while(n)t(n),n=n.parent}function g(e,n){return e.map(function(t){var e=n.filter(function(e){return t.id===e.id});if(e.length)return e[0];return t})}function N(e){return e.control&&e.control._parent&&e.control._parent.isDestroyed&&e.control._parent.isDestroyed()}function b(e){if("[object String]"===Object.prototype.toString.call(e))return o(e);return e}function _(e){return e.map(function e(t){return t.id})}var C=[],w=[],T={},k={},r={_rebuild:function(){function e(l){var u=k;if(0===Object.keys(u).length)return{dirties:u,oldRoots:C,newRoots:C,rebuildChanges:null,applyResults:null};k={},C.splice(w.length);var d=C,e=c.mapM(d,function e(t,n){return t.requestDirtyCheck=O.bind(t),f.rebuildNode(w[n],u,t,void 0,true)},f.RebuildResultWriter,this);if(e.then)e.then(function(e){var n=e.value.filter(function(e){if(N(e))return false;return true}),t=e.memo,r=_(n),o={createdNodes:true,updatedChangedNodes:true,selfDirtyNodes:true,createdTemplateNodes:true,updatedChangedTemplateNodes:true},i;for(var a in o)if(t[a].length>0)r=r.concat(_(t[a]));r=h(r);var s=function(e,t){return n[t]&&n[t].fullMarkup?e.applyNewVNode(n[t].fullMarkup,r,n[t]):null};if(l)s=l(s);if(t.createdNodes.forEach(function(e){e.requestDirtyCheck=O.bind(e),T[e.id]=e},this),t.destroyedNodes.forEach(function(e){delete T[e.id]},this),i=w.map(s),C.length>n.length)C=g(C,n);else C=n;return{dirties:u,oldRoots:d,newRoots:n,rebuildChanges:t,applyResults:i}},function(e){return m.Common.asyncRenderErrorLog(e),e});else{var n=e.value.filter(function(e){return-1!==w.indexOf(e.environment)}),t=e.memo,r=_(n).map(function(e){return u[e]&f.DirtyKind.DIRTY?e:void 0}),o={createdNodes:true,updatedChangedNodes:true,selfDirtyNodes:true,createdTemplateNodes:true,updatedChangedTemplateNodes:true},i;for(var a in o)if(t[a].length>0)r=r.concat(_(t[a]));r=h(r);var s=function(e,t){return n[t]&&n[t].fullMarkup?e.applyNewVNode(n[t].fullMarkup,r,n[t]):null};if(l)s=l(s);return t.createdNodes.forEach(function(e){e.requestDirtyCheck=O.bind(e),T[e.id]=e},this),t.destroyedNodes.forEach(function(e){delete T[e.id]},this),i=w.map(s),{dirties:u,oldRoots:d,newRoots:C=n,rebuildChanges:t,applyResults:i}}}var t=d?s.withLogRebuild(e,{silent:true}):e,n;for(n=0;n!==l;n++)if(t.call(this),i(k))break;if(n===l){var r;for(a.setLoggerStatus(true,true),r=1;r<=u;r++)a.log("MAX_REBUILD error",["Logged iteration "+r]),t.call(this);throw a.setLoggerStatus(false,true),new Error("SBIS3.CORE.VDOM.Synchronizer: i === MAX_REBUILD")}},controlStateChangedCallback:function(e){r.requestRebuild(e)},mountControlToDOM:function(a,s,l,u,e){u=u[0]?u[0]:u;var t,d=e||{},c=u.getAttribute("data-component-root-id"),n=c&&window.vdomJsModules[c];if(!e)d["data-component"]=u.getAttribute("data-component");s=b(s);var r=function e(){var n,t,r,o=new v,i;if(t=new p.default(u,this.controlStateChangedCallback,d,c),(n=f.createNode(a,{user:l},void 0,t,null,r)).requestDirtyCheck=O.bind(n),d)n.attributes=d;if(T[n.id]=n,w.push(t),C.push(n),n.control._saveEnvironment(t,n),!a._mounted&&!a._unmounted&&!a._beforeMountCalled)i=m.Vdom.getReceivedState(n,{controlProperties:l,controlClass:s},o);if(n["element"]=u,n.control.saveOptions)n.control.saveOptions(n.options,n);else n.control._options=n.options,n.control._container=$(n.element);if(i)i.then(function e(t){return n.receivedState=t,this.requestRebuild(n.id),t}.bind(this),function e(t){return m.Common.asyncRenderErrorLog(t),t});else this.requestRebuild(n.id)}.bind(this);if(t=w.some(function(e){return e instanceof p.default&&e.getDOMNode()===u}))throw new Error("На этом DOM-элементе уже есть смонтированный корневой компонент");if(n&&n.length>0)o(n,r);else r()},cleanControlDomLink:function(e){if(!e)return;var t=e[0]?e[0]:e;if(t.controlNodes)for(var n=0;n<t.controlNodes.length;n++)if(!t.controlNodes[n].control||t.controlNodes[n].control._destroyed)if(delete T[t.controlNodes[n].id],t.controlNodes.length>0)if(t.controlNodes.length>1||!t.controlNodes[0].parent)t.controlNodes.splice(n,1),n--},unMountControlFromDOM:function e(t,n){for(var r=n[0]?n[0]:n,o,i,a=C.length-1;a>=0;a--){var s=C[a].environment._rootDOMNode;if(r===s&&C[a].environment._canDestroy(t)||!s){var l=C[a].id,u=w.splice(a,1)[0];if(T[l])i=T[l],delete T[l];if(C.splice(a,1),r===s)o=u;else u.destroy()}}if(o){if(!t._destroyed)t.destroy();if(i)f.destroyReqursive(i,o);t._mounted=false,t._unmounted=true,o.destroy()}},queue:null,requestRebuild:function(e){var r=T[e],t=k,o=this;if(r&&!r.environment._rebuildRequestStarted){if(t[e]|=f.DirtyKind.DIRTY,y(r,function(e){t[e.id]|=f.DirtyKind.CHILD_DIRTY}),!r.environment._haveRebuildRequest)r.environment._haveRebuildRequest=true,n.default(function e(){if(r.environment._rebuildRequestStarted=true,this._savedActiveElement!==document.activeElement){var t=document.activeElement;while(t&&t.parentElement){if(t.controlNodes&&t.controlNodes[0]){this._savedControlNode=t.controlNodes[0];break}t=t.parentElement}}var n;if(this._savedActiveElement=document.activeElement,o._rebuild(),r.environment.addTabListener(),r.control.__$focusing)n=r;if(n)r.environment.autofocusChanges.call(this,n)}.bind(this))}else if(r&&r.environment){if(!r.environment.queue)r.environment.queue=[];if(!r.environment.queueIds)r.environment.queueIds={};if(!r.environment.queueIds[e])r.environment.queue.push(e);r.environment.queueIds[e]=1}},setDebugMode:function(e){d=e}};function O(){r.requestRebuild(this.id)}e.default=r}(_,e,Y,R,K,B,P,g,l,h,b,p);if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();function ee(e,t){C.resolve("ILogger").warn("Vdom/Vdom",'"'+e+'" wrapper is deprecated and will be removed. Require '+'"Vdom/Vdom" and use '+t+" from it instead.")}return e.Debug=G,e.DirtyChecking=z,e.DirtyCheckingCompatible=O,e.Hooks=V,e.SwipeController=M,e.TabIndex=j,e.VdomMarkup=U,e.DefaultOpenerFinder=Q,e.Focus=n,e.Functional=F,e.Monad=A,e.Synchronizer=Z.default,e.DOMEnvironment=W.default,e.Environment=S.default,e.runDelayedRebuild=x.default,e.SyntheticEvent=T.default,e.logDeprecatedWrapper=ee,e});