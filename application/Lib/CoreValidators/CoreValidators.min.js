define("Lib/CoreValidators/CoreValidators",["Lib/Control/Control","Core/core-instance"],function(n,l){"use strict";var f,h=/^([0-9A-Z]+)$/,o=/^([0-9]+)$/;function u(r,t,e){for(var n=0,u=t,i=r.length,a=0;a<i-1;a++,u++){if(0===(u%=e+1))u++;n+=parseInt(r.charAt(a),10)*u}return n%11}function g(r){if(void 0===r||null===r||""===r)return"";return r}return f={required:function(){var r=this.getText?this.getText():this.getValue();if(l.instanceOfModule(r,"Deprecated/Enum"))r=r.getCurrentValue();if(void 0===r||null===r||""===r)return rk("Поле обязательно для заполнения");return true},kpp:function(r){var t,e=(this.getParentWindow()||this.getTopParent()).getChildControlByName(r);if(true===f.inn.call(e)){var n=e.getValue()+"";if(10==n.length){var u=this.getValue()||"",i=u.substr(0,4),a=u.substr(4,2),s=u.substr(6,3);if(l.instanceOfModule(u,"Deprecated/Enum"))u=u.getCurrentValue();return 9==(""+u).length&&o.test(i)&&h.test(a)&&o.test(s)||!(u+"").length?true:rk("КПП должен состоять из 9 символов:")+" "+rk("1-4 и 7-9 должны быть цифрами, 5-6 могут быть цифрами или заглавными латинскими буквами")}else if(12==n.length)return true!==f.required.call(this)?true:rk("КПП не должен быть заполнен");else return true}else return true},kppAtPlace:function(r){var t,e=this.getLinkedContext().getRecord().get(r);if(f.innCheckValue(e))if(10==e.length){var n=this.getValue();return/^([0-9]+)$/.test(n)&&9==(""+n).length||!(n+"").length?true:rk("КПП должен состоять из 9 цифр")}else if(12==e.length)if(!n)return rk("КПП не должен быть заполнен");return true},innCheckSum:function(){var r=g(this.getValue());return f.innCheckValue(r)},innCheckValue:function(r){if(""===r)return true;if("000000000000"===r||"0000000000"===r)return rk("ИНН не может состоять из одних нулей");var t=[3,7,2,4,10,3,5,9,4,6,8],e=r.toString(),n=0,u,i;if(12===e.length){for(u=0,i=1;u<10;u++,i++)n+=e.charAt(u)*t[i];if(n%11%10==e.charAt(10)){for(i=u=n=0;u<11;u++,i++)n+=e.charAt(u)*t[i];if(n%11%10==e.charAt(11))return true}}else if(10===e.length){for(u=0,i=2;u<9;u++,i++)n+=e.charAt(u)*t[i];if(n%11%10==e.charAt(9))return true}else return true;return rk("Неверная контрольная сумма ИНН")},inn:function(r){r=parseInt(r,10)||0;var t=g(this.getValue());if(""===t)return true;var e=(""+t).length,n,u;if(!/^([0-9]+)$/.test(t)||!(r>0?(""+t).length==r:10===e||12===e))return rk("ИНН должен состоять из")+" "+(r>0?r:rk("10 или 12"))+" "+rk("цифр");return f.innCheckSum.apply(this)},email:function(){var r=g(this.getValue());if(""===r)return true;if(/^[a-z0-9+_][-a-z0-9+_]*(\.[-a-z0-9+_]+)*@([a-z0-9]([-a-z0-9]{0,61}[a-z0-9])?\.)+([a-z]{1,10})$/i.test(r))return true;if(/^(([a-z0-9+_][-a-z0-9+_]*(\.[-a-z0-9+_]+)*)|([-а-яё0-9+_]+(\.[-а-яё0-9+_]+)*))@([а-яё0-9]([-а-яё0-9]{0,61}[а-яё0-9])?\.)+([а-яё]{1,10})$/i.test(r))return true;return rk("В поле требуется ввести адрес электронной почты")},inRange:function(r,t){var e=g(this.getValue());if(""===e)return true;r=parseFloat(r),t=parseFloat(t);var n=isNaN(r)?e:r,u=isNaN(t)?e:t;return!isNaN(parseFloat(e))&&isFinite(e)&&e>=n&&e<=u?true:rk("Значение должно попадать в диапазон [")+(isNaN(r)?"*":r)+";"+(isNaN(t)?"*":t)+"]"},length:function(r,t){var e=this.getStringValue()||"";if(""===e)return true;r=parseInt(r,10),t=parseInt(t,10);var n=e.length,u=isNaN(r)?n:r,i=isNaN(t)?n:t;return n>=u&&n<=i?true:rk("Длина должна попадать в указанный диапазон [")+(isNaN(r)?"*":r)+";"+(isNaN(t)?"*":t)+"]"},url:function(){var r=g(this.getValue());if(""===r)return true;return/^(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/i.test(r)?true:rk("Должен быть указан корректный URL")},compare:function(r){var t=this.getStringValue()||"",e;try{e=n.ControlStorage.getByName(r).getStringValue()||""}catch(r){return false}return t===e?true:rk("Значение поля должно совпадать с полем '")+r+"'"},okpo:function(){var r=g(this.getValue()).trim(),t,e,n;if(""===r)return true;if(8!=(t=r.length)&&14!=t&&10!=t)return rk("ОКПО должен содержать 8 или 14 цифр. ОКПО для ИП должен содержать 10 цифр.");if(14==t)r=r.substr(0,8),t=8;if(e=parseInt(r.charAt(t-1),10),10===(n=u(r,1,10)))n=u(r,3,10);if(10===n)n=0;if(n!==e)return rk("Неверная контрольная сумма ОКПО");return true},ogrn:function(r,t){var e=g(this.getValue()).trim(),n,u,i,a,s,l=parseInt(e,10).toString().length,f=[1,2,3,5],h=false;if(""===e)return true;if(n=e.length,t=t||(15==r?rk("ОГРНИП"):rk("ОГРН")),r&&n!=r||!r&&13!==n&&15!==n)return t+" "+rk("должен состоять из")+" "+(r||rk("13 или 15"))+" "+rk("цифр");if(s=parseInt(e.charAt(0),10),u=parseInt(e.charAt(n-1),10),a=(i=parseInt(e.substr(0,n-1),10)%(l-2))%10,h=-1!==f.indexOf(s),a!==u||!h)return rk("Неверная контрольная сумма")+" "+t;return true},snils:function(){var r=g(this.getValue());if(""===r)return true;if(11!==r.length)return rk("СНИЛС должен состоять из 11 цифр");if(!/^[\d]+$/.test(r))return rk("СНИЛС должен состоять из 11 цифр");for(var t=r%100,e=r.substr(0,9),n=0,u=1;u<10;u++)n+=e.substr(u-1,1)*(10-u);if((n=n%101%100)!=t)return rk("Неверная контрольная сумма СНИЛС");return true},snilsValidalion:function(){var r,t=this.getValue();if(""===t||"___-___-___ __"===t||null===t)return true;else{var e;if(/^[0-9]{3}\-[0-9]{3}\-[0-9]{3} [0-9]{2}$/.test(t)){for(var n="",u=Number(t[12]+t[13]),i=0;i<12;i+=4){for(var a="",s=i;s<i+3;s++)a+=t[s];n+=a}if(Number(n)>1001998){for(var l=0,f=0;f<9;f++)l+=(9-f)*Number(n[f]);if(l<100&&Number(u)==l||(100===l||101===l)&&0===Number(u)||l>101&&Number(u)==l%101%100)return true}else return true}}return rk("Неверный номер страхового свидетельства ПФ")},PFNumber:function(){var r=g(this.getValue());if(""===r||!/^[0-9]{3}-[0-9]{3}-[0-9]{6}$/.test(r))return rk("Регистрационный номер в ПФ должен состоять из 12 цифр");return true},FSSNumber:function(){var r=g(this.getValue());if(""===r)return true;if(10!=r.length)return rk("Номер в ФСС должен состоять из 10 цифр");return true},kodPodchinennostiFSS:function(){var r=g(this.getValue());if(""===r||!/^[0-9]{4}[1-3]{1}$/.test(r))return rk("Код подчиненности в ФСС должен состоять из 5 цифр. Последняя цифра может быть равна 1, 2 или 3.");return true},TFOMS:function(){var r=[3,5,7,9,11,13,15,13,11,9,7,5,3,1],t=0,e=g(this.getValue()).trim(),n=parseInt(e.charAt(e.length-1),10);if(""===e)return true;if(15!=e.length)return rk("Номер должен состоять из 15 цифр");else if("000000000000000"===e)return rk("Номер ТФОМС не может состоять из одних нулей");for(var u=0;u<e.length-1;u++)t+=parseInt(e.charAt(u),10)*r[u];if(t%9===n)return true;return rk("Неверная контрольная сумма ТФОМС")},removeExcessSpaces:function(){var r=g(this.getValue()).trim().replace(/\s+/g," ");return this.setValue(r),true}}});