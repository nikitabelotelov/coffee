define("Lib/Control/ModalOverlay/ModalOverlay",["Core/WindowManager","Core/Abstract","Core/helpers/isNewEnvironment","css!Lib/Control/ModalOverlay/ModalOverlay"],function(o,e,t){"use strict";var i;return new(e.extend({$protected:{_overlay:void 0,_overlayState:false},$constructor:function(){this._publish("onOverlayToggle","onClick")},_createOverlay:function(){if(void 0===this._overlay){var e=$(".ws-window-overlay");if(e.length)this._overlay=e;else if(this._overlay=$("<div></div>").appendTo(document.body).hide().addClass("ws-window-overlay"),t())this._overlay.on("mousedown",function(e){e.preventDefault()});this._overlay.click(function(e){var t=o.getActiveWindow(),i;if(t)t.onBringToFront();if(this._notify("onClick",e))e.stopPropagation()}.bind(this))}},_setZIndex:function(e){if(void 0!==this._overlay)this._overlay.css("z-index",e)},getZIndex:function(){return this._overlay&&this._overlay.css("z-index")||0},isShownForWindow:function(e){return e.getZIndex()-this.getZIndex()===1},_show:function(){if(true!==this._overlayState)this._createOverlay(),this._overlay.show(),this._notify("onOverlayToggle",this._overlayState=true);if(!o.isMaximizedWindowExists())this._overlay.css("right",$("body").css("margin-right"))},_hide:function(){if(void 0!==this._overlay)if(false!==this._overlayState)this._overlay.hide(),this._notify("onOverlayToggle",this._overlayState=false)},adjust:function(e){if((e=e||o.getMaxVisibleZIndex())>0)return this._show(),this._setZIndex(e-1),true;else return this._hide(),false},getState:function(){return this._overlayState}}))});