define("Types/entity",["Types/object","Types/formatter","Core/EventBus","Core/core-extend","Types/shim","tslib","Core/constants","Core/defaultRenders","Types/di","Types/util","Core/Serializer","require","exports"],function(i,n,a,o,s,u,l,f,d,c,p,j,e){Object.defineProperty(e,"__esModule",{value:true}),e["Types/_entity/OptionsToPropertyMixin"]=true;var h=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var s="_$",a=s.length;function u(t,r,e,i){Object.defineProperty(t,r,{enumerable:true,configurable:true,get:function(){return delete t[r],t[r]=i[e]},set:function(e){delete t[r],t[r]=e}})}var r=function(){function e(e){if(e&&"object"===typeof e)for(var t=s,r=Object.keys(e),i=void 0,n=void 0,a=0,o=r.length;a<o;a++)if((n=t+(i=r[a]))in this)u(this,n,i,e)}return e.prototype._getOptions=function(){for(var e={},t=Object.keys(this),r,i=0,n=t.length;i<n;i++)if((r=t[i]).substr(0,a)===s)e[r.substr(a)]=this[r];if(this._options)for(r in this._options)if(this._options.hasOwnProperty(r)&&!(r in e))e[r]=this._options[r];return e},e}();(t.default=r).prototype["[Types/_entity/OptionsToPropertyMixin]"]=true}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),t=h;e["Types/_entity/format/UniversalField"]=true;var R=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(){}return e}();(t.default=r).prototype["[Types/_entity/format/UniversalField]"]=true,r.prototype._moduleName="Types/entity:format.UniversalField",r.prototype.type="",r.prototype.name="",r.prototype.defaultValue=null,r.prototype.nullable=false,r.prototype.meta=null}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/DestroyableMixin"]=true;var y=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var i=r.protect("destroyed");function n(){throw new ReferenceError("This class instance is destroyed.")}var a=function(){function e(){}return Object.defineProperty(e.prototype,"destroyed",{get:function(){return Boolean(this[i])},enumerable:true,configurable:true}),e.prototype.destroy=function(){for(var e in this[i]=true,this)switch(e){case"destroy":case"destroyed":case"isDestroyed":break;default:if("function"===typeof this[e])this[e]=n}},e.prototype.isDestroyed=function(){return this.destroyed},e}();(t.default=a).prototype["[Types/_entity/DestroyableMixin]"]=true}(j,e,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),r=y;e["Types/_entity/adapter/SbisFieldType"]=true;var b=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r={boolean:"Логическое",integer:"Число целое",real:"Число вещественное",money:"Деньги",string:"Строка",xml:"XML-файл",datetime:"Дата и время",date:"Дата",time:"Время",timeinterval:"Временной интервал",link:"Связь",identity:"Идентификатор",enum:"Перечисляемое",flags:"Флаги",record:"Запись",recordset:"Выборка",binary:"Двоичное",uuid:"UUID",rpcfile:"Файл-rpc",object:"JSON-объект",array:"Массив"};t.default=r}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/Identity"]=true;var _,v=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var i=function(){function e(e){if(!(e instanceof Array))if("string"===typeof e)e=e.split(this._separator);else e=[e];this._value=e}return e.prototype.getValue=function(){return this._value[0]},e.prototype.getName=function(){return this._value[1]},e.prototype.valueOf=function(){return this._value},e.prototype.toString=function(){return null===this._value[0]?null:this._value.join(",")},e}();(t.default=i).prototype["[Types/_entity/Identity]"]=true,i.prototype._separator=",",i.prototype._value=null,r.register("Types/entity:Identity",i,{instantiate:false})}(j,e,d);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/ICloneable"]=true;var m,g=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/IEquatable"]=true;var F,w=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/IInstantiable"]=true;var T,D=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/InstantiableMixin"]=true;var O=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var i=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,n=0,a={"[Types/_entity/InstantiableMixin]":true,_instancePrefix:"id-",_instanceId:"",getInstanceId:function(){if(n>=i)n=0;return this._instanceId||(this._instanceId=(r.isBrowserPlatform?"client-":"server-")+this._instancePrefix+n++)}};a.getHash=a.getInstanceId,t.default=a}(j,e,l);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),P=O;e["Types/_entity/IObject"]=true;var M,C=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/IObservableObject"]=true;var I,E=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/IProducible"]=true;var S,x=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/IVersionable"]=true;var N,A=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/relation/IReceiver"]=true;var $=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/descriptor"]=true;var k,V=function(){"use strict";var e={},t=function(e,t){function r(e){if("function"===typeof e)switch(e){case Boolean:e="boolean";break;case Number:e="number";break;case String:e="string"}return e}function i(i){var e=typeof(i=r(i));switch(e){case"string":return function e(t){if(void 0===t||typeof t===i||t instanceof String)return t;return new TypeError('Value "'+t+'" should be type of '+i)};case"function":return function e(t){if(void 0===t||t instanceof i)return t;return new TypeError('Value "'+t+'" should be instance of '+i)};case"object":return function e(t){if(void 0===t)return t;var r=t&&t._mixins;if(r instanceof Array&&-1!==r.indexOf(i))return t;return new TypeError('Value "'+t+'" should implement '+i)}}throw new TypeError('Argument "type" should be one of following types: string, function or object but "'+e+'" received.')}function n(){var r=this;return s(function e(t){if(void 0===t)return new TypeError("Value is required");return r(t)})}function a(r){if(!(r instanceof Array))throw new TypeError("Argument values should be an instance of Array");var i=this;return s(function e(t){if(void 0!==t&&-1===r.indexOf(t))return new TypeError("Invalid value "+t);return i(t)})}function o(e){var n=this,a=i(e);return s(function e(t){if(void 0!==t){if(!(t instanceof Array))return new TypeError("'Value \""+t+'" is not an Array');for(var r=void 0,i=0;i<t.length;i++)if((r=a(t[i]))instanceof Error)return r}return n(t)})}function s(r){var i=this,e=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.apply(i,e)};return Object.defineProperties(e,{required:{enumerable:true,value:n},oneOf:{enumerable:true,value:a},arrayOf:{enumerable:true,value:o}}),e}function u(e){return s(i(e))}Object.defineProperty(t,"__esModule",{value:true}),t.default=u}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/ObservableMixin"]=true;var z=function(){"use strict";var e={},t=function(e,t,n){Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(e){var t=e&&e.handlers;if(t instanceof Object)for(var r in t)if(t.hasOwnProperty(r))this.subscribe(r,t[r])}return e.prototype.destroy=function(){if(this._eventBusChannel)this._eventBusChannel.unsubscribeAll(),this._eventBusChannel.destroy(),this._eventBusChannel=null},e.prototype.subscribe=function(e,t,r){if(this._destroyed)return;if(!this._eventBusChannel)if(this._eventBusChannel=n.channel(),this._publishedEvents)for(var i=0;i<this._publishedEvents.length;i++)this._eventBusChannel.publish(this._publishedEvents[i]);if(void 0===r)r=this;this._eventBusChannel.subscribe(e,t,r)},e.prototype.unsubscribe=function(e,t,r){if(this._eventBusChannel){if(void 0===r)r=this;this._eventBusChannel.unsubscribe(e,t,r)}},e.prototype.getEventHandlers=function(e){return this._eventBusChannel?this._eventBusChannel.getEventHandlers(e):[]},e.prototype.hasEventHandlers=function(e){return this._eventBusChannel?this._eventBusChannel.hasEventHandlers(e):false},e.prototype._publish=function(){for(var e=[],t=0,r;t<arguments.length;t++)e[t]=arguments[t];this._publishedEvents=this._publishedEvents||[];for(var i=0;i<e.length;i++)if(r=e[i],this._publishedEvents.push(r),this._eventBusChannel)this._eventBusChannel.publish(r)},e.prototype._notify=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(this._eventBusChannel)return this._notifyPushQueue.apply(this,arguments),this._notifyQueue(this._eventsQueue)[0]},e.prototype._notifyLater=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(this._eventBusChannel)this._notifyPushQueue.apply(this,arguments)},e.prototype._notifyPushQueue=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this._eventsQueue=this._eventsQueue||[],this._eventsQueue.push([e].concat(t))},e.prototype._notifyQueue=function(e){var t=[];if(!e.running){e.running=true;var r=void 0;while(r=e[0])t.push(this._eventBusChannel._notifyWithTarget(r[0],this,r.slice(1))),e.shift();e.running=false}return t},e.prototype._removeFromQueue=function(e){if(!this._eventsQueue)return;for(var t=1;t<this._eventsQueue.length;t++)if(this._eventsQueue[t][0]===e)this._eventsQueue.splice(t,1),t--},e}();(t.default=r).prototype["[Types/_entity/ObservableMixin]"]=true,r.prototype._eventBusChannel=null,r.prototype._eventsQueue=null,r.prototype._publishedEvents=null}(j,e,a);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),H=z;e["Types/_entity/functor/Compute"]=true;var B=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r=function(){function r(e,t){if(t=t||[],!(e instanceof Function))throw new TypeError('Argument "fn" be an instance of Function');if(!(t instanceof Array))throw new TypeError('Argument "properties" be an instance of Array');return Object.defineProperty(e,"functor",{get:function(){return r}}),Object.defineProperty(e,"properties",{get:function(){return t}}),e}return r.isFunctor=function(e){return e&&e.functor===r},r}();t.default=r}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/CloneableMixin"]=true;var L=function(){"use strict";var e={},t=function(e,t,o){Object.defineProperty(t,"__esModule",{value:true});var r={"[Types/_entity/CloneableMixin]":true,"[Types/_entity/ICloneable]":true,clone:function(e){var t;if(e){var r,i=Object.getPrototypeOf(this).constructor,n=this.toJSON();if(n.state=this._unlinkCollection(n.state),n.state.$options)n.state.$options=this._unlinkCollection(n.state.$options);t=i.prototype.fromJSON.call(i,n)}else{var a=new o;t=JSON.parse(JSON.stringify(this,a.serialize),a.deserialize)}return delete t._instanceId,t},_unlinkCollection:function(e){var t;if(e instanceof Array){t=[];for(var r=0;r<e.length;r++)t[r]=this._unlinkObject(e[r]);return t}if(e instanceof Object){for(var i in t={},e)if(e.hasOwnProperty(i))t[i]=this._unlinkObject(e[i]);return t}return e},_unlinkObject:function(e){if(e instanceof Array)return e.slice();return e}};t.default=r}(j,e,p);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),Q=L;e["Types/_entity/SerializableMixin"]=true;var J=function(){"use strict";var e={},t=function(e,t,n){Object.defineProperty(t,"__esModule",{value:true});var r=n.protect("unserialized"),i="object"===typeof{}.__proto__,a="function"===typeof getFunctionDefinition,o=0;function s(){return this._instanceNumber||(this._instanceNumber=++o)}function u(e){var t=Object.getPrototypeOf(e),r=[];return"{"+Object.keys(t).map(function(e){return[e,JSON.stringify(t[e],function(e,t){if(t&&"object"===typeof t)if(-1===r.indexOf(t)){if(r.push(t),t.$serialized$)return"{*serialized*}"}else return"{*recursion*}";if("function"===typeof t)return a?getFunctionDefinition(t):String(t);return t})]}).map(function(e){return e[0]+": "+e[1]}).join(",")+"}"}function l(e,t,r){var i='Property "_moduleName" with module name for RequireJS\'s define() is not found in this prototype: "'+u(e)+'"';if(t)throw new ReferenceError(i);else n.logger.stack(i,void 0===r?3:r)}var f=function(){function e(e){}return e.prototype.toJSON=function(){return this._checkModuleName(true),{$serialized$:"inst",module:this._moduleName,id:s.call(this),state:this._getSerializableState({})}},e.fromJSON=function(e){var t=this.prototype._setSerializableState(e.state),r=new this(e.state.$options);if(t)t.call(r);return r},e.prototype._checkModuleName=function(e,t){var r=this;if(!r._moduleName)return void l(this,e,t);if(!i)return;if(!(r=this.__proto__).hasOwnProperty("_moduleName"))l(this,e,t)},e.prototype._getSerializableState=function(e){return e.$options="function"===typeof this._getOptions?this._getOptions():{},e},e.prototype._setSerializableState=function(e){return function(){this[r]=true}},e}();(t.default=f).prototype["[Types/_entity/SerializableMixin]"]=true,f.prototype.fromJSON=f.fromJSON,f.prototype._instanceNumber=null}(j,e,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),U=J;e["Types/_entity/VersionableMixin"]=true;var G=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r={"[Types/_entity/VersionableMixin]":true,_version:0,getVersion:function(){return this._version},_nextVersion:function(){if(this._version++,this["[Types/_entity/ManyToManyMixin]"])this._getMediator().belongsTo(this,function(e){if(e&&e["[Types/_entity/IVersionable]"])e._nextVersion()})}};t.default=r}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),W=G;e["Types/_entity/TimeInterval"]=true;var q=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r=1e3,i=6e4,n=36e5,o=864e5,s=60,u=60,l=24,a=["days","hours","minutes","seconds","milliseconds"],f={days:o,hours:n,minutes:i,seconds:r,milliseconds:1},d={regExp:/^P(?:(-?[0-9]+)D)?(?:T(?:(-?[0-9]+)H)?(?:(-?[0-9]+)M)?(?:(-?[0-9]+(?:\.[0-9]{0,3})?)[0-9]*S)?)?$/i,format:"P[<Число_дней>D][T[<Число_часов>H][<Число_минут>M][<Число_секунд>[.Число_долей_секунды]S]"},c={regExp:/^P(-?[0-9]+D)?(T(-?[0-9]+H)?(-?[0-9]+M)?(-?[0-9]+(\.[0-9]+)?S)?)?$/i,format:"P[<Число_дней>D][T[<Число_часов>H][<Число_минут>M][<Число_секунд>[.Число_долей_секунды]S]"};function p(e){return parseFloat(e)||0}function h(e){return e>0?Math.floor(e):Math.ceil(e)}function y(e){var r=[],i=d.regExp.exec(e);if(!b(e))throw new Error(rk("Передаваемый аргумент не соответствует формату ISO 8601. Допустимые форматы")+": "+c.format+". ");return i.slice(1).forEach(function(e,t){if(t===i.length-1)r.push(h(Number(e))),r.push((Number(e)%1*1e3).toFixed());else r.push(p(e))}),r}function _(e){for(var t={},r=0;r<a.length;r++)t[a[r]]=p(String(e[r]));return t}function v(e){var t=0;for(var r in f)if(f.hasOwnProperty(r)){var i;t+=f[r]*p(e[r])}return t}function m(e){var t={};for(var r in f)if(f.hasOwnProperty(r)){var i=f[r];t[r]=h(e/i),e%=i}return t}function g(e){var t=Number((e.seconds+e.milliseconds/1e3).toFixed(3));return"P"+e.days+"D"+"T"+e.hours+"H"+e.minutes+"M"+t+"S"}function b(e){return c.regExp.test(e)}var F=function(){function a(e){if(this instanceof a)this._normIntervalObj=void 0,this._normIntervalStr=void 0,this.set(e);else throw new Error(rk("TimeInterval вызывать через оператор new"))}return a.prototype.getDays=function(){return this._normIntervalObj.days},a.prototype.addDays=function(e){return this.addMilliseconds(e*o)},a.prototype.subDays=function(e){return this.subMilliseconds(e*o)},a.prototype.getHours=function(){return this._normIntervalObj.hours},a.prototype.addHours=function(e){return this.addMilliseconds(e*n)},a.prototype.subHours=function(e){return this.subMilliseconds(e*n)},a.prototype.getMinutes=function(){return this._normIntervalObj.minutes},a.prototype.addMinutes=function(e){return this.addMilliseconds(e*i)},a.prototype.subMinutes=function(e){return this.subMilliseconds(e*i)},a.prototype.getSeconds=function(){return this._normIntervalObj.seconds},a.prototype.addSeconds=function(e){return this.addMilliseconds(e*r)},a.prototype.subSeconds=function(e){return this.subMilliseconds(e*r)},a.prototype.getMilliseconds=function(){return this._normIntervalObj.milliseconds},a.prototype.addMilliseconds=function(e){return this.set(this.getTotalMilliseconds()+h(e))},a.prototype.subMilliseconds=function(e){return this.set(this.getTotalMilliseconds()-h(e))},a.prototype.getTotalHours=function(){return this._normIntervalObj.days*l+this._normIntervalObj.hours},a.prototype.getTotalMinutes=function(){return this.getTotalHours()*u+this._normIntervalObj.minutes},a.prototype.getTotalSeconds=function(){return this.getTotalMinutes()*s+this._normIntervalObj.seconds},a.prototype.getTotalMilliseconds=function(){return this.getTotalSeconds()*r+this._normIntervalObj.milliseconds},a.prototype.set=function(e){var t;if(e instanceof a)t="timeInterval";else if("string"===typeof e)t="intervalStr";else if(e instanceof Array)e=e.slice(),t="intervalArray";else if(e&&"object"===typeof e)e=Object.assign({},e),t="intervalObj";else e=p(e),t="milliseconds";switch(t){case"intervalStr":e=y(e);case"intervalArray":e=_(e);case"intervalObj":e=v(e);case"milliseconds":this._normIntervalObj=e=m(e),this._normIntervalStr=g(e);break;case"timeInterval":this.assign(e)}return this},a.prototype.toString=function(){return String(this._normIntervalStr)},a.prototype.valueOf=function(){return String(this._normIntervalStr)},a.prototype.toObject=function(){return Object.assign({},this._normIntervalObj)},a.prototype.clone=function(){return new a(this)},a.prototype.calc=function(e,t){var r=["==","!=",">=","<=",">","<","+","-","+=","-="];if(-1===r.indexOf(e))throw new Error(rk("Операция")+' "'+e+'" '+rk("не доступна. Разрешенные операции")+": "+r.join(", "));if(!(this instanceof a&&t instanceof a))throw new Error(rk("Operand должен быть объектом класса TimeInterval"));var i=this.getTotalMilliseconds(),n=t.getTotalMilliseconds();switch(e){case"==":return i===n;case"!=":return i!==n;case">=":return i>=n;case"<=":return i<=n;case">":return i>n;case"<":return i<n;case"+":return(new a).set(i+n);case"-":return(new a).set(i-n);case"+=":return this.set(i+n);case"-=":return this.set(i-n)}},a.prototype.addToDate=function(e){return this._dateModifier(1,e)},a.prototype.subFromDate=function(e){return this._dateModifier(-1,e)},a.prototype.assign=function(e){this._normIntervalObj=e.toObject(),this._normIntervalStr=e.valueOf()},a.prototype._dateModifier=function(e,t){return(t=new Date(t.getTime())).setTime(t.getTime()+e*this.getTotalMilliseconds()),t},a.toString=function(e){if(void 0!==e)return a.prototype.set.call({},e)._normIntervalStr;return Function.toString.call(this)},a}();t.default=F}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),K=q;e["Types/_entity/Guid"]=true;var Z,Y=function(){"use strict";var e={},t=function(e,t){Object.defineProperty(t,"__esModule",{value:true});var r=function(){function e(){}return e.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=16*Math.random()|0,r;return("x"==e?t:3&t|8).toString(16)})},e}();t.default=r}(j,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/date/fromSql"]=true;var X=function(){"use strict";var e={},t=function(e,t,h){Object.defineProperty(t,"__esModule",{value:true});var y=/([0-9]{2}:[0-9]{2}:[0-9]{2}(?:\.[0-9]{1,9})?)([+-])([0-9]{2})[:-]*([0-9]{2})*$/;function r(e,t){var r=e.indexOf("-"),i=e.indexOf(":"),n=e.indexOf("."),a=e.match(y),o=a&&a.index+a[1].length||-1,s=new Date,u=null,l,f,d,c;if(s.setHours(0,0,0,0),-1===i&&-1===r)return s;if(i>-1&&r>i)r=-1;if(-1!==n){if((l=e.substr(n+1,(-1===o?e.length:o)-(n+1))).length>3)l=l.substr(0,3);if(u=parseInt(l,10),l.length<3)u*=2===l.length?10:100}if(-1!==r){if(f=parseInt(e.substr(r-4,4),10),d=parseInt(e.substr(r+1,2),10)-1,c=parseInt(e.substr(r+4,2),10),h.compatibility.dateBug&&0===d&&1===c)s.setHours(1);s.setFullYear(f,d,c)}if(-1!==i){s.setHours(parseInt(e.substr(i-2,2),10),parseInt(e.substr(i+1,2),10),parseInt(e.substr(i+4,2),10),u);var p=t;if(a)p=Number(a[2]+"1")*(60*Number(a[3])+(1*Number(a[4])||0));if(void 0!==p)s.setMinutes(s.getMinutes()-p-s.getTimezoneOffset())}return s}t.default=r}(j,e,l);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/date/toSql"]=true;var ee=function(){"use strict";var e={},t=function(e,t,i){Object.defineProperty(t,"__esModule",{value:true});var n={TIME:"time",DATE:"date",DATETIME:"datetime"};t.MODE=n;var a={time:"HH:mm:ss",date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss"},o=new Date(0);function s(e){var t=e.getTimezoneOffset(),r=t<=0;if(t<0)t=-t;var i=Math.floor(t/60),n=t-60*i;if(i<10)i="0"+i;if(0===n)n="";else if(n<10)n="0"+n;return(r?"+":"-")+i+(n?":"+n:"")}function r(e,t){if(void 0===t)t=n.DATETIME;var r=i.date(e,a[t]);if(t!==n.DATE&&e>o){if(e.getMilliseconds()>0)r+="."+e.getMilliseconds();r+=s(e)}return r}t.default=r}(j,e,n);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/ITable"]=true;var te=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/adapter/IAdapter"]=true;var re=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/adapter/IMetaData"]=true;var ie=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/adapter/IRecord"]=true;var ne=function(){"use strict";var e={},t=(r=j,i=e,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}();e["Types/_entity/adapter/Abstract"]=true;var ae=function(){"use strict";var e={},t=function(e,t,r,i,n,a,o){Object.defineProperty(t,"__esModule",{value:true});var s=(u=function(e){if(e instanceof Array)return l(e);else if(e&&"object"===typeof e)return f(e);else return e},l=function(e){return e.map(function(e){return u(e)})},f=function(e){if("function"===typeof e.getRawData)return e.getRawData(true);else if(e instanceof Date){var t=o.MODE.DATETIME;if((e=e).getSQLSerializationMode)switch(e.getSQLSerializationMode()){case Date.SQL_SERIALIZE_MODE_DATE:t=o.MODE.DATE;break;case Date.SQL_SERIALIZE_MODE_TIME:t=o.MODE.TIME}return o.default(e,t)}else{if(e.valueOf)e=e.valueOf();if(e&&"object"===typeof e)return d(e);return e}},d=function(e){var t={},r=Object.getPrototypeOf(e);if(null!==r&&r!==Object.prototype)throw new TypeError("Unsupported object type. Only plain objects can be serialized.");for(var i=Object.keys(e),n,a=0;a<i.length;a++)t[n=i[a]]=u(e[n]);return t},{serialize:u}),u,l,f,d,c=function(t){function e(){var e=t.call(this)||this;return n.default.constructor.call(e),e}return r.__extends(e,t),e.prototype.getProperty=function(e,t){for(var r=(t=t||"").split(this._pathSeparator),i,n=0;n<r.length;n++)i=n?i?i[r[n]]:void 0:e?e[r[n]]:void 0;return i},e.prototype.setProperty=function(e,t,r){if(!e||!(e instanceof Object))return;for(var i=(t=t||"").split(this._pathSeparator),n=e,a=0,o=i.length-1;a<=o;a++)if(a===o)n[i[a]]=r;else{if(void 0===n[i[a]])n[i[a]]={};n=n[i[a]]}},e.prototype.serialize=function(e){return s.serialize(e)},e.prototype.forRecord=function(e,t){throw new Error("Method must be implemented")},e.prototype.forTable=function(e){throw new Error("Method must be implemented")},e.prototype.getKeyField=function(e){throw new Error("Method must be implemented")},e}(a.mixin(i.default,n.default));(t.default=c).prototype["[Types/_entity/adapter/Abstract]"]=true,c.prototype["[Types/_entity/adapter/IAdapter]"]=true,c.prototype._pathSeparator="."}(j,e,u,y,J,c,ee);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/Field"]=true;var oe=function(){"use strict";var e={},t=function(e,t,i,r,n,a,o,s,u){Object.defineProperty(t,"__esModule",{value:true});var l=function(r){function e(e){var t=r.call(this,e)||this;return a.default.call(t,e),t}return i.__extends(e,r),e.prototype.isEqual=function(e){if(e===this)return true;var t,r;return Object.getPrototypeOf(this)===Object.getPrototypeOf(e)&&this.getName()===e.getName()&&u.isEqual(this.getDefaultValue(),e.getDefaultValue())&&this.isNullable()===e.isNullable()},e.prototype.getType=function(){return this._$type||this.getTypeName()},e.prototype.getTypeName=function(){return this._typeName},e.prototype.getName=function(){return this._$name},e.prototype.setName=function(e){this._$name=e},e.prototype.getDefaultValue=function(){return this._$defaultValue},e.prototype.setDefaultValue=function(e){this._$defaultValue=e},e.prototype.isNullable=function(){return this._$nullable},e.prototype.setNullable=function(e){this._$nullable=e},e.prototype.copyFrom=function(e){var t=e._getOptions(),r;for(var i in t)if(t.hasOwnProperty(i))if((r="_$"+i)in this)this[r]=t[i]},e}(r.mixin(n.default,a.default,o.default,s.default));(t.default=l).prototype["[Types/_entity/format/DestroyableMixin]"]=true,l.prototype._$name="",l.prototype._$type=null,l.prototype._$defaultValue=null,l.prototype._$nullable=true,l.prototype._typeName=""}(j,e,u,c,y,h,J,L,i);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/CowRecord"]=true;var se=function(){"use strict";var e={},t=function(e,t,r,i,a){Object.defineProperty(t,"__esModule",{value:true});var n=function(n){function e(e,t,r){var i=n.call(this)||this;if(i._original=t,i._originalRecord=t.forRecord(e),r)i._writeCallback=r;return i}return r.__extends(e,n),e.prototype.has=function(e){return this._originalRecord.has(e)},e.prototype.get=function(e){return this._originalRecord.get(e)},e.prototype.set=function(e,t){return this._copy(),this._originalRecord.set(e,t)},e.prototype.clear=function(){return this._copy(),this._originalRecord.clear()},e.prototype.getData=function(){return this._originalRecord.getData()},e.prototype.getFields=function(){return this._originalRecord.getFields()},e.prototype.getFormat=function(e){return this._originalRecord.getFormat(e)},e.prototype.getSharedFormat=function(e){return this._originalRecord.getSharedFormat(e)},e.prototype.addField=function(e,t){return this._copy(),this._originalRecord.addField(e,t)},e.prototype.removeField=function(e){return this._copy(),this._originalRecord.removeField(e)},e.prototype.removeFieldAt=function(e){return this._copy(),this._originalRecord.removeFieldAt(e)},e.prototype.getOriginal=function(){return this._originalRecord},e.prototype._copy=function(){if(!this._copied){if(this._originalRecord["[Types/_entity/ICloneable]"])this._originalRecord=this._originalRecord.clone();else this._originalRecord=this._original.forRecord(a.object.clonePlain(this._originalRecord.getData()));if(this._copied=true,this._writeCallback)this._writeCallback(),this._writeCallback=null}},e}(i.default);(t.default=n).prototype["[Types/_entity/adapter/CowRecord]"]=true,n.prototype["[Types/_entity/adapter/IRecord]"]=true,n.prototype["[Types/_entity/adapter/IDecorator]"]=true,n.prototype._original=null,n.prototype._originalRecord=null,n.prototype._writeCallback=null,n.prototype._copied=false}(j,e,u,y,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/relation/Hierarchy"]=true;var ue=function(){"use strict";var e={},t=function(e,t,i,r,n,a){Object.defineProperty(t,"__esModule",{value:true});var o=function(r){function e(e){var t=r.call(this,e)||this;return n.default.call(t,e),t}return i.__extends(e,r),e.prototype.getIdProperty=function(){return this._$idProperty},e.prototype.setIdProperty=function(e){this._$idProperty=e},e.prototype.getParentProperty=function(){return this._$parentProperty},e.prototype.setParentProperty=function(e){this._$parentProperty=e},e.prototype.getNodeProperty=function(){return this._$nodeProperty},e.prototype.setNodeProperty=function(e){this._$nodeProperty=e},e.prototype.getDeclaredChildrenProperty=function(){return this._$declaredChildrenProperty},e.prototype.setDeclaredChildrenProperty=function(e){this._$declaredChildrenProperty=e},e.prototype.isNode=function(e){return e.get(this._$nodeProperty)},e.prototype.getChildren=function(e,t){if(!this._$parentProperty)return null===e||void 0===e?(r=[],t.each(function(e){r.push(e)}),r):[];var r,i=this._asField(e,this._$idProperty),n=t.getIndicesByValue(this._$parentProperty,i),a=[];if(0===n.length&&null===i)n=t.getIndicesByValue(this._$parentProperty);for(var o=0;o<n.length;o++)a.push(t.at(n[o]));return a},e.prototype.hasDeclaredChildren=function(e){return e.get(this._$declaredChildrenProperty)},e.prototype.hasParent=function(e,t){var r=(e=this._asRecord(e,t)).get(this._$parentProperty),i=this._$idProperty||t.getIdProperty(),n;return t.getIndexByValue(i,r)>-1},e.prototype.getParent=function(e,t){var r=(e=this._asRecord(e,t)).get(this._$parentProperty);return void 0===r||null===r?null:this._asRecord(r,t)},e.prototype._asRecord=function(e,t){if(e&&e["[Types/_entity/Record]"])return e;var r=this._$idProperty||t.getIdProperty(),i=t.getIndexByValue(r,e);if(-1===i)throw new ReferenceError(this._moduleName+': record with id "'+e+'" does not found in the recordset');return t.at(i)},e.prototype._asField=function(e,t){if(!(e&&e["[Types/_entity/Record]"]))return e;return e.get(t)},e}(a.mixin(r.default,n.default));(t.default=o).prototype["[Types/_entity/relation/Hierarchy]"]=true,o.prototype._$idProperty="",o.prototype._$parentProperty="",o.prototype._$nodeProperty="",o.prototype._$declaredChildrenProperty=""}(j,e,u,y,h,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/CowTable"]=true;var le=function(){"use strict";var e={},t=function(e,t,r,i,a){Object.defineProperty(t,"__esModule",{value:true});var n=function(n){function e(e,t,r){var i=n.call(this)||this;if(i._original=t,i._originalTable=t.forTable(e),r)i._writeCallback=r;return i}return r.__extends(e,n),e.prototype.getFields=function(){return this._originalTable.getFields()},e.prototype.getCount=function(){return this._originalTable.getCount()},e.prototype.getData=function(){return this._originalTable.getData()},e.prototype.add=function(e,t){return this._copy(),this._originalTable.add(e,t)},e.prototype.at=function(e){return this._originalTable.at(e)},e.prototype.remove=function(e){return this._copy(),this._originalTable.remove(e)},e.prototype.replace=function(e,t){return this._copy(),this._originalTable.replace(e,t)},e.prototype.move=function(e,t){return this._copy(),this._originalTable.move(e,t)},e.prototype.merge=function(e,t,r){return this._copy(),this._originalTable.merge(e,t,r)},e.prototype.copy=function(e){return this._copy(),this._originalTable.copy(e)},e.prototype.clear=function(){return this._copy(),this._originalTable.clear()},e.prototype.getFormat=function(e){return this._originalTable.getFormat(e)},e.prototype.getSharedFormat=function(e){return this._originalTable.getSharedFormat(e)},e.prototype.addField=function(e,t){return this._copy(),this._originalTable.addField(e,t)},e.prototype.removeField=function(e){return this._copy(),this._originalTable.removeField(e)},e.prototype.removeFieldAt=function(e){return this._copy(),this._originalTable.removeFieldAt(e)},e.prototype.getOriginal=function(){return this._originalTable},e.prototype._copy=function(){if(!this._copied){if(this._originalTable["[Types/_entity/ICloneable]"])this._originalTable=this._originalTable.clone();else this._originalTable=this._original.forTable(a.object.clonePlain(this._originalTable.getData()));if(this._copied=true,this._writeCallback)this._writeCallback(),this._writeCallback=null}},e}(i.default);(t.default=n).prototype["[Types/_entity/adapter/CowTable]"]=true,n.prototype["[Types/_entity/adapter/ITable]"]=true,n.prototype["[Types/_entity/adapter/IDecorator]"]=true,n.prototype._original=null,n.prototype._originalTable=null,n.prototype._writeCallback=null,n.prototype._copied=false}(j,e,u,y,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/functor"]=true;var fe=function(){"use strict";var e={},t=(r=j,i=e,n=B,Object.defineProperty(i,"__esModule",{value:true}),i.Compute=n.default,void(i.IComputeFunctor=n.IFunctor)),r,i,n;if(t instanceof Function)return t;else for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];return e}(),de=fe;e["Types/_entity/relation/ManyToMany"]=true;var ce=function(){"use strict";var e={},t=function(e,t,r,i,a){function n(e){return e instanceof Object&&e["[Types/_entity/DestroyableMixin]"]?!e.destroyed:true}Object.defineProperty(t,"__esModule",{value:true});var o=function(t){function e(){var e=t.call(this)||this;return e._hasMany=new a.Map,e._hasManyName=new a.Map,e._belongsTo=new a.Map,e._belongsToName=new a.Map,e}return r.__extends(e,t),e.prototype.destroy=function(){this._hasMany=null,this._hasManyName=null,this._belongsTo=null,this._belongsToName=null,t.prototype.destroy.call(this)},e.prototype.addRelationship=function(e,t,r){this._addHasMany(e,t,r),this._addBelongsTo(t,e,r)},e.prototype.removeRelationship=function(e,t){this._removeHasMany(e,t),this._removeBelongsTo(t,e)},e.prototype.clear=function(t){var r=this;if(this._hasMany.has(t))this._hasMany.get(t).forEach(function(e){r._removeBelongsTo(e,t)}),this._hasMany.delete(t),this._hasManyName.delete(t);if(this._belongsTo.has(t))this._belongsTo.get(t).forEach(function(e){r._removeHasMany(e,t)}),this._belongsTo.delete(t),this._belongsToName.delete(t)},e.prototype.hasMany=function(e,t){var r=this;if(this._hasMany.has(e)){var i=this._hasManyName.get(e);this._hasMany.get(e).forEach(function(e){if(n(e))t.call(r,e,i.get(e))})}},e.prototype.belongsTo=function(e,t){var r=this;if(this._belongsTo.has(e)){var i=this._belongsToName.get(e);this._belongsTo.get(e).forEach(function(e){if(n(e))t.call(r,e,i.get(e))})}},e.prototype._addHasMany=function(e,t,r){var i,n;if(this._hasMany.has(e))i=this._hasMany.get(e),n=this._hasManyName.get(e);else i=new a.Set,n=new a.Map,this._hasMany.set(e,i),this._hasManyName.set(e,n);i.add(t),n.set(t,r)},e.prototype._removeHasMany=function(e,t){if(this._hasMany.has(e)){var r=this._hasMany.get(e);if(r.delete(t),this._hasManyName.get(e).delete(t),0===r.size)this._hasMany.delete(e),this._hasManyName.delete(e)}},e.prototype._addBelongsTo=function(e,t,r){var i,n;if(this._belongsTo.has(e))i=this._belongsTo.get(e),n=this._belongsToName.get(e);else i=new a.Set,n=new a.Map,this._belongsTo.set(e,i),this._belongsToName.set(e,n);i.add(t),n.set(t,r)},e.prototype._removeBelongsTo=function(e,t){if(this._belongsTo.has(e)){var r=this._belongsTo.get(e);if(r.delete(t),this._belongsToName.get(e).delete(t),0===r.size)this._belongsTo.delete(e),this._belongsToName.delete(e)}},e}(i.default);(t.default=o).prototype["[Types/_entity/relation/ManyToMany]"]=true,o.prototype._hasMany=null,o.prototype._hasManyName=null,o.prototype._belongsTo=null,o.prototype._belongsToName=null}(j,e,u,y,s);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/ManyToManyMixin"]=true;var pe=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var i={"[Types/_entity/ManyToManyMixin]":true,"[WS.Data/Entity/ManyToManyMixin]":true,_mediator:null,destroy:function(){var e=this._getMediator(),t=[],r;e.hasMany(this,function(e){t.push(e)}),e.clear(this);for(var i=0,n=t.length;i<n;i++)if((r=t[i]).destroy)r.destroy();this._setMediator(null)},_addChild:function(e,t){if(e instanceof Object){var r=this._getMediator();if(r.addRelationship(this,e,t),e["[Types/_entity/ManyToManyMixin]"]&&!e._hasSameMediator(r)){if(!e._hasMediator())e._setMediator(this._createMediator());e._getMediator().addRelationship(this,e,t)}}},_removeChild:function(e){if(e instanceof Object){var t=this._getMediator();if(t.removeRelationship(this,e),e["[Types/_entity/ManyToManyMixin]"]&&e._hasMediator()&&!e._hasSameMediator(t))e._getMediator().removeRelationship(this,e)}},_parentChanged:function(e){var r={target:this,data:e,original:e};this._getMediator().hasMany(this,function(e,t){if(e["[Types/_entity/relation/IReceiver]"])e.relationChanged(r,[t])})},_childChanged:function(s){var u=s,l=function(e,a,o){e.belongsTo(a,function(e,t){var r=o.slice(),i={target:a,data:s,original:u},n;if(r.unshift(t),e["[Types/_entity/relation/IReceiver]"])if(void 0!==(n=e.relationChanged(i,r)))s=n.data;l(e._getMediator(),e,r)})};l(this._getMediator(),this,[])},_hasMediator:function(){return!!this._mediator},_hasSameMediator:function(e){return this._mediator===e},_createMediator:function(){return new r.default},_getMediator:function(){return this._mediator||(this._mediator=this._createMediator())},_setMediator:function(e){this._mediator=e}};t.default=i}(j,e,ce);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),he=pe;e["Types/_entity/relation"]=true;var ye,_e=function(){"use strict";var e={},t=(r=j,i=e,n=ue,a=$,Object.defineProperty(i,"__esModule",{value:true}),i.Hierarchy=n.default,void(i.IReceiver=a.default)),r,i,n,a;if(t instanceof Function)return t;else for(var o in t)if(t.hasOwnProperty(o))e[o]=t[o];return e}();e["Types/_entity/ReadWriteMixin"]=true;var ve=function(){"use strict";var e={},t=function(e,t,r,i,n,a){Object.defineProperty(t,"__esModule",{value:true});var o=Object.prototype.hasOwnProperty,s=a.protect("writable"),u={"[Types/_entity/ReadWriteMixin]":true,get writable(){return this[s]},constructor:function(e){if(this._options&&o.call(this._options,"writable"))this[s]=this._options.writable;if(e&&o.call(e,"writable"))this[s]=e.writable;if(this[s])i.default.apply(this,arguments)},destroy:function(){if(this[s])i.default.prototype.destroy.call(this),n.default.destroy.call(this)},subscribe:function(e,t,r){if(this[s])return i.default.prototype.subscribe.call(this,e,t,r)},unsubscribe:function(e,t,r){if(this[s])return i.default.prototype.unsubscribe.call(this,e,t,r)},_publish:function(){if(this[s])return i.default.prototype._publish.apply(this,arguments)},_notify:function(){if(this[s])return i.default.prototype._notify.apply(this,arguments)},_getOptions:function(){var e=r.default.prototype._getOptions.call(this);return delete e.writable,e}},l="undefined"!==typeof window,f=!!("undefined"!==typeof global&&global.assert&&global.assert.strictEqual);Object.defineProperty(u,s,{writable:true,value:l||f}),t.default=u}(j,e,h,z,pe,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),me=ve;e["Types/_entity/adapter/Cow"]=true;var ge=function(){"use strict";var e={},t=function(e,t,r,i,n,a,o,s,u){Object.defineProperty(t,"__esModule",{value:true});var l=function(i){function e(e,t){var r=i.call(this)||this;if(o.default.constructor.call(r),r._original=e,t)r._writeCallback=t;return r}return r.__extends(e,i),e.prototype.forTable=function(e){return new n.default(e,this._original,this._writeCallback)},e.prototype.forRecord=function(e){return new a.default(e,this._original,this._writeCallback)},e.prototype.getKeyField=function(e){return this._original.getKeyField(e)},e.prototype.getProperty=function(e,t){return this._original.getProperty(e,t)},e.prototype.setProperty=function(e,t,r){return this._original.setProperty(e,t,r)},e.prototype.serialize=function(e){return this._original.serialize(e)},e.prototype.getOriginal=function(){return this._original},e.prototype._getSerializableState=function(e){return(e=o.default.prototype._getSerializableState.call(this,e))._original=this._original,e},e.prototype._setSerializableState=function(e){var t=o.default.prototype._setSerializableState(e);return function(){t.call(this),this._original=e._original}},e}(u.mixin(i.default,o.default));(t.default=l).prototype["[Types/_entity/adapter/Cow]"]=true,l.prototype["[Types/_entity/adapter/IDecorator]"]=true,l.prototype._moduleName="Types/entity:adapter.Cow",l.prototype._original=null,l.prototype._writeCallback=null,s.register("Types/entity:adapter.Cow",l,{instantiate:false})}(j,e,u,ae,le,se,J,d,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/ArrayField"]=true;var be=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getKind=function(){return this._$kind},t}(i.default);(t.default=n).prototype["[Types/_entity/format/ArrayField]"]=true,n.prototype._moduleName="Types/entity:format.ArrayField",n.prototype._typeName="Array",n.prototype._$kind=""}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/BinaryField"]=true;var Fe=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/BinaryField]"]=true,n.prototype._moduleName="Types/entity:format.BinaryField",n.prototype._typeName="Binary"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/BooleanField"]=true;var we=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/BooleanField]"]=true,n.prototype._moduleName="Types/entity:format.BooleanField",n.prototype._typeName="Boolean"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/DateField"]=true;var Te=function(){"use strict";var e={},t=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:true});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getDefaultValue=function(){if(this._$defaultValue instanceof Date)return n.default(this._$defaultValue,n.MODE.DATE);return this._$defaultValue},t}(i.default);(t.default=a).prototype["[Types/_entity/format/DateField]"]=true,a.prototype._moduleName="Types/entity:format.DateField",a.prototype._typeName="Date"}(j,e,u,oe,ee);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/DateTimeField"]=true;var De=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.isWithoutTimeZone=function(){return this._$withoutTimeZone},t}(i.default);(t.default=n).prototype["[Types/_entity/format/DateTimeField]"]=true,n.prototype._moduleName="Types/entity:format.DateTimeField",n.prototype._typeName="DateTime",n.prototype._$withoutTimeZone=false}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/DictionaryField"]=true;var Oe=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getDictionary=function(){return this._$dictionary},t.prototype.getLocaleDictionary=function(){return this._$localeDictionary},t}(i.default);(t.default=n).prototype["[Types/_entity/format/DictionaryField]"]=true,n.prototype._moduleName="Types/entity:format.DictionaryField",n.prototype._typeName="Dictionary",n.prototype._$dictionary=null,n.prototype._$localeDictionary=null}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/IdentityField"]=true;var Pe=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getSeparator=function(){return this._separator},t}(i.default);(t.default=n).prototype["[Types/_entity/format/IdentityField]"]=true,n.prototype._moduleName="Types/entity:format.IdentityField",n.prototype._typeName="Identity",n.prototype._separator=",",n.prototype._$defaultValue=[null]}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/RecordField"]=true;var Me=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/RecordField]"]=true,n.prototype._moduleName="Types/entity:format.RecordField",n.prototype._typeName="Record"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/TimeIntervalField"]=true;var Ce=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/TimeIntervalField]"]=true,n.prototype._moduleName="Types/entity:format.TimeIntervalField",n.prototype._typeName="TimeInterval",n.prototype._$defaultValue=0}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/RpcFileField"]=true;var Ie=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/RpcFileField]"]=true,n.prototype._moduleName="Types/entity:format.RpcFileField",n.prototype._typeName="RpcFile"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/ObjectField"]=true;var Ee=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/ObjectField]"]=true,n.prototype._moduleName="Types/entity:format.ObjectField",n.prototype._typeName="Object"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/UuidField"]=true;var je=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/UuidField]"]=true,n.prototype._moduleName="Types/entity:format.UuidField",n.prototype._typeName="Uuid"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/TimeField"]=true;var Re=function(){"use strict";var e={},t=function(e,t,r,i,n){Object.defineProperty(t,"__esModule",{value:true});var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getDefaultValue=function(){if(this._$defaultValue instanceof Date)return n.default(this._$defaultValue,n.MODE.TIME);return this._$defaultValue},t}(i.default);(t.default=a).prototype["[Types/_entity/format/TimeField]"]=true,a.prototype._moduleName="Types/entity:format.TimeField",a.prototype._typeName="Time"}(j,e,u,oe,ee);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/RecordSetField"]=true;var Se=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/RecordSetField]"]=true,n.prototype._moduleName="Types/entity:format.RecordSetField",n.prototype._typeName="RecordSet"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/XmlField"]=true;var xe=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/XmlField]"]=true,n.prototype._moduleName="Types/entity:format.XmlField",n.prototype._typeName="Xml",n.prototype._$defaultValue=""}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/LinkField"]=true;var Ne=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/LinkField]"]=true,n.prototype._moduleName="Types/entity:format.LinkField",n.prototype._typeName="Link",n.prototype._$defaultValue=0}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/IntegerField"]=true;var Ae=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/IntegerField]"]=true,n.prototype._moduleName="Types/entity:format.IntegerField",n.prototype._typeName="Integer",n.prototype._$defaultValue=0}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/RealField"]=true;var $e=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getPrecision=function(){return this._$precision},t.prototype.setPrecision=function(e){this._$precision=e},t}(i.default);(t.default=n).prototype["[Types/_entity/format/RealField]"]=true,n.prototype._moduleName="Types/entity:format.RealField",n.prototype._typeName="Real",n.prototype._$defaultValue=0,n.prototype._$precision=16}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/StringField"]=true;var ke=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/StringField]"]=true,n.prototype._moduleName="Types/entity:format.StringField",n.prototype._typeName="String"}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/HierarchyField"]=true;var Ve=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.getKind=function(){return this._$kind},t.prototype.getDefaultValue=function(){if(this._$kind&&"Identity"===this._$kind)return[null];return null},t}(i.default);(t.default=n).prototype["[Types/_entity/format/HierarchyField]"]=true,n.prototype._moduleName="Types/entity:format.HierarchyField",n.prototype._typeName="Hierarchy",n.prototype._$kind=""}(j,e,u,oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/MoneyField"]=true;var ze=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.isLarge=function(){return this._$large},t}(i.default);(t.default=n).prototype["[Types/_entity/format/MoneyField]"]=true,n.prototype._moduleName="Types/entity:format.MoneyField",n.prototype._typeName="Money",n.prototype._$precision=2,n.prototype._$large=false}(j,e,u,$e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/FlagsField"]=true;var He=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/FlagsField]"]=true,n.prototype._moduleName="Types/entity:format.FlagsField",n.prototype._typeName="Flags"}(j,e,u,Oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/EnumField"]=true;var Be=function(){"use strict";var e={},t=function(e,t,r,i){Object.defineProperty(t,"__esModule",{value:true});var n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t}(i.default);(t.default=n).prototype["[Types/_entity/format/EnumField]"]=true,n.prototype._moduleName="Types/entity:format.EnumField",n.prototype._typeName="Enum"}(j,e,u,Oe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format/fieldsFactory"]=true;var Le=function(){"use strict";var e={},t=function(e,t,i,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m,g,b,F,w,T,D,O){function r(e){if(Object.getPrototypeOf(e)!==Object.prototype)throw new TypeError("Types/_entity/format/FieldsFactory::create(): declaration should be an instance of Object");var t=e.type;if("string"===typeof t){switch(t.toLowerCase()){case"boolean":return new i.default(e);case"integer":return new n.default(e);case"real":return new a.default(e);case"money":return new o.default(e);case"string":return new s.default(e);case"text":return O.logger.error("Types/_entity/format/FieldsFactory::create()",'Type "text" has been removed in 3.18.10. Use "string" instead.'),e.type="string",new s.default(e);case"xml":return new u.default(e);case"datetime":return new l.default(e);case"date":return new f.default(e);case"time":return new d.default(e);case"timeinterval":return new c.default(e);case"link":return new p.default(e);case"identity":return new h.default(e);case"enum":return new y.default(e);case"flags":return new _.default(e);case"record":case"model":return new v.default(e);case"recordset":return new m.default(e);case"binary":return new g.default(e);case"uuid":return new b.default(e);case"rpcfile":return new F.default(e);case"hierarchy":return O.logger.error("Types/_entity/format/FieldsFactory::create()",'Type "hierarchy" has been removed in 3.18.10. Use "identity" instead.'),e.type="identity",new h.default(e);case"object":return new w.default(e);case"array":return new T.default(e)}if(D.isRegistered(t))t=D.resolve(t)}if("function"===typeof t){var r=Object.create(t.prototype);if(r["[Types/_entity/IObject]"]&&r["[Types/_entity/FormattableMixin]"])return new v.default(e);else if(r["[Types/_collection/IList]"]&&r["[Types/_entity/FormattableMixin]"])return new m.default(e);else if(r["[Types/_collection/IEnum]"])return new y.default(e);else if(r["[Types/_collection/IFlags]"])return new _.default(e);else if(r instanceof Array)return new T.default(e);else if(r instanceof Date)return new f.default(e);else if(r instanceof String)return new s.default(e);else if(r instanceof Number)return new a.default(e);else if(t===Object)return new w.default(e)}throw new TypeError("Types/_entity/format/fieldsFactory(): unsupported field type "+("function"===typeof t?t.name:'"'+t+'"'))}Object.defineProperty(t,"__esModule",{value:true}),t.default=r}(j,e,we,Ae,$e,ze,ke,xe,De,Te,Re,Ce,Ne,Pe,Be,He,Me,Se,Fe,je,Ie,Ee,be,d,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/format"]=true;var Qe=function(){"use strict";var e={},t=(r=j,i=e,n=oe,a=be,o=Fe,s=we,u=Te,l=De,f=Oe,d=Be,c=Le,p=He,h=Ve,y=Pe,_=Ae,v=Ne,m=ze,g=Ee,b=$e,F=Me,w=Se,T=Ie,D=ke,O=Re,P=Ce,M=R,C=je,I=xe,Object.defineProperty(i,"__esModule",{value:true}),i.Field=n.default,i.ArrayField=a.default,i.BinaryField=o.default,i.BooleanField=s.default,i.DateField=u.default,i.DateTimeField=l.default,i.DictionaryField=f.default,i.EnumField=d.default,i.fieldsFactory=c.default,i.FlagsField=p.default,i.HierarchyField=h.default,i.IdentityField=y.default,i.IntegerField=_.default,i.LinkField=v.default,i.MoneyField=m.default,i.ObjectField=g.default,i.RealField=b.default,i.RecordField=F.default,i.RecordSetField=w.default,i.RpcFileField=T.default,i.StringField=D.default,i.TimeField=O.default,i.TimeIntervalField=P.default,i.UniversalField=M.default,i.UuidField=C.default,void(i.XmlField=I.default)),r,i,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m,g,b,F,w,T,D,O,P,M,C,I;if(t instanceof Function)return t;else for(var E in t)if(t.hasOwnProperty(E))e[E]=t[E];return e}(),Je=Qe;e["Types/_entity/adapter/GenericFormatMixin"]=true;var Ue=function(){"use strict";var e={},t=function(e,t,a){Object.defineProperty(t,"__esModule",{value:true});var r={"[Types/_entity/adapter/GenericFormatMixin]":true,_data:null,_sharedFieldFormat:null,_sharedFieldMeta:null,constructor:function(e){this._data=e},getData:function(){return this._data},getFields:function(){throw new Error("Method must be implemented")},getFormat:function(e){var t=this._getFieldsFormat(),r=t?t.getFieldIndex(e):-1;if(-1===r)throw new ReferenceError(this._moduleName+'::getFormat(): field "'+e+"\" doesn't exist");return t.at(r)},getSharedFormat:function(e){if(null===this._sharedFieldFormat)this._sharedFieldFormat=new a.UniversalField;var t=this._sharedFieldFormat,r=this._getFieldsFormat(),i=r?r.getFieldIndex(e):-1;return t.name=e,t.type=-1===i?"String":r.at(i).getType(),t.meta=-1===i?{}:this._getFieldMeta(e),t},addField:function(e,t){if(!e||!(e instanceof a.Field))throw new TypeError(this._moduleName+"::addField(): format should be an instance of Types/entity:format.Field");var r=e.getName();if(!r)throw new Error("{$this._moduleName}::addField(): field name is empty");var i=this._getFieldsFormat(),n;if((i?i.getFieldIndex(r):-1)>-1)throw new Error(this._moduleName+'::addField(): field "'+r+'" already exists');this._touchData(),i.add(e,t)},removeField:function(e){var t=this._getFieldsFormat(),r=t?t.getFieldIndex(e):-1;if(-1===r)throw new ReferenceError(this._moduleName+'::removeField(): field "'+e+"\" doesn't exist");this._touchData(),t.removeAt(r)},removeFieldAt:function(e){this._touchData();var t=this._getFieldsFormat();if(t)t.removeAt(e)},_touchData:function(){},_isValidData:function(){return true},_getFieldsFormat:function(){throw new Error("Method must be implemented")},_getFieldMeta:function(e){if(null===this._sharedFieldMeta)this._sharedFieldMeta={};var t=this.getFormat(e),r=this._sharedFieldMeta;switch(t.getType()){case"Real":case"Money":r.precision=t.getPrecision();break;case"Enum":case"Flags":r.dictionary=t.getDictionary();break;case"Identity":r.separator=t.getSeparator();break;case"Array":r.kind=t.getKind()}return r}};t.default=r}(j,e,Qe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/JsonFormatMixin"]=true;var Ge=function(){"use strict";var e={},t=function(e,t,r){Object.defineProperty(t,"__esModule",{value:true});var i={"[Types/_entity/adapter/GenericFormatMixin]":true,_format:null,constructor:function(){this._format={}},getFormat:function(e){if(!this._has(e))throw new ReferenceError(this._moduleName+'::getFormat(): field "'+e+"\" doesn't exist");if(!this._format.hasOwnProperty(e))this._format[e]=this._buildFormat(e);return this._format[e]},getSharedFormat:function(e){if(null===this._sharedFieldFormat)this._sharedFieldFormat=new r.UniversalField;var t=this._sharedFieldFormat;if(t.name=e,this._format.hasOwnProperty(e))t.type=this.getFormat(e).getType(),t.meta=this._getFieldMeta(e);else t.type="String";return t},addField:function(e){if(!e||!(e instanceof r.Field))throw new TypeError(this._moduleName+"::addField(): format should be an instance of Types/entity:format.Field");var t=e.getName();if(!t)throw new Error(this._moduleName+"::addField(): field name is empty");this._touchData(),this._format[t]=e},removeField:function(e){if(!this._has(e))throw new ReferenceError(this._moduleName+'::removeField(): field "'+e+"\" doesn't exist");this._touchData(),delete this._format[e]},removeFieldAt:function(){throw new Error("Method "+this._moduleName+"::removeFieldAt() doesn't supported")},_touchData:function(){if(!(this._data instanceof Object))this._data={}},_isValidData:function(){return this._data instanceof Object},_has:function(){throw new Error("Method must be implemented")},_buildFormat:function(e){return r.fieldsFactory({name:e,type:"string"})}};t.default=i}(j,e,Qe);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/factory"]=true;var We=function(){"use strict";var e={},t=function(e,t,r,o,u,l,f,d){Object.defineProperty(t,"__esModule",{value:true});var c=/[+-][0-9]+$/;function i(e){return(e instanceof r.DictionaryField?e.getDictionary():e.meta&&e.meta.dictionary)||[]}function n(e,t){var r=i(t.format);if(null===e&&!r.hasOwnProperty(e))return true;else if(void 0===e)return true;return false}function p(e,t,r){if(void 0===t||null===t){switch(e){case"identity":return false;case"enum":return n(t,r)}if("function"===typeof e){var i=Object.create(e.prototype);if(i&&i["[Types/_collection/IEnum]"])return n(t,r)}return true}return false}function h(e){if(Array.isArray(e)&&e.length<2)return e.length?e[0]:null;return e}function y(e){var t;if("object"===typeof e)t=e instanceof r.Field?e.getType():e.type;else t=e;return(""+t).toLowerCase()}function _(e){if(!e)return false;return e instanceof r.DateTimeField?e.isWithoutTimeZone():e.meta&&e.meta.withoutTimeZone}function v(e){if(!e)return false;return e instanceof r.MoneyField?e.isLarge():e.meta&&e.meta.large}function m(e){if(!e)return 0;return(e.getPrecision?e.getPrecision():e.meta&&e.meta.precision)||0}function g(e){return(e.getKind?e.getKind():e.meta&&e.meta.kind)||""}function b(t){var r=[];return t.each(function(e){r.push(t.get(e))}),r}function F(e){var t="Types/entity:adapter.Json",r=e.getCount(),i,n;for(n=0;n<r;n++)if((i=e.at(n))&&i["[Types/_entity/IObject]"]&&i["[Types/_entity/FormattableMixin]"]){t=i.getAdapter();break}var a=o.create("Types/collection:RecordSet",{adapter:t});for(n=0;n<r;n++)a.add(e.at(n));return a.getRawData(true)}var a={"[Types/_entity/factory]":true,cast:function(e,t,r){var i=this;if(p(t,e,r=r||{}))return e;if("string"===typeof t)switch(t=t.toLowerCase()){case"recordset":t=o.resolve(o.isRegistered("collection.$recordset")?"collection.$recordset":"Types/collection:RecordSet");break;case"record":t=o.resolve(o.isRegistered("entity.$model")?"entity.$model":"Types/entity:Model");break;case"enum":t=o.resolve("Types/collection:Enum");break;case"flags":t=o.resolve("Types/collection:Flags");break;case"link":case"integer":return"number"===typeof e?e:isNaN(parseInt(e,10))?null:parseInt(e,10);case"real":case"double":return"number"===typeof e?e:isNaN(parseFloat(e))?null:parseFloat(e);case"boolean":return!!e;case"money":if(!v(r.format)){var n=m(r.format);if(n>3)return d.real(e,n,false,true)}return void 0===e?null:e;case"date":case"time":case"datetime":if(e instanceof Date)return e;else if("infinity"===e)return 1/0;else if("-infinity"===e)return-1/0;if((e=l.default(""+e)).setSQLSerializationMode)switch(t){case"date":e.setSQLSerializationMode(Date.SQL_SERIALIZE_MODE_DATE);break;case"time":e.setSQLSerializationMode(Date.SQL_SERIALIZE_MODE_TIME);break;case"datetime":e.setSQLSerializationMode(Date.SQL_SERIALIZE_MODE_DATETIME)}return e;case"timeinterval":if(e instanceof f.default)return e.toString();return f.default.toString(e);case"array":var a=g(r.format);if(!(e instanceof Array))e=[e];return e.map(function(e){return i.cast(e,a,r)},this);default:return e}if("function"===typeof t){if(e instanceof t)return e;if(t.prototype["[Types/_entity/IProducible]"])return t.produceInstance(e,r);return new t(e)}throw new TypeError("Unknown type "+t)},serialize:function(e,t){var r=this,i=y((t=t||{}).format);if(p(i,e,t))return e;if(e&&"object"===typeof e)if(e["[Types/_entity/FormattableMixin]"])e=e.getRawData(true);else if(e["[Types/_collection/IFlags]"])e=b(e);else if(e["[Types/_collection/IEnum]"])e=e.get();else if(e["[Types/_collection/IList]"]&&"recordset"===i)e=F(e);else if("Deprecated/Record"===e._moduleName)throw new TypeError('Deprecated/Record can\'t be used with "Data"');else if("Deprecated/RecordSet"===e._moduleName)throw new TypeError('Deprecated/RecordSet can\'t be used with "Data"');else if("Deprecated/Enum"===e._moduleName)throw new TypeError('Deprecated/Enum can\'t be used with "Data"');switch(i){case"integer":return"number"===typeof(e=h(e))?e:isNaN(e-=0)?null:parseInt(e,10);case"real":case"double":return h(e);case"link":return parseInt(e,10);case"money":if(e=h(e),!v(t.format)){var n=m(t.format);if(n>3)return d.real(e,n,false,true)}return e;case"date":case"time":case"datetime":e=h(e);var a=u.MODE.DATE,o=false;switch(i){case"datetime":a=u.MODE.DATETIME,o=_(t.format);break;case"time":a=u.MODE.TIME}if(!e)e=l.default(""+e);if(e instanceof Date){if(e=u.default(e,a),o)e=e.replace(c,"")}else if(e===1/0)return"infinity";else if(e===-1/0)return"-infinity";return e;case"timeinterval":if((e=h(e))instanceof f.default)return e.toString();return f.default.toString(e);case"array":var s=g(t.format);if(!(e instanceof Array))e=[e];return e.map(function(e){return r.serialize(e,{format:s})},this);default:return e}}};t.default=a}(j,e,Qe,d,ee,X,q,f);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),qe=We;e["Types/_entity/adapter/RecordSetRecord"]=true;var Ke=function(){"use strict";var e={},t=function(e,t,r,i,n,a,o){Object.defineProperty(t,"__esModule",{value:true});var s=function(i){function e(e,t){var r=this;if(e&&!e["[Types/_entity/Record]"])throw new TypeError('Argument "data" should be an instance of Types/entity:Record');return r=i.call(this,e)||this,n.default.constructor.call(r,e),r._tableData=t,r}return r.__extends(e,i),e.prototype.has=function(e){return this._isValidData()?this._data.has(e):false},e.prototype.get=function(e){return this._isValidData()?this._data.get(e):void 0},e.prototype.set=function(e,t){if(!e)throw new ReferenceError(this._moduleName+'::set(): argument "name" is not defined');if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");return this._data.set(e,t)},e.prototype.clear=function(){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");var e=this.getFields(),t=this._data.getFormat();if(t)for(var r=void 0,i=void 0,n=0;n<e.length;n++)if(r=e[n],(i=t.getFieldIndex(r))>-1)this._data.removeField(r)},e.prototype.getFields=function(){var t=[];if(this._isValidData())this._data.getFormat().each(function(e){t.push(e.getName())});return t},e.prototype.addField=function(e,t){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.addField(e,t)},e.prototype.removeField=function(e){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeField(e)},e.prototype.removeFieldAt=function(e){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeFieldAt(e)},e.prototype._touchData=function(){if(!this._data&&this._tableData&&this._tableData["[Types/_entity/FormattableMixin]"]){var e=this._tableData.getModel(),t=this._tableData.getAdapter();this._data=a.create(e,{adapter:t})}},e.prototype._isValidData=function(){return this._data&&this._data["[Types/_entity/Record]"]},e.prototype._getFieldsFormat=function(){return this._isValidData()?this._data.getFormat():a.create("Types/collection:format.Format")},e}(o.mixin(i.default,n.default));(t.default=s).prototype["[Types/_entity/adapter/RecordSetRecord]"]=true,s.prototype["[Types/_entity/adapter/IRecord]"]=true,s.prototype._data=null,s.prototype._tableData=null}(j,e,u,y,Ue,d,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/JsonRecord"]=true;var Ze=function(){"use strict";var e={},t=function(e,t,i,r,n,a,o,s){Object.defineProperty(t,"__esModule",{value:true});var u=function(r){function e(e){var t=r.call(this,e)||this;return n.default.constructor.call(t,e),a.default.constructor.call(t,e),t}return i.__extends(e,r),e.prototype.addField=function(e,t){if(!e||!(e instanceof o.Field))throw new TypeError(this._moduleName+'::addField(): argument "format" should be an instance of Types/entity:format.Field');var r=e.getName();if(this.has(r))throw new Error(this._moduleName+'::addField(): field "'+r+'" already exists');a.default.addField.call(this,e,t),this.set(r,e.getDefaultValue())},e.prototype.removeField=function(e){a.default.removeField.call(this,e),delete this._data[e]},e.prototype.has=function(e){return this._isValidData()?this._data.hasOwnProperty(e):false},e.prototype.get=function(e){return this._isValidData()?this._data[e]:void 0},e.prototype.set=function(e,t){if(!e)throw new ReferenceError(this._moduleName+"::set(): field name is not defined");this._touchData(),this._data[e]=t},e.prototype.clear=function(){this._touchData();for(var e=Object.keys(this._data),t=e.length,r=0;r<t;r++)delete this._data[e[r]]},e.prototype.getFields=function(){return this._isValidData()?Object.keys(this._data):[]},e.prototype.getKeyField=function(){return},e.prototype._has=function(e){return this.has(e)},e}(s.mixin(r.default,n.default,a.default));(t.default=u).prototype["[Types/_entity/adapter/JsonRecord]"]=true,u.prototype["[Types/_entity/adapter/IRecord]"]=true,u.prototype._data=null}(j,e,u,y,Ue,Ge,Qe,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/RecordSetTable"]=true;var Ye=function(){"use strict";var e={},t=function(e,t,i,r,n,a,o){Object.defineProperty(t,"__esModule",{value:true});var s=function(r){function e(e){var t=this;if(e&&!e["[Types/_collection/RecordSet]"])throw new TypeError('Argument "data" should be an instance of Types/collection:RecordSet');return t=r.call(this,e)||this,n.default.constructor.call(t,e),t}return i.__extends(e,r),e.prototype.getFields=function(){var t=[];if(this._isValidData())this._data.getFormat().each(function(e){t.push(e.getName())});return t},e.prototype.getCount=function(){return this._isValidData()?this._data.getCount():0},e.prototype.add=function(e,t){this._buildData(e),this._data.add(e,t)},e.prototype.at=function(e){return this._isValidData()?this._data.at(e):void 0},e.prototype.remove=function(e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");return this._data.removeAt(e)},e.prototype.replace=function(e,t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");return this._data.replace(e,t)},e.prototype.move=function(e,t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");var r=this._data.at(e);this._data.removeAt(e),this._data.add(r,t)},e.prototype.merge=function(r,e,i){if(!this._isValidData())throw new TypeError("Passed data has invalid format");r=this._data.at(r),this._data.at(e).each(function(e,t){if(e!==i)r.set(e,t)},this),this._data.removeAt(e)},e.prototype.copy=function(e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");var t=this._data.at(e).clone();return this.add(t,1+e),t},e.prototype.clear=function(){if(!this._isValidData())throw new TypeError("Passed data has invalid format");for(var e,t=this._data.getCount()-1;t>=0;t--)this._data.removeAt(t)},e.prototype.addField=function(e,t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.addField(e,t)},e.prototype.removeField=function(e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeField(e)},e.prototype.removeFieldAt=function(e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeFieldAt(e)},e.prototype._buildData=function(e){if(!this._data){var t={};if(e){if(e.getAdapter)t.adapter=e.getAdapter();if(e.getIdProperty)t.idProperty=e.getIdProperty()}this._data=a.create("Types/collection:RecordSet",t)}},e.prototype._isValidData=function(){return this._data&&this._data["[Types/_collection/RecordSet]"]},e.prototype._getFieldsFormat=function(){return this._data.getFormat()},e}(o.mixin(r.default,n.default));(t.default=s).prototype["[Types/_entity/adapter/RecordSetTable]"]=true,s.prototype["[Types/_entity/adapter/ITable]"]=true,s.prototype._data=null}(j,e,u,y,Ue,d,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/RecordSet"]=true;var Xe=function(){"use strict";var e={},t=function(e,t,r,i,n,a,o,s){Object.defineProperty(t,"__esModule",{value:true});var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.forTable=function(e){return new n.default(e)},t.prototype.forRecord=function(e,t){return new a.default(e,t)},t.prototype.getProperty=function(e,t){return s.object.getPropertyValue(e,t)},t.prototype.setProperty=function(e,t,r){return s.object.setPropertyValue(e,t,r)},t.prototype.getKeyField=function(e){if(e&&"function"===typeof e.getIdProperty)return e.getIdProperty();return},t}(i.default);(t.default=u).prototype["[Types/_entity/adapter/RecordSet]"]=true,u.prototype._moduleName="Types/entity:adapter.RecordSet",o.register("Types/entity:adapter.RecordSet",u,{instantiate:false}),o.register("adapter.recordset",u,{instantiate:false})}(j,e,u,ae,Ye,Ke,d,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/SbisFormatMixin"]=true;var et=function(){"use strict";var e={},t=function(e,t,a,i,n,o,s){Object.defineProperty(t,"__esModule",{value:true});var r=Object.keys(a.default).reduce(function(e,t){return e[a.default[t]]=t,e},{}),u="undefined"===typeof Symbol?void 0:Symbol("fieldIndices");function l(e){return r[e]||"string"}function f(e){return a.default[(e+"").toLowerCase()]}var d={"[Types/_entity/adapter/SbisFormatMixin]":true,_data:null,_type:"",_fieldIndices:null,_format:null,_sharedFieldFormat:null,_sharedFieldMeta:null,constructor:function(e){if(e&&e._type&&e._type!==this._type)throw new TypeError('Argument "data" has "'+e._type+'" type signature but "'+this._type+'" expected.');if(u&&e&&e.s)e.s[u]=null;this._data=e,this._format={}},getData:function(){return this._data},getFields:function(){var e=[];if(this._isValidData())for(var t=0,r=this._data.s.length;t<r;t++)e.push(this._data.s[t].n);return e},clear:function(){this._touchData(),this._data.d.length=0},getFormat:function(e){if(!this._has(e))throw new ReferenceError(this._moduleName+'::getFormat(): field "'+e+"\" doesn't exist");if(!this._format.hasOwnProperty(e))this._format[e]=this._buildFormat(e);return this._format[e]},getSharedFormat:function(e){var t=this._sharedFieldFormat||(this._sharedFieldFormat=new n.UniversalField),r=this._getFieldIndex(e);if(-1===r)throw new ReferenceError(this._moduleName+'::getSharedFormat(): field "'+e+"\" doesn't exist");return t.name=e,t.type=this._getFieldType(r),t.meta=this._getFieldMeta(r,t.type,true),t},addField:function(e,t){if(!e||!(e instanceof n.Field))throw new TypeError(this._moduleName+"::addField(): format should be an instance of Types/entity:format.Field");var r=e.getName();if(this._has(r))throw new ReferenceError(this._moduleName+'::addField(): field "'+r+'" already exists');if(this._touchData(),void 0===t)t=this._data.s.length;this._checkFieldIndex(t,true),this._format[r]=e,this._resetFieldIndices(),this._data.s.splice(t,0,this._buildS(e)),this._buildD(t,i.default.serialize(e.getDefaultValue(),{format:e}))},removeField:function(e){this._touchData();var t=this._getFieldIndex(e);if(-1===t)throw new ReferenceError(this._moduleName+'::removeField(): field "'+e+"\" doesn't exist");delete this._format[e],this._resetFieldIndices(),this._data.s.splice(t,1),this._removeD(t)},removeFieldAt:function(e){this._touchData(),this._checkFieldIndex(e);var t=this._data.s[e].n;delete this._format[t],this._resetFieldIndices(),this._data.s.splice(e,1),this._removeD(e)},_touchData:function(){this._data=this._normalizeData(this._data,this._type)},_normalizeData:function(e,t){if(!(e instanceof Object))e={};if(!(e.d instanceof Array))e.d=[];if(!(e.s instanceof Array))e.s=[];return e._type=t,e},_cloneData:function(e){var t=s.object.clone(this._data);if(e&&t&&t.s)t.s=this._data.s;return t},_isValidData:function(){return this._data&&this._data.s instanceof Array},_has:function(e){return this._getFieldIndex(e)>=0},_getFieldIndex:function(e){if(!this._isValidData())return-1;var t=this._data.s,r=u?t[u]:this._fieldIndices;if(!u&&r&&this._fieldIndices["[{s}]"]!==t)r=null;if(!r){if(r=new o.Map,u)t[u]=r;else this._fieldIndices=r,this._fieldIndices["[{s}]"]=t;for(var i=0,n=t.length;i<n;i++)r.set(t[i].n,i)}return r.has(e)?r.get(e):-1},_resetFieldIndices:function(){if(this._isValidData())if(u)this._data.s[u]=null;else this._fieldIndices=null},_checkFieldIndex:function(e,t){var r=this._data.s.length-1;if(t)r++;if(!(e>=0&&e<=r))throw new RangeError(this._moduleName+': field index "'+e+'" is out of bounds.')},_getFieldType:function(e){var t,r=this._data.s[e].t;if(r&&r instanceof Object)r=r.n;return l(r)},_getFieldMeta:function(e,t,r){if(r&&null===this._sharedFieldMeta)this._sharedFieldMeta={};var i=this._data.s[e],n=r?this._sharedFieldMeta:{};switch(t){case"real":n.precision=i.t.p;break;case"money":if(n.precision=void 0,"object"===typeof i.t&&"p"in i.t)n.precision=i.t.p;n.large=!!i.t.l;break;case"enum":case"flags":n.dictionary=i.t.s,n.localeDictionary=i.t.sl;break;case"datetime":n.withoutTimeZone=i.t&&i.t.n&&"tz"in i.t?!i.t.tz:false;break;case"identity":n.separator=",";break;case"array":n.kind=l(i.t.t),Object.assign(n,this._getFieldMeta(e,n.kind))}return n},_checkFormat:function(e,t){var r=this._isValidData()?this._data.s:[],i=e?e.s||[]:[],n=r.length,a;if(r===i)return;if(t=t||"",n!==i.length)a=n+" columns expected instead of "+i.length;else for(var o=0;o<n;o++)if(a=this._checkFormatColumns(r[o],i[o]||{},o))break;if(a)s.logger.info(this._moduleName+t+": the formats are not equal ("+a+")")},_checkFormatColumns:function(e,t,r){if(e.n!==t.n)return'field with name "'+e.n+'" at position '+r+' expected instead of "'+t.n+'"';var i=e.t,n;if(i&&i.n)i=i.n;if((n=t.t)&&n.n)n=n.n;if(i!==n)return'expected field type for "'+e.n+'" at position '+r+' is "'+i+'" instead of "'+n+'"'},_buildFormatDeclaration:function(e){var t=this._getFieldIndex(e),r=this._getFieldType(t),i=this._getFieldMeta(t,r);return i.name=e,i.type=r,i},_buildFormat:function(e){return n.fieldsFactory(this._buildFormatDeclaration(e))},_buildS:function(e){var t={n:e.getName()};return this._buildSType(t,e),t},_buildSType:function(e,t){var r=(t.getTypeName()+"").toLowerCase();switch(r){case"money":if(t.isLarge())e.t={n:a.default[r],l:true};else e.t=a.default[r];break;case"enum":case"flags":var i=t.getDictionary();if(i instanceof Array)i=i.reduce(function(e,t,r){return e[r]=t,e},{});e.t={n:a.default[r],s:i};break;case"datetime":var n=t.isWithoutTimeZone();if(n)e.t={n:a.default[r],tz:!n};else e.t=a.default[r];break;case"array":e.t={n:a.default[r],t:f(t.getKind())};break;default:e.t=a.default[r]}},_buildD:function(){throw new Error("Method must be implemented")},_removeD:function(){throw new Error("Method must be implemented")}};t.default=d}(j,e,b,We,Qe,s,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/SbisRecord"]=true;var tt=function(){"use strict";var e={},t=function(e,t,i,r,n,a){Object.defineProperty(t,"__esModule",{value:true});var o=function(r){function t(e){var t=r.call(this,e)||this;return n.default.constructor.call(t,e),t}return i.__extends(t,r),t.prototype.has=function(e){return this._has(e)},t.prototype.get=function(e){var t=this._getFieldIndex(e);return t>=0?this._cast(this._data.s[t],this._data.d[t]):void 0},t.prototype.set=function(e,t){var r=this._getFieldIndex(e);if(r<0)throw new ReferenceError(this._moduleName+'::set(): field "'+e+'" is not defined');this._data.d[r]=this._uncast(this._data.s[r],t)},t.prototype.clear=function(){this._touchData(),n.default.clear.call(this),this._data.s.length=0},t.prototype.clone=function(e){return new t(e?this.getData():this._cloneData(true))},t.prototype._buildD=function(e,t){this._data.d.splice(e,0,t)},t.prototype._removeD=function(e){this._data.d.splice(e,1)},t.prototype._cast=function(e,t){switch(e&&e.t){case"Идентификатор":return t instanceof Array?null===t[0]?t[0]:t.join(this._castSeparator):t}return t},t.prototype._uncast=function(e,t){switch(e&&e.t){case"Идентификатор":if(t instanceof Array)return t;return"string"===typeof t?t.split(this._castSeparator):[t]}return t},t}(a.mixin(r.default,n.default));(t.default=o).prototype["[Types/_entity/adapter/SbisRecord]"]=true,o.prototype["[Types/_entity/adapter/IRecord]"]=true,o.prototype["[Types/_entity/ICloneable]"]=true,o.prototype._type="record",o.prototype._castSeparator=",",o.prototype["[WS.Data/Entity/ICloneable]"]=true}(j,e,u,y,et,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/SbisTable"]=true;var rt=function(){"use strict";var e={},t=function(e,t,i,r,n,a,o,s,u){Object.defineProperty(t,"__esModule",{value:true});var l=function(r){function t(e){var t=r.call(this,e)||this;return n.default.constructor.call(t,e),t}return i.__extends(t,r),t.prototype.getCount=function(){return this._isValidData()?this._data.d.length:0},t.prototype.add=function(e,t){if(this._touchData(),e=this._normalizeData(e,a.default.prototype._type),0===this._data.d.length&&e.s)this._data.s=e.s;if(this._checkFormat(e,"::add()"),e.s=this._data.s,void 0===t)this._data.d.push(e.d);else this._checkRowIndex(t,true),this._data.d.splice(t,0,e.d)},t.prototype.at=function(e){return this._isValidData()&&this._data.d[e]?{d:this._data.d[e],s:this._data.s}:void 0},t.prototype.remove=function(e){this._touchData(),this._checkRowIndex(e),this._data.d.splice(e,1)},t.prototype.replace=function(e,t){if(this._touchData(),this._checkRowIndex(t),!this._data.s.length&&e.s.length)this._data.s=e.s;e.s=this._data.s,this._checkFormat(e,"::replace()"),this._data.d[t]=e.d},t.prototype.move=function(e,t){if(this._touchData(),t===e)return;var r=this._data.d.splice(e,1);-1===t?this._data.d.unshift(r.shift()):this._data.d.splice(t,0,r.shift())},t.prototype.merge=function(e,t){this._touchData(),this._checkRowIndex(e),this._checkRowIndex(t),u.merge(this._data.d[e],this._data.d[t]),this.remove(t)},t.prototype.copy=function(e){this._touchData(),this._checkRowIndex(e);var t=this._data.d[e],r=u.merge([],t);return this._data.d.splice(1+e,0,r),r},t.prototype.getMetaDataDescriptor=function(){var t=[],e=this.getData();if(!(e instanceof Object))return t;if(e.hasOwnProperty("r"))t.push(o.fieldsFactory({name:"results",type:"record"}));if(e.hasOwnProperty("p"))t.push(o.fieldsFactory({name:"path",type:"recordset"}));if(e.hasOwnProperty("n")){var r="integer";switch(typeof e.n){case"boolean":r="boolean";break;case"object":if(e.n)r="object"}t.push(o.fieldsFactory({name:"total",type:r})),t.push(o.fieldsFactory({name:"more",type:r}))}if(e.hasOwnProperty("m")){var i=new a.default(e.m);i.getFields().forEach(function(e){t.push(i.getFormat(e))})}return t},t.prototype.getMetaData=function(e){var t=this._getMetaDataAlias(e),r=this.getData(),i;if(t)return r&&r instanceof Object?r[t]:void 0;return new a.default(r.m).get(e)},t.prototype.setMetaData=function(e,t){var r=this._getMetaDataAlias(e),i=this.getData(),n;if(r){if(i&&i instanceof Object)i[r]=t;return}new a.default(i.m).set(e,t)},t.prototype._getMetaDataAlias=function(e){switch(e){case"results":return"r";case"path":return"p";case"more":case"total":return"n"}},t.prototype.clone=function(e){return new t(e?this.getData():this._cloneData())},t.prototype._buildD=function(t,r){this._data.d.forEach(function(e){e.splice(t,0,r)})},t.prototype._removeD=function(t){this._data.d.forEach(function(e){e.splice(t,1)})},t.prototype._checkRowIndex=function(e,t){var r=this._data.d.length+(t?0:-1);if(!(e>=0&&e<=r))throw new RangeError(this._moduleName+": row index "+e+" is out of bounds.")},t}(s.mixin(r.default,n.default));(t.default=l).prototype["[Types/_entity/adapter/SbisTable]"]=true,l.prototype["[Types/_entity/adapter/ITable]"]=true,l.prototype["[Types/_entity/adapter/IMetaData]"]=true,l.prototype["[Types/_entity/ICloneable]"]=true,l.prototype._type="recordset",l.prototype["[WS.Data/Entity/ICloneable]"]=true}(j,e,u,y,et,tt,Qe,c,i);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/JsonTable"]=true;var it=function(){"use strict";var e={},t=function(e,t,i,r,n,o,s,u,a,l){Object.defineProperty(t,"__esModule",{value:true});var f=function(r){function e(e){var t=r.call(this,e)||this;return n.default.constructor.call(t,e),o.default.constructor.call(t,e),t}return i.__extends(e,r),e.prototype.addField=function(e,t){o.default.addField.call(this,e,t);for(var r=e.getName(),i=e.getDefaultValue(),n,a=0;a<this._data.length;a++)if(!(n=this._data[a]).hasOwnProperty(r))n[r]=i},e.prototype.removeField=function(e){o.default.removeField.call(this,e);for(var t=0;t<this._data.length;t++)delete this._data[t][e]},e.prototype.getFields=function(){for(var e=this.getCount(),t=new u.Set,r=[],i,n=function(e){t.add(e)},a=0;a<e;a++)if((i=this.at(a))instanceof Object)Object.keys(i).forEach(n);return t.forEach(function(e){r.push(e)}),r},e.prototype.getCount=function(){return this._isValidData()?this._data.length:0},e.prototype.add=function(e,t){if(this._touchData(),void 0===t)this._data.push(e);else this._checkPosition(t),this._data.splice(t,0,e)},e.prototype.at=function(e){return this._isValidData()?this._data[e]:void 0},e.prototype.remove=function(e){this._touchData(),this._checkPosition(e),this._data.splice(e,1)},e.prototype.replace=function(e,t){this._touchData(),this._checkPosition(t),this._data[t]=e},e.prototype.move=function(e,t){if(this._touchData(),t===e)return;var r=this._data.splice(e,1);if(-1===t)this._data.unshift(r.shift());else this._data.splice(t,0,r.shift())},e.prototype.merge=function(e,t,r){this._touchData();var i=this.at(e),n=this.at(t),a=new s.default(i),o=a.get(r);l.merge(i,n),a.set(r,o),this.remove(t)},e.prototype.copy=function(e){this._touchData();var t=this.at(e),r=l.merge({},t);return this.add(r,1+e),r},e.prototype.clear=function(){this._touchData(),this._data.length=0},e.prototype._touchData=function(){if(n.default._touchData.call(this),!(this._data instanceof Array))this._data=[]},e.prototype._isValidData=function(){return this._data instanceof Array},e.prototype._has=function(e){for(var t=this.getCount(),r=false,i,n=0;n<t;n++)if((i=this.at(n))instanceof Object)if(r=i.hasOwnProperty(e))break;return r},e.prototype._checkPosition=function(e){if(e<0||e>this._data.length)throw new Error("Out of bounds")},e}(a.mixin(r.default,n.default,o.default));(t.default=f).prototype["[Types/_entity/adapter/JsonTable]"]=true,f.prototype._data=null}(j,e,u,y,Ue,Ge,Ze,s,c,i);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/Json"]=true;var nt=function(){"use strict";var e={},t=function(e,t,r,i,n,a,o){Object.defineProperty(t,"__esModule",{value:true});var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.forTable=function(e){return new n.default(e)},t.prototype.forRecord=function(e){return new a.default(e)},t.prototype.getKeyField=function(){return},t}(i.default);(t.default=s).prototype["[Types/_entity/adapter/Json]"]=true,s.prototype._moduleName="Types/entity:adapter.Json",o.register("Types/entity:adapter.Json",s,{instantiate:false}),o.register("adapter.json",s)}(j,e,u,ae,it,Ze,d);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter/Sbis"]=true;var at=function(){"use strict";var e={},t=function(e,t,r,i,n,a,o,s){Object.defineProperty(t,"__esModule",{value:true});var u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r.__extends(t,e),t.prototype.forTable=function(e){return new n.default(e)},t.prototype.forRecord=function(e){return new a.default(e)},t.prototype.getKeyField=function(e){var t,r;if(e&&e.s){for(var i=0,n=(r=e.s).length;i<n;i++)if(r[i].n&&"@"===r[i].n[0]){t=i;break}if(void 0===t&&r.length)t=0}return void 0===t?void 0:r[t].n},Object.defineProperty(t,"FIELD_TYPE",{get:function(){return o.default},enumerable:true,configurable:true}),t}(i.default);(t.default=u).prototype["[Types/_entity/adapter/Sbis]"]=true,u.prototype._moduleName="Types/entity:adapter.Sbis",s.register("Types/entity:adapter.Sbis",u,{instantiate:false}),s.register("adapter.sbis",u)}(j,e,u,ae,rt,tt,b,d);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Types/_entity/adapter"]=true;var ot=function(){"use strict";var e={},t=(r=j,i=e,n=ae,a=ge,o=Ue,s=nt,u=re,l=ie,f=ne,d=te,c=Xe,p=Ke,h=Ye,y=at,_=b,v=tt,m=rt,Object.defineProperty(i,"__esModule",{value:true}),i.Abstract=n.default,i.Cow=a.default,i.GenericFormatMixin=o.default,i.Json=s.default,i.IAdapter=u.default,i.IMetaData=l.default,i.IRecord=f.default,i.ITable=d.default,i.RecordSet=c.default,i.RecordSetRecord=p.default,i.RecordSetTable=h.default,i.Sbis=y.default,i.SbisFieldType=_.default,i.SbisRecord=v.default,void(i.SbisTable=m.default)),r,i,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m;if(t instanceof Function)return t;else for(var g in t)if(t.hasOwnProperty(g))e[g]=t[g];return e}(),st=ot;e["Types/_entity/FormattableMixin"]=true;var ut=function(){"use strict";var e={},t=function(e,t,a,r,o,n){Object.defineProperty(t,"__esModule",{value:true});var i="Types/entity:adapter.Json";function s(e,t){var r,i;for(var n in e){if(!e.hasOwnProperty(n))continue;if("object"!==typeof(r=e[n]))r={type:r};if(!(r instanceof a.Field))r=a.fieldsFactory(r);if(r.setName(n),-1===(i=t.getFieldIndex(n)))t.add(r);else t.replace(r,i)}return t}function u(){for(var e,t=new(o.resolve("Types/collection:format.Format")),r=this._getRawDataAdapter(),i=this._getRawDataFields(),n=i.length,a=0;a<n;a++)t.add(r.getFormat(i[a]));return t}function l(){var t=this;if(this._hasFormat()){var r=this._getRawDataAdapter(),i=r.getFields();if(r["[Types/_entity/adapter/IDecorator]"])r=r.getOriginal();if(r._touchData)r._touchData();this._getFormat().each(function(e){try{if(-1===i.indexOf(e.getName()))r.addField(e)}catch(e){n.logger.info(t._moduleName+"::constructor(): can't add raw data field ("+e.message+")")}})}}var f={"[Types/_entity/FormattableMixin]":true,"[WS.Data/Entity/FormattableMixin]":true,_$rawData:null,_$cow:false,_$adapter:i,_$format:null,_format:null,_formatClone:null,_rawDataAdapter:null,_rawDataFields:null,constructor:function(){if(!this._$format&&this._options&&this._options.format)this._$format=this._options.format;l.call(this)},_getSerializableState:function(e){return e.$options.rawData=this._getRawData(),e},_setSerializableState:function(e){return function(){}},getRawData:function(e){return e?this._getRawData():n.object.clone(this._getRawData())},setRawData:function(e){this._resetRawDataAdapter(e),this._resetRawDataFields(),this._clearFormatClone(),l.call(this)},getAdapter:function(){var e=this._getAdapter();if(e["[Types/_entity/adapter/IDecorator]"])e=e.getOriginal();return e},getFormat:function(e){if(e)return this._getFormat(true);if(!this._formatClone)this._formatClone=this._getFormat(true).clone(true);return this._formatClone},addField:function(e,t){e=this._buildField(e),this._$format=this._getFormat(true),this._$format.add(e,t),this._getRawDataAdapter().addField(e,t),this._resetRawDataFields(),this._clearFormatClone()},removeField:function(e){this._$format=this._getFormat(true),this._$format.removeField(e),this._getRawDataAdapter().removeField(e),this._resetRawDataFields(),this._clearFormatClone()},removeFieldAt:function(e){this._$format=this._getFormat(true),this._$format.removeAt(e),this._getRawDataAdapter().removeFieldAt(e),this._resetRawDataFields(),this._clearFormatClone()},_getRawData:function(e){if(!e&&this._rawDataAdapter)return this._rawDataAdapter.getData();return"function"===typeof this._$rawData?this._$rawData():this._$rawData},_getDefaultAdapter:function(){return i},_getAdapter:function(){if(this._$adapter===i&&f._getDefaultAdapter!==this._getDefaultAdapter)this._$adapter=this._getDefaultAdapter();if(this._$adapter&&!(this._$adapter instanceof Object))this._$adapter=o.create(this._$adapter);if(this._$cow&&!this._$adapter["[Types/_entity/adapter/IDecorator]"])this._$adapter=new r.Cow(this._$adapter);return this._$adapter},_getRawDataAdapter:function(){if(!this._rawDataAdapter)this._rawDataAdapter=this._createRawDataAdapter();return this._rawDataAdapter},_createRawDataAdapter:function(){throw new Error("Method must be implemented")},_resetRawDataAdapter:function(e){if(void 0===e){if(this._rawDataAdapter&&"function"!==typeof this._$rawData)this._$rawData=this._rawDataAdapter.getData()}else this._$rawData=e;this._rawDataAdapter=null},_checkAdapterCompatibility:function(e){var t=this._getAdapter(),r;if(e["[Types/_entity/adapter/IDecorator]"])e=e.getOriginal();if(t["[Types/_entity/adapter/IDecorator]"])t=t.getOriginal();if(!Object.getPrototypeOf(t).isPrototypeOf(e))throw new TypeError('The foreign adapter "'+e._moduleName+'" is incompatible with the internal adapter "'+t._moduleName+'"')},_getRawDataFields:function(){return this._rawDataFields||(this._rawDataFields=this._getRawDataAdapter().getFields())},_addRawDataField:function(e){this._getRawDataFields().push(e)},_resetRawDataFields:function(){this._rawDataFields=null},_getFormat:function(e){var t=this;if(!this._format)if(this._hasFormat())this._format=this._$format=f._buildFormat(this._$format,function(){return u.call(t)});else if(e)this._format=u.call(this);return this._format},_clearFormat:function(){if(this._hasFormat())throw new Error(this._moduleName+": format can't be cleared because it's defined directly");this._format=null,this._clearFormatClone()},_clearFormatClone:function(){this._formatClone=null},_hasFormat:function(){return!!this._$format},_getFieldFormat:function(e,t){if(this._hasFormat()){var r=this._getFormat(),i=r.getFieldIndex(e);if(i>-1)return r.at(i)}return t.getSharedFormat(e)},_getFieldType:function(e){var t=e.getType?e.getType():e.type;if(t&&"string"===typeof t)if(o.isRegistered(t))t=o.resolve(t);return t},_buildField:function(e){if("string"===typeof e||Object.getPrototypeOf(e)===Object.prototype)e=a.fieldsFactory(e);if(!e||!(e instanceof a.Field))throw new TypeError(this._moduleName+": format should be an instance of Types/entity:format.Field");return e},_buildFormat:function(e,t){var r=o.resolve("Types/collection:format.Format");if(e){var i=Object.getPrototypeOf(e);if(i===Array.prototype){var n;e=o.resolve("Types/collection:format.factory")(e)}else if(i===Object.prototype)e=s(e,t?t():new r)}if(!e||!(e instanceof r))e=new r;return e}};t.default=f}(j,e,Qe,ot,d,c);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),lt=ut;e["Types/_entity/Record"]=true;var ft=function(){"use strict";var e={},t=function(e,t,i,r,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m){function g(e){return e&&"object"===typeof e?false:true}function b(e){if(e&&"object"===typeof e&&e!==e.valueOf())return e.valueOf();return e}function F(e,t){return b(e)===b(t)}function w(e){switch(typeof e){case"boolean":return"boolean";case"number":if(e%1===0)return"integer";return"real";case"object":if(null===e)return"string";else if(e instanceof E)return"record";else if(e&&e["[Types/_collection/RecordSet]"])return"recordset";else if(e instanceof Date){if(e.hasOwnProperty("_serializeMode"))switch((e=e).getSQLSerializationMode()){case Date.SQL_SERIALIZE_MODE_DATE:return"date";case Date.SQL_SERIALIZE_MODE_TIME:return"time"}return"datetime"}else if(e instanceof Array)return{type:"array",kind:w(e.find(function(e){return null!==e&&void 0!==e}))};return"object";default:return"string"}}Object.defineProperty(t,"__esModule",{value:true});var T=r.protect("fieldsCache"),D=r.protect("fieldsClone"),O=r.protect("changedFields"),P={ADDED:"Added",DELETED:"Deleted",CHANGED:"Changed",UNCHANGED:"Unchanged",DETACHED:"Detached"},M="field.",C=r.protect("objects"),I=r.protect("all"),E=function(r){function u(e){var t=this;if(e&&e.owner&&!e.owner["[Types/_collection/RecordSet]"])throw new TypeError("Records owner should be an instance of Types/collection:RecordSet");return t=r.call(this,e)||this,a.default.call(t,e),s.default.constructor.call(t),d.default.constructor.call(t,e),f.default.constructor.call(t,e),t._publish("onPropertyChange"),t._clearChangedFields(),t._acceptedState=t._$state,t}return i.__extends(u,r),Object.defineProperty(u.prototype,"_fieldsCache",{get:function(){return this[T]||(this[T]=new _.Map)},enumerable:true,configurable:true}),Object.defineProperty(u.prototype,"_fieldsClone",{get:function(){return this[D]||(this[D]=new _.Map)},enumerable:true,configurable:true}),Object.defineProperty(u.prototype,"_changedFields",{get:function(){var t=this,r={},i=this[O],n,a,o;if(!i)return r;return Object.keys(i).forEach(function(e){if(n=i[e],o=n[0],a=n[1],o&&a&&o["[Types/_entity/Record]"]&&!o.isChanged())return;r[e]=t._haveToClone(o)&&t._fieldsClone.has(e)?t._fieldsClone.get(e):o}),r},enumerable:true,configurable:true}),u.prototype.destroy=function(){this[O]=null,this._clearFieldsCache(),f.default.destroy.call(this),n.default.prototype.destroy.call(this)},u.prototype.get=function(e){if(this._fieldsCache.has(e))return this._fieldsCache.get(e);var t=this._getRawDataValue(e);if(this._isFieldValueCacheable(t))if(this._addChild(t,this._getRelationNameForField(e)),this._fieldsCache.set(e,t),this._haveToClone(t))this._fieldsClone.set(e,t.clone());return t},u.prototype.set=function(e,t){var r=this,i=this._getHashMap(e,t),n=[],a=this._setPairs(Object.keys(i).map(function(e){return[e,i[e],r.get(e)]}),n);if(a)this._notifyChange(a);this._checkErrors(n)},u.prototype.has=function(e){return this._getRawDataFields().indexOf(e)>-1},u.prototype._setPairs=function(e,n){var a=this,o=null;return e.forEach(function(e){var t=e[0],r=e[1],i=e[2];if(F(r,i)){if("object"===typeof r)a._setRawDataValue(t,r)}else try{if(a._removeChild(i),g(r))r=a._setRawDataValue(t,r);else a._setRawDataValue(t,r);if(a._addChild(r,a._getRelationNameForField(t)),r!==i){if(!a.has(t))a._addRawDataField(t);if(!o)o={};if(o[t]=r,a._hasChangedField(t)&&b(a._getChangedFieldValue(t))===b(r))a._unsetChangedField(t);else a._setChangedField(t,i);if(a._isFieldValueCacheable(r)){if(a._fieldsCache.set(t,r),a._haveToClone(r))a._fieldsClone.set(t,r.clone())}else a._fieldsCache.delete(t),a._fieldsClone.delete(t)}}catch(e){n.push(e)}}),o},u.prototype.getEnumerator=function(){var e;return new(h.resolve("Types/collection:enumerator.Arraywise"))(this._getRawDataFields())},u.prototype.each=function(e,t){var r=this.getEnumerator(),i;while(r.moveNext())i=r.getCurrent(),e.call(t||this,i,this.get(i))},u.prototype.isEqual=function(e){if(e===this)return true;if(!e)return false;if(!(e instanceof u))return false;return JSON.stringify(this._getRawData())===JSON.stringify(e.getRawData(true))},u.prototype.relationChanged=function(e,t){var a=this,r=function(e,t){var r={},i,n;if(a._getRawDataAdapter().has(e))a._setRawDataValue(e,t,true);return a._setChangedField(e,t,true),r[e]=t,a._notify("onPropertyChange",r),r},i=t[0],n=this._getFieldFromRelationName(i),o=e.target;switch(e.original){case u.prototype.acceptChanges:if(n&&(o["[Types/_entity/Record]"]&&!o.isChanged()||o["[Types/_collection/RecordSet]"]&&!o.isChanged()))this.acceptChanges([n]);break;case u.prototype.rejectChanges:if(n&&(o["[Types/_entity/Record]"]&&!o.isChanged()||o["[Types/_collection/RecordSet]"]&&!o.isChanged()))this.rejectChanges([n]);break;case u.prototype.addField:case u.prototype.removeField:case u.prototype.removeFieldAt:if(this._resetRawDataAdapter(),this._resetRawDataFields(),n)r(n,o);break;default:if(n){var s;return{target:o,data:r(n,o)}}}},u.produceInstance=function(e,t){var r={rawData:e};if(t&&t.adapter)r.adapter=t.adapter;return new this(r)},u.prototype._getSerializableState=function(e){if(e=s.default.prototype._getSerializableState.call(this,e),(e=d.default._getSerializableState.call(this,e))._changedFields=this[O],e.$options.owner&&e.$options.owner._hasFormat())e._format=e.$options.owner.getFormat();return delete e.$options.owner,e},u.prototype._setSerializableState=function(e){var t=s.default.prototype._setSerializableState(e),r=d.default._setSerializableState(e);return function(){if(t.call(this),r.call(this),this[O]=e._changedFields,e._format)this._$format=e._format}},u.prototype.setRawData=function(e){d.default.setRawData.call(this,e),this._nextVersion(),this._clearFieldsCache(),this._notifyChange()},u.prototype.addField=function(e,t,r){if(this._checkFormatIsWritable(),e=this._buildField(e),d.default.addField.call(this,e,t),void 0!==r)this.set(e.getName(),r);this._childChanged(u.prototype.addField),this._nextVersion()},u.prototype.removeField=function(e){this._checkFormatIsWritable(),this._nextVersion(),this._fieldsCache.delete(e),this._fieldsClone.delete(e),d.default.removeField.call(this,e),this._childChanged(u.prototype.removeField)},u.prototype.removeFieldAt=function(e){this._checkFormatIsWritable(),this._nextVersion();var t=this._getFormat(true).at(e);if(t)this._fieldsCache.delete(t.getName()),this._fieldsClone.delete(t.getName());d.default.removeFieldAt.call(this,e),this._childChanged(u.prototype.removeFieldAt)},u.prototype._hasFormat=function(){var e=this.getOwner();if(e)return e._hasFormat();else return d.default._hasFormat.call(this)},u.prototype._getFormat=function(e){var t=this.getOwner();if(t)return t._getFormat(e);else return d.default._getFormat.call(this,e)},u.prototype._getFieldFormat=function(e,t){var r=this.getOwner();if(r)return r._getFieldFormat(e,t);else return d.default._getFieldFormat.call(this,e,t)},u.prototype._createRawDataAdapter=function(){return this._getAdapter().forRecord(this._getRawData(true))},u.prototype._checkFormatIsWritable=function(){var e;if(this.getOwner())throw new Error("Record format has read only access if record belongs to recordset. You should change recordset format instead.")},u.prototype.isChanged=function(e){return e?this._hasChangedField(e):this.getChanged().length>0},u.prototype.getOwner=function(){return this._$owner},u.prototype.detach=function(){this._$owner=null,this.setState(P.DETACHED)},u.prototype.getState=function(){return this._$state},u.prototype.setState=function(e){this._$state=e},u.prototype.getChanged=function(){return Object.keys(this._changedFields)},u.prototype.acceptChanges=function(e,t){var r=this;if(void 0===t&&"boolean"===typeof e)t=e,e=void 0;if(void 0===e)this._clearChangedFields();else{if(!(e instanceof Array))throw new TypeError('Argument "fields" should be an instance of Array');e.forEach(function(e){r._unsetChangedField(e)})}if(0===this.getChanged().length)switch(this._$state){case P.ADDED:case P.CHANGED:this._$state=P.UNCHANGED;break;case P.DELETED:this._$state=P.DETACHED}if(this._acceptedState=this._$state,t)this._childChanged(u.prototype.acceptChanges)},u.prototype.rejectChanges=function(e,t){var r=this;if(void 0===t&&"boolean"===typeof e)t=e,e=void 0;var i={};if(void 0===e)e=this.getChanged();else if(!(e instanceof Array))throw new TypeError('Argument "fields" should be an instance of Array');for(var n in e.forEach(function(e){if(r._hasChangedField(e))i[e]=r._getChangedFieldValue(e)}),this.set(i),i)if(i.hasOwnProperty(n))this._unsetChangedField(n);if(0===this.getChanged().length)this._$state=this._acceptedState;if(t)this._childChanged(u.prototype.rejectChanges)},u.prototype.toString=function(){var r={};return this.each(function(e,t){r[e]=t}),JSON.stringify(r)},u.prototype._getRelationNameForField=function(e){return M+e},u.prototype._getFieldFromRelationName=function(e){if((e+="").substr(0,M.length)===M)return e.substr(M.length)},u.prototype._checkErrors=function(e){if(e.length){for(var t=e[0],r=e.length;r>0;r--)if(t>e[r])t=e[r];throw t}},u.prototype._getHashMap=function(e,t){var r=e;if(!(r instanceof Object))(r={})[e]=t;return r},u.prototype._clearFieldsCache=function(){this[T]=null,this[D]=null},u.prototype._isFieldValueCacheable=function(e){switch(this._$cacheMode){case C:return e instanceof Object;case I:return true}return false},u.prototype._haveToClone=function(e){return this._$cloneChanged&&e&&e["[Types/_entity/ICloneable]"]},u.prototype._getRawDataValue=function(e){var t=this._getRawDataAdapter();if(!t.has(e))return;var r=t.get(e),i=this._getFieldFormat(e,t);return p.default.cast(r,this._getFieldType(i),{format:i,adapter:this._getAdapter()})},u.prototype._setRawDataValue=function(e,t,r){if(!r&&t&&t["[Types/_entity/FormattableMixin]"])this._checkAdapterCompatibility(t.getAdapter());var i=this._getRawDataAdapter();return t=p.default.serialize(t,{format:this._getFieldFormat(e,i),adapter:this.getAdapter()}),i.set(e,t),t},u.prototype._notifyChange=function(e){e=e||{},this._childChanged(e),this._nextVersion(),this._notify("onPropertyChange",e)},u.prototype._clearChangedFields=function(){this[O]={}},u.prototype._hasChangedField=function(e){return this._changedFields.hasOwnProperty(e)},u.prototype._getChangedFieldValue=function(e){return this._changedFields[e]},u.prototype._setChangedField=function(e,t,r){if(!this[O].hasOwnProperty(e))this[O][e]=[t,Boolean(r)];switch(this._$state){case P.UNCHANGED:this._$state=P.CHANGED}},u.prototype._unsetChangedField=function(e){delete this[O][e]},Object.defineProperty(u,"RecordState",{get:function(){return P},enumerable:true,configurable:true}),Object.defineProperty(u,"CACHE_MODE_OBJECTS",{get:function(){return C},enumerable:true,configurable:true}),Object.defineProperty(u,"CACHE_MODE_ALL",{get:function(){return I},enumerable:true,configurable:true}),u.addFieldTo=function(e,t,r,i){if(!i){if(!((i=w(r))instanceof Object))i={type:i};i.name=t}e.addField(i,void 0,r)},u.fromObject=function(e,t){if(null===e)return e;if(e&&e instanceof u)return e;var r=new u({adapter:t||"Types/entity:adapter.Json",format:[]}),i=[];for(var n in e)if(e.hasOwnProperty(n))i.push(n);for(var a=0,o=(i=i.sort()).length;a<o;a++){var n,s=e[n=i[a]];if(void 0===s)continue;u.addFieldTo(r,n,s)}return r},u.filter=function(i,n){var a=new u({adapter:i.getAdapter()}),e;return i.getFormat().each(function(e){var t=e.getName(),r=i.get(t);if(!n||n(t,r))a.addField(e),a.set(t,r)}),a.acceptChanges(),a},u.filterFields=function(e,t){if(!(t instanceof Array))throw new TypeError('Argument "fields" should be an instance of Array');return u.filter(e,function(e){return t.indexOf(e)>-1})},u.extend=function(e,t){return v.logger.info("Types/entity:Record","Method extend is deprecated, use ES6 extends or Core/core-extend"),m(this,e,t)},u}(y.mixin(n.default,a.default,o.default,s.default,u.default,l.default,f.default,d.default,c.default));(t.default=E).prototype["[Types/_entity/Record]"]=true,E.prototype["[Types/_collection/IEnumerable]"]=true,E.prototype["[Types/_entity/ICloneable]"]=true,E.prototype["[Types/_entity/IEquatable]"]=true,E.prototype["[Types/_entity/IObject]"]=true,E.prototype["[Types/_entity/IObservableObject]"]=true,E.prototype["[Types/_entity/IProducible]"]=true,E.prototype["[Types/_entity/IVersionable]"]=true,E.prototype["[Types/_entity/relation/IReceiver]"]=true,E.prototype._moduleName="Types/entity:Record",E.prototype[O]=null,E.prototype._$state=P.DETACHED,E.prototype._$cacheMode=C,E.prototype._$cloneChanged=false,E.prototype._$owner=null,E.prototype._acceptedState=void 0,E.prototype["[WS.Data/Entity/Record]"]=true,E.prototype["[WS.Data/Collection/IEnumerable]"]=true,E.prototype["[WS.Data/Entity/ICloneable]"]=true,h.register("Types/entity:Record",E,{instantiate:false})}(j,e,u,c,y,h,z,J,L,pe,ve,ut,G,We,d,c,s,c,o);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),dt=ft;e["Types/_entity/Model"]=true;var ct,pt=function(){"use strict";var e={},t=function(e,t,r,c,i,p,n,a,h,o){Object.defineProperty(t,"__esModule",{value:true});var s=".",u=function(d){function i(e){var t=d.call(this,e)||this;if(t._propertiesInjected=e&&"properties"in e,t._options){if(t._options.properties){var r={};Object.assign(r,t._$properties),Object.assign(r,t._options.properties),t._$properties=r}if(t._options.idProperty)t._$idProperty=t._options.idProperty}if(!t._$idProperty)t._$idProperty=t._getAdapter().getKeyField(t._getRawData())||"";return t}return r.__extends(i,d),i.prototype.destroy=function(){this._defaultPropertiesValues=null,this._propertiesDependency=null,this._calculatingProperties=null,this._deepChangedProperties=null,d.prototype.destroy.call(this)},i.prototype.get=function(e){this._pushDependency(e);var t=this._calculatingProperties?this._calculatingProperties.has(e):false;if(!t&&this._fieldsCache.has(e))return this._fieldsCache.get(e);var r=this._$properties&&this._$properties[e],i=d.prototype.get.call(this,e);if(!r)return i;var n=i;if("def"in r&&!this._getRawDataAdapter().has(e))n=this.getDefault(e);if(!r.get)return n;var a=this._processCalculatedValue(e,n,r,true);if(a!==i)this._removeChild(i),this._addChild(a,this._getRelationNameForField(e));if(!t&&this._isFieldValueCacheable(a))this._fieldsCache.set(e,a);else if(this._fieldsCache.has(e))this._fieldsCache.delete(e);return a},i.prototype.set=function(e,t){var i=this,r;if(!this._$properties)return void d.prototype.set.call(this,e,t);var n=this._getHashMap(e,t),a=[],o=[],s=this._calculatingProperties?this._calculatingProperties.size>0:false;if(Object.keys(n).forEach(function(e){i._deleteDependencyCache(e);var t=n[e];try{var r=i._$properties&&i._$properties[e];if(r)if(r.set){if(i._fieldsCache.has(e))i._removeChild(i._fieldsCache.get(e)),i._fieldsCache.delete(e);if(void 0===(t=i._processCalculatedValue(e,t,r,false)))return}else if(r.get)return void o.push(new ReferenceError('Property "'+e+'" is read only'));a.push([e,t,c.default.prototype.get.call(i,e)])}catch(e){o.push(e)}}),s&&a.length)this._deepChangedProperties=this._deepChangedProperties||[],(r=this._deepChangedProperties).push.apply(r,a);else if(!s&&this._deepChangedProperties)a.push.apply(a,this._deepChangedProperties),this._deepChangedProperties.length=0;var u=[];if(!s){var l=d.prototype._setPairs.call(this,a,u);if(l){var f=Object.keys(l).reduce(function(e,t){return e[t]=i.get(t),e},{});this._notifyChange(f)}}this._checkErrors(o.concat(u))},i.prototype.has=function(e){return this._$properties&&this._$properties.hasOwnProperty(e)||d.prototype.has.call(this,e)},i.prototype.getEnumerator=function(){var e;return new(n.resolve("Types/collection:enumerator.Arraywise"))(this._getAllProperties())},i.prototype.each=function(e,t){return d.prototype.each.call(this,e,t)},i.prototype.relationChanged=function(i,e){var n=this,a=[],o=e.length-1;return e.forEach(function(e,t){var r=n._getFieldFromRelationName(e);if(a.push(r),r)if(n._deleteDependencyCache(a.join(s)),t===o&&i.data instanceof Object)Object.keys(i.data).forEach(function(e){n._deleteDependencyCache(a.concat([e]).join(s))})}),d.prototype.relationChanged.call(this,i,e)},i.prototype._getSerializableState=function(e){if(e=d.prototype._getSerializableState.call(this,e),!this._propertiesInjected)delete e.$options.properties;if(e._instanceId=this.getInstanceId(),e._isDeleted=this._isDeleted,this._defaultPropertiesValues)e._defaultPropertiesValues=this._defaultPropertiesValues;return e},i.prototype._setSerializableState=function(e){var t=d.prototype._setSerializableState.call(this,e);return function(){if(t.call(this),this._instanceId=e._instanceId,this._isDeleted=e._isDeleted,e._defaultPropertiesValues)this._defaultPropertiesValues=e._defaultPropertiesValues}},i.prototype.rejectChanges=function(e,t){if(d.prototype.rejectChanges.call(this,e,t),!(e instanceof Array))this._isChanged=false},i.prototype.acceptChanges=function(e,t){if(d.prototype.acceptChanges.call(this,e,t),!(e instanceof Array))this._isChanged=false},i.prototype.isChanged=function(e){if(!e&&this._isChanged)return true;return d.prototype.isChanged.call(this,e)},i.prototype.getProperties=function(){return this._$properties},i.prototype.getDefault=function(e){var t=this._defaultPropertiesValues;if(!t)t=this._defaultPropertiesValues={};if(!t.hasOwnProperty(e)){var r=this._$properties[e];if(r&&"def"in r)t[e]=[r.def instanceof Function?r.def.call(this):r.def];else t[e]=[]}return t[e][0]},i.prototype.merge=function(e){try{var r={};e.each(function(e,t){r[e]=t}),this.set(r)}catch(e){if(e instanceof ReferenceError)a.logger.info(this._moduleName+"::merge(): "+e.toString());else throw e}},i.prototype.getId=function(){var e=this.getIdProperty();if(!e)return void a.logger.info(this._moduleName+"::getId(): idProperty is not defined");return this.get(e)},i.prototype.getIdProperty=function(){return this._$idProperty},i.prototype.setIdProperty=function(e){if(e&&!this.has(e))return void a.logger.info(this._moduleName+'::setIdProperty(): property "'+e+'" is not defined');this._$idProperty=e},i.prototype._getAllProperties=function(){var e=this._getRawDataFields();if(!this._$properties)return e;var t=this._$properties,r;return Object.keys(t).concat(e.filter(function(e){return!t.hasOwnProperty(e)}))},i.prototype._processCalculatedValue=function(t,e,r,i){var n=this,a=this._calculatingProperties;if(!a)a=this._calculatingProperties=new h.Set;var o=t+"|"+i;if(a.has(o))throw new Error("Recursive value "+(i?"reading":"writing")+' detected for property "'+t+'"');var s=i?r.get:r.set,u=i&&p.Compute.isFunctor(s),l=i&&!u,f;if(i)f=this._propertiesDependencyGathering,this._propertiesDependencyGathering=l?t:"";if(u)s.properties.forEach(function(e){n._pushDependencyFor(e,t)});try{a.add(o),e=s.call(this,e)}finally{if(i)this._propertiesDependencyGathering=f;a.delete(o)}return e},i.prototype._pushDependency=function(e){if(this._propertiesDependencyGathering&&this._propertiesDependencyGathering!==e)this._pushDependencyFor(e,this._propertiesDependencyGathering)},i.prototype._pushDependencyFor=function(e,t){var r=this._propertiesDependency,i;if(!r)r=this._propertiesDependency=new h.Map;if(r.has(e))i=r.get(e);else i=new h.Set,r.set(e,i);if(!i.has(t))i.add(t)},i.prototype._deleteDependencyCache=function(e){var t=this,r=this._propertiesDependency;if(r&&r.has(e))r.get(e).forEach(function(e){t._removeChild(t._fieldsCache.get(e)),t._fieldsCache.delete(e),t._fieldsClone.delete(e),t._deleteDependencyCache(e)})},i.fromObject=function(e,t){var r=c.default.fromObject(e,t);if(!r)return r;return new i({rawData:r.getRawData(true),adapter:r.getAdapter(),format:r._getFormat(true)})},i.extend=function(e,t){return o(this,e,t)},i}(a.mixin(c.default,i.default));(t.default=u).prototype["[Types/_entity/Model]"]=true,u.prototype["[Types/_entity/IInstantiable]"]=true,u.prototype._moduleName="Types/entity:Model",u.prototype._instancePrefix="model-",u.prototype._$properties=null,u.prototype._$idProperty="",u.prototype._isDeleted=false,u.prototype._defaultPropertiesValues=null,u.prototype._propertiesDependency=null,u.prototype._propertiesDependencyGathering="",u.prototype._calculatingProperties=null,u.prototype._deepChangedProperties=null,u.prototype["[WS.Data/Entity/Model]"]=true,u.produceInstance=c.default.produceInstance,n.register("Types/entity:Model",u,{instantiate:false}),n.register("entity.model",u)}(j,e,u,ft,O,fe,d,c,s,o);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();return e.adapter=st,e.CloneableMixin=Q.default,e.descriptor=V.default,e.DestroyableMixin=r.default,e.factory=qe.default,e.format=Je,e.FormattableMixin=lt.default,e.functor=de,e.Identity=v.default,e.ICloneable=g.default,e.IEquatable=w.default,e.IInstantiable=D.default,e.InstantiableMixin=P.default,e.IObject=C.default,e.IObservableObject=E.default,e.IProducible=x.default,e.IVersionable=A.default,e.ManyToManyMixin=he.default,e.Model=pt.default,e.OptionsToPropertyMixin=t.default,e.ObservableMixin=H.default,e.ReadWriteMixin=me.default,e.Record=dt.default,e.relation=_e,e.SerializableMixin=U.default,e.VersionableMixin=W.default,e.TimeInterval=K.default,e.Guid=Y.default,e});