define("Types/entity",["Types/object","Types/formatter","Core/EventBus","Core/core-extend","Types/shim","tslib","Core/constants","Core/defaultRenders","Core/TimeInterval","Types/di","Types/util","Core/Serializer","require","exports"],function(i,n,a,o,s,u,l,f,d,c,p,h,j,t){Object.defineProperty(t,"__esModule",{value:true}),t["Types/_entity/OptionsToPropertyMixin"]=true;var y=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var s="_$",a=s.length;function u(e,r,t,i){Object.defineProperty(e,r,{enumerable:true,configurable:true,get:function(){return delete e[r],e[r]=i[t]},set:function(t){delete e[r],e[r]=t}})}var r=function(){function t(t){if(t&&"object"===typeof t)for(var e=s,r=Object.keys(t),i=void 0,n=void 0,a=0,o=r.length;a<o;a++)if((n=e+(i=r[a]))in this)u(this,n,i,t)}return t.prototype._getOptions=function(){for(var t={},e=Object.keys(this),r,i=0,n=e.length;i<n;i++)if((r=e[i]).substr(0,a)===s)t[r.substr(a)]=this[r];if(this._options)for(r in this._options)if(this._options.hasOwnProperty(r)&&!(r in t))t[r]=this._options[r];return t},t}();(e.default=r).prototype["[Types/_entity/OptionsToPropertyMixin]"]=true}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),e=y;t["Types/_entity/format/UniversalField"]=true;var R=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var r=function(){function t(){}return t}();(e.default=r).prototype["[Types/_entity/format/UniversalField]"]=true,r.prototype._moduleName="Types/entity:format.UniversalField",r.prototype.type="",r.prototype.name="",r.prototype.defaultValue=null,r.prototype.nullable=false,r.prototype.meta=null}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/DestroyableMixin"]=true;var _=function(){"use strict";var t={},e=function(t,e,r){Object.defineProperty(e,"__esModule",{value:true});var i=r.protect("destroyed");function n(){throw new ReferenceError("This class instance is destroyed.")}var a=function(){function t(){}return Object.defineProperty(t.prototype,"destroyed",{get:function(){return Boolean(this[i])},enumerable:true,configurable:true}),t.prototype.destroy=function(){for(var t in this[i]=true,this)switch(t){case"destroy":case"destroyed":case"isDestroyed":break;default:if("function"===typeof this[t])this[t]=n}},t.prototype.isDestroyed=function(){return this.destroyed},t}();(e.default=a).prototype["[Types/_entity/DestroyableMixin]"]=true}(j,t,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),r=_;t["Types/_entity/adapter/SbisFieldType"]=true;var b=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var r={boolean:"Логическое",integer:"Число целое",real:"Число вещественное",money:"Деньги",string:"Строка",xml:"XML-файл",datetime:"Дата и время",date:"Дата",time:"Время",timeinterval:"Временной интервал",link:"Связь",identity:"Идентификатор",enum:"Перечисляемое",flags:"Флаги",record:"Запись",recordset:"Выборка",binary:"Двоичное",uuid:"UUID",rpcfile:"Файл-rpc",object:"JSON-объект",array:"Массив"};e.default=r}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/Identity"]=true;var v,m=function(){"use strict";var t={},e=function(t,e,r){Object.defineProperty(e,"__esModule",{value:true});var i=function(){function t(t){if(!(t instanceof Array))if("string"===typeof t)t=t.split(this._separator);else t=[t];this._value=t}return t.prototype.getValue=function(){return this._value[0]},t.prototype.getName=function(){return this._value[1]},t.prototype.valueOf=function(){return this._value},t.prototype.toString=function(){return null===this._value[0]?null:this._value.join(",")},t}();(e.default=i).prototype["[Types/_entity/Identity]"]=true,i.prototype._separator=",",i.prototype._value=null,r.register("Types/entity:Identity",i,{instantiate:false})}(j,t,c);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/ICloneable"]=true;var g,F=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/IEquatable"]=true;var w,T=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/IInstantiable"]=true;var D,O=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/InstantiableMixin"]=true;var M=function(){"use strict";var t={},e=function(t,e,r){Object.defineProperty(e,"__esModule",{value:true});var i=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,n=0,a={"[Types/_entity/InstantiableMixin]":true,_instancePrefix:"id-",_instanceId:"",getInstanceId:function(){if(n>=i)n=0;return this._instanceId||(this._instanceId=(r.isBrowserPlatform?"client-":"server-")+this._instancePrefix+n++)}};a.getHash=a.getInstanceId,e.default=a}(j,t,l);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),P=M;t["Types/_entity/IObject"]=true;var C,I=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/IObservableObject"]=true;var E,S=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/IProducible"]=true;var x,N=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/IVersionable"]=true;var A,$=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/relation/IReceiver"]=true;var k=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/descriptor"]=true;var V,z=function(){"use strict";var t={},e=function(t,e){function r(t){if("function"===typeof t)switch(t){case Boolean:t="boolean";break;case Number:t="number";break;case String:t="string"}return t}function i(i){var t=typeof(i=r(i));switch(t){case"string":return function t(e){if(void 0===e||typeof e===i||e instanceof String)return e;return new TypeError('Value "'+e+'" should be type of '+i)};case"function":return function t(e){if(void 0===e||e instanceof i)return e;return new TypeError('Value "'+e+'" should be instance of '+i)};case"object":return function t(e){if(void 0===e)return e;var r=e&&e._mixins;if(r instanceof Array&&-1!==r.indexOf(i))return e;return new TypeError('Value "'+e+'" should implement '+i)}}throw new TypeError('Argument "type" should be one of following types: string, function or object but "'+t+'" received.')}function n(){var r=this;return s(function t(e){if(void 0===e)return new TypeError("Value is required");return r(e)})}function a(r){if(!(r instanceof Array))throw new TypeError("Argument values should be an instance of Array");var i=this;return s(function t(e){if(void 0!==e&&-1===r.indexOf(e))return new TypeError("Invalid value "+e);return i(e)})}function o(t){var n=this,a=i(t);return s(function t(e){if(void 0!==e){if(!(e instanceof Array))return new TypeError("'Value \""+e+'" is not an Array');for(var r=void 0,i=0;i<e.length;i++)if((r=a(e[i]))instanceof Error)return r}return n(e)})}function s(r){var i=this,t=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return r.apply(i,t)};return Object.defineProperties(t,{required:{enumerable:true,value:n},oneOf:{enumerable:true,value:a},arrayOf:{enumerable:true,value:o}}),t}function u(t){return s(i(t))}Object.defineProperty(e,"__esModule",{value:true}),e.default=u}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/ObservableMixin"]=true;var H=function(){"use strict";var t={},e=function(t,e,n){Object.defineProperty(e,"__esModule",{value:true});var r=function(){function t(t){var e=t&&t.handlers;if(e instanceof Object)for(var r in e)if(e.hasOwnProperty(r))this.subscribe(r,e[r])}return t.prototype.destroy=function(){if(this._eventBusChannel)this._eventBusChannel.unsubscribeAll(),this._eventBusChannel.destroy(),this._eventBusChannel=null},t.prototype.subscribe=function(t,e,r){if(this._destroyed)return;if(!this._eventBusChannel)if(this._eventBusChannel=n.channel(),this._publishedEvents)for(var i=0;i<this._publishedEvents.length;i++)this._eventBusChannel.publish(this._publishedEvents[i]);if(void 0===r)r=this;this._eventBusChannel.subscribe(t,e,r)},t.prototype.unsubscribe=function(t,e,r){if(this._eventBusChannel){if(void 0===r)r=this;this._eventBusChannel.unsubscribe(t,e,r)}},t.prototype.getEventHandlers=function(t){return this._eventBusChannel?this._eventBusChannel.getEventHandlers(t):[]},t.prototype.hasEventHandlers=function(t){return this._eventBusChannel?this._eventBusChannel.hasEventHandlers(t):false},t.prototype._publish=function(){for(var t=[],e=0,r;e<arguments.length;e++)t[e]=arguments[e];this._publishedEvents=this._publishedEvents||[];for(var i=0;i<t.length;i++)if(r=t[i],this._publishedEvents.push(r),this._eventBusChannel)this._eventBusChannel.publish(r)},t.prototype._notify=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this._eventBusChannel)return this._notifyPushQueue.apply(this,arguments),this._notifyQueue(this._eventsQueue)[0]},t.prototype._notifyLater=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];if(this._eventBusChannel)this._notifyPushQueue.apply(this,arguments)},t.prototype._notifyPushQueue=function(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];this._eventsQueue=this._eventsQueue||[],this._eventsQueue.push([t].concat(e))},t.prototype._notifyQueue=function(t){var e=[];if(!t.running){t.running=true;var r=void 0;while(r=t[0])e.push(this._eventBusChannel._notifyWithTarget(r[0],this,r.slice(1))),t.shift();t.running=false}return e},t.prototype._removeFromQueue=function(t){if(!this._eventsQueue)return;for(var e=1;e<this._eventsQueue.length;e++)if(this._eventsQueue[e][0]===t)this._eventsQueue.splice(e,1),e--},t}();(e.default=r).prototype["[Types/_entity/ObservableMixin]"]=true,r.prototype._eventBusChannel=null,r.prototype._eventsQueue=null,r.prototype._publishedEvents=null}(j,t,a);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),B=H;t["Types/_entity/functor/Compute"]=true;var L=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var r=function(){function r(t,e){if(e=e||[],!(t instanceof Function))throw new TypeError('Argument "fn" be an instance of Function');if(!(e instanceof Array))throw new TypeError('Argument "properties" be an instance of Array');return Object.defineProperty(t,"functor",{get:function(){return r}}),Object.defineProperty(t,"properties",{get:function(){return e}}),t}return r.isFunctor=function(t){return t&&t.functor===r},r}();e.default=r}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/CloneableMixin"]=true;var Q=function(){"use strict";var t={},e=function(t,e,o){Object.defineProperty(e,"__esModule",{value:true});var r={"[Types/_entity/CloneableMixin]":true,"[Types/_entity/ICloneable]":true,clone:function(t){var e;if(t){var r,i=Object.getPrototypeOf(this).constructor,n=this.toJSON();if(n.state=this._unlinkCollection(n.state),n.state.$options)n.state.$options=this._unlinkCollection(n.state.$options);e=i.prototype.fromJSON.call(i,n)}else{var a=new o;e=JSON.parse(JSON.stringify(this,a.serialize),a.deserialize)}return delete e._instanceId,e},_unlinkCollection:function(t){var e;if(t instanceof Array){e=[];for(var r=0;r<t.length;r++)e[r]=this._unlinkObject(t[r]);return e}if(t instanceof Object){for(var i in e={},t)if(t.hasOwnProperty(i))e[i]=this._unlinkObject(t[i]);return e}return t},_unlinkObject:function(t){if(t instanceof Array)return t.slice();return t}};e.default=r}(j,t,h);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),J=Q;t["Types/_entity/SerializableMixin"]=true;var U=function(){"use strict";var t={},e=function(t,e,n){Object.defineProperty(e,"__esModule",{value:true});var r=n.protect("unserialized"),i="object"===typeof{}.__proto__,a="function"===typeof getFunctionDefinition,o=0;function s(){return this._instanceNumber||(this._instanceNumber=++o)}function u(t){var e=Object.getPrototypeOf(t),r=[];return"{"+Object.keys(e).map(function(t){return[t,JSON.stringify(e[t],function(t,e){if(e&&"object"===typeof e)if(-1===r.indexOf(e)){if(r.push(e),e.$serialized$)return"{*serialized*}"}else return"{*recursion*}";if("function"===typeof e)return a?getFunctionDefinition(e):String(e);return e})]}).map(function(t){return t[0]+": "+t[1]}).join(",")+"}"}function l(t,e,r){var i='Property "_moduleName" with module name for RequireJS\'s define() is not found in this prototype: "'+u(t)+'"';if(e)throw new ReferenceError(i);else n.logger.stack(i,void 0===r?3:r)}var f=function(){function t(t){}return t.prototype.toJSON=function(){return this._checkModuleName(true),{$serialized$:"inst",module:this._moduleName,id:s.call(this),state:this._getSerializableState({})}},t.fromJSON=function(t){var e=this.prototype._setSerializableState(t.state),r=new this(t.state.$options);if(e)e.call(r);return r},t.prototype._checkModuleName=function(t,e){var r=this;if(!r._moduleName)return void l(this,t,e);if(!i)return;if(!(r=this.__proto__).hasOwnProperty("_moduleName"))l(this,t,e)},t.prototype._getSerializableState=function(t){return t.$options="function"===typeof this._getOptions?this._getOptions():{},t},t.prototype._setSerializableState=function(t){return function(){this[r]=true}},t}();(e.default=f).prototype["[Types/_entity/SerializableMixin]"]=true,f.prototype.fromJSON=f.fromJSON,f.prototype._instanceNumber=null}(j,t,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),G=U;t["Types/_entity/VersionableMixin"]=true;var W=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var r={"[Types/_entity/VersionableMixin]":true,_version:0,getVersion:function(){return this._version},_nextVersion:function(){if(this._version++,this["[Types/_entity/ManyToManyMixin]"])this._getMediator().belongsTo(this,function(t){if(t&&t["[Types/_entity/IVersionable]"])t._nextVersion()})}};e.default=r}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),q=W;t["Types/_entity/TimeInterval"]=true;var K,Z=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var r=1e3,i=6e4,n=36e5,o=864e5,s=60,u=60,l=24,a=["days","hours","minutes","seconds","milliseconds"],f={days:o,hours:n,minutes:i,seconds:r,milliseconds:1},d={regExp:/^P(?:(-?[0-9]+)D)?(?:T(?:(-?[0-9]+)H)?(?:(-?[0-9]+)M)?(?:(-?[0-9]+(?:\.[0-9]{0,3})?)[0-9]*S)?)?$/i,format:"P[<Число_дней>D][T[<Число_часов>H][<Число_минут>M][<Число_секунд>[.Число_долей_секунды]S]"},c={regExp:/^P(-?[0-9]+D)?(T(-?[0-9]+H)?(-?[0-9]+M)?(-?[0-9]+(\.[0-9]+)?S)?)?$/i,format:"P[<Число_дней>D][T[<Число_часов>H][<Число_минут>M][<Число_секунд>[.Число_долей_секунды]S]"};function p(t){return parseFloat(t)||0}function h(t){return t>0?Math.floor(t):Math.ceil(t)}function y(t){var r=[],i=d.regExp.exec(t);if(!b(t))throw new Error(rk("Передаваемый аргумент не соответствует формату ISO 8601. Допустимые форматы")+": "+c.format+". ");return i.slice(1).forEach(function(t,e){if(e===i.length-1)r.push(h(Number(t))),r.push((Number(t)%1*1e3).toFixed());else r.push(p(t))}),r}function _(t){for(var e={},r=0;r<a.length;r++)e[a[r]]=p(String(t[r]));return e}function v(t){var e=0;for(var r in f)if(f.hasOwnProperty(r)){var i;e+=f[r]*p(t[r])}return e}function m(t){var e={};for(var r in f)if(f.hasOwnProperty(r)){var i=f[r];e[r]=h(t/i),t%=i}return e}function g(t){var e=Number((t.seconds+t.milliseconds/1e3).toFixed(3));return"P"+t.days+"D"+"T"+t.hours+"H"+t.minutes+"M"+e+"S"}function b(t){return c.regExp.test(t)}var F=function(){function a(t){if(this instanceof a)this._normIntervalObj=void 0,this._normIntervalStr=void 0,this.set(t);else throw new Error(rk("TimeInterval вызывать через оператор new"))}return a.prototype.getDays=function(){return this._normIntervalObj.days},a.prototype.addDays=function(t){return this.addMilliseconds(t*o)},a.prototype.subDays=function(t){return this.subMilliseconds(t*o)},a.prototype.getHours=function(){return this._normIntervalObj.hours},a.prototype.addHours=function(t){return this.addMilliseconds(t*n)},a.prototype.subHours=function(t){return this.subMilliseconds(t*n)},a.prototype.getMinutes=function(){return this._normIntervalObj.minutes},a.prototype.addMinutes=function(t){return this.addMilliseconds(t*i)},a.prototype.subMinutes=function(t){return this.subMilliseconds(t*i)},a.prototype.getSeconds=function(){return this._normIntervalObj.seconds},a.prototype.addSeconds=function(t){return this.addMilliseconds(t*r)},a.prototype.subSeconds=function(t){return this.subMilliseconds(t*r)},a.prototype.getMilliseconds=function(){return this._normIntervalObj.milliseconds},a.prototype.addMilliseconds=function(t){return this.set(this.getTotalMilliseconds()+h(t))},a.prototype.subMilliseconds=function(t){return this.set(this.getTotalMilliseconds()-h(t))},a.prototype.getTotalHours=function(){return this._normIntervalObj.days*l+this._normIntervalObj.hours},a.prototype.getTotalMinutes=function(){return this.getTotalHours()*u+this._normIntervalObj.minutes},a.prototype.getTotalSeconds=function(){return this.getTotalMinutes()*s+this._normIntervalObj.seconds},a.prototype.getTotalMilliseconds=function(){return this.getTotalSeconds()*r+this._normIntervalObj.milliseconds},a.prototype.set=function(t){var e;if(t instanceof a)e="timeInterval";else if("string"===typeof t)e="intervalStr";else if(t instanceof Array)t=t.slice(),e="intervalArray";else if(t&&"object"===typeof t)t=Object.assign({},t),e="intervalObj";else t=p(t),e="milliseconds";switch(e){case"intervalStr":t=y(t);case"intervalArray":t=_(t);case"intervalObj":t=v(t);case"milliseconds":this._normIntervalObj=t=m(t),this._normIntervalStr=g(t);break;case"timeInterval":this.assign(t)}return this},a.prototype.toString=function(){return String(this._normIntervalStr)},a.prototype.valueOf=function(){return String(this._normIntervalStr)},a.prototype.toObject=function(){return Object.assign({},this._normIntervalObj)},a.prototype.clone=function(){return new a(this)},a.prototype.calc=function(t,e){var r=["==","!=",">=","<=",">","<","+","-","+=","-="];if(-1===r.indexOf(t))throw new Error(rk("Операция")+' "'+t+'" '+rk("не доступна. Разрешенные операции")+": "+r.join(", "));if(!(this instanceof a&&e instanceof a))throw new Error(rk("Operand должен быть объектом класса TimeInterval"));var i=this.getTotalMilliseconds(),n=e.getTotalMilliseconds();switch(t){case"==":return i===n;case"!=":return i!==n;case">=":return i>=n;case"<=":return i<=n;case">":return i>n;case"<":return i<n;case"+":return(new a).set(i+n);case"-":return(new a).set(i-n);case"+=":return this.set(i+n);case"-=":return this.set(i-n)}},a.prototype.addToDate=function(t){return this._dateModifier(1,t)},a.prototype.subFromDate=function(t){return this._dateModifier(-1,t)},a.prototype.assign=function(t){this._normIntervalObj=t.toObject(),this._normIntervalStr=t.valueOf()},a.prototype._dateModifier=function(t,e){return(e=new Date(e.getTime())).setTime(e.getTime()+t*this.getTotalMilliseconds()),e},a.toString=function(t){if(void 0!==t)return a.prototype.set.call({},t)._normIntervalStr;return Function.toString.call(this)},a}();e.default=F}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/Guid"]=true;var Y,X=function(){"use strict";var t={},e=function(t,e){Object.defineProperty(e,"__esModule",{value:true});var r=function(){function t(){}return t.create=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,r;return("x"==t?e:3&e|8).toString(16)})},t}();e.default=r}(j,t);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/date/fromSql"]=true;var tt=function(){"use strict";var t={},e=function(t,e,h){Object.defineProperty(e,"__esModule",{value:true});var y=/([0-9]{2}:[0-9]{2}:[0-9]{2}(?:\.[0-9]{1,9})?)([+-])([0-9]{2})[:-]*([0-9]{2})*$/;function r(t,e){var r=t.indexOf("-"),i=t.indexOf(":"),n=t.indexOf("."),a=t.match(y),o=a&&a.index+a[1].length||-1,s=new Date,u=null,l,f,d,c;if(s.setHours(0,0,0,0),-1===i&&-1===r)return s;if(i>-1&&r>i)r=-1;if(-1!==n){if((l=t.substr(n+1,(-1===o?t.length:o)-(n+1))).length>3)l=l.substr(0,3);if(u=parseInt(l,10),l.length<3)u*=2===l.length?10:100}if(-1!==r){if(f=parseInt(t.substr(r-4,4),10),d=parseInt(t.substr(r+1,2),10)-1,c=parseInt(t.substr(r+4,2),10),h.compatibility.dateBug&&0===d&&1===c)s.setHours(1);s.setFullYear(f,d,c)}if(-1!==i){s.setHours(parseInt(t.substr(i-2,2),10),parseInt(t.substr(i+1,2),10),parseInt(t.substr(i+4,2),10),u);var p=e;if(a)p=Number(a[2]+"1")*(60*Number(a[3])+(1*Number(a[4])||0));if(void 0!==p)s.setMinutes(s.getMinutes()-p-s.getTimezoneOffset())}return s}e.default=r}(j,t,l);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/date/toSql"]=true;var et=function(){"use strict";var t={},e=function(t,e,i){Object.defineProperty(e,"__esModule",{value:true});var n={TIME:"time",DATE:"date",DATETIME:"datetime"};e.MODE=n;var a={time:"HH:mm:ss",date:"YYYY-MM-DD",datetime:"YYYY-MM-DD HH:mm:ss"},o=new Date(0);function s(t){var e=-t.getTimezoneOffset()/60,r=e<0;if(r)e=-e;return(r?"-":"+")+(e<10?"0":"")+e}function r(t,e){if(void 0===e)e=n.DATETIME;var r=i.date(t,a[e]);if(e!==n.DATE&&t>o){if(t.getMilliseconds()>0)r+="."+t.getMilliseconds();r+=s(t)}return r}e.default=r}(j,t,n);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/ITable"]=true;var rt=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/adapter/IAdapter"]=true;var it=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/adapter/IMetaData"]=true;var nt=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/adapter/IRecord"]=true;var at=function(){"use strict";var t={},e=(r=j,i=t,void Object.defineProperty(i,"__esModule",{value:true})),r,i;if(e instanceof Function)return e;else for(var n in e)if(e.hasOwnProperty(n))t[n]=e[n];return t}();t["Types/_entity/adapter/Abstract"]=true;var ot=function(){"use strict";var t={},e=function(t,e,r,i,n,a,o){Object.defineProperty(e,"__esModule",{value:true});var s=(u=function(t){if(t instanceof Array)return l(t);else if(t&&"object"===typeof t)return f(t);else return t},l=function(t){return t.map(function(t){return u(t)})},f=function(t){if("function"===typeof t.getRawData)return t.getRawData(true);else if(t instanceof Date){var e=o.MODE.DATETIME;if((t=t).getSQLSerializationMode)switch(t.getSQLSerializationMode()){case Date.SQL_SERIALIZE_MODE_DATE:e=o.MODE.DATE;break;case Date.SQL_SERIALIZE_MODE_TIME:e=o.MODE.TIME}return o.default(t,e)}else{if(t.valueOf)t=t.valueOf();if(t&&"object"===typeof t)return d(t);return t}},d=function(t){var e={},r=Object.getPrototypeOf(t);if(null!==r&&r!==Object.prototype)throw new TypeError("Unsupported object type. Only plain objects can be serialized.");for(var i=Object.keys(t),n,a=0;a<i.length;a++)e[n=i[a]]=u(t[n]);return e},{serialize:u}),u,l,f,d,c=function(e){function t(){var t=e.call(this)||this;return n.default.constructor.call(t),t}return r.__extends(t,e),t.prototype.getProperty=function(t,e){for(var r=(e=e||"").split(this._pathSeparator),i,n=0;n<r.length;n++)i=n?i?i[r[n]]:void 0:t?t[r[n]]:void 0;return i},t.prototype.setProperty=function(t,e,r){if(!t||!(t instanceof Object))return;for(var i=(e=e||"").split(this._pathSeparator),n=t,a=0,o=i.length-1;a<=o;a++)if(a===o)n[i[a]]=r;else{if(void 0===n[i[a]])n[i[a]]={};n=n[i[a]]}},t.prototype.serialize=function(t){return s.serialize(t)},t.prototype.forRecord=function(t,e){throw new Error("Method must be implemented")},t.prototype.forTable=function(t){throw new Error("Method must be implemented")},t.prototype.getKeyField=function(t){throw new Error("Method must be implemented")},t}(a.mixin(i.default,n.default));(e.default=c).prototype["[Types/_entity/adapter/Abstract]"]=true,c.prototype["[Types/_entity/adapter/IAdapter]"]=true,c.prototype._pathSeparator="."}(j,t,u,_,U,p,et);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/Field"]=true;var st=function(){"use strict";var t={},e=function(t,e,i,r,n,a,o,s,u){Object.defineProperty(e,"__esModule",{value:true});var l=function(r){function t(t){var e=r.call(this,t)||this;return a.default.call(e,t),e}return i.__extends(t,r),t.prototype.isEqual=function(t){if(t===this)return true;var e,r;return Object.getPrototypeOf(this)===Object.getPrototypeOf(t)&&this.getName()===t.getName()&&u.isEqual(this.getDefaultValue(),t.getDefaultValue())&&this.isNullable()===t.isNullable()},t.prototype.getType=function(){return this._$type||this.getTypeName()},t.prototype.getTypeName=function(){return this._typeName},t.prototype.getName=function(){return this._$name},t.prototype.setName=function(t){this._$name=t},t.prototype.getDefaultValue=function(){return this._$defaultValue},t.prototype.setDefaultValue=function(t){this._$defaultValue=t},t.prototype.isNullable=function(){return this._$nullable},t.prototype.setNullable=function(t){this._$nullable=t},t.prototype.copyFrom=function(t){var e=t._getOptions(),r;for(var i in e)if(e.hasOwnProperty(i))if((r="_$"+i)in this)this[r]=e[i]},t}(r.mixin(n.default,a.default,o.default,s.default));(e.default=l).prototype["[Types/_entity/format/DestroyableMixin]"]=true,l.prototype._$name="",l.prototype._$type=null,l.prototype._$defaultValue=null,l.prototype._$nullable=true,l.prototype._typeName=""}(j,t,u,p,_,y,U,Q,i);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/CowRecord"]=true;var ut=function(){"use strict";var t={},e=function(t,e,r,i,a){Object.defineProperty(e,"__esModule",{value:true});var n=function(n){function t(t,e,r){var i=n.call(this)||this;if(i._original=e,i._originalRecord=e.forRecord(t),r)i._writeCallback=r;return i}return r.__extends(t,n),t.prototype.has=function(t){return this._originalRecord.has(t)},t.prototype.get=function(t){return this._originalRecord.get(t)},t.prototype.set=function(t,e){return this._copy(),this._originalRecord.set(t,e)},t.prototype.clear=function(){return this._copy(),this._originalRecord.clear()},t.prototype.getData=function(){return this._originalRecord.getData()},t.prototype.getFields=function(){return this._originalRecord.getFields()},t.prototype.getFormat=function(t){return this._originalRecord.getFormat(t)},t.prototype.getSharedFormat=function(t){return this._originalRecord.getSharedFormat(t)},t.prototype.addField=function(t,e){return this._copy(),this._originalRecord.addField(t,e)},t.prototype.removeField=function(t){return this._copy(),this._originalRecord.removeField(t)},t.prototype.removeFieldAt=function(t){return this._copy(),this._originalRecord.removeFieldAt(t)},t.prototype.getOriginal=function(){return this._originalRecord},t.prototype._copy=function(){if(!this._copied){if(this._originalRecord["[Types/_entity/ICloneable]"])this._originalRecord=this._originalRecord.clone();else this._originalRecord=this._original.forRecord(a.object.clonePlain(this._originalRecord.getData()));if(this._copied=true,this._writeCallback)this._writeCallback(),this._writeCallback=null}},t}(i.default);(e.default=n).prototype["[Types/_entity/adapter/CowRecord]"]=true,n.prototype["[Types/_entity/adapter/IRecord]"]=true,n.prototype["[Types/_entity/adapter/IDecorator]"]=true,n.prototype._original=null,n.prototype._originalRecord=null,n.prototype._writeCallback=null,n.prototype._copied=false}(j,t,u,_,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/relation/Hierarchy"]=true;var lt=function(){"use strict";var t={},e=function(t,e,i,r,n,a){Object.defineProperty(e,"__esModule",{value:true});var o=function(r){function t(t){var e=r.call(this,t)||this;return n.default.call(e,t),e}return i.__extends(t,r),t.prototype.getIdProperty=function(){return this._$idProperty},t.prototype.setIdProperty=function(t){this._$idProperty=t},t.prototype.getParentProperty=function(){return this._$parentProperty},t.prototype.setParentProperty=function(t){this._$parentProperty=t},t.prototype.getNodeProperty=function(){return this._$nodeProperty},t.prototype.setNodeProperty=function(t){this._$nodeProperty=t},t.prototype.getDeclaredChildrenProperty=function(){return this._$declaredChildrenProperty},t.prototype.setDeclaredChildrenProperty=function(t){this._$declaredChildrenProperty=t},t.prototype.isNode=function(t){return t.get(this._$nodeProperty)},t.prototype.getChildren=function(t,e){if(!this._$parentProperty)return null===t||void 0===t?(r=[],e.each(function(t){r.push(t)}),r):[];var r,i=this._asField(t,this._$idProperty),n=e.getIndicesByValue(this._$parentProperty,i),a=[];if(0===n.length&&null===i)n=e.getIndicesByValue(this._$parentProperty);for(var o=0;o<n.length;o++)a.push(e.at(n[o]));return a},t.prototype.hasDeclaredChildren=function(t){return t.get(this._$declaredChildrenProperty)},t.prototype.hasParent=function(t,e){var r=(t=this._asRecord(t,e)).get(this._$parentProperty),i=this._$idProperty||e.getIdProperty(),n;return e.getIndexByValue(i,r)>-1},t.prototype.getParent=function(t,e){var r=(t=this._asRecord(t,e)).get(this._$parentProperty);return void 0===r||null===r?null:this._asRecord(r,e)},t.prototype._asRecord=function(t,e){if(t&&t["[Types/_entity/Record]"])return t;var r=this._$idProperty||e.getIdProperty(),i=e.getIndexByValue(r,t);if(-1===i)throw new ReferenceError(this._moduleName+': record with id "'+t+'" does not found in the recordset');return e.at(i)},t.prototype._asField=function(t,e){if(!(t&&t["[Types/_entity/Record]"]))return t;return t.get(e)},t}(a.mixin(r.default,n.default));(e.default=o).prototype["[Types/_entity/relation/Hierarchy]"]=true,o.prototype._$idProperty="",o.prototype._$parentProperty="",o.prototype._$nodeProperty="",o.prototype._$declaredChildrenProperty=""}(j,t,u,_,y,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/CowTable"]=true;var ft=function(){"use strict";var t={},e=function(t,e,r,i,a){Object.defineProperty(e,"__esModule",{value:true});var n=function(n){function t(t,e,r){var i=n.call(this)||this;if(i._original=e,i._originalTable=e.forTable(t),r)i._writeCallback=r;return i}return r.__extends(t,n),t.prototype.getFields=function(){return this._originalTable.getFields()},t.prototype.getCount=function(){return this._originalTable.getCount()},t.prototype.getData=function(){return this._originalTable.getData()},t.prototype.add=function(t,e){return this._copy(),this._originalTable.add(t,e)},t.prototype.at=function(t){return this._originalTable.at(t)},t.prototype.remove=function(t){return this._copy(),this._originalTable.remove(t)},t.prototype.replace=function(t,e){return this._copy(),this._originalTable.replace(t,e)},t.prototype.move=function(t,e){return this._copy(),this._originalTable.move(t,e)},t.prototype.merge=function(t,e,r){return this._copy(),this._originalTable.merge(t,e,r)},t.prototype.copy=function(t){return this._copy(),this._originalTable.copy(t)},t.prototype.clear=function(){return this._copy(),this._originalTable.clear()},t.prototype.getFormat=function(t){return this._originalTable.getFormat(t)},t.prototype.getSharedFormat=function(t){return this._originalTable.getSharedFormat(t)},t.prototype.addField=function(t,e){return this._copy(),this._originalTable.addField(t,e)},t.prototype.removeField=function(t){return this._copy(),this._originalTable.removeField(t)},t.prototype.removeFieldAt=function(t){return this._copy(),this._originalTable.removeFieldAt(t)},t.prototype.getOriginal=function(){return this._originalTable},t.prototype._copy=function(){if(!this._copied){if(this._originalTable["[Types/_entity/ICloneable]"])this._originalTable=this._originalTable.clone();else this._originalTable=this._original.forTable(a.object.clonePlain(this._originalTable.getData()));if(this._copied=true,this._writeCallback)this._writeCallback(),this._writeCallback=null}},t}(i.default);(e.default=n).prototype["[Types/_entity/adapter/CowTable]"]=true,n.prototype["[Types/_entity/adapter/ITable]"]=true,n.prototype["[Types/_entity/adapter/IDecorator]"]=true,n.prototype._original=null,n.prototype._originalTable=null,n.prototype._writeCallback=null,n.prototype._copied=false}(j,t,u,_,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/functor"]=true;var dt=function(){"use strict";var t={},e=(r=j,i=t,n=L,Object.defineProperty(i,"__esModule",{value:true}),void(i.Compute=n.default)),r,i,n;if(e instanceof Function)return e;else for(var a in e)if(e.hasOwnProperty(a))t[a]=e[a];return t}(),ct=dt;t["Types/_entity/relation/ManyToMany"]=true;var pt=function(){"use strict";var t={},e=function(t,e,r,i,a){function n(t){return t instanceof Object&&t["[Types/_entity/DestroyableMixin]"]?!t.destroyed:true}Object.defineProperty(e,"__esModule",{value:true});var o=function(e){function t(){var t=e.call(this)||this;return t._hasMany=new a.Map,t._hasManyName=new a.Map,t._belongsTo=new a.Map,t._belongsToName=new a.Map,t}return r.__extends(t,e),t.prototype.destroy=function(){this._hasMany=null,this._hasManyName=null,this._belongsTo=null,this._belongsToName=null,e.prototype.destroy.call(this)},t.prototype.addRelationship=function(t,e,r){this._addHasMany(t,e,r),this._addBelongsTo(e,t,r)},t.prototype.removeRelationship=function(t,e){this._removeHasMany(t,e),this._removeBelongsTo(e,t)},t.prototype.clear=function(e){var r=this;if(this._hasMany.has(e))this._hasMany.get(e).forEach(function(t){r._removeBelongsTo(t,e)}),this._hasMany.delete(e),this._hasManyName.delete(e);if(this._belongsTo.has(e))this._belongsTo.get(e).forEach(function(t){r._removeHasMany(t,e)}),this._belongsTo.delete(e),this._belongsToName.delete(e)},t.prototype.hasMany=function(t,e){var r=this;if(this._hasMany.has(t)){var i=this._hasManyName.get(t);this._hasMany.get(t).forEach(function(t){if(n(t))e.call(r,t,i.get(t))})}},t.prototype.belongsTo=function(t,e){var r=this;if(this._belongsTo.has(t)){var i=this._belongsToName.get(t);this._belongsTo.get(t).forEach(function(t){if(n(t))e.call(r,t,i.get(t))})}},t.prototype._addHasMany=function(t,e,r){var i,n;if(this._hasMany.has(t))i=this._hasMany.get(t),n=this._hasManyName.get(t);else i=new a.Set,n=new a.Map,this._hasMany.set(t,i),this._hasManyName.set(t,n);i.add(e),n.set(e,r)},t.prototype._removeHasMany=function(t,e){if(this._hasMany.has(t)){var r=this._hasMany.get(t);if(r.delete(e),this._hasManyName.get(t).delete(e),0===r.size)this._hasMany.delete(t),this._hasManyName.delete(t)}},t.prototype._addBelongsTo=function(t,e,r){var i,n;if(this._belongsTo.has(t))i=this._belongsTo.get(t),n=this._belongsToName.get(t);else i=new a.Set,n=new a.Map,this._belongsTo.set(t,i),this._belongsToName.set(t,n);i.add(e),n.set(e,r)},t.prototype._removeBelongsTo=function(t,e){if(this._belongsTo.has(t)){var r=this._belongsTo.get(t);if(r.delete(e),this._belongsToName.get(t).delete(e),0===r.size)this._belongsTo.delete(t),this._belongsToName.delete(t)}},t}(i.default);(e.default=o).prototype["[Types/_entity/relation/ManyToMany]"]=true,o.prototype._hasMany=null,o.prototype._hasManyName=null,o.prototype._belongsTo=null,o.prototype._belongsToName=null}(j,t,u,_,s);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/ManyToManyMixin"]=true;var ht=function(){"use strict";var t={},e=function(t,e,r){Object.defineProperty(e,"__esModule",{value:true});var i={"[Types/_entity/ManyToManyMixin]":true,"[WS.Data/Entity/ManyToManyMixin]":true,_mediator:null,destroy:function(){var t=this._getMediator(),e=[],r;t.hasMany(this,function(t){e.push(t)}),t.clear(this);for(var i=0,n=e.length;i<n;i++)if((r=e[i]).destroy)r.destroy();this._setMediator(null)},_addChild:function(t,e){if(t instanceof Object){var r=this._getMediator();if(r.addRelationship(this,t,e),t["[Types/_entity/ManyToManyMixin]"]&&!t._hasSameMediator(r)){if(!t._hasMediator())t._setMediator(this._createMediator());t._getMediator().addRelationship(this,t,e)}}},_removeChild:function(t){if(t instanceof Object){var e=this._getMediator();if(e.removeRelationship(this,t),t["[Types/_entity/ManyToManyMixin]"]&&t._hasMediator()&&!t._hasSameMediator(e))t._getMediator().removeRelationship(this,t)}},_parentChanged:function(t){var r={target:this,data:t,original:t};this._getMediator().hasMany(this,function(t,e){if(t["[Types/_entity/relation/IReceiver]"])t.relationChanged(r,[e])})},_childChanged:function(s){var u=s,l=function(t,a,o){t.belongsTo(a,function(t,e){var r=o.slice(),i={target:a,data:s,original:u},n;if(r.unshift(e),t["[Types/_entity/relation/IReceiver]"])if(void 0!==(n=t.relationChanged(i,r)))s=n.data;l(t._getMediator(),t,r)})};l(this._getMediator(),this,[])},_hasMediator:function(){return!!this._mediator},_hasSameMediator:function(t){return this._mediator===t},_createMediator:function(){return new r.default},_getMediator:function(){return this._mediator||(this._mediator=this._createMediator())},_setMediator:function(t){this._mediator=t}};e.default=i}(j,t,pt);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),yt=ht;t["Types/_entity/relation"]=true;var _t,vt=function(){"use strict";var t={},e=(r=j,i=t,n=lt,a=k,Object.defineProperty(i,"__esModule",{value:true}),i.Hierarchy=n.default,void(i.IReceiver=a.default)),r,i,n,a;if(e instanceof Function)return e;else for(var o in e)if(e.hasOwnProperty(o))t[o]=e[o];return t}();t["Types/_entity/ReadWriteMixin"]=true;var mt=function(){"use strict";var t={},e=function(t,e,r,i,n,a){Object.defineProperty(e,"__esModule",{value:true});var o=Object.prototype.hasOwnProperty,s=a.protect("writable"),u={"[Types/_entity/ReadWriteMixin]":true,get writable(){return this[s]},constructor:function(t){if(this._options&&o.call(this._options,"writable"))this[s]=this._options.writable;if(t&&o.call(t,"writable"))this[s]=t.writable;if(this[s])i.default.apply(this,arguments)},destroy:function(){if(this[s])i.default.prototype.destroy.call(this),n.default.destroy.call(this)},subscribe:function(t,e,r){if(this[s])return i.default.prototype.subscribe.call(this,t,e,r)},unsubscribe:function(t,e,r){if(this[s])return i.default.prototype.unsubscribe.call(this,t,e,r)},_publish:function(){if(this[s])return i.default.prototype._publish.apply(this,arguments)},_notify:function(){if(this[s])return i.default.prototype._notify.apply(this,arguments)},_getOptions:function(){var t=r.default.prototype._getOptions.call(this);return delete t.writable,t}},l="undefined"!==typeof window,f=!!("undefined"!==typeof global&&global.assert&&global.assert.strictEqual);Object.defineProperty(u,s,{writable:true,value:l||f}),e.default=u}(j,t,y,H,ht,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),gt=mt;t["Types/_entity/adapter/Cow"]=true;var bt=function(){"use strict";var t={},e=function(t,e,r,i,n,a,o,s,u){Object.defineProperty(e,"__esModule",{value:true});var l=function(i){function t(t,e){var r=i.call(this)||this;if(o.default.constructor.call(r),r._original=t,e)r._writeCallback=e;return r}return r.__extends(t,i),t.prototype.forTable=function(t){return new n.default(t,this._original,this._writeCallback)},t.prototype.forRecord=function(t){return new a.default(t,this._original,this._writeCallback)},t.prototype.getKeyField=function(t){return this._original.getKeyField(t)},t.prototype.getProperty=function(t,e){return this._original.getProperty(t,e)},t.prototype.setProperty=function(t,e,r){return this._original.setProperty(t,e,r)},t.prototype.serialize=function(t){return this._original.serialize(t)},t.prototype.getOriginal=function(){return this._original},t.prototype._getSerializableState=function(t){return(t=o.default.prototype._getSerializableState.call(this,t))._original=this._original,t},t.prototype._setSerializableState=function(t){var e=o.default.prototype._setSerializableState(t);return function(){e.call(this),this._original=t._original}},t}(u.mixin(i.default,o.default));(e.default=l).prototype["[Types/_entity/adapter/Cow]"]=true,l.prototype["[Types/_entity/adapter/IDecorator]"]=true,l.prototype._moduleName="Types/entity:adapter.Cow",l.prototype._original=null,l.prototype._writeCallback=null,s.register("Types/entity:adapter.Cow",l,{instantiate:false})}(j,t,u,ot,ft,ut,U,c,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/ArrayField"]=true;var Ft=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getKind=function(){return this._$kind},e}(i.default);(e.default=n).prototype["[Types/_entity/format/ArrayField]"]=true,n.prototype._moduleName="Types/entity:format.ArrayField",n.prototype._typeName="Array",n.prototype._$kind=""}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/BinaryField"]=true;var wt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/BinaryField]"]=true,n.prototype._moduleName="Types/entity:format.BinaryField",n.prototype._typeName="Binary"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/BooleanField"]=true;var Tt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/BooleanField]"]=true,n.prototype._moduleName="Types/entity:format.BooleanField",n.prototype._typeName="Boolean"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/DateField"]=true;var Dt=function(){"use strict";var t={},e=function(t,e,r,i,n){Object.defineProperty(e,"__esModule",{value:true});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getDefaultValue=function(){if(this._$defaultValue instanceof Date)return n.default(this._$defaultValue,n.MODE.DATE);return this._$defaultValue},e}(i.default);(e.default=a).prototype["[Types/_entity/format/DateField]"]=true,a.prototype._moduleName="Types/entity:format.DateField",a.prototype._typeName="Date"}(j,t,u,st,et);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/DateTimeField"]=true;var Ot=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.isWithoutTimeZone=function(){return this._$withoutTimeZone},e}(i.default);(e.default=n).prototype["[Types/_entity/format/DateTimeField]"]=true,n.prototype._moduleName="Types/entity:format.DateTimeField",n.prototype._typeName="DateTime",n.prototype._$withoutTimeZone=false}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/DictionaryField"]=true;var Mt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getDictionary=function(){return this._$dictionary},e.prototype.getLocaleDictionary=function(){return this._$localeDictionary},e}(i.default);(e.default=n).prototype["[Types/_entity/format/DictionaryField]"]=true,n.prototype._moduleName="Types/entity:format.DictionaryField",n.prototype._typeName="Dictionary",n.prototype._$dictionary=null,n.prototype._$localeDictionary=null}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/IdentityField"]=true;var Pt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getSeparator=function(){return this._separator},e}(i.default);(e.default=n).prototype["[Types/_entity/format/IdentityField]"]=true,n.prototype._moduleName="Types/entity:format.IdentityField",n.prototype._typeName="Identity",n.prototype._separator=",",n.prototype._$defaultValue=[null]}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/RecordField"]=true;var Ct=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/RecordField]"]=true,n.prototype._moduleName="Types/entity:format.RecordField",n.prototype._typeName="Record"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/TimeIntervalField"]=true;var It=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/TimeIntervalField]"]=true,n.prototype._moduleName="Types/entity:format.TimeIntervalField",n.prototype._typeName="TimeInterval",n.prototype._$defaultValue=0}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/RpcFileField"]=true;var Et=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/RpcFileField]"]=true,n.prototype._moduleName="Types/entity:format.RpcFileField",n.prototype._typeName="RpcFile"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/ObjectField"]=true;var jt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/ObjectField]"]=true,n.prototype._moduleName="Types/entity:format.ObjectField",n.prototype._typeName="Object"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/UuidField"]=true;var Rt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/UuidField]"]=true,n.prototype._moduleName="Types/entity:format.UuidField",n.prototype._typeName="Uuid"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/TimeField"]=true;var St=function(){"use strict";var t={},e=function(t,e,r,i,n){Object.defineProperty(e,"__esModule",{value:true});var a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getDefaultValue=function(){if(this._$defaultValue instanceof Date)return n.default(this._$defaultValue,n.MODE.TIME);return this._$defaultValue},e}(i.default);(e.default=a).prototype["[Types/_entity/format/TimeField]"]=true,a.prototype._moduleName="Types/entity:format.TimeField",a.prototype._typeName="Time"}(j,t,u,st,et);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/RecordSetField"]=true;var xt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/RecordSetField]"]=true,n.prototype._moduleName="Types/entity:format.RecordSetField",n.prototype._typeName="RecordSet"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/XmlField"]=true;var Nt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/XmlField]"]=true,n.prototype._moduleName="Types/entity:format.XmlField",n.prototype._typeName="Xml",n.prototype._$defaultValue=""}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/LinkField"]=true;var At=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/LinkField]"]=true,n.prototype._moduleName="Types/entity:format.LinkField",n.prototype._typeName="Link",n.prototype._$defaultValue=0}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/IntegerField"]=true;var $t=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/IntegerField]"]=true,n.prototype._moduleName="Types/entity:format.IntegerField",n.prototype._typeName="Integer",n.prototype._$defaultValue=0}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/RealField"]=true;var kt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getPrecision=function(){return this._$precision},e.prototype.setPrecision=function(t){this._$precision=t},e}(i.default);(e.default=n).prototype["[Types/_entity/format/RealField]"]=true,n.prototype._moduleName="Types/entity:format.RealField",n.prototype._typeName="Real",n.prototype._$defaultValue=0,n.prototype._$precision=16}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/StringField"]=true;var Vt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/StringField]"]=true,n.prototype._moduleName="Types/entity:format.StringField",n.prototype._typeName="String"}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/HierarchyField"]=true;var zt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.getKind=function(){return this._$kind},e.prototype.getDefaultValue=function(){if(this._$kind&&"Identity"===this._$kind)return[null];return null},e}(i.default);(e.default=n).prototype["[Types/_entity/format/HierarchyField]"]=true,n.prototype._moduleName="Types/entity:format.HierarchyField",n.prototype._typeName="Hierarchy",n.prototype._$kind=""}(j,t,u,st);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/MoneyField"]=true;var Ht=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.isLarge=function(){return this._$large},e}(i.default);(e.default=n).prototype["[Types/_entity/format/MoneyField]"]=true,n.prototype._moduleName="Types/entity:format.MoneyField",n.prototype._typeName="Money",n.prototype._$precision=2,n.prototype._$large=false}(j,t,u,kt);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/FlagsField"]=true;var Bt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/FlagsField]"]=true,n.prototype._moduleName="Types/entity:format.FlagsField",n.prototype._typeName="Flags"}(j,t,u,Mt);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/EnumField"]=true;var Lt=function(){"use strict";var t={},e=function(t,e,r,i){Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e}(i.default);(e.default=n).prototype["[Types/_entity/format/EnumField]"]=true,n.prototype._moduleName="Types/entity:format.EnumField",n.prototype._typeName="Enum"}(j,t,u,Mt);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format/fieldsFactory"]=true;var Qt=function(){"use strict";var t={},e=function(t,e,i,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m,g,b,F,w,T,D,O){function r(t){if(Object.getPrototypeOf(t)!==Object.prototype)throw new TypeError("Types/_entity/format/FieldsFactory::create(): declaration should be an instance of Object");var e=t.type;if("string"===typeof e){switch(e.toLowerCase()){case"boolean":return new i.default(t);case"integer":return new n.default(t);case"real":return new a.default(t);case"money":return new o.default(t);case"string":return new s.default(t);case"text":return O.logger.error("Types/_entity/format/FieldsFactory::create()",'Type "text" has been removed in 3.18.10. Use "string" instead.'),t.type="string",new s.default(t);case"xml":return new u.default(t);case"datetime":return new l.default(t);case"date":return new f.default(t);case"time":return new d.default(t);case"timeinterval":return new c.default(t);case"link":return new p.default(t);case"identity":return new h.default(t);case"enum":return new y.default(t);case"flags":return new _.default(t);case"record":case"model":return new v.default(t);case"recordset":return new m.default(t);case"binary":return new g.default(t);case"uuid":return new b.default(t);case"rpcfile":return new F.default(t);case"hierarchy":return O.logger.error("Types/_entity/format/FieldsFactory::create()",'Type "hierarchy" has been removed in 3.18.10. Use "identity" instead.'),t.type="identity",new h.default(t);case"object":return new w.default(t);case"array":return new T.default(t)}if(D.isRegistered(e))e=D.resolve(e)}if("function"===typeof e){var r=Object.create(e.prototype);if(r["[Types/_entity/IObject]"]&&r["[Types/_entity/FormattableMixin]"])return new v.default(t);else if(r["[Types/_collection/IList]"]&&r["[Types/_entity/FormattableMixin]"])return new m.default(t);else if(r["[Types/_collection/IEnum]"])return new y.default(t);else if(r["[Types/_collection/IFlags]"])return new _.default(t);else if(r instanceof Array)return new T.default(t);else if(r instanceof Date)return new f.default(t);else if(r instanceof String)return new s.default(t);else if(r instanceof Number)return new a.default(t);else if(e===Object)return new w.default(t)}throw new TypeError("Types/_entity/format/fieldsFactory(): unsupported field type "+("function"===typeof e?e.name:'"'+e+'"'))}Object.defineProperty(e,"__esModule",{value:true}),e.default=r}(j,t,Tt,$t,kt,Ht,Vt,Nt,Ot,Dt,St,It,At,Pt,Lt,Bt,Ct,xt,wt,Rt,Et,jt,Ft,c,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/format"]=true;var Jt=function(){"use strict";var t={},e=(r=j,i=t,n=st,a=Ft,o=wt,s=Tt,u=Dt,l=Ot,f=Mt,d=Lt,c=Qt,p=Bt,h=zt,y=Pt,_=$t,v=At,m=Ht,g=jt,b=kt,F=Ct,w=xt,T=Et,D=Vt,O=St,M=It,P=R,C=Rt,I=Nt,Object.defineProperty(i,"__esModule",{value:true}),i.Field=n.default,i.ArrayField=a.default,i.BinaryField=o.default,i.BooleanField=s.default,i.DateField=u.default,i.DateTimeField=l.default,i.DictionaryField=f.default,i.EnumField=d.default,i.fieldsFactory=c.default,i.FlagsField=p.default,i.HierarchyField=h.default,i.IdentityField=y.default,i.IntegerField=_.default,i.LinkField=v.default,i.MoneyField=m.default,i.ObjectField=g.default,i.RealField=b.default,i.RecordField=F.default,i.RecordSetField=w.default,i.RpcFileField=T.default,i.StringField=D.default,i.TimeField=O.default,i.TimeIntervalField=M.default,i.UniversalField=P.default,i.UuidField=C.default,void(i.XmlField=I.default)),r,i,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m,g,b,F,w,T,D,O,M,P,C,I;if(e instanceof Function)return e;else for(var E in e)if(e.hasOwnProperty(E))t[E]=e[E];return t}(),Ut=Jt;t["Types/_entity/adapter/GenericFormatMixin"]=true;var Gt=function(){"use strict";var t={},e=function(t,e,a){Object.defineProperty(e,"__esModule",{value:true});var r={"[Types/_entity/adapter/GenericFormatMixin]":true,_data:null,_sharedFieldFormat:null,_sharedFieldMeta:null,constructor:function(t){this._data=t},getData:function(){return this._data},getFields:function(){throw new Error("Method must be implemented")},getFormat:function(t){var e=this._getFieldsFormat(),r=e?e.getFieldIndex(t):-1;if(-1===r)throw new ReferenceError(this._moduleName+'::getFormat(): field "'+t+"\" doesn't exist");return e.at(r)},getSharedFormat:function(t){if(null===this._sharedFieldFormat)this._sharedFieldFormat=new a.UniversalField;var e=this._sharedFieldFormat,r=this._getFieldsFormat(),i=r?r.getFieldIndex(t):-1;return e.name=t,e.type=-1===i?"String":r.at(i).getType(),e.meta=-1===i?{}:this._getFieldMeta(t),e},addField:function(t,e){if(!t||!(t instanceof a.Field))throw new TypeError(this._moduleName+"::addField(): format should be an instance of Types/entity:format.Field");var r=t.getName();if(!r)throw new Error("{$this._moduleName}::addField(): field name is empty");var i=this._getFieldsFormat(),n;if((i?i.getFieldIndex(r):-1)>-1)throw new Error(this._moduleName+'::addField(): field "'+r+'" already exists');this._touchData(),i.add(t,e)},removeField:function(t){var e=this._getFieldsFormat(),r=e?e.getFieldIndex(t):-1;if(-1===r)throw new ReferenceError(this._moduleName+'::removeField(): field "'+t+"\" doesn't exist");this._touchData(),e.removeAt(r)},removeFieldAt:function(t){this._touchData();var e=this._getFieldsFormat();if(e)e.removeAt(t)},_touchData:function(){},_isValidData:function(){return true},_getFieldsFormat:function(){throw new Error("Method must be implemented")},_getFieldMeta:function(t){if(null===this._sharedFieldMeta)this._sharedFieldMeta={};var e=this.getFormat(t),r=this._sharedFieldMeta;switch(e.getType()){case"Real":case"Money":r.precision=e.getPrecision();break;case"Enum":case"Flags":r.dictionary=e.getDictionary();break;case"Identity":r.separator=e.getSeparator();break;case"Array":r.kind=e.getKind()}return r}};e.default=r}(j,t,Jt);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/JsonFormatMixin"]=true;var Wt=function(){"use strict";var t={},e=function(t,e,r){Object.defineProperty(e,"__esModule",{value:true});var i={"[Types/_entity/adapter/GenericFormatMixin]":true,_format:null,constructor:function(){this._format={}},getFormat:function(t){if(!this._has(t))throw new ReferenceError(this._moduleName+'::getFormat(): field "'+t+"\" doesn't exist");if(!this._format.hasOwnProperty(t))this._format[t]=this._buildFormat(t);return this._format[t]},getSharedFormat:function(t){if(null===this._sharedFieldFormat)this._sharedFieldFormat=new r.UniversalField;var e=this._sharedFieldFormat;if(e.name=t,this._format.hasOwnProperty(t))e.type=this.getFormat(t).getType(),e.meta=this._getFieldMeta(t);else e.type="String";return e},addField:function(t){if(!t||!(t instanceof r.Field))throw new TypeError(this._moduleName+"::addField(): format should be an instance of Types/entity:format.Field");var e=t.getName();if(!e)throw new Error(this._moduleName+"::addField(): field name is empty");this._touchData(),this._format[e]=t},removeField:function(t){if(!this._has(t))throw new ReferenceError(this._moduleName+'::removeField(): field "'+t+"\" doesn't exist");this._touchData(),delete this._format[t]},removeFieldAt:function(){throw new Error("Method "+this._moduleName+"::removeFieldAt() doesn't supported")},_touchData:function(){if(!(this._data instanceof Object))this._data={}},_isValidData:function(){return this._data instanceof Object},_has:function(){throw new Error("Method must be implemented")},_buildFormat:function(t){return r.fieldsFactory({name:t,type:"string"})}};e.default=i}(j,t,Jt);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/factory"]=true;var qt=function(){"use strict";var t={},e=function(t,e,r,o,u,l,f,d){Object.defineProperty(e,"__esModule",{value:true});var c=/[+-][0-9]+$/;function i(t){return(t instanceof r.DictionaryField?t.getDictionary():t.meta&&t.meta.dictionary)||[]}function n(t,e){var r=i(e.format);if(null===t&&!r.hasOwnProperty(t))return true;else if(void 0===t)return true;return false}function p(t,e,r){if(void 0===e||null===e){switch(t){case"identity":return false;case"enum":return n(e,r)}if("function"===typeof t){var i=Object.create(t.prototype);if(i&&i["[Types/_collection/IEnum]"])return n(e,r)}return true}return false}function h(t){if(Array.isArray(t)&&t.length<2)return t.length?t[0]:null;return t}function y(t){var e;if("object"===typeof t)e=t instanceof r.Field?t.getType():t.type;else e=t;return(""+e).toLowerCase()}function _(t){if(!t)return false;return t instanceof r.DateTimeField?t.isWithoutTimeZone():t.meta&&t.meta.withoutTimeZone}function v(t){if(!t)return false;return t instanceof r.MoneyField?t.isLarge():t.meta&&t.meta.large}function m(t){if(!t)return 0;return(t.getPrecision?t.getPrecision():t.meta&&t.meta.precision)||0}function g(t){return(t.getKind?t.getKind():t.meta&&t.meta.kind)||""}function b(e){var r=[];return e.each(function(t){r.push(e.get(t))}),r}function F(t){var e="Types/entity:adapter.Json",r=t.getCount(),i,n;for(n=0;n<r;n++)if((i=t.at(n))&&i["[Types/_entity/IObject]"]&&i["[Types/_entity/FormattableMixin]"]){e=i.getAdapter();break}var a=o.create("Types/collection:RecordSet",{adapter:e});for(n=0;n<r;n++)a.add(t.at(n));return a.getRawData(true)}var a={"[Types/_entity/factory]":true,cast:function(t,e,r){var i=this;if(p(e,t,r=r||{}))return t;if("string"===typeof e)switch(e=e.toLowerCase()){case"recordset":e=o.resolve(o.isRegistered("collection.$recordset")?"collection.$recordset":"Types/collection:RecordSet");break;case"record":e=o.resolve(o.isRegistered("entity.$model")?"entity.$model":"Types/entity:Model");break;case"enum":e=o.resolve("Types/collection:Enum");break;case"flags":e=o.resolve("Types/collection:Flags");break;case"link":case"integer":return"number"===typeof t?t:isNaN(parseInt(t,10))?null:parseInt(t,10);case"real":case"double":return"number"===typeof t?t:isNaN(parseFloat(t))?null:parseFloat(t);case"boolean":return!!t;case"money":if(!v(r.format)){var n=m(r.format);if(n>3)return d.real(t,n,false,true)}return void 0===t?null:t;case"date":case"time":case"datetime":if(t instanceof Date)return t;else if("infinity"===t)return 1/0;else if("-infinity"===t)return-1/0;if((t=l.default(""+t)).setSQLSerializationMode)switch(e){case"date":t.setSQLSerializationMode(Date.SQL_SERIALIZE_MODE_DATE);break;case"time":t.setSQLSerializationMode(Date.SQL_SERIALIZE_MODE_TIME);break;case"datetime":t.setSQLSerializationMode(Date.SQL_SERIALIZE_MODE_DATETIME)}return t;case"timeinterval":if(t instanceof f)return t.toString();return f.toString(t);case"array":var a=g(r.format);if(!(t instanceof Array))t=[t];return t.map(function(t){return i.cast(t,a,r)},this);default:return t}if("function"===typeof e){if(t instanceof e)return t;if(e.prototype["[Types/_entity/IProducible]"])return e.produceInstance(t,r);return new e(t)}throw new TypeError("Unknown type "+e)},serialize:function(t,e){var r=this,i=y((e=e||{}).format);if(p(i,t,e))return t;if(t&&"object"===typeof t)if(t["[Types/_entity/FormattableMixin]"])t=t.getRawData(true);else if(t["[Types/_collection/IFlags]"])t=b(t);else if(t["[Types/_collection/IEnum]"])t=t.get();else if(t["[Types/_collection/IList]"]&&"recordset"===i)t=F(t);else if("Deprecated/Record"===t._moduleName)throw new TypeError('Deprecated/Record can\'t be used with "Data"');else if("Deprecated/RecordSet"===t._moduleName)throw new TypeError('Deprecated/RecordSet can\'t be used with "Data"');else if("Deprecated/Enum"===t._moduleName)throw new TypeError('Deprecated/Enum can\'t be used with "Data"');switch(i){case"integer":return"number"===typeof(t=h(t))?t:isNaN(t-=0)?null:parseInt(t,10);case"real":case"double":return h(t);case"link":return parseInt(t,10);case"money":if(t=h(t),!v(e.format)){var n=m(e.format);if(n>3)return d.real(t,n,false,true)}return t;case"date":case"time":case"datetime":t=h(t);var a=u.MODE.DATE,o=false;switch(i){case"datetime":a=u.MODE.DATETIME,o=_(e.format);break;case"time":a=u.MODE.TIME}if(!t)t=l.default(""+t);if(t instanceof Date){if(t=u.default(t,a),o)t=t.replace(c,"")}else if(t===1/0)return"infinity";else if(t===-1/0)return"-infinity";return t;case"timeinterval":if((t=h(t))instanceof f)return t.toString();return f.toString(t);case"array":var s=g(e.format);if(!(t instanceof Array))t=[t];return t.map(function(t){return r.serialize(t,{format:s})},this);default:return t}}};e.default=a}(j,t,Jt,c,et,tt,d,f);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),Kt=qt;t["Types/_entity/adapter/RecordSetRecord"]=true;var Zt=function(){"use strict";var t={},e=function(t,e,r,i,n,a,o){Object.defineProperty(e,"__esModule",{value:true});var s=function(i){function t(t,e){var r=this;if(t&&!t["[Types/_entity/Record]"])throw new TypeError('Argument "data" should be an instance of Types/entity:Record');return r=i.call(this,t)||this,n.default.constructor.call(r,t),r._tableData=e,r}return r.__extends(t,i),t.prototype.has=function(t){return this._isValidData()?this._data.has(t):false},t.prototype.get=function(t){return this._isValidData()?this._data.get(t):void 0},t.prototype.set=function(t,e){if(!t)throw new ReferenceError(this._moduleName+'::set(): argument "name" is not defined');if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");return this._data.set(t,e)},t.prototype.clear=function(){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");var t=this.getFields(),e=this._data.getFormat();if(e)for(var r=void 0,i=void 0,n=0;n<t.length;n++)if(r=t[n],(i=e.getFieldIndex(r))>-1)this._data.removeField(r)},t.prototype.getFields=function(){var e=[];if(this._isValidData())this._data.getFormat().each(function(t){e.push(t.getName())});return e},t.prototype.addField=function(t,e){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.addField(t,e)},t.prototype.removeField=function(t){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeField(t)},t.prototype.removeFieldAt=function(t){if(this._touchData(),!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeFieldAt(t)},t.prototype._touchData=function(){if(!this._data&&this._tableData&&this._tableData["[Types/_entity/FormattableMixin]"]){var t=this._tableData.getModel(),e=this._tableData.getAdapter();this._data=a.create(t,{adapter:e})}},t.prototype._isValidData=function(){return this._data&&this._data["[Types/_entity/Record]"]},t.prototype._getFieldsFormat=function(){return this._isValidData()?this._data.getFormat():a.create("Types/collection:format.Format")},t}(o.mixin(i.default,n.default));(e.default=s).prototype["[Types/_entity/adapter/RecordSetRecord]"]=true,s.prototype["[Types/_entity/adapter/IRecord]"]=true,s.prototype._data=null,s.prototype._tableData=null}(j,t,u,_,Gt,c,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/JsonRecord"]=true;var Yt=function(){"use strict";var t={},e=function(t,e,i,r,n,a,o,s){Object.defineProperty(e,"__esModule",{value:true});var u=function(r){function t(t){var e=r.call(this,t)||this;return n.default.constructor.call(e,t),a.default.constructor.call(e,t),e}return i.__extends(t,r),t.prototype.addField=function(t,e){if(!t||!(t instanceof o.Field))throw new TypeError(this._moduleName+'::addField(): argument "format" should be an instance of Types/entity:format.Field');var r=t.getName();if(this.has(r))throw new Error(this._moduleName+'::addField(): field "'+r+'" already exists');a.default.addField.call(this,t,e),this.set(r,t.getDefaultValue())},t.prototype.removeField=function(t){a.default.removeField.call(this,t),delete this._data[t]},t.prototype.has=function(t){return this._isValidData()?this._data.hasOwnProperty(t):false},t.prototype.get=function(t){return this._isValidData()?this._data[t]:void 0},t.prototype.set=function(t,e){if(!t)throw new ReferenceError(this._moduleName+"::set(): field name is not defined");this._touchData(),this._data[t]=e},t.prototype.clear=function(){this._touchData();for(var t=Object.keys(this._data),e=t.length,r=0;r<e;r++)delete this._data[t[r]]},t.prototype.getFields=function(){return this._isValidData()?Object.keys(this._data):[]},t.prototype.getKeyField=function(){return},t.prototype._has=function(t){return this.has(t)},t}(s.mixin(r.default,n.default,a.default));(e.default=u).prototype["[Types/_entity/adapter/JsonRecord]"]=true,u.prototype["[Types/_entity/adapter/IRecord]"]=true,u.prototype._data=null}(j,t,u,_,Gt,Wt,Jt,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/RecordSetTable"]=true;var Xt=function(){"use strict";var t={},e=function(t,e,i,r,n,a,o){Object.defineProperty(e,"__esModule",{value:true});var s=function(r){function t(t){var e=this;if(t&&!t["[Types/_collection/RecordSet]"])throw new TypeError('Argument "data" should be an instance of Types/collection:RecordSet');return e=r.call(this,t)||this,n.default.constructor.call(e,t),e}return i.__extends(t,r),t.prototype.getFields=function(){var e=[];if(this._isValidData())this._data.getFormat().each(function(t){e.push(t.getName())});return e},t.prototype.getCount=function(){return this._isValidData()?this._data.getCount():0},t.prototype.add=function(t,e){this._buildData(t),this._data.add(t,e)},t.prototype.at=function(t){return this._isValidData()?this._data.at(t):void 0},t.prototype.remove=function(t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");return this._data.removeAt(t)},t.prototype.replace=function(t,e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");return this._data.replace(t,e)},t.prototype.move=function(t,e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");var r=this._data.at(t);this._data.removeAt(t),this._data.add(r,e)},t.prototype.merge=function(r,t,i){if(!this._isValidData())throw new TypeError("Passed data has invalid format");r=this._data.at(r),this._data.at(t).each(function(t,e){if(t!==i)r.set(t,e)},this),this._data.removeAt(t)},t.prototype.copy=function(t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");var e=this._data.at(t).clone();return this.add(e,1+t),e},t.prototype.clear=function(){if(!this._isValidData())throw new TypeError("Passed data has invalid format");for(var t,e=this._data.getCount()-1;e>=0;e--)this._data.removeAt(e)},t.prototype.addField=function(t,e){if(!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.addField(t,e)},t.prototype.removeField=function(t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeField(t)},t.prototype.removeFieldAt=function(t){if(!this._isValidData())throw new TypeError("Passed data has invalid format");this._data.removeFieldAt(t)},t.prototype._buildData=function(t){if(!this._data){var e={};if(t){if(t.getAdapter)e.adapter=t.getAdapter();if(t.getIdProperty)e.idProperty=t.getIdProperty()}this._data=a.create("Types/collection:RecordSet",e)}},t.prototype._isValidData=function(){return this._data&&this._data["[Types/_collection/RecordSet]"]},t.prototype._getFieldsFormat=function(){return this._data.getFormat()},t}(o.mixin(r.default,n.default));(e.default=s).prototype["[Types/_entity/adapter/RecordSetTable]"]=true,s.prototype["[Types/_entity/adapter/ITable]"]=true,s.prototype._data=null}(j,t,u,_,Gt,c,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/SbisFormatMixin"]=true;var te=function(){"use strict";var t={},e=function(t,e,a,i,n,o,s){Object.defineProperty(e,"__esModule",{value:true});var r=Object.keys(a.default).reduce(function(t,e){return t[a.default[e]]=e,t},{}),u="undefined"===typeof Symbol?void 0:Symbol("fieldIndices");function l(t){return r[t]||"string"}function f(t){return a.default[(t+"").toLowerCase()]}var d={"[Types/_entity/adapter/SbisFormatMixin]":true,_data:null,_type:"",_fieldIndices:null,_format:null,_sharedFieldFormat:null,_sharedFieldMeta:null,constructor:function(t){if(t&&t._type&&t._type!==this._type)throw new TypeError('Argument "data" has "'+t._type+'" type signature but "'+this._type+'" expected.');if(u&&t&&t.s)t.s[u]=null;this._data=t,this._format={}},getData:function(){return this._data},getFields:function(){var t=[];if(this._isValidData())for(var e=0,r=this._data.s.length;e<r;e++)t.push(this._data.s[e].n);return t},clear:function(){this._touchData(),this._data.d.length=0},getFormat:function(t){if(!this._has(t))throw new ReferenceError(this._moduleName+'::getFormat(): field "'+t+"\" doesn't exist");if(!this._format.hasOwnProperty(t))this._format[t]=this._buildFormat(t);return this._format[t]},getSharedFormat:function(t){var e=this._sharedFieldFormat||(this._sharedFieldFormat=new n.UniversalField),r=this._getFieldIndex(t);if(-1===r)throw new ReferenceError(this._moduleName+'::getSharedFormat(): field "'+t+"\" doesn't exist");return e.name=t,e.type=this._getFieldType(r),e.meta=this._getFieldMeta(r,e.type,true),e},addField:function(t,e){if(!t||!(t instanceof n.Field))throw new TypeError(this._moduleName+"::addField(): format should be an instance of Types/entity:format.Field");var r=t.getName();if(this._has(r))throw new ReferenceError(this._moduleName+'::addField(): field "'+r+'" already exists');if(this._touchData(),void 0===e)e=this._data.s.length;this._checkFieldIndex(e,true),this._format[r]=t,this._resetFieldIndices(),this._data.s.splice(e,0,this._buildS(t)),this._buildD(e,i.default.serialize(t.getDefaultValue(),{format:t}))},removeField:function(t){this._touchData();var e=this._getFieldIndex(t);if(-1===e)throw new ReferenceError(this._moduleName+'::removeField(): field "'+t+"\" doesn't exist");delete this._format[t],this._resetFieldIndices(),this._data.s.splice(e,1),this._removeD(e)},removeFieldAt:function(t){this._touchData(),this._checkFieldIndex(t);var e=this._data.s[t].n;delete this._format[e],this._resetFieldIndices(),this._data.s.splice(t,1),this._removeD(t)},_touchData:function(){this._data=this._normalizeData(this._data,this._type)},_normalizeData:function(t,e){if(!(t instanceof Object))t={};if(!(t.d instanceof Array))t.d=[];if(!(t.s instanceof Array))t.s=[];return t._type=e,t},_cloneData:function(t){var e=s.object.clone(this._data);if(t&&e&&e.s)e.s=this._data.s;return e},_isValidData:function(){return this._data&&this._data.s instanceof Array},_has:function(t){return this._getFieldIndex(t)>=0},_getFieldIndex:function(t){if(!this._isValidData())return-1;var e=this._data.s,r=u?e[u]:this._fieldIndices;if(!u&&r&&this._fieldIndices["[{s}]"]!==e)r=null;if(!r){if(r=new o.Map,u)e[u]=r;else this._fieldIndices=r,this._fieldIndices["[{s}]"]=e;for(var i=0,n=e.length;i<n;i++)r.set(e[i].n,i)}return r.has(t)?r.get(t):-1},_resetFieldIndices:function(){if(this._isValidData())if(u)this._data.s[u]=null;else this._fieldIndices=null},_checkFieldIndex:function(t,e){var r=this._data.s.length-1;if(e)r++;if(!(t>=0&&t<=r))throw new RangeError(this._moduleName+': field index "'+t+'" is out of bounds.')},_getFieldType:function(t){var e,r=this._data.s[t].t;if(r&&r instanceof Object)r=r.n;return l(r)},_getFieldMeta:function(t,e,r){if(r&&null===this._sharedFieldMeta)this._sharedFieldMeta={};var i=this._data.s[t],n=r?this._sharedFieldMeta:{};switch(e){case"real":n.precision=i.t.p;break;case"money":if(n.precision=void 0,"object"===typeof i.t&&"p"in i.t)n.precision=i.t.p;n.large=!!i.t.l;break;case"enum":case"flags":n.dictionary=i.t.s,n.localeDictionary=i.t.sl;break;case"datetime":n.withoutTimeZone=i.t&&i.t.n&&"tz"in i.t?!i.t.tz:false;break;case"identity":n.separator=",";break;case"array":n.kind=l(i.t.t),Object.assign(n,this._getFieldMeta(t,n.kind))}return n},_checkFormat:function(t,e){var r=this._isValidData()?this._data.s:[],i=t?t.s||[]:[],n=r.length,a;if(r===i)return;if(e=e||"",n!==i.length)a=n+" columns expected instead of "+i.length;else for(var o=0;o<n;o++)if(a=this._checkFormatColumns(r[o],i[o]||{},o))break;if(a)s.logger.info(this._moduleName+e+": the formats are not equal ("+a+")")},_checkFormatColumns:function(t,e,r){if(t.n!==e.n)return'field with name "'+t.n+'" at position '+r+' expected instead of "'+e.n+'"';var i=t.t,n;if(i&&i.n)i=i.n;if((n=e.t)&&n.n)n=n.n;if(i!==n)return'expected field type for "'+t.n+'" at position '+r+' is "'+i+'" instead of "'+n+'"'},_buildFormatDeclaration:function(t){var e=this._getFieldIndex(t),r=this._getFieldType(e),i=this._getFieldMeta(e,r);return i.name=t,i.type=r,i},_buildFormat:function(t){return n.fieldsFactory(this._buildFormatDeclaration(t))},_buildS:function(t){var e={n:t.getName()};return this._buildSType(e,t),e},_buildSType:function(t,e){var r=(e.getTypeName()+"").toLowerCase();switch(r){case"money":if(e.isLarge())t.t={n:a.default[r],l:true};else t.t=a.default[r];break;case"enum":case"flags":var i=e.getDictionary();if(i instanceof Array)i=i.reduce(function(t,e,r){return t[r]=e,t},{});t.t={n:a.default[r],s:i};break;case"datetime":var n=e.isWithoutTimeZone();if(n)t.t={n:a.default[r],tz:!n};else t.t=a.default[r];break;case"array":t.t={n:a.default[r],t:f(e.getKind())};break;default:t.t=a.default[r]}},_buildD:function(){throw new Error("Method must be implemented")},_removeD:function(){throw new Error("Method must be implemented")}};e.default=d}(j,t,b,qt,Jt,s,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/RecordSet"]=true;var ee=function(){"use strict";var t={},e=function(t,e,r,i,n,a,o,s){Object.defineProperty(e,"__esModule",{value:true});var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.forTable=function(t){return new n.default(t)},e.prototype.forRecord=function(t,e){return new a.default(t,e)},e.prototype.getProperty=function(t,e){return s.object.getPropertyValue(t,e)},e.prototype.setProperty=function(t,e,r){return s.object.setPropertyValue(t,e,r)},e.prototype.getKeyField=function(t){if(t&&"function"===typeof t.getIdProperty)return t.getIdProperty();return},e}(i.default);(e.default=u).prototype["[Types/_entity/adapter/RecordSet]"]=true,u.prototype._moduleName="Types/entity:adapter.RecordSet",o.register("Types/entity:adapter.RecordSet",u,{instantiate:false}),o.register("adapter.recordset",u,{instantiate:false})}(j,t,u,ot,Xt,Zt,c,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/SbisRecord"]=true;var re=function(){"use strict";var t={},e=function(t,e,i,r,n,a){Object.defineProperty(e,"__esModule",{value:true});var o=function(r){function e(t){var e=r.call(this,t)||this;return n.default.constructor.call(e,t),e}return i.__extends(e,r),e.prototype.has=function(t){return this._has(t)},e.prototype.get=function(t){var e=this._getFieldIndex(t);return e>=0?this._cast(this._data.s[e],this._data.d[e]):void 0},e.prototype.set=function(t,e){var r=this._getFieldIndex(t);if(r<0)throw new ReferenceError(this._moduleName+'::set(): field "'+t+'" is not defined');this._data.d[r]=this._uncast(this._data.s[r],e)},e.prototype.clear=function(){this._touchData(),n.default.clear.call(this),this._data.s.length=0},e.prototype.clone=function(t){return new e(t?this.getData():this._cloneData(true))},e.prototype._buildD=function(t,e){this._data.d.splice(t,0,e)},e.prototype._removeD=function(t){this._data.d.splice(t,1)},e.prototype._cast=function(t,e){switch(t&&t.t){case"Идентификатор":return e instanceof Array?null===e[0]?e[0]:e.join(this._castSeparator):e}return e},e.prototype._uncast=function(t,e){switch(t&&t.t){case"Идентификатор":if(e instanceof Array)return e;return"string"===typeof e?e.split(this._castSeparator):[e]}return e},e}(a.mixin(r.default,n.default));(e.default=o).prototype["[Types/_entity/adapter/SbisRecord]"]=true,o.prototype["[Types/_entity/adapter/IRecord]"]=true,o.prototype["[Types/_entity/ICloneable]"]=true,o.prototype._type="record",o.prototype._castSeparator=",",o.prototype["[WS.Data/Entity/ICloneable]"]=true}(j,t,u,_,te,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/SbisTable"]=true;var ie=function(){"use strict";var t={},e=function(t,e,i,r,n,a,o,s,u){Object.defineProperty(e,"__esModule",{value:true});var l=function(r){function e(t){var e=r.call(this,t)||this;return n.default.constructor.call(e,t),e}return i.__extends(e,r),e.prototype.getCount=function(){return this._isValidData()?this._data.d.length:0},e.prototype.add=function(t,e){if(this._touchData(),t=this._normalizeData(t,a.default.prototype._type),0===this._data.d.length&&t.s)this._data.s=t.s;if(this._checkFormat(t,"::add()"),t.s=this._data.s,void 0===e)this._data.d.push(t.d);else this._checkRowIndex(e,true),this._data.d.splice(e,0,t.d)},e.prototype.at=function(t){return this._isValidData()&&this._data.d[t]?{d:this._data.d[t],s:this._data.s}:void 0},e.prototype.remove=function(t){this._touchData(),this._checkRowIndex(t),this._data.d.splice(t,1)},e.prototype.replace=function(t,e){if(this._touchData(),this._checkRowIndex(e),!this._data.s.length&&t.s.length)this._data.s=t.s;t.s=this._data.s,this._checkFormat(t,"::replace()"),this._data.d[e]=t.d},e.prototype.move=function(t,e){if(this._touchData(),e===t)return;var r=this._data.d.splice(t,1);-1===e?this._data.d.unshift(r.shift()):this._data.d.splice(e,0,r.shift())},e.prototype.merge=function(t,e){this._touchData(),this._checkRowIndex(t),this._checkRowIndex(e),u.merge(this._data.d[t],this._data.d[e]),this.remove(e)},e.prototype.copy=function(t){this._touchData(),this._checkRowIndex(t);var e=this._data.d[t],r=u.merge([],e);return this._data.d.splice(1+t,0,r),r},e.prototype.getMetaDataDescriptor=function(){var e=[],t=this.getData();if(!(t instanceof Object))return e;if(t.hasOwnProperty("r"))e.push(o.fieldsFactory({name:"results",type:"record"}));if(t.hasOwnProperty("p"))e.push(o.fieldsFactory({name:"path",type:"recordset"}));if(t.hasOwnProperty("n")){var r="integer";switch(typeof t.n){case"boolean":r="boolean";break;case"object":if(t.n)r="object"}e.push(o.fieldsFactory({name:"total",type:r})),e.push(o.fieldsFactory({name:"more",type:r}))}if(t.hasOwnProperty("m")){var i=new a.default(t.m);i.getFields().forEach(function(t){e.push(i.getFormat(t))})}return e},e.prototype.getMetaData=function(t){var e=this._getMetaDataAlias(t),r=this.getData(),i;if(e)return r&&r instanceof Object?r[e]:void 0;return new a.default(r.m).get(t)},e.prototype.setMetaData=function(t,e){var r=this._getMetaDataAlias(t),i=this.getData(),n;if(r){if(i&&i instanceof Object)i[r]=e;return}new a.default(i.m).set(t,e)},e.prototype._getMetaDataAlias=function(t){switch(t){case"results":return"r";case"path":return"p";case"more":case"total":return"n"}},e.prototype.clone=function(t){return new e(t?this.getData():this._cloneData())},e.prototype._buildD=function(e,r){this._data.d.forEach(function(t){t.splice(e,0,r)})},e.prototype._removeD=function(e){this._data.d.forEach(function(t){t.splice(e,1)})},e.prototype._checkRowIndex=function(t,e){var r=this._data.d.length+(e?0:-1);if(!(t>=0&&t<=r))throw new RangeError(this._moduleName+": row index "+t+" is out of bounds.")},e}(s.mixin(r.default,n.default));(e.default=l).prototype["[Types/_entity/adapter/SbisTable]"]=true,l.prototype["[Types/_entity/adapter/ITable]"]=true,l.prototype["[Types/_entity/adapter/IMetaData]"]=true,l.prototype["[Types/_entity/ICloneable]"]=true,l.prototype._type="recordset",l.prototype["[WS.Data/Entity/ICloneable]"]=true}(j,t,u,_,te,re,Jt,p,i);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/JsonTable"]=true;var ne=function(){"use strict";var t={},e=function(t,e,i,r,n,o,s,u,a,l){Object.defineProperty(e,"__esModule",{value:true});var f=function(r){function t(t){var e=r.call(this,t)||this;return n.default.constructor.call(e,t),o.default.constructor.call(e,t),e}return i.__extends(t,r),t.prototype.addField=function(t,e){o.default.addField.call(this,t,e);for(var r=t.getName(),i=t.getDefaultValue(),n,a=0;a<this._data.length;a++)if(!(n=this._data[a]).hasOwnProperty(r))n[r]=i},t.prototype.removeField=function(t){o.default.removeField.call(this,t);for(var e=0;e<this._data.length;e++)delete this._data[e][t]},t.prototype.getFields=function(){for(var t=this.getCount(),e=new u.Set,r=[],i,n=function(t){e.add(t)},a=0;a<t;a++)if((i=this.at(a))instanceof Object)Object.keys(i).forEach(n);return e.forEach(function(t){r.push(t)}),r},t.prototype.getCount=function(){return this._isValidData()?this._data.length:0},t.prototype.add=function(t,e){if(this._touchData(),void 0===e)this._data.push(t);else this._checkPosition(e),this._data.splice(e,0,t)},t.prototype.at=function(t){return this._isValidData()?this._data[t]:void 0},t.prototype.remove=function(t){this._touchData(),this._checkPosition(t),this._data.splice(t,1)},t.prototype.replace=function(t,e){this._touchData(),this._checkPosition(e),this._data[e]=t},t.prototype.move=function(t,e){if(this._touchData(),e===t)return;var r=this._data.splice(t,1);if(-1===e)this._data.unshift(r.shift());else this._data.splice(e,0,r.shift())},t.prototype.merge=function(t,e,r){this._touchData();var i=this.at(t),n=this.at(e),a=new s.default(i),o=a.get(r);l.merge(i,n),a.set(r,o),this.remove(e)},t.prototype.copy=function(t){this._touchData();var e=this.at(t),r=l.merge({},e);return this.add(r,1+t),r},t.prototype.clear=function(){this._touchData(),this._data.length=0},t.prototype._touchData=function(){if(n.default._touchData.call(this),!(this._data instanceof Array))this._data=[]},t.prototype._isValidData=function(){return this._data instanceof Array},t.prototype._has=function(t){for(var e=this.getCount(),r=false,i,n=0;n<e;n++)if((i=this.at(n))instanceof Object)if(r=i.hasOwnProperty(t))break;return r},t.prototype._checkPosition=function(t){if(t<0||t>this._data.length)throw new Error("Out of bounds")},t}(a.mixin(r.default,n.default,o.default));(e.default=f).prototype["[Types/_entity/adapter/JsonTable]"]=true,f.prototype._data=null}(j,t,u,_,Gt,Wt,Yt,s,p,i);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/Json"]=true;var ae=function(){"use strict";var t={},e=function(t,e,r,i,n,a,o){Object.defineProperty(e,"__esModule",{value:true});var s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.forTable=function(t){return new n.default(t)},e.prototype.forRecord=function(t){return new a.default(t)},e.prototype.getKeyField=function(){return},e}(i.default);(e.default=s).prototype["[Types/_entity/adapter/Json]"]=true,s.prototype._moduleName="Types/entity:adapter.Json",o.register("Types/entity:adapter.Json",s,{instantiate:false}),o.register("adapter.json",s)}(j,t,u,ot,ne,Yt,c);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter/Sbis"]=true;var oe=function(){"use strict";var t={},e=function(t,e,r,i,n,a,o,s){Object.defineProperty(e,"__esModule",{value:true});var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r.__extends(e,t),e.prototype.forTable=function(t){return new n.default(t)},e.prototype.forRecord=function(t){return new a.default(t)},e.prototype.getKeyField=function(t){var e,r;if(t&&t.s){for(var i=0,n=(r=t.s).length;i<n;i++)if(r[i].n&&"@"===r[i].n[0]){e=i;break}if(void 0===e&&r.length)e=0}return void 0===e?void 0:r[e].n},Object.defineProperty(e,"FIELD_TYPE",{get:function(){return o.default},enumerable:true,configurable:true}),e}(i.default);(e.default=u).prototype["[Types/_entity/adapter/Sbis]"]=true,u.prototype._moduleName="Types/entity:adapter.Sbis",s.register("Types/entity:adapter.Sbis",u,{instantiate:false}),s.register("adapter.sbis",u)}(j,t,u,ot,ie,re,b,c);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();t["Types/_entity/adapter"]=true;var se=function(){"use strict";var t={},e=(r=j,i=t,n=ot,a=bt,o=Gt,s=ae,u=it,l=nt,f=at,d=rt,c=ee,p=Zt,h=Xt,y=oe,_=b,v=re,m=ie,Object.defineProperty(i,"__esModule",{value:true}),i.Abstract=n.default,i.Cow=a.default,i.GenericFormatMixin=o.default,i.Json=s.default,i.IAdapter=u.default,i.IMetaData=l.default,i.IRecord=f.default,i.ITable=d.default,i.RecordSet=c.default,i.RecordSetRecord=p.default,i.RecordSetTable=h.default,i.Sbis=y.default,i.SbisFieldType=_.default,i.SbisRecord=v.default,void(i.SbisTable=m.default)),r,i,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m;if(e instanceof Function)return e;else for(var g in e)if(e.hasOwnProperty(g))t[g]=e[g];return t}(),ue=se;t["Types/_entity/FormattableMixin"]=true;var le=function(){"use strict";var t={},e=function(t,e,a,r,o,n){Object.defineProperty(e,"__esModule",{value:true});var i="Types/entity:adapter.Json";function s(t,e){var r,i;for(var n in t){if(!t.hasOwnProperty(n))continue;if("object"!==typeof(r=t[n]))r={type:r};if(!(r instanceof a.Field))r=a.fieldsFactory(r);if(r.setName(n),-1===(i=e.getFieldIndex(n)))e.add(r);else e.replace(r,i)}return e}function u(){for(var t,e=new(o.resolve("Types/collection:format.Format")),r=this._getRawDataAdapter(),i=this._getRawDataFields(),n=i.length,a=0;a<n;a++)e.add(r.getFormat(i[a]));return e}function l(){var e=this;if(this._hasFormat()){var r=this._getRawDataAdapter(),i=r.getFields();if(r["[Types/_entity/adapter/IDecorator]"])r=r.getOriginal();if(r._touchData)r._touchData();this._getFormat().each(function(t){try{if(-1===i.indexOf(t.getName()))r.addField(t)}catch(t){n.logger.info(e._moduleName+"::constructor(): can't add raw data field ("+t.message+")")}})}}var f={"[Types/_entity/FormattableMixin]":true,"[WS.Data/Entity/FormattableMixin]":true,_$rawData:null,_$cow:false,_$adapter:i,_$format:null,_format:null,_formatClone:null,_rawDataAdapter:null,_rawDataFields:null,constructor:function(){if(!this._$format&&this._options&&this._options.format)this._$format=this._options.format;l.call(this)},_getSerializableState:function(t){return t.$options.rawData=this._getRawData(),t},_setSerializableState:function(t){return function(){}},getRawData:function(t){return t?this._getRawData():n.object.clone(this._getRawData())},setRawData:function(t){this._resetRawDataAdapter(t),this._resetRawDataFields(),this._clearFormatClone(),l.call(this)},getAdapter:function(){var t=this._getAdapter();if(t["[Types/_entity/adapter/IDecorator]"])t=t.getOriginal();return t},getFormat:function(t){if(t)return this._getFormat(true);if(!this._formatClone)this._formatClone=this._getFormat(true).clone(true);return this._formatClone},addField:function(t,e){t=this._buildField(t),this._$format=this._getFormat(true),this._$format.add(t,e),this._getRawDataAdapter().addField(t,e),this._resetRawDataFields(),this._clearFormatClone()},removeField:function(t){this._$format=this._getFormat(true),this._$format.removeField(t),this._getRawDataAdapter().removeField(t),this._resetRawDataFields(),this._clearFormatClone()},removeFieldAt:function(t){this._$format=this._getFormat(true),this._$format.removeAt(t),this._getRawDataAdapter().removeFieldAt(t),this._resetRawDataFields(),this._clearFormatClone()},_getRawData:function(t){if(!t&&this._rawDataAdapter)return this._rawDataAdapter.getData();return"function"===typeof this._$rawData?this._$rawData():this._$rawData},_getDefaultAdapter:function(){return i},_getAdapter:function(){if(this._$adapter===i&&f._getDefaultAdapter!==this._getDefaultAdapter)this._$adapter=this._getDefaultAdapter();if(this._$adapter&&!(this._$adapter instanceof Object))this._$adapter=o.create(this._$adapter);if(this._$cow&&!this._$adapter["[Types/_entity/adapter/IDecorator]"])this._$adapter=new r.Cow(this._$adapter);return this._$adapter},_getRawDataAdapter:function(){if(!this._rawDataAdapter)this._rawDataAdapter=this._createRawDataAdapter();return this._rawDataAdapter},_createRawDataAdapter:function(){throw new Error("Method must be implemented")},_resetRawDataAdapter:function(t){if(void 0===t){if(this._rawDataAdapter&&"function"!==typeof this._$rawData)this._$rawData=this._rawDataAdapter.getData()}else this._$rawData=t;this._rawDataAdapter=null},_checkAdapterCompatibility:function(t){var e=this._getAdapter(),r;if(t["[Types/_entity/adapter/IDecorator]"])t=t.getOriginal();if(e["[Types/_entity/adapter/IDecorator]"])e=e.getOriginal();if(!Object.getPrototypeOf(e).isPrototypeOf(t))throw new TypeError('The foreign adapter "'+t._moduleName+'" is incompatible with the internal adapter "'+e._moduleName+'"')},_getRawDataFields:function(){return this._rawDataFields||(this._rawDataFields=this._getRawDataAdapter().getFields())},_addRawDataField:function(t){this._getRawDataFields().push(t)},_resetRawDataFields:function(){this._rawDataFields=null},_getFormat:function(t){var e=this;if(!this._format)if(this._hasFormat())this._format=this._$format=f._buildFormat(this._$format,function(){return u.call(e)});else if(t)this._format=u.call(this);return this._format},_clearFormat:function(){if(this._hasFormat())throw new Error(this._moduleName+": format can't be cleared because it's defined directly");this._format=null,this._clearFormatClone()},_clearFormatClone:function(){this._formatClone=null},_hasFormat:function(){return!!this._$format},_getFieldFormat:function(t,e){if(this._hasFormat()){var r=this._getFormat(),i=r.getFieldIndex(t);if(i>-1)return r.at(i)}return e.getSharedFormat(t)},_getFieldType:function(t){var e=t.getType?t.getType():t.type;if(e&&"string"===typeof e)if(o.isRegistered(e))e=o.resolve(e);return e},_buildField:function(t){if("string"===typeof t||Object.getPrototypeOf(t)===Object.prototype)t=a.fieldsFactory(t);if(!t||!(t instanceof a.Field))throw new TypeError(this._moduleName+": format should be an instance of Types/entity:format.Field");return t},_buildFormat:function(t,e){var r=o.resolve("Types/collection:format.Format");if(t){var i=Object.getPrototypeOf(t);if(i===Array.prototype){var n;t=o.resolve("Types/collection:format.factory")(t)}else if(i===Object.prototype)t=s(t,e?e():new r)}if(!t||!(t instanceof r))t=new r;return t}};e.default=f}(j,t,Jt,se,c,p);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),fe=le;t["Types/_entity/Record"]=true;var de=function(){"use strict";var t={},e=function(t,e,i,r,n,a,o,s,u,l,f,d,c,p,h,y,_,v,m){function g(t){return t&&"object"===typeof t?false:true}function b(t){if(t&&"object"===typeof t&&t!==t.valueOf())return t.valueOf();return t}function F(t,e){return b(t)===b(e)}function w(t){switch(typeof t){case"boolean":return"boolean";case"number":if(t%1===0)return"integer";return"real";case"object":if(null===t)return"string";else if(t instanceof E)return"record";else if(t&&t["[Types/_collection/RecordSet]"])return"recordset";else if(t instanceof Date){if(t.hasOwnProperty("_serializeMode"))switch((t=t).getSQLSerializationMode()){case Date.SQL_SERIALIZE_MODE_DATE:return"date";case Date.SQL_SERIALIZE_MODE_TIME:return"time"}return"datetime"}else if(t instanceof Array)return{type:"array",kind:w(t.find(function(t){return null!==t&&void 0!==t}))};return"object";default:return"string"}}Object.defineProperty(e,"__esModule",{value:true});var T=r.protect("fieldsCache"),D=r.protect("fieldsClone"),O=r.protect("changedFields"),M={ADDED:"Added",DELETED:"Deleted",CHANGED:"Changed",UNCHANGED:"Unchanged",DETACHED:"Detached"},P="field.",C=r.protect("objects"),I=r.protect("all"),E=function(r){function u(t){var e=this;if(t&&t.owner&&!t.owner["[Types/_collection/RecordSet]"])throw new TypeError("Records owner should be an instance of Types/collection:RecordSet");return e=r.call(this,t)||this,a.default.call(e,t),s.default.constructor.call(e),d.default.constructor.call(e,t),f.default.constructor.call(e,t),e._publish("onPropertyChange"),e._clearChangedFields(),e._acceptedState=e._$state,e}return i.__extends(u,r),Object.defineProperty(u.prototype,"_fieldsCache",{get:function(){return this[T]||(this[T]=new _.Map)},enumerable:true,configurable:true}),Object.defineProperty(u.prototype,"_fieldsClone",{get:function(){return this[D]||(this[D]=new _.Map)},enumerable:true,configurable:true}),Object.defineProperty(u.prototype,"_changedFields",{get:function(){var e=this,r={},i=this[O],n,a,o;if(!i)return r;return Object.keys(i).forEach(function(t){if(n=i[t],o=n[0],a=n[1],o&&a&&o["[Types/_entity/Record]"]&&!o.isChanged())return;r[t]=e._haveToClone(o)&&e._fieldsClone.has(t)?e._fieldsClone.get(t):o}),r},enumerable:true,configurable:true}),u.prototype.destroy=function(){this[O]=null,this._clearFieldsCache(),f.default.destroy.call(this),n.default.prototype.destroy.call(this)},u.prototype.get=function(t){if(this._fieldsCache.has(t))return this._fieldsCache.get(t);var e=this._getRawDataValue(t);if(this._isFieldValueCacheable(e))if(this._addChild(e,this._getRelationNameForField(t)),this._fieldsCache.set(t,e),this._haveToClone(e))this._fieldsClone.set(t,e.clone());return e},u.prototype.set=function(t,e){var r=this,i=this._getHashMap(t,e),n=[],a=this._setPairs(Object.keys(i).map(function(t){return[t,i[t],r.get(t)]}),n);if(a)this._notifyChange(a);this._checkErrors(n)},u.prototype.has=function(t){return this._getRawDataFields().indexOf(t)>-1},u.prototype._setPairs=function(t,n){var a=this,o=null;return t.forEach(function(t){var e=t[0],r=t[1],i=t[2];if(F(r,i)){if("object"===typeof r)a._setRawDataValue(e,r)}else try{if(a._removeChild(i),g(r))r=a._setRawDataValue(e,r);else a._setRawDataValue(e,r);if(a._addChild(r,a._getRelationNameForField(e)),r!==i){if(!a.has(e))a._addRawDataField(e);if(!o)o={};if(o[e]=r,a._hasChangedField(e)&&b(a._getChangedFieldValue(e))===b(r))a._unsetChangedField(e);else a._setChangedField(e,i);if(a._isFieldValueCacheable(r)){if(a._fieldsCache.set(e,r),a._haveToClone(r))a._fieldsClone.set(e,r.clone())}else a._fieldsCache.delete(e),a._fieldsClone.delete(e)}}catch(t){n.push(t)}}),o},u.prototype.getEnumerator=function(){var t;return new(h.resolve("Types/collection:enumerator.Arraywise"))(this._getRawDataFields())},u.prototype.each=function(t,e){var r=this.getEnumerator(),i;while(r.moveNext())i=r.getCurrent(),t.call(e||this,i,this.get(i))},u.prototype.isEqual=function(t){if(t===this)return true;if(!t)return false;if(!(t instanceof u))return false;return JSON.stringify(this._getRawData())===JSON.stringify(t.getRawData(true))},u.prototype.relationChanged=function(t,e){var a=this,r=function(t,e){var r={},i,n;if(a._getRawDataAdapter().has(t))a._setRawDataValue(t,e,true);return a._setChangedField(t,e,true),r[t]=e,a._notify("onPropertyChange",r),r},i=e[0],n=this._getFieldFromRelationName(i),o=t.target;switch(t.original){case u.prototype.acceptChanges:if(n&&(o["[Types/_entity/Record]"]&&!o.isChanged()||o["[Types/_collection/RecordSet]"]&&!o.isChanged()))this.acceptChanges([n]);break;case u.prototype.rejectChanges:if(n&&(o["[Types/_entity/Record]"]&&!o.isChanged()||o["[Types/_collection/RecordSet]"]&&!o.isChanged()))this.rejectChanges([n]);break;case u.prototype.addField:case u.prototype.removeField:case u.prototype.removeFieldAt:if(this._resetRawDataAdapter(),this._resetRawDataFields(),n)r(n,o);break;default:if(n){var s;return{target:o,data:r(n,o)}}}},u.produceInstance=function(t,e){var r={rawData:t};if(e&&e.adapter)r.adapter=e.adapter;return new this(r)},u.prototype._getSerializableState=function(t){if(t=s.default.prototype._getSerializableState.call(this,t),(t=d.default._getSerializableState.call(this,t))._changedFields=this[O],t.$options.owner&&t.$options.owner._hasFormat())t._format=t.$options.owner.getFormat();return delete t.$options.owner,t},u.prototype._setSerializableState=function(t){var e=s.default.prototype._setSerializableState(t),r=d.default._setSerializableState(t);return function(){if(e.call(this),r.call(this),this[O]=t._changedFields,t._format)this._$format=t._format}},u.prototype.setRawData=function(t){d.default.setRawData.call(this,t),this._nextVersion(),this._clearFieldsCache(),this._notifyChange()},u.prototype.addField=function(t,e,r){if(this._checkFormatIsWritable(),t=this._buildField(t),d.default.addField.call(this,t,e),void 0!==r)this.set(t.getName(),r);this._childChanged(u.prototype.addField),this._nextVersion()},u.prototype.removeField=function(t){this._checkFormatIsWritable(),this._nextVersion(),this._fieldsCache.delete(t),this._fieldsClone.delete(t),d.default.removeField.call(this,t),this._childChanged(u.prototype.removeField)},u.prototype.removeFieldAt=function(t){this._checkFormatIsWritable(),this._nextVersion();var e=this._getFormat(true).at(t);if(e)this._fieldsCache.delete(e.getName()),this._fieldsClone.delete(e.getName());d.default.removeFieldAt.call(this,t),this._childChanged(u.prototype.removeFieldAt)},u.prototype._hasFormat=function(){var t=this.getOwner();if(t)return t._hasFormat();else return d.default._hasFormat.call(this)},u.prototype._getFormat=function(t){var e=this.getOwner();if(e)return e._getFormat(t);else return d.default._getFormat.call(this,t)},u.prototype._getFieldFormat=function(t,e){var r=this.getOwner();if(r)return r._getFieldFormat(t,e);else return d.default._getFieldFormat.call(this,t,e)},u.prototype._createRawDataAdapter=function(){return this._getAdapter().forRecord(this._getRawData(true))},u.prototype._checkFormatIsWritable=function(){var t;if(this.getOwner())throw new Error("Record format has read only access if record belongs to recordset. You should change recordset format instead.")},u.prototype.isChanged=function(t){return t?this._hasChangedField(t):this.getChanged().length>0},u.prototype.getOwner=function(){return this._$owner},u.prototype.detach=function(){this._$owner=null,this.setState(M.DETACHED)},u.prototype.getState=function(){return this._$state},u.prototype.setState=function(t){this._$state=t},u.prototype.getChanged=function(){return Object.keys(this._changedFields)},u.prototype.acceptChanges=function(t,e){var r=this;if(void 0===e&&"boolean"===typeof t)e=t,t=void 0;if(void 0===t)this._clearChangedFields();else{if(!(t instanceof Array))throw new TypeError('Argument "fields" should be an instance of Array');t.forEach(function(t){r._unsetChangedField(t)})}if(0===this.getChanged().length)switch(this._$state){case M.ADDED:case M.CHANGED:this._$state=M.UNCHANGED;break;case M.DELETED:this._$state=M.DETACHED}if(this._acceptedState=this._$state,e)this._childChanged(u.prototype.acceptChanges)},u.prototype.rejectChanges=function(t,e){var r=this;if(void 0===e&&"boolean"===typeof t)e=t,t=void 0;var i={};if(void 0===t)t=this.getChanged();else if(!(t instanceof Array))throw new TypeError('Argument "fields" should be an instance of Array');for(var n in t.forEach(function(t){if(r._hasChangedField(t))i[t]=r._getChangedFieldValue(t)}),this.set(i),i)if(i.hasOwnProperty(n))this._unsetChangedField(n);if(0===this.getChanged().length)this._$state=this._acceptedState;if(e)this._childChanged(u.prototype.rejectChanges)},u.prototype.toString=function(){var r={};return this.each(function(t,e){r[t]=e}),JSON.stringify(r)},u.prototype._getRelationNameForField=function(t){return P+t},u.prototype._getFieldFromRelationName=function(t){if((t+="").substr(0,P.length)===P)return t.substr(P.length)},u.prototype._checkErrors=function(t){if(t.length){for(var e=t[0],r=t.length;r>0;r--)if(e>t[r])e=t[r];throw e}},u.prototype._getHashMap=function(t,e){var r=t;if(!(r instanceof Object))(r={})[t]=e;return r},u.prototype._clearFieldsCache=function(){this[T]=null,this[D]=null},u.prototype._isFieldValueCacheable=function(t){switch(this._$cacheMode){case C:return t instanceof Object;case I:return true}return false},u.prototype._haveToClone=function(t){return this._$cloneChanged&&t&&t["[Types/_entity/ICloneable]"]},u.prototype._getRawDataValue=function(t){var e=this._getRawDataAdapter();if(!e.has(t))return;var r=e.get(t),i=this._getFieldFormat(t,e);return p.default.cast(r,this._getFieldType(i),{format:i,adapter:this._getAdapter()})},u.prototype._setRawDataValue=function(t,e,r){if(!r&&e&&e["[Types/_entity/FormattableMixin]"])this._checkAdapterCompatibility(e.getAdapter());var i=this._getRawDataAdapter();return e=p.default.serialize(e,{format:this._getFieldFormat(t,i),adapter:this.getAdapter()}),i.set(t,e),e},u.prototype._notifyChange=function(t){t=t||{},this._childChanged(t),this._nextVersion(),this._notify("onPropertyChange",t)},u.prototype._clearChangedFields=function(){this[O]={}},u.prototype._hasChangedField=function(t){return this._changedFields.hasOwnProperty(t)},u.prototype._getChangedFieldValue=function(t){return this._changedFields[t]},u.prototype._setChangedField=function(t,e,r){if(!this[O].hasOwnProperty(t))this[O][t]=[e,Boolean(r)];switch(this._$state){case M.UNCHANGED:this._$state=M.CHANGED}},u.prototype._unsetChangedField=function(t){delete this[O][t]},Object.defineProperty(u,"RecordState",{get:function(){return M},enumerable:true,configurable:true}),Object.defineProperty(u,"CACHE_MODE_OBJECTS",{get:function(){return C},enumerable:true,configurable:true}),Object.defineProperty(u,"CACHE_MODE_ALL",{get:function(){return I},enumerable:true,configurable:true}),u.addFieldTo=function(t,e,r,i){if(!i){if(!((i=w(r))instanceof Object))i={type:i};i.name=e}t.addField(i,void 0,r)},u.fromObject=function(t,e){if(null===t)return t;if(t&&t instanceof u)return t;var r=new u({adapter:e||"Types/entity:adapter.Json",format:[]}),i=[];for(var n in t)if(t.hasOwnProperty(n))i.push(n);for(var a=0,o=(i=i.sort()).length;a<o;a++){var n,s=t[n=i[a]];if(void 0===s)continue;u.addFieldTo(r,n,s)}return r},u.filter=function(i,n){var a=new u({adapter:i.getAdapter()}),t;return i.getFormat().each(function(t){var e=t.getName(),r=i.get(e);if(!n||n(e,r))a.addField(t),a.set(e,r)}),a.acceptChanges(),a},u.filterFields=function(t,e){if(!(e instanceof Array))throw new TypeError('Argument "fields" should be an instance of Array');return u.filter(t,function(t){return e.indexOf(t)>-1})},u.extend=function(t,e){return v.logger.info("Types/entity:Record","Method extend is deprecated, use ES6 extends or Core/core-extend"),m(this,t,e)},u}(y.mixin(n.default,a.default,o.default,s.default,u.default,l.default,f.default,d.default,c.default));(e.default=E).prototype["[Types/_entity/Record]"]=true,E.prototype["[Types/_collection/IEnumerable]"]=true,E.prototype["[Types/_entity/ICloneable]"]=true,E.prototype["[Types/_entity/IEquatable]"]=true,E.prototype["[Types/_entity/IObject]"]=true,E.prototype["[Types/_entity/IObservableObject]"]=true,E.prototype["[Types/_entity/IProducible]"]=true,E.prototype["[Types/_entity/IVersionable]"]=true,E.prototype["[Types/_entity/relation/IReceiver]"]=true,E.prototype._moduleName="Types/entity:Record",E.prototype[O]=null,E.prototype._$state=M.DETACHED,E.prototype._$cacheMode=C,E.prototype._$cloneChanged=false,E.prototype._$owner=null,E.prototype._acceptedState=void 0,E.prototype["[WS.Data/Entity/Record]"]=true,E.prototype["[WS.Data/Collection/IEnumerable]"]=true,E.prototype["[WS.Data/Entity/ICloneable]"]=true,h.register("Types/entity:Record",E,{instantiate:false})}(j,t,u,p,_,y,H,U,Q,ht,mt,le,W,qt,c,p,s,p,o);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}(),ce=de;t["Types/_entity/Model"]=true;var pe,he=function(){"use strict";var t={},e=function(t,e,r,f,i,d,n,a,c,o){Object.defineProperty(e,"__esModule",{value:true});var s=".",u=function(l){function i(t){var e=l.call(this,t)||this;if(e._propertiesInjected=t&&"properties"in t,e._options){if(e._options.properties){var r={};Object.assign(r,e._$properties),Object.assign(r,e._options.properties),e._$properties=r}if(e._options.idProperty)e._$idProperty=e._options.idProperty}if(!e._$idProperty)e._$idProperty=e._getAdapter().getKeyField(e._getRawData())||"";return e}return r.__extends(i,l),i.prototype.destroy=function(){this._defaultPropertiesValues=null,this._propertiesDependency=null,this._nowCalculatingProperties=null,l.prototype.destroy.call(this)},i.prototype.get=function(t){if(this._pushDependency(t),this._fieldsCache.has(t))return this._fieldsCache.get(t);var e=this._$properties&&this._$properties[t],r=l.prototype.get.call(this,t);if(!e)return r;var i=r;if("def"in e&&!this._getRawDataAdapter().has(t))i=this.getDefault(t);if(!e.get)return i;var n=this._processCalculatedValue(t,i,e,true);if(n!==r)this._removeChild(r),this._addChild(n,this._getRelationNameForField(t));if(this._isFieldValueCacheable(n))this._fieldsCache.set(t,n);else if(this._fieldsCache.has(t))this._fieldsCache.delete(t);return n},i.prototype.set=function(t,e){var i=this;if(!this._$properties)return void l.prototype.set.call(this,t,e);var n=this._getHashMap(t,e),a=[],o=[];Object.keys(n).forEach(function(t){i._deleteDependencyCache(t);var e=n[t];try{var r=i._$properties&&i._$properties[t];if(r)if(r.set){if(i._fieldsCache.has(t))i._removeChild(i._fieldsCache.get(t)),i._fieldsCache.delete(t);if(void 0===(e=i._processCalculatedValue(t,e,r,false)))return}else if(r.get)return void o.push(new ReferenceError('Property "'+t+'" is read only'));a.push([t,e,f.default.prototype.get.call(i,t)])}catch(t){o.push(t)}});var r=[],s=l.prototype._setPairs.call(this,a,r);if(s){var u=Object.keys(s).reduce(function(t,e){return t[e]=n[e],t},{});this._notifyChange(u)}this._checkErrors(o),this._checkErrors(r)},i.prototype.has=function(t){return this._$properties&&this._$properties.hasOwnProperty(t)||l.prototype.has.call(this,t)},i.prototype.getEnumerator=function(){var t;return new(n.resolve("Types/collection:enumerator.Arraywise"))(this._getAllProperties())},i.prototype.each=function(t,e){return l.prototype.each.call(this,t,e)},i.prototype.relationChanged=function(i,t){var n=this,a=[],o=t.length-1;return t.forEach(function(t,e){var r=n._getFieldFromRelationName(t);if(a.push(r),r)if(n._deleteDependencyCache(a.join(s)),e===o&&i.data instanceof Object)Object.keys(i.data).forEach(function(t){n._deleteDependencyCache(a.concat([t]).join(s))})}),l.prototype.relationChanged.call(this,i,t)},i.prototype._getSerializableState=function(t){if(t=l.prototype._getSerializableState.call(this,t),!this._propertiesInjected)delete t.$options.properties;if(t._instanceId=this.getInstanceId(),t._isDeleted=this._isDeleted,this._defaultPropertiesValues)t._defaultPropertiesValues=this._defaultPropertiesValues;return t},i.prototype._setSerializableState=function(t){var e=l.prototype._setSerializableState.call(this,t);return function(){if(e.call(this),this._instanceId=t._instanceId,this._isDeleted=t._isDeleted,t._defaultPropertiesValues)this._defaultPropertiesValues=t._defaultPropertiesValues}},i.prototype.rejectChanges=function(t,e){if(l.prototype.rejectChanges.call(this,t,e),!(t instanceof Array))this._isChanged=false},i.prototype.acceptChanges=function(t,e){if(l.prototype.acceptChanges.call(this,t,e),!(t instanceof Array))this._isChanged=false},i.prototype.isChanged=function(t){if(!t&&this._isChanged)return true;return l.prototype.isChanged.call(this,t)},i.prototype.getProperties=function(){return this._$properties},i.prototype.getDefault=function(t){var e=this._defaultPropertiesValues;if(!e)e=this._defaultPropertiesValues={};if(!e.hasOwnProperty(t)){var r=this._$properties[t];if(r&&"def"in r)e[t]=[r.def instanceof Function?r.def.call(this):r.def];else e[t]=[]}return e[t][0]},i.prototype.merge=function(t){try{var r={};t.each(function(t,e){r[t]=e}),this.set(r)}catch(t){if(t instanceof ReferenceError)a.logger.info(this._moduleName+"::merge(): "+t.toString());else throw t}},i.prototype.getId=function(){var t=this.getIdProperty();if(!t)return void a.logger.info(this._moduleName+"::getId(): idProperty is not defined");return this.get(t)},i.prototype.getIdProperty=function(){return this._$idProperty},i.prototype.setIdProperty=function(t){if(t&&!this.has(t))return void a.logger.info(this._moduleName+'::setIdProperty(): property "'+t+'" is not defined');this._$idProperty=t},i.prototype._getAllProperties=function(){var t=this._getRawDataFields();if(!this._$properties)return t;var e=this._$properties,r;return Object.keys(e).concat(t.filter(function(t){return!e.hasOwnProperty(t)}))},i.prototype._processCalculatedValue=function(e,t,r,i){var n=this,a=this._nowCalculatingProperties;if(!a)a=this._nowCalculatingProperties=new c.Set;var o=e+"|"+i;if(a.has(o))throw new Error("Recursive value "+(i?"reading":"writing")+' detected for property "'+e+'"');var s=i?r.get:r.set,u=i&&d.Compute.isFunctor(s),l=i&&!u,f;if(i)f=this._propertiesDependencyGathering,this._propertiesDependencyGathering=l?e:"";if(u)s.properties.forEach(function(t){n._pushDependencyFor(t,e)});try{a.add(o),t=s.call(this,t)}finally{if(i)this._propertiesDependencyGathering=f;a.delete(o)}return t},i.prototype._pushDependency=function(t){if(this._propertiesDependencyGathering&&this._propertiesDependencyGathering!==t)this._pushDependencyFor(t,this._propertiesDependencyGathering)},i.prototype._pushDependencyFor=function(t,e){var r=this._propertiesDependency,i;if(!r)r=this._propertiesDependency=new c.Map;if(r.has(t))i=r.get(t);else i=new c.Set,r.set(t,i);if(!i.has(e))i.add(e)},i.prototype._deleteDependencyCache=function(t){var e=this,r=this._propertiesDependency;if(r&&r.has(t))r.get(t).forEach(function(t){e._removeChild(e._fieldsCache.get(t)),e._fieldsCache.delete(t),e._fieldsClone.delete(t),e._deleteDependencyCache(t)})},i.fromObject=function(t,e){var r=f.default.fromObject(t,e);if(!r)return r;return new i({rawData:r.getRawData(true),adapter:r.getAdapter(),format:r._getFormat(true)})},i.extend=function(t,e){return o(this,t,e)},i}(a.mixin(f.default,i.default));(e.default=u).prototype["[Types/_entity/Model]"]=true,u.prototype["[Types/_entity/IInstantiable]"]=true,u.prototype._moduleName="Types/entity:Model",u.prototype._instancePrefix="model-",u.prototype._$properties=null,u.prototype._$idProperty="",u.prototype._isDeleted=false,u.prototype._defaultPropertiesValues=null,u.prototype._propertiesDependency=null,u.prototype._propertiesDependencyGathering="",u.prototype._nowCalculatingProperties=null,u.prototype["[WS.Data/Entity/Model]"]=true,u.produceInstance=f.default.produceInstance,n.register("Types/entity:Model",u,{instantiate:false}),n.register("entity.model",u)}(j,t,u,de,M,dt,c,p,s,o);if(e instanceof Function)return e;else for(var r in e)if(e.hasOwnProperty(r))t[r]=e[r];return t}();return t.adapter=ue,t.CloneableMixin=J.default,t.descriptor=z.default,t.DestroyableMixin=r.default,t.factory=Kt.default,t.format=Ut,t.FormattableMixin=fe.default,t.functor=ct,t.Identity=m.default,t.ICloneable=F.default,t.IEquatable=T.default,t.IInstantiable=O.default,t.InstantiableMixin=P.default,t.IObject=I.default,t.IObservableObject=S.default,t.IProducible=N.default,t.IVersionable=$.default,t.ManyToManyMixin=yt.default,t.Model=he.default,t.OptionsToPropertyMixin=e.default,t.ObservableMixin=B.default,t.ReadWriteMixin=gt.default,t.Record=ce.default,t.relation=vt,t.SerializableMixin=G.default,t.VersionableMixin=q.default,t.TimeInterval=Z.default,t.Guid=X.default,t});