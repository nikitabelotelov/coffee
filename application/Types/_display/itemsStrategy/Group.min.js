define("Types/_display/itemsStrategy/Group",["require","exports","tslib","Types/_display/GroupItem","Types/entity","Types/util"],function(t,e,i,_,o,r){"use strict";Object.defineProperty(e,"__esModule",{value:true});var n=function(r){function t(t){var e=r.call(this)||this;return e._groups=[],e["[Types/_display/IItemsStrategy]"]=true,e._options=t,e}return i.__extends(t,r),Object.defineProperty(t.prototype,"handler",{set:function(t){this._options.handler=t},enumerable:true,configurable:true}),Object.defineProperty(t.prototype,"options",{get:function(){return this.source.options},enumerable:true,configurable:true}),Object.defineProperty(t.prototype,"source",{get:function(){return this._options.source},enumerable:true,configurable:true}),Object.defineProperty(t.prototype,"count",{get:function(){return this._getItemsOrder().length},enumerable:true,configurable:true}),Object.defineProperty(t.prototype,"items",{get:function(){var t=this._getItemsOrder(),e=this._getItems();return t.map(function(t){return e[t]})},enumerable:true,configurable:true}),t.prototype.at=function(t){var e,r=this._getItemsOrder()[t];if(void 0===r)throw new ReferenceError("Index "+t+" is out of bounds.");return this._getItems()[r]},t.prototype.splice=function(t,e,r){return this._itemsOrder=null,this.source.splice(t,e,r)},t.prototype.reset=function(){return this._groups=[],this._itemsOrder=null,this.source.reset()},t.prototype.invalidate=function(){return this._itemsOrder=null,this.source.invalidate()},t.prototype.getDisplayIndex=function(t){var e=this._getItemsOrder(),r,i=this.source.getDisplayIndex(t)+this._groups.length,o=e.indexOf(i);return-1===o?e.length:o},t.prototype.getCollectionIndex=function(t){var e,r,i=this._getItemsOrder()[t]-this._groups.length;return i=i>=0?this.source.getCollectionIndex(i):-1},t.prototype._getSerializableState=function(t){if((t=o.SerializableMixin.prototype._getSerializableState.call(this,t)).$options=this._options,t._groups=this._groups,t._itemsOrder=this._itemsOrder,!t._itemsOrder&&this._options.handler)t._itemsOrder=this._getItemsOrder();return t},t.prototype._setSerializableState=function(t){var e=o.SerializableMixin.prototype._setSerializableState(t);return function(){this._groups=t._groups,this._itemsOrder=t._itemsOrder,e.call(this)}},t.prototype._getItems=function(){return this._groups.concat(this.source.items)},t.prototype._getItemsOrder=function(){if(!this._itemsOrder)this._itemsOrder=this._createItemsOrder();return this._itemsOrder},t.prototype._createItemsOrder=function(){return t.sortItems(this.source.items,{display:this.options.display,handler:this._options.handler,groups:this._groups})},t.prototype._getActiveGroupsCount=function(t){return t.length-this.source.items.length},t.sortItems=function(t,e){var r=e.groups,i=e.display,o=e.handler,n;if(!o)return r.length=0,t.map(function(t,e){return e});n=r.map(function(t){return t.getContents()});for(var s=[],u=[],p=0;p<t.length;p++){var l=t[p],a=o?o(l.getContents(),p,l):void 0,h=n.indexOf(a);if(-1===n.indexOf(a)){var c=new _.default({owner:i,contents:a});h=r.length,r.push(c),n.push(a)}if(-1===s.indexOf(h))s.push(h);if(!u[h])u[h]=[];u[h].push(p)}var d=[],f=r.length;return s.forEach(function(t){d.push(t),u[t].forEach(function(t){d.push(t+f)})}),d},t}(r.mixin(o.DestroyableMixin,o.SerializableMixin));(e.default=n).prototype._moduleName="Types/display:itemsStrategy.Group",n.prototype["[Types/_display/itemsStrategy/Group]"]=true,n.prototype._groups=null,n.prototype._itemsOrder=null});