define("Types/_display/itemsStrategy/Group",["require","exports","tslib","Types/_display/GroupItem","Types/entity","Types/util"],function(e,t,i,g,n,r){"use strict";Object.defineProperty(t,"__esModule",{value:true});var s=function(r){function e(e){var t=r.call(this)||this;return t._groups=[],t["[Types/_display/IItemsStrategy]"]=true,t._options=e,t}return i.__extends(e,r),Object.defineProperty(e.prototype,"handler",{set:function(e){this._options.handler=e},enumerable:true,configurable:true}),Object.defineProperty(e.prototype,"options",{get:function(){return this.source.options},enumerable:true,configurable:true}),Object.defineProperty(e.prototype,"source",{get:function(){return this._options.source},enumerable:true,configurable:true}),Object.defineProperty(e.prototype,"count",{get:function(){return this._getItemsOrder().length},enumerable:true,configurable:true}),Object.defineProperty(e.prototype,"items",{get:function(){var e=this._getItemsOrder(),t=this._getItems();return e.map(function(e){return t[e]})},enumerable:true,configurable:true}),e.prototype.at=function(e){var t,r=this._getItemsOrder()[e];if(void 0===r)throw new ReferenceError("Index "+e+" is out of bounds.");return this._getItems()[r]},e.prototype.splice=function(e,t,r){return this._itemsOrder=null,this.source.splice(e,t,r)},e.prototype.reset=function(){return this._groups=[],this._itemsOrder=null,this.source.reset()},e.prototype.invalidate=function(){return this._itemsOrder=null,this.source.invalidate()},e.prototype.getDisplayIndex=function(e){var t=this._getItemsOrder(),r,i=this.source.getDisplayIndex(e)+this._groups.length,n=t.indexOf(i);return-1===n?t.length:n},e.prototype.getCollectionIndex=function(e){var t,r,i=this._getItemsOrder()[e]-this._groups.length;return i=i>=0?this.source.getCollectionIndex(i):-1},e.prototype._getSerializableState=function(e){if((e=n.SerializableMixin.prototype._getSerializableState.call(this,e)).$options=this._options,e._groups=this._groups,e._itemsOrder=this._itemsOrder,!e._itemsOrder&&this._options.handler)e._itemsOrder=this._getItemsOrder();return e},e.prototype._setSerializableState=function(e){var t=n.SerializableMixin.prototype._setSerializableState(e);return function(){this._groups=e._groups,this._itemsOrder=e._itemsOrder,t.call(this)}},e.prototype._getItems=function(){return this._groups.concat(this.source.items)},e.prototype._getItemsOrder=function(){if(!this._itemsOrder)this._itemsOrder=this._createItemsOrder();return this._itemsOrder},e.prototype._createItemsOrder=function(){return e.sortItems(this.source.items,{display:this.options.display,handler:this._options.handler,groups:this._groups})},e.prototype._getActiveGroupsCount=function(e){return e.length-this.source.items.length},e.sortItems=function(e,t){var r=t.groups,i=t.display,n=t.handler,s;if(!n)return r.length=0,e.map(function(e,t){return t});s=r.map(function(e){return e.getContents()});for(var o=[],u=[],p=0;p<e.length;p++){var a=e[p],l=n?n(a.getContents(),p,a):void 0,c=s.indexOf(l);if(-1===s.indexOf(l)){var h=new g.default({owner:i,contents:l});c=r.length,r.push(h),s.push(l)}if(-1===o.indexOf(c))o.push(c);if(!u[c])u[c]=[];u[c].push(p)}var d=[],f=r.length;return o.forEach(function(e){d.push(e),u[e].forEach(function(e){d.push(e+f)})}),d},e}(r.mixin(n.DestroyableMixin,n.SerializableMixin));t.default=s,Object.assign(s.prototype,{"[Types/_display/itemsStrategy/Group]":true,_moduleName:"Types/display:itemsStrategy.Group",_groups:null,_itemsOrder:null})});