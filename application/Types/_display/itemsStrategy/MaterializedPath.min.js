define("Types/_display/itemsStrategy/MaterializedPath",["require","exports","tslib","Types/_display/itemsStrategy/AbstractStrategy","Types/util"],function(t,e,i,r,g){"use strict";Object.defineProperty(e,"__esModule",{value:true});var o=function(r){function o(t){var e=r.call(this,t)||this;return e._indexToPath=[],e}return i.__extends(o,r),o.prototype.getSorters=function(){var t=this,e=[];return e.push({name:"tree",enabled:true,method:o.sortItems,options:function(){return{indexToPath:t._indexToPath}}}),e},Object.defineProperty(o.prototype,"count",{get:function(){var t=0;while(void 0!==this.at(t))t++;return t},enumerable:true,configurable:true}),Object.defineProperty(o.prototype,"items",{get:function(){var t=0;while(void 0!==this.at(t))t++;return this._getItems()},enumerable:true,configurable:true}),o.prototype.at=function(t){var e=this._getItems();if(!e[t]){var r=this._getCollection(),o=this._getPathTo(r,t),i=void 0;if(o)i=this._getItemByPath(r,o);if(i)e[t]=this.options.display.createItem({contents:i,parent:this._getParent(t,o)})}return e[t]},o.prototype.splice=function(t){return this._getItems().length=t,this._indexToPath.length=t,[]},o.prototype._getPathTo=function(t,e){if(this._indexToPath[e])return this._indexToPath[e];var f=this._options.childrenProperty,h,r,y=function(t,e,r){for(var o=e instanceof Array,i=e["[Types/_collection/IList]"],n=e["[Types/_collection/IEnumerable]"],a,s,u,l,c,p=0;;){if(o){if(!(s=e.length<=p))u=e[p]}else if(i){if(!(s=e.getCount()<=p))u=e.at(p)}else if(n){if(!a)a=e.getEnumerator();s=void 0===(u=a.moveNext()?a.getCurrent():void 0)}else throw new TypeError("Unsupported object type: only Array, Types/_collection/IList or Types/_collection/IEnumerable are supported.");if(s)break;if(t===h)return r.concat(p);if(h++,(l=g.object.getPropertyValue(u,f))instanceof Object)if(c=y(t,l,r.concat(p)))return c;p++}};if(h=0,r=y(e,t,[]))this._indexToPath[e]=r;return r},o.prototype._getItemByPath=function(t,e){for(var r=this._options.childrenProperty,o=t,i=0;i<e.length;)if(o=this._getItemAt(t,e[i]),++i<e.length)t=g.object.getPropertyValue(o,r);return o},o.prototype._getParent=function(t,e){var r=e.slice(0,e.length-1);if(r.length){var o=this._getItems(),i=this._getItemByPath(this._getCollection(),r);if(i)for(var n=t-1;n>=0;n--)if(o[n]&&o[n].getContents()===i)return o[n]}else return"function"===typeof this._options.root?this._options.root():this._options.root},o.prototype._getItemAt=function(t,e){var r=t instanceof Array,o=t["[Types/_collection/IEnumerable]"],i=t["[Types/_collection/IEnumerable]"],n;if(r)n=t[e];else if(o)n=t.at(e);else if(i){var a=t.getEnumerator(),s=void 0,u=0;while(a.moveNext()){if(s=a.getCurrent(),u===e){n=s;break}u++}}else throw new TypeError("Unsupported object type: only Array, Types/_collection/IList or Types/_collection/IEnumerable are supported.");if(void 0===n)throw new ReferenceError("Item at "+e+" is out of range.");return n},o.sortItems=function(t,i,e){var l=e.indexToPath,r,o={},n=function(t){return t.join(".")},a=function(t){return o[n(t)]},c=function(t,e){var r=a(t),o=a(e);return i.indexOf(r)-i.indexOf(o)};return(r=l.map(n)).forEach(function(t,e){o[t]=e}),i.slice().sort(function(t,e){for(var r=l[t],o=l[e],i=r.length,n=o.length,a=Math.min(i,n),s=0,u=0;u<a;u++){if(r[u]===o[u])continue;if(0!==(s=c(r.slice(0,1+u),o.slice(0,1+u))))break}if(0===s&&i!==n)s=i-n;return s})},o}(r.default);(e.default=o).prototype._moduleName="Types/display:itemsStrategy.MaterializedPath",o.prototype["[Types/_display/itemsStrategy/MaterializedPath]"]=true});