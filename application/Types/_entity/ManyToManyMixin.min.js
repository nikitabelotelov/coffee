define("Types/_entity/ManyToManyMixin",["require","exports","Types/_entity/relation/ManyToMany"],function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:true});var a={"[Types/_entity/ManyToManyMixin]":true,"[WS.Data/Entity/ManyToManyMixin]":true,_mediator:null,destroy:function(){var t=this._getMediator(),e=[],i;t.hasMany(this,function(t){e.push(t)}),t.clear(this);for(var a=0,n=e.length;a<n;a++)if((i=e[a]).destroy&&!i.destroyed)i.destroy();this._setMediator(null)},_addChild:function(t,e){if(t instanceof Object){var i=this._getMediator();if(i.addRelationship(this,t,e),t["[Types/_entity/ManyToManyMixin]"]&&!t._hasSameMediator(i)){if(!t._hasMediator())t._setMediator(this._createMediator());t._getMediator().addRelationship(this,t,e)}}},_removeChild:function(t){if(t instanceof Object){var e=this._getMediator();if(e.removeRelationship(this,t),t["[Types/_entity/ManyToManyMixin]"]&&t._hasMediator()&&!t._hasSameMediator(e))t._getMediator().removeRelationship(this,t)}},_parentChanged:function(t){var i={target:this,data:t,original:t};this._getMediator().hasMany(this,function(t,e){if(t["[Types/_entity/relation/IReceiver]"])t.relationChanged(i,[e])})},_childChanged:function(s){var d=s,h=function(t,r,o){t.belongsTo(r,function(t,e){var i=o.slice(),a={target:r,data:s,original:d},n;if(i.unshift(e),t["[Types/_entity/relation/IReceiver]"])if(void 0!==(n=t.relationChanged(a,i)))s=n.data;h(t._getMediator(),t,i)})};h(this._getMediator(),this,[])},_hasMediator:function(){return!!this._mediator},_hasSameMediator:function(t){return this._mediator===t},_createMediator:function(){return new i.default},_getMediator:function(){return this._mediator||(this._mediator=this._createMediator())},_setMediator:function(t){this._mediator=t}};e.default=a});