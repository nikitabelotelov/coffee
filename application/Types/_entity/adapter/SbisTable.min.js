define("Types/_entity/adapter/SbisTable",["require","exports","tslib","Types/_entity/DestroyableMixin","Types/_entity/adapter/SbisFormatMixin","Types/_entity/adapter/SbisRecord","Types/_entity/format","Types/util","Core/core-merge"],function(t,e,i,a,o,s,r,n,p){"use strict";Object.defineProperty(e,"__esModule",{value:true});var c=function(a){function e(t){var e=a.call(this,t)||this;return o.default.constructor.call(e,t),e}return i.__extends(e,a),e.prototype.getCount=function(){return this._isValidData()?this._data.d.length:0},e.prototype.add=function(t,e){if(this._touchData(),t=this._normalizeData(t,s.default.prototype._type),0===this._data.d.length&&t.s)this._data.s=t.s;if(this._checkFormat(t,"::add()"),t.s=this._data.s,void 0===e)this._data.d.push(t.d);else this._checkRowIndex(e,true),this._data.d.splice(e,0,t.d)},e.prototype.at=function(t){return this._isValidData()&&this._data.d[t]?{d:this._data.d[t],s:this._data.s}:void 0},e.prototype.remove=function(t){this._touchData(),this._checkRowIndex(t),this._data.d.splice(t,1)},e.prototype.replace=function(t,e){if(this._touchData(),this._checkRowIndex(e),!this._data.s.length&&t.s.length)this._data.s=t.s;t.s=this._data.s,this._checkFormat(t,"::replace()"),this._data.d[e]=t.d},e.prototype.move=function(t,e){if(this._touchData(),e===t)return;var a=this._data.d.splice(t,1);-1===e?this._data.d.unshift(a.shift()):this._data.d.splice(e,0,a.shift())},e.prototype.merge=function(t,e){this._touchData(),this._checkRowIndex(t),this._checkRowIndex(e),p(this._data.d[t],this._data.d[e]),this.remove(e)},e.prototype.copy=function(t){this._touchData(),this._checkRowIndex(t);var e=this._data.d[t],a=[];return p(a,e,{clone:true}),this._data.d.splice(1+t,0,a),a},e.prototype.getMetaDataDescriptor=function(){var e=[],t=this.getData();if(!(t instanceof Object))return e;if(t.hasOwnProperty("r"))e.push(r.fieldsFactory({name:"results",type:"record"}));if(t.hasOwnProperty("p"))e.push(r.fieldsFactory({name:"path",type:"recordset"}));if(t.hasOwnProperty("n")){var a="integer";switch(typeof t.n){case"boolean":a="boolean";break;case"object":if(t.n)a="object"}e.push(r.fieldsFactory({name:"total",type:a})),e.push(r.fieldsFactory({name:"more",type:a}))}if(t.hasOwnProperty("m")){var i=new s.default(t.m);i.getFields().forEach(function(t){e.push(i.getFormat(t))})}return e},e.prototype.getMetaData=function(t){var e=this._getMetaDataAlias(t),a=this.getData(),i;if(e)return a&&a instanceof Object?a[e]:void 0;return new s.default(a.m).get(t)},e.prototype.setMetaData=function(t,e){var a=this._getMetaDataAlias(t),i=this.getData(),o;if(a){if(i&&i instanceof Object)i[a]=e;return}new s.default(i.m).set(t,e)},e.prototype._getMetaDataAlias=function(t){switch(t){case"results":return"r";case"path":return"p";case"more":case"total":return"n"}},e.prototype.clone=function(t){return new e(t?this.getData():this._cloneData())},e.prototype._buildD=function(e,a){this._data.d.forEach(function(t){t.splice(e,0,a)})},e.prototype._removeD=function(e){this._data.d.forEach(function(t){t.splice(e,1)})},e.prototype._checkRowIndex=function(t,e){var a=this._data.d.length+(e?0:-1);if(!(t>=0&&t<=a))throw new RangeError(this._moduleName+": row index "+t+" is out of bounds.")},e}(n.mixin(a.default,o.default));(e.default=c).prototype["[Types/_entity/adapter/SbisTable]"]=true,c.prototype["[Types/_entity/adapter/ITable]"]=true,c.prototype["[Types/_entity/adapter/IMetaData]"]=true,c.prototype["[Types/_entity/ICloneable]"]=true,c.prototype._type="recordset",c.prototype["[WS.Data/Entity/ICloneable]"]=true});