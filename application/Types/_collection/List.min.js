define("Types/_collection/List",["require","exports","tslib","Types/_collection/IObservable","Types/_collection/enumerator/Arraywise","Types/_collection/Indexer","Types/entity","Types/di","Types/util","Core/core-extend"],function(e,t,i,o,s,l,a,r,u,h){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n=function(n){function r(e){var t=this;if(e&&"items"in e&&!(e.items instanceof Array))throw new TypeError('Option "items" should be an instance of Array');t=n.call(this,e)||this,a.OptionsToPropertyMixin.call(t,e),a.SerializableMixin.constructor.call(t),a.ReadWriteMixin.constructor.call(t,e),t._$items=t._$items||[];for(var i=0,r=t._$items.length;i<r;i++)t._addChild(t._$items[i]);return t}return i.__extends(r,n),r.prototype.destroy=function(){this._$items=null,this._indexer=null,a.ReadWriteMixin.destroy.call(this),n.prototype.destroy.call(this)},r.prototype.getEnumerator=function(){return new s.default(this._$items)},r.prototype.each=function(e,t){for(var i=0,r=this.getCount();i<r;i++)e.call(t||this,this.at(i),i,this)},r.prototype.assign=function(e){for(var t=0,i=this._$items.length;t<i;t++)this._removeChild(this._$items[t]);for(var t=this._$items.length=0,i=(e=this._splice(e||[],0,o.default.ACTION_RESET)).length;t<i;t++)this._addChild(e[t]);this._childChanged(e)},r.prototype.append=function(e){for(var t=0,i=(e=this._splice(e,this.getCount(),o.default.ACTION_ADD)).length;t<i;t++)this._addChild(e[t]);this._childChanged(e)},r.prototype.prepend=function(e){for(var t=0,i=(e=this._splice(e,0,o.default.ACTION_ADD)).length;t<i;t++)this._addChild(e[t]);this._childChanged(e)},r.prototype.clear=function(){this._$items.length=0,this._reindex(),this._getMediator().clear(this),this._childChanged(),this._nextVersion()},r.prototype.add=function(e,t){if(void 0===t)t=this._$items.length,this._$items.push(e);else{if(0!==(t=t||0)&&!this._isValidIndex(t,true))throw new Error("Index is out of bounds");this._$items.splice(t,0,e)}this._addChild(e),this._childChanged(e),this._nextVersion(),this._reindex(o.default.ACTION_ADD,t,1)},r.prototype.at=function(e){return this._$items[e]},r.prototype.remove=function(e){var t=this.getIndex(e);if(-1!==t)return this.removeAt(t),this._childChanged(e),true;return false},r.prototype.removeAt=function(e){if(!this._isValidIndex(e))throw new Error("Index is out of bounds");this._removeChild(this._$items[e]);var t=this._$items.splice(e,1);return this._reindex(o.default.ACTION_REMOVE,e,1),this._childChanged(e),this._nextVersion(),t[0]},r.prototype.replace=function(e,t){if(!this._isValidIndex(t))throw new Error("Index is out of bounds");var i=this._$items[t];if(i===e)return;this._removeChild(i),this._$items[t]=e,this._addChild(e),this._reindex(o.default.ACTION_REPLACE,t,1),this._childChanged(e),this._nextVersion()},r.prototype.move=function(e,t){if(!this._isValidIndex(e))throw new Error('Argument "from" is out of bounds');if(!this._isValidIndex(t))throw new Error('Argument "to" is out of bounds');if(e===t)return;var i=this._$items.splice(e,1);if(this._$items.splice(t,0,i[0]),e<t)this._reindex(o.default.ACTION_REPLACE,e,1+t-e);else this._reindex(o.default.ACTION_REPLACE,t,1+e-t);this._childChanged(i[0]),this._nextVersion()},r.prototype.getIndex=function(e){return this._$items.indexOf(e)},r.prototype.getCount=function(){return this._$items.length},r.prototype.getIndexByValue=function(e,t){return this._getIndexer().getIndexByValue(e,t)},r.prototype.getIndicesByValue=function(e,t){return this._getIndexer().getIndicesByValue(e,t)},r.prototype.isEqual=function(e){if(e===this)return true;if(!e||!(e instanceof r))return false;if(this.getCount()!==e.getCount())return false;for(var t=0,i=this.getCount();t<i;t++)if(this.at(t)!==e.at(t))return false;return true},r.prototype._getSerializableState=function(e){return a.SerializableMixin.prototype._getSerializableState.call(this,e)},r.prototype._setSerializableState=function(e){var t=a.SerializableMixin.prototype._setSerializableState(e);return function(){t.call(this),this._clearIndexer()}},r.prototype._getIndexer=function(){return this._indexer||(this._indexer=new l.default(this._$items,function(e){return e.length},function(e,t){return e[t]},function(e,t){return u.object.getPropertyValue(e,t)}))},r.prototype._clearIndexer=function(){this._indexer=null},r.prototype._isValidIndex=function(e,t){var i=this.getCount();if(t)i++;return e>=0&&e<i},r.prototype._reindex=function(e,t,i){if(!this._indexer)return;var r=this._getIndexer();switch(e){case o.default.ACTION_ADD:r.shiftIndex(t,this.getCount()-t,i),r.updateIndex(t,i);break;case o.default.ACTION_REMOVE:r.removeFromIndex(t,i),r.shiftIndex(t+i,this.getCount()-t,-i);break;case o.default.ACTION_REPLACE:r.removeFromIndex(t,i),r.updateIndex(t,i);break;case o.default.ACTION_RESET:r.resetIndex();break;default:if(i>0)r.removeFromIndex(t,i),r.updateIndex(t,i);else r.resetIndex()}},r.prototype._splice=function(e,t,i){var r;return e=this._itemsToArray(e),(r=this._$items).splice.apply(r,[t,0].concat(e)),this._reindex(i,t,e.length),this._nextVersion(),e},r.prototype._itemsToArray=function(e){if(e instanceof Array)return e;else if(e&&e["[Types/_collection/IEnumerable]"]){var t=[];return e.each(function(e){t.push(e)}),t}else throw new TypeError('Argument "items" must be an instance of Array or implement Types/collection:IEnumerable.')},r.extend=function(e,t){return u.logger.error("Types/source:Base","Method extend is deprecated, use ES6 extends or Core/core-extend"),h(this,e,t)},r}(u.mixin(a.DestroyableMixin,a.OptionsToPropertyMixin,a.ObservableMixin,a.SerializableMixin,a.CloneableMixin,a.ManyToManyMixin,a.ReadWriteMixin,a.VersionableMixin));(t.default=n).prototype._moduleName="Types/collection:List",n.prototype["[Types/_collection/List]"]=true,n.prototype["[Types/_collection/IEnumerable]"]=true,n.prototype["[Types/_collection/IIndexedCollection]"]=true,n.prototype["[Types/_collection/IList]"]=true,n.prototype["[Types/_entity/ICloneable]"]=true,n.prototype["[Types/_entity/IEquatable]"]=true,n.prototype["[Types/_entity/IVersionable]"]=true,n.prototype._$items=null,n.prototype._indexer=null,n.prototype.forEach=n.prototype.each,n.prototype["[WS.Data/Collection/List]"]=true,n.prototype["[WS.Data/Collection/IEnumerable]"]=true,n.prototype["[WS.Data/Collection/IList]"]=true,n.prototype["[WS.Data/Collection/IIndexedCollection]"]=true,n.prototype["[WS.Data/Entity/ICloneable]"]=true,r.register("Types/collection:List",n,{instantiate:false})});