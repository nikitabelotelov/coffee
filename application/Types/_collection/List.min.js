define("Types/_collection/List",["require","exports","tslib","Types/_collection/IObservable","Types/_collection/enumerator/Arraywise","Types/_collection/Indexer","Types/entity","Types/di","Types/util"],function(o,e,t,s,i,l,a,n,u){"use strict";Object.defineProperty(e,"__esModule",{value:true});var r=function(r){function n(e){var t=this;if(e&&"items"in e&&!(e.items instanceof Array))throw new TypeError('Option "items" should be an instance of Array');t=r.call(this,e)||this,a.OptionsToPropertyMixin.call(t,e),a.SerializableMixin.constructor.call(t),a.ReadWriteMixin.constructor.call(t,e),t._$items=t._$items||[];for(var i=0,n=t._$items.length;i<n;i++)t._addChild(t._$items[i]);return t}return t.__extends(n,r),n.extend=function(e,t){if(u.logger.info("Types/_collection/List","Method extend is deprecated, use ES6 extends or Core/core-extend"),!o.defined("Core/core-extend"))throw new ReferenceError('You should require module "Core/core-extend" to use old-fashioned "Types/_collection/List::extend()" method.');var i;return o("Core/core-extend")(this,e,t)},n.prototype.destroy=function(){this._$items=null,this._indexer=null,a.ReadWriteMixin.destroy.call(this),r.prototype.destroy.call(this)},n.prototype.getEnumerator=function(){return new i.default(this._$items)},n.prototype.each=function(e,t){for(var i=0,n=this.getCount();i<n;i++)e.call(t||this,this.at(i),i,this)},n.prototype.assign=function(e){for(var t=0,i=this._$items.length;t<i;t++)this._removeChild(this._$items[t]);for(var t=this._$items.length=0,i=(e=this._splice(e||[],0,s.default.ACTION_RESET)).length;t<i;t++)this._addChild(e[t]);this._childChanged(e)},n.prototype.append=function(e){for(var t=0,i=(e=this._splice(e,this.getCount(),s.default.ACTION_ADD)).length;t<i;t++)this._addChild(e[t]);this._childChanged(e)},n.prototype.prepend=function(e){for(var t=0,i=(e=this._splice(e,0,s.default.ACTION_ADD)).length;t<i;t++)this._addChild(e[t]);this._childChanged(e)},n.prototype.clear=function(){this._$items.length=0,this._reindex(),this._getMediator().clear(this),this._childChanged(),this._nextVersion()},n.prototype.add=function(e,t){if(void 0===t)t=this._$items.length,this._$items.push(e);else{if(0!==(t=t||0)&&!this._isValidIndex(t,true))throw new Error("Index is out of bounds");this._$items.splice(t,0,e)}this._addChild(e),this._childChanged(e),this._nextVersion(),this._reindex(s.default.ACTION_ADD,t,1)},n.prototype.at=function(e){return this._$items[e]},n.prototype.remove=function(e){var t=this.getIndex(e);if(-1!==t)return this.removeAt(t),this._childChanged(e),true;return false},n.prototype.removeAt=function(e){if(!this._isValidIndex(e))throw new Error("Index is out of bounds");this._removeChild(this._$items[e]);var t=this._$items.splice(e,1);return this._reindex(s.default.ACTION_REMOVE,e,1),this._childChanged(e),this._nextVersion(),t[0]},n.prototype.replace=function(e,t){if(!this._isValidIndex(t))throw new Error("Index is out of bounds");var i=this._$items[t];if(i===e)return;this._removeChild(i),this._$items[t]=e,this._addChild(e),this._reindex(s.default.ACTION_REPLACE,t,1),this._childChanged(e),this._nextVersion()},n.prototype.move=function(e,t){if(!this._isValidIndex(e))throw new Error('Argument "from" is out of bounds');if(!this._isValidIndex(t))throw new Error('Argument "to" is out of bounds');if(e===t)return;var i=this._$items.splice(e,1);if(this._$items.splice(t,0,i[0]),e<t)this._reindex(s.default.ACTION_REPLACE,e,1+t-e);else this._reindex(s.default.ACTION_REPLACE,t,1+e-t);this._childChanged(i[0]),this._nextVersion()},n.prototype.getIndex=function(e){return this._$items.indexOf(e)},n.prototype.getCount=function(){return this._$items.length},n.prototype.getIndexByValue=function(e,t){return this._getIndexer().getIndexByValue(e,t)},n.prototype.getIndicesByValue=function(e,t){return this._getIndexer().getIndicesByValue(e,t)},n.prototype.isEqual=function(e){if(e===this)return true;if(!e||!(e instanceof n))return false;if(this.getCount()!==e.getCount())return false;for(var t=0,i=this.getCount();t<i;t++)if(this.at(t)!==e.at(t))return false;return true},n.prototype._getSerializableState=function(e){return a.SerializableMixin.prototype._getSerializableState.call(this,e)},n.prototype._setSerializableState=function(e){var t=a.SerializableMixin.prototype._setSerializableState(e);return function(){t.call(this),this._clearIndexer()}},n.prototype._getIndexer=function(){return this._indexer||(this._indexer=new l.default(this._$items,function(e){return e.length},function(e,t){return e[t]},function(e,t){return u.object.getPropertyValue(e,t)}))},n.prototype._clearIndexer=function(){this._indexer=null},n.prototype._isValidIndex=function(e,t){var i=this.getCount();if(t)i++;return e>=0&&e<i},n.prototype._reindex=function(e,t,i){if(!this._indexer)return;var n=this._getIndexer();switch(e){case s.default.ACTION_ADD:n.shiftIndex(t,this.getCount()-t,i),n.updateIndex(t,i);break;case s.default.ACTION_REMOVE:n.removeFromIndex(t,i),n.shiftIndex(t+i,this.getCount()-t,-i);break;case s.default.ACTION_REPLACE:n.removeFromIndex(t,i),n.updateIndex(t,i);break;case s.default.ACTION_RESET:n.resetIndex();break;default:if(i>0)n.removeFromIndex(t,i),n.updateIndex(t,i);else n.resetIndex()}},n.prototype._splice=function(e,t,i){var n;return e=this._itemsToArray(e),(n=this._$items).splice.apply(n,[t,0].concat(e)),this._reindex(i,t,e.length),this._nextVersion(),e},n.prototype._itemsToArray=function(e){if(e instanceof Array)return e;else if(e&&e["[Types/_collection/IEnumerable]"]){var t=[];return e.each(function(e){t.push(e)}),t}else throw new TypeError('Argument "items" must be an instance of Array or implement Types/collection:IEnumerable.')},n}(u.mixin(a.DestroyableMixin,a.OptionsToPropertyMixin,a.ObservableMixin,a.SerializableMixin,a.CloneableMixin,a.ManyToManyMixin,a.ReadWriteMixin,a.VersionableMixin));e.default=r,Object.assign(r.prototype,{"[Types/_collection/List]":true,"[Types/_collection/IEnumerable]":true,"[Types/_collection/IIndexedCollection]":true,"[Types/_collection/IList]":true,"[Types/_entity/ICloneable]":true,"[Types/_entity/IEquatable]":true,"[Types/_entity/IVersionable]":true,_moduleName:"Types/collection:List",_$items:null,_indexer:null}),r.prototype.forEach=r.prototype.each,r.prototype["[WS.Data/Collection/List]"]=true,r.prototype["[WS.Data/Collection/IEnumerable]"]=true,r.prototype["[WS.Data/Collection/IList]"]=true,r.prototype["[WS.Data/Collection/IIndexedCollection]"]=true,r.prototype["[WS.Data/Entity/ICloneable]"]=true,n.register("Types/collection:List",r,{instantiate:false})});