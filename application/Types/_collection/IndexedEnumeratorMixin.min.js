define("Types/_collection/IndexedEnumeratorMixin",["require","exports","Types/util","Types/_collection/IObservable"],function(e,t,i,s){"use strict";Object.defineProperty(t,"__esModule",{value:true});var n={"[Types/_collection/IndexedEnumeratorMixin]":true,_enumeratorIndexes:null,constructor:function(){this._enumeratorIndexes={},this._onCollectionChange=this._onCollectionChange.bind(this)},reIndex:function(e,t,n){switch(e){case s.default.ACTION_ADD:this._shiftIndex(t,n),this._addToIndex(t,n);break;case s.default.ACTION_REMOVE:this._removeFromIndex(t,n),this._shiftIndex(t+n,-n);break;case s.default.ACTION_REPLACE:this._replaceInIndex(t,n);break;default:this._resetIndex()}},getIndexByValue:function(e,t){var n=this._getIndexForPropertyValue(e,t);return n.length?n[0]:-1},getIndicesByValue:function(e,t){return this._getIndexForPropertyValue(e,t)},setObservableCollection:function(e){e.subscribe("onCollectionChange",this._onCollectionChange)},unsetObservableCollection:function(e){e.unsubscribe("onCollectionChange",this._onCollectionChange)},_getIndexForPropertyValue:function(e,t){var n=this._getIndex(e);return n&&n[t]||[]},_hasIndex:function(e){if(e)return Object.prototype.hasOwnProperty.call(this._enumeratorIndexes,e);return 0===Object.keys(this._enumeratorIndexes).length},_getIndex:function(e){if(e&&!this._hasIndex(e))this._createIndex(e);return this._enumeratorIndexes[e]},_resetIndex:function(){this._enumeratorIndexes={}},_deleteIndex:function(e){delete this._enumeratorIndexes[e]},_createIndex:function(e){var t={},n=0;this._enumeratorIndexes[e]=t,this.reset();while(this.moveNext())this._setToIndex(t,e,this.getCurrent(),n),n++},_addToIndex:function(e,t){var n,r=e+t,o;for(var i in this._enumeratorIndexes)if(this._enumeratorIndexes.hasOwnProperty(i)){n=this._enumeratorIndexes[i],o=0,this.reset();while(this.moveNext()){if(o>=e)this._setToIndex(n,i,this.getCurrent(),o);if(++o>=r)break}}},_removeFromIndex:function(e,t){var n,r,o,i;for(var s in this._enumeratorIndexes)if(this._enumeratorIndexes.hasOwnProperty(s))for(r in n=this._enumeratorIndexes[s])if(n.hasOwnProperty(r)){o=n[r];for(var a=0;a<t;a++)if((i=o.indexOf(e+a))>-1)o.splice(i,1)}},_replaceInIndex:function(e,t){this._removeFromIndex(e,t),this._addToIndex(e,t)},_shiftIndex:function(e,t){var n,r;for(var o in this._enumeratorIndexes)if(this._enumeratorIndexes.hasOwnProperty(o))for(var i in n=this._enumeratorIndexes[o])if(n.hasOwnProperty(i)){r=n[i];for(var s=0;s<r.length;s++)if(r[s]>=e)r[s]+=t}},_setToIndex:function(e,t,n,r){var o=i.object.getPropertyValue(n,t);if(void 0===o&&n instanceof Object&&"function"===typeof n.getContents)o=i.object.getPropertyValue(n.getContents(),t);if(!Object.prototype.hasOwnProperty.call(e,o))e[o]=[];e[o].push(r)},_onCollectionChange:function(e,t,n,r,o,i){switch(t){case s.default.ACTION_ADD:case s.default.ACTION_REPLACE:this.reIndex(t,r,n.length);break;case s.default.ACTION_REMOVE:this.reIndex(t,i,o.length);break;default:this.reIndex(t)}}};t.default=n});