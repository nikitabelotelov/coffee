define("Types/_source/HierarchicalMemory",["require","exports","tslib","Types/_source/Memory","Types/entity","Types/util","Core/Deferred"],function(r,e,o,i,d,t,a){"use strict";Object.defineProperty(e,"__esModule",{value:true});var n=function(t){function e(e){var r=t.call(this)||this;return r["[Types/_source/ICrud]"]=true,r["[Types/_source/ICrudPlus]"]=true,d.OptionsToPropertyMixin.call(r,e),d.SerializableMixin.constructor.call(r),r._source=new i.default(e),r}return o.__extends(e,t),Object.defineProperty(e.prototype,"_idProperty",{get:function(){return this._source.getIdProperty()},enumerable:true,configurable:true}),e.prototype.create=function(e){return this._source.create(e)},e.prototype.read=function(e,r){return this._source.read(e,r)},e.prototype.update=function(e,r){return this._source.update(e,r)},e.prototype.destroy=function(e,r){return this._source.destroy(e,r)},e.prototype.query=function(s){var y=this,l=new a;return r(["Types/collection"],function(p){y._source.query(s).addCallbacks(function(e){if(y._$parentProperty){var r=new d.relation.Hierarchy({idProperty:y._idProperty,parentProperty:y._$parentProperty}),t=new p.RecordSet({rawData:y._source.data,adapter:y._source.getAdapter(),idProperty:y._idProperty}),o=new p.RecordSet({adapter:y._source.getAdapter(),idProperty:y._idProperty}),i=s.getWhere()[y._$parentProperty],a=t.getRecordById(i);if(a){o.add(a,0);var n=void 0;while(a&&(n=r.getParent(a,t)))o.add(n,0),a=n.get(y._idProperty)}var u=e.getRawData(true);if(u){var c=u.meta||{};c.path=o,u.meta=c,e.setRawData(u)}}l.callback(e)},function(e){l.errback(e)})},function(e){l.errback(e)}),l},e.prototype.merge=function(e,r){return this._source.merge(e,r)},e.prototype.copy=function(e,r){return this._source.copy(e,r)},e.prototype.move=function(e,r,t){return this._source.move(e,r,t)},e.prototype._getSerializableState=function(e){var r=d.SerializableMixin.prototype._getSerializableState.call(this,e);return r._source=this._source,r},e.prototype._setSerializableState=function(e){var r=d.SerializableMixin.prototype._setSerializableState(e);return function(){r.call(this),this._source=e._source}},e}(t.mixin(d.DestroyableMixin,d.OptionsToPropertyMixin,d.SerializableMixin));e.default=n,Object.assign(n.prototype,{"[Types/_source/HierarchicalMemory]":true,_moduleName:"Types/source:HierarchicalMemory",_$parentProperty:null}),n.prototype["[WS.Data/Source/ICrud]"]=true});