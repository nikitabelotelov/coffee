define("Types/_source/HierarchicalMemory",["require","exports","tslib","Types/_source/Memory","Types/entity","Types/util","require","Core/Deferred"],function(e,r,o,i,d,t,a,p){"use strict";Object.defineProperty(r,"__esModule",{value:true});var u=function(t){function e(e){var r=t.call(this)||this;return r["[Types/_source/ICrud]"]=true,r["[Types/_source/ICrudPlus]"]=true,d.OptionsToPropertyMixin.call(r,e),d.SerializableMixin.constructor.call(r),r._source=new i.default(e),r}return o.__extends(e,t),e.prototype.create=function(e){return this._source.create(e)},e.prototype.read=function(e,r){return this._source.read(e,r)},e.prototype.update=function(e,r){return this._source.update(e,r)},e.prototype.destroy=function(e,r){return this._source.destroy(e,r)},e.prototype.query=function(l){var s=this,y=new p;return a(["Types/collection"],function(c){s._source.query(l).addCallbacks(function(e){if(s._$parentProperty){var r=new d.relation.Hierarchy({idProperty:s._$idProperty,parentProperty:s._$parentProperty}),t=new c.RecordSet({rawData:s._$data,adapter:s._source.getAdapter(),idProperty:s._$idProperty}),o=new c.RecordSet({adapter:s._source.getAdapter(),idProperty:s._$idProperty}),i=l.getWhere()[s._$parentProperty],a=t.getRecordById(i);if(a){o.add(a,0);var p=void 0;while(a&&(p=r.getParent(a,t)))o.add(p,0),a=p.get(s._$idProperty)}var u=e.getRawData(true);if(u){var n=u.meta||{};n.path=o,u.meta=n,e.setRawData(u)}}y.callback(e)},function(e){y.errback(e)})},function(e){y.errback(e)}),y},e.prototype.merge=function(e,r){return this._source.merge(e,r)},e.prototype.copy=function(e,r){return this._source.copy(e,r)},e.prototype.move=function(e,r,t){return this._source.move(e,r,t)},e.prototype._getSerializableState=function(e){return(e=d.SerializableMixin.prototype._getSerializableState.call(this,e))._source=this._source,e},e.prototype._setSerializableState=function(e){var r=d.SerializableMixin.prototype._setSerializableState(e);return function(){r.call(this),this._source=e._source}},e}(t.mixin(d.DestroyableMixin,d.OptionsToPropertyMixin,d.SerializableMixin));(r.default=u).prototype._moduleName="Types/source:HierarchicalMemory",u.prototype["[Types/_source/HierarchicalMemory]"]=true,u.prototype._$adapter=null,u.prototype._$model=null,u.prototype._$listModule=null,u.prototype._$idProperty=null,u.prototype._$parentProperty=null,u.prototype._$data=null,u.prototype._$filter=null,u.prototype["[WS.Data/Source/ICrud]"]=true});