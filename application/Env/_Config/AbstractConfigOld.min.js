define("Env/_Config/AbstractConfigOld",["require","exports","Core/Abstract","Core/Deferred","Browser/Storage","Env/_Constants/constants","optional!Types/source"],function(e,t,r,n,a,i,o){"use strict";Object.defineProperty(t,"__esModule",{value:true}),t.default=r.extend({$protected:{_blo:null},$constructor:function(){this._publish("onChange")},_isConfigSupport:function(){throw new Error("AbstractConfig:_isConfigSupport must be implemented in child classes")},_getObjectName:function(){throw new Error("AbstractConfig:_getObjectName must be implemented in child classes")},_getBLObject:function(){if(!o.SbisService)throw new Error("Для работы Core/AbstractConfig нужен модуль Types/source.SbisService");var e=new n,t=this;if(null===this._blo)return e.callback().addCallback(function(){return t._blo=new o.SbisService({endpoint:t._getObjectName()}),t._blo});else e.callback(this._blo);return e},_callMethod:function(t,r){if(!this._isConfigSupport())return n.success();return this._getBLObject().addCallback(function(e){return e.call(t,r)})},_prepareParam:function(e,t){var r={"Путь":e};if(t)r["Контекст"]=t;return r},_processingParam:function(e,t,r){if(!i.default.isBrowserPlatform||!t)return;switch(e){case"update":a.SessionStorage.set(t,r);break;case"delete":a.SessionStorage.remove(t);break;case"read":return a.SessionStorage.get(t)}this._notify("onChange",t,r)},_getParam:function(e,r,t){var a=this;return this._callMethod(e,this._prepareParam(r,t)).addCallback(function(e){if(!e)return a._processingParam("read",r);var t=e.getScalar();return a._processingParam("update",r,t),t})},getParam:function(e,t){return this._getParam("ПолучитьЗначение",e,t)},getParams:function(e){var a=this,t=e?{Names:e}:{};return this._callMethod("ПолучитьПараметры",t).addCallback(function(e){if(!e)return{};var t,r;if(t=e.getAll())t.each(function(e){(r=e.get("Название"))&&a._processingParam("update",r,e.get("Значение"))});return t})},setParam:function(e,t,r){if(void 0===t)t=null;if(this._processingParam("update",e,t),!this._isConfigSupport())return(new n).callback(true);var a=this._prepareParam(e,r);return a["ЗначениеПараметра"]=t,this._callMethod("ВставитьЗначение",a).addCallback(function(e){return e&&e.getScalar()})},removeParam:function(e,t){if(this._processingParam("delete",e,null),!this._isConfigSupport())return(new n).callback(true);var r=this._prepareParam(e,t);return this._callMethod("УдалитьПараметр",r).addCallback(function(e){return e&&e.getScalar()})}})});