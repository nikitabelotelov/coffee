define("Browser/_Event/Server/_class/creator/TransportConnect",["require","exports"],function(c,e){"use strict";Object.defineProperty(e,"__esModule",{value:true});var t=function(){function o(e){if(void 0===e)e=false;this.connectWay=!e?this.byWebSocket:this.bySockjs}return o.prototype.getWebSocket=function(n,o){if(void 0===o)o=true;return new Promise(function(t,r){c(["Browser/_Event/Server/native/SockjsEmulator"],function(e){try{t(new e(n,void 0,o))}catch(e){r(e)}})})},o.prototype.getSockjs=function(n,o){return new Promise(function(e,t){try{var r;e(new n(o.replace("wss:","https:").replace("ws:","http:"),null,{transports:["xhr-streaming"],debug:function(){},stompLogger:function(){}}))}catch(e){return t(e)}})},o.prototype.requireStomp=function(){return new Promise(function(e){c(["Browser/_Event/Server/resources/stomp"],function(){e()})})},o.prototype.requireSockjs=function(){return new Promise(function(r,n){c(["Browser/_Event/Server/resources/stomp","Browser/_Event/Server/resources/sockjs-1.0.3"],function(e,t){if(!t)return n("Can't load Browser/_Event/Server/resources/sockjs-1.0.3");r(t)})})},o.prototype.byWebSocket=function(e,t){var r=this;return this.requireStomp().then(function(){return r.getWebSocket(e,t)})},o.prototype.bySockjs=function(t){var r=this;return this.requireSockjs().then(function(e){return r.getSockjs(e,t)})},o.prototype.initStomp=function(n){return new Promise(function(e,t){var r=Stomp.over(n);r.heartbeat.outgoing=o.STOMP_HEARTBEAT_OUT_TIME,r.heartbeat.incoming=o.STOMP_HEARTBEAT_IN_TIME,r.debug=function(){},r.connect(o.LOGIN,o.PASSWORD,function(){e(r)},function(e){t(e)})})},o.prototype.connect=function(e,t){return this.connectWay(e.getWebSocketUrl(),t).then(this.initStomp)},o.STOMP_HEARTBEAT_OUT_TIME=6e4,o.STOMP_HEARTBEAT_IN_TIME=0,o.LOGIN="stomp_user",o.PASSWORD="stomp_user",o}();e.TransportConnect=t});