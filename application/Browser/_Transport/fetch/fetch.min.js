define("Browser/_Transport/fetch/fetch",["require","exports","tslib","Env/Env","Browser/_Transport/fetch/Errors","Browser/_Transport/_utils"],function(e,n,l,t,w,h){"use strict";Object.defineProperty(n,"__esModule",{value:true});var E={method:"GET",url:""},T=2e3,r=600,v=false,o=false,i,_=function(e){return o||300==e||405==e},b=function(e){return e>=200&&e<300||304===e},m=function(e){return"AbortError"==e.name},R=function(e,n){var t=true;return n.forEach(function(e,n){t=false}),0===e&&t};(function(){if("undefined"===typeof window)return;if(t.detection.firefox)window.addEventListener("beforeunload",function(){v=true,setTimeout(function(){v=false},r)});else window.addEventListener("unload",function(){v=true});window.addEventListener("online",function(){o=false}),window.addEventListener("offline",function(){o=true})})();var u=function(e){var n=l.__assign({},E,e),i=n.url,t=n.method,r=n.body,o=n.headers,u=n.credentials,f=n.cache,a=n.redirect,s=n.mode,d=new AbortController,c=fetch(i,{method:t,headers:o,redirect:a,mode:s,body:r,credentials:u,cache:f,signal:d.signal}).then(function(e){var n=e.status,t=e.statusText,r=e.headers;if(b(n))return e;if(401==n)throw new w.Auth(i);if(_(n)||R(n,r))throw new w.Connection(i);var o=w.ERROR_TEXT[n]||w.ERROR_TEXT[t]||w.ERROR_TEXT.unknown;return e.text().then(function(e){throw new w.HTTP({url:i,message:o,payload:e,httpError:n})})},function(e){if(m(e)||v)throw new w.Abort(i);return h.delay(T).then(function(){if(_())throw new w.Connection(i);throw e})});return h.getAbortedPromise(c,d)};n.default=u});