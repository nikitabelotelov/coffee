define("Browser/_Transport/RPC/fallback",["require","exports","Core/Deferred"],function(r,e,t){"use strict";Object.defineProperty(e,"__esModule",{value:true});var s="system.bl_async_replies",c=function(n){return function(e,r){if(!r)return;var t;if("string"===typeof r)t=JSON.parse(r);if(t&&t.guid===n.guid)clearTimeout(n.timeout),n.deferred.callback(t.data)}},n=function(e){var n=e.data,u=e.headers,i=e.transport,a=e.timeout,o=new t;return r(["Env/ServerEvent/Bus"],function(e){var t=function(){return e.serverChannel(s)};t().once("onReady",function(){var e={deferred:o,guid:u["X-UNIQ-ID"]},r=c(e);e.timeout=setTimeout(function(){t().unsubscribe("onMessage",r),o.errback("Timeout")},a),t().subscribe("onMessage",r),i.execute(n,u)})},function(e){o.errback(e)}),o};e.default=n});