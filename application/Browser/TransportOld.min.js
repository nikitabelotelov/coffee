define("Browser/TransportOld",["Core/helpers/Object/isEmpty","Core/moduleStubs","Core/CommandDispatcher","Core/Context","Core/core-attach","View/Runner/requireHelper","Core/ParallelDeferred","Core/core-instance","Core/helpers/axo","Core/helpers/Number/randomId","Core/property-merge","Core/core-merge","Core/Storage","Core/core-classicExtend","tslib","Core/helpers/createGUID","Core/base64","Core/helpers/i18n/transliterate","Core/i18n","Core/UserInfo","Env/Event","Env/Constants","Env/Env","Core/xslt-async","Core/Deferred","Core/core-extend","require","exports"],function(n,a,l,u,c,i,s,d,o,f,h,p,m,g,_,v,y,T,C,E,b,O,N,w,R,A,I,e){Object.defineProperty(e,"__esModule",{value:true}),e["Browser/_TransportOld/nodeType"]=true;var D=function(){"use strict";var e={},t={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),t=D;e["Browser/_Transport/URL/serializeData"]=true;var x=function(){"use strict";var e={},t=function(e,t,n){function r(r){if(r instanceof Object&&Object.getPrototypeOf(r)===Object.prototype)r=Object.keys(r).sort().reduce(function(e,t){return e[t]=r[t],e},{});var e=JSON.stringify(void 0===r?"":r);if(-1!==e.indexOf("\\u"))e=unescape(e.replace(/\\u/g,"%u"));return n.encode(e)}Object.defineProperty(t,"__esModule",{value:true}),t.default=r}(I,e,y);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/Record"]=true;var r=function(){"use strict";var e={},t=void(r=N).IoC.resolve("ILogger").log("Browser/_TransportOld/Record",'module removed, use "Deprecated/Record"'),r;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),P=r;e["Browser/_TransportOld/RecordSetToXMLSerializer"]=true;var k=function(){"use strict";var e={},t=function(t,E,b){var e;function O(e){if("string"==typeof e)e=e.replace(/[^\x09\x0A\x0D\x20-\uD7FF\uE000-\uFFFD\u10000-\u10FFFF]*/g,"");return e}return e={_complexFields:{"Связь":true,"Иерархия":true,"Перечисляемое":true,"Флаги":true,"Массив":true,"Запись":true,"Выборка":true},_wordsToTranslate:{"Дата":"Date","Время":"Time","Строка":"String","Текст":"Text","Логическое":"Boolean","Деньги":"Money","Двоичное":"Binary","Файл-rpc":"RPCFile","Временной интервал":"TimeInterval","Идентификатор":"ID","JSON-объект":"JSON-object"},_colNameToTag:{"Число целое":"Integer","Число вещественное":"Double","Дата и время":"DateTime"},_branchTypes:{true:"Node",false:"Leaf",null:"HiddenNode"},serialize:function(e,t,r,n){var o=this._createXMLDocument(),i=E.instanceOfModule(e,"Deprecated/Record")?[e]:e;return this._serializeObject(i,o,o),this._serializeColumns(t,i,o,r,n),o},_serializeColumns:function(e,t,r,n,o){var i="",a,s;if(e&&e instanceof Array&&e.length>0){r.documentElement.appendChild(a=r.createElement("Columns"));for(var l=0,u=e.length;l<u;l++)a.appendChild(s=r.createElement("Column")),s.setAttribute("Name",e[l].title),s.setAttribute("Field",e[l].field)}if(E.instanceOfModule(t,"Deprecated/RecordSet"))i=t.getHierarchyField();if(t instanceof Array&&E.instanceOfModule(t[0],"Deprecated/Record")&&null!==t[0].getRecordSet()){var c=t[0].getRecordSet();if(c)i=c.getHierarchyField()}if(""!==i)r.documentElement.setAttribute("HierarchyField",i),r.documentElement.setAttribute("HierarchyName",void 0===n?"":n),r.documentElement.setAttribute("Root",o?o+"":"")},_serializeObject:function(e,t,r){var n,o,i=[],a,s;if(E.instanceOfModule(e,"Deprecated/RecordSet")){t.appendChild(o=r.createElement("RecordSet")),e.rewind();while(false!==(n=e.next()))this._serializeObject(n,o,r)}else if(e instanceof Array){t.appendChild(o=r.createElement("RecordSet"));for(var l=e.length,u=0;u<l;u++)this._serializeObject(e[u],o,r)}else if(E.instanceOfModule(e,"Deprecated/Record")){t.appendChild(a=r.createElement("Record"));var c=e.getKey();if(null===c)c="null";a.setAttribute("RecordKey",O(c+"")),i=e.getColumns(),s=null===e.getRecordSet()?i[0]:i[e.getRecordSet().getPkColumnIndex()],a.setAttribute("KeyField",s);for(var d=0,f=i.length;d<f;d++)this._serializeField(i[d],e,a,r)}},_serializeField:function(e,t,r,n){var o,i,a,s,l=/[а-я]+/gi;o=t.getColumnDefinition(e),r.appendChild(i=n.createElement("Field")),i.setAttribute("Name",o.title);var u=null===t.get(o.title)?"":t.get(o.title),c="object"==typeof o.type?o.type.n:o.type;if(!this._complexFields[c]&&!o.s&&!this._complexFields[o.s]){var d;if(a=this._colNameToTag[o.type]?this._colNameToTag[o.type]:o.type,a=this._wordsToTranslate[a]?this._wordsToTranslate[a]:a,l.test(a))b.IoC.resolve("ILogger").error("XSLT",rk("Внимание! Кирилический тэг без замены:")+" "+a);if(s=n.createElement(a),u instanceof Date){if("Дата и время"==o.type)u=u.toSQL()+"T"+u.toTimeString().replace(" GMT","").replace(/\s[\w\W]*/,"");if("Дата"==o.type)u=u.toSQL();if("Время"==o.type)u=u.toTimeString().replace(" GMT","").replace(/\s[\w\W]*/,"")}u=O(u+""),s.appendChild(n.createTextNode(u)),i.appendChild(s)}else if("Связь"==c)(s=n.createElement("Link")).setAttribute("Table","object"==typeof o.type?o.type.t:o.table),s.appendChild(n.createTextNode(u)),i.appendChild(s);else if("Иерархия"==c||o.s&&"Иерархия"==o.s){var f,h;if(i.appendChild(s=n.createElement("Hierarchy")),s.appendChild(f=n.createElement("Parent")),s.appendChild(h=n.createElement("NodeType")),"object"==typeof o.type)s.setAttribute("HierarchyName",o.type.f+""),f.appendChild(n.createTextNode(u[1]+"")),h.appendChild(n.createTextNode(this._branchTypes[u[0]+""]));else if("Идентификатор"==c){if(s.setAttribute("HierarchyName",o.titleColumn+""),f.appendChild(n.createTextNode(u+"")),t.hasColumn(o.title+"@"))u=this._branchTypes[t.get(o.title+"@")+""],h.appendChild(n.createTextNode(u))}else r.removeChild(i)}else if("Перечисляемое"==c){var p;for(var m in i.appendChild(s=n.createElement("Enumerable")),(u=u.toObject()).availableValues)if(u.availableValues.hasOwnProperty(m)){s.appendChild(p=n.createElement("Variant")),p.setAttribute("Value",m);var g=u.availableValues[m];if(null===g)g="";if(p.setAttribute("Title",g),m==u.currentValue)p.setAttribute("Checked","true")}}else if("Флаги"==c){var _;if(i.appendChild(s=n.createElement("Flags")),u)for(var v in u=u.toObject())if(u.hasOwnProperty(v))s.appendChild(_=n.createElement("Flag")),_.setAttribute("Title",v),_.setAttribute("Condition",u[v]+"")}else if("Массив"==c){var y;i.appendChild(s=n.createElement("Array")),s.setAttribute("DataType","object"==typeof o.type?o.type.t:o.arrayType);for(var T=0,C=u.length;T<C;T++)s.appendChild(y=n.createElement("Value")),y.appendChild(n.createTextNode(O(u[T]+"")))}else if(E.instanceOfModule(u,"Deprecated/RecordSet")||E.instanceOfModule(u,"Deprecated/Record"))this._serializeObject(u,i,n)},_createXMLDocument:function(){var e;if(document.implementation&&document.implementation.createDocument)e=document.implementation.createDocument("","",null);if(t)e=t("Microsoft.XmlDom");return e}}}(o,d,N);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),S=k;e["Browser/_TransportOld/BLObject"]=true;var L=function(){"use strict";var e={},t=void(r=N).IoC.resolve("ILogger").log("Browser/_TransportOld/BLObject",'module removed, use "Deprecated/BLObject"'),r;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),F=L;e["Browser/_Transport/RPC/Headers"]=true;var B=function(){"use strict";var e={},t=function(e,t,r,s,n,o,i,l){Object.defineProperty(t,"__esModule",{value:true});var u="X-LastModification",c={};r.Bus.channel("Transport").subscribe("onResponseSuccess",function(e,t,r,n){c[n]=t.getResponseHeader(u)||c[n]});var d=function(e,t){switch(e){case"GET":var r={},n=s.getCurrent();if(n){var o=n.split("-"),i=o[0],a=o[1];r["X-SbisSessionsID"]=n,r["X-CID"]=i,r["X-UID"]=a}return r;case"POST":var r={};if(c[t])r[u]=c[t];return r;default:return{}}},f=function(e){if(!e)return{};return{"X-CalledMethod":o(""+e),"X-OriginalMethodName":i.encode(""+e),"Accept-Language":(n.getLang()||"ru-RU")+";q=0.8,en-US;q=0.5,en;q=0.3"}},a=function(){function e(e){var t=e.fallback,r=e.asyncInvoke,n=e.url,o=e.recent,i=e.method,a=e.httpMethod,s=e.headers;if(t)this["X-PublishAsyncResponse"]=true,this["X-UNIQ-ID"]=l();if(r||t)this["X-ASYNCINVOKE"]=true;if(o)this["X-RequireRecent"]=true;Object.assign(this,f(i),d(a,n),s)}return e.getForMethod=f,e}();t.default=a}(I,e,b,E,C,T,y,v);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/RecordSet"]=true;var M=function(){"use strict";var e={},t=void(r=N).IoC.resolve("ILogger").log("Browser/_TransportOld/RecordSet",'module removed, use "Deprecated/RecordSet"'),r;if(t instanceof Function)return t;else for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n];return e}(),H=M;e["Browser/_Transport/fetch/Errors"]=true;var j=function(){"use strict";var e={},t=function(e,c,t,r,n){Object.defineProperty(c,"__esModule",{value:true}),c.ERROR_TEXT={get timeout(){return r.rk("Таймаут запроса")},get unknown(){return r.rk("Неизвестная ошибка")},get parsererror(){return r.rk("Ошибка разбора документа")},get abort(){return r.rk("Запрос был прерван")},get lossOfConnection(){return r.rk("Потеряна связь с сайтом")},get 401(){return r.rk("Ошибка авторизации")},get 403(){return r.rk("У вас недостаточно прав для выполнения данного действия")},get 404(){return r.rk("Документ не найден")},get 413(){return r.rk("Превышен допустимый размер загружаемого файла")},get 423(){return r.rk("Действие заблокировано лицензией")},get 500(){return r.rk("Внутренняя ошибка сервера")},get 502(){return r.rk("Сервис находится на техническом обслуживании")},get 503(){return r.rk("Сервис находится на техническом обслуживании")},get 504(){return r.rk("Сервис находится на техническом обслуживании")}},c.DETAILS_TEXT={get default(){return r.rk("Мы знаем об этом и уже исправляем. Попробуйте заглянуть сюда через 15 минут.")},get lossOfConnection(){return r.rk("Проверьте настройки подключения к сети")}};var o=function(){function e(e){var t=e.url,r=e.message,n=e.details,o=e.name;this.name="TransportError",this.processed=false,this.message=r,this.stack=(new Error).stack,this.url=t,this.details=n,this.name=this.name||o}return e.prototype.toString=function(){return this.name+": "+this.message+"; url: "+this.url},e}();n(c.Transport=o,Error);var i=function(u){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this,o;if("string"==typeof e){var i,a,s,l;o={message:e,httpError:t[0],url:t[1],payload:t[2],details:t[3]}}else o=e;return(n=u.call(this,o)||this).name="HTTP Error",n.payload=o.payload||"",n.status=o.httpError,n.details=n.details||c.DETAILS_TEXT.default,n.xhr=o.xhr,n.httpError="undefined"!==typeof n.status?n.status:"",n}return t.__extends(e,u),e.prototype.toString=function(){return this.name+": "+this.message+"; httpError: "+this.httpError+"; url: "+this.url},e}(o);c.HTTP=i;var a=function(o){function e(e){var t=e.url,r=e.details,n=o.call(this,{url:t,details:r,message:c.ERROR_TEXT.parsererror})||this;return n.name="ParseError",n}return t.__extends(e,o),e}(o);c.Parse=a;var s=function(r){function e(e){var t=r.call(this,{url:e,message:c.ERROR_TEXT.lossOfConnection,details:c.DETAILS_TEXT.lossOfConnection})||this;return t.name="ConnectionError",t._isOfflineMode=true,t}return t.__extends(e,r),e}(o);c.Connection=s;var l=function(r){function e(e){var t=r.call(this,{url:e,message:c.ERROR_TEXT[401]})||this;return t.name="AuthError",t}return t.__extends(e,r),e}(o);c.Auth=l;var u=function(r){function e(e){var t=r.call(this,{url:e,message:c.ERROR_TEXT.abort})||this;return t.canceled=true,t}return t.__extends(e,r),e}(o);c.Abort=u}(I,e,_,C,g);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_Transport/URL/deserializeData"]=true;var U=function(){"use strict";var e={},t=function(e,t,r){function n(e){return JSON.parse(r.decode(e))}Object.defineProperty(t,"__esModule",{value:true}),t.default=n}(I,e,y);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/RecordTypes"]=true;var Y=function(){"use strict";var e={},t={FIELD_TYPE_QUERY:"Выборка",FIELD_TYPE_RECORD:"Запись",FIELD_TYPE_INTEGER:"Число целое",FIELD_TYPE_STRING:"Строка",FIELD_TYPE_TEXT:"Строка",FIELD_TYPE_DOUBLE:"Число вещественное",FIELD_TYPE_MONEY:"Деньги",FIELD_TYPE_DATE:"Дата",FIELD_TYPE_DATETIME:"Дата и время",FIELD_TYPE_TIME:"Время",FIELD_TYPE_ARRAY:"Массив",FIELD_TYPE_BOOLEAN:"Логическое",FIELD_TYPE_HIERARCHY:"Иерархия",FIELD_TYPE_IDENTITY:"Идентификатор",FIELD_TYPE_ENUM:"Перечисляемое",FIELD_TYPE_FLAGS:"Флаги",FIELD_TYPE_LINK:"Связь",FIELD_TYPE_BINARY:"Двоичное",FIELD_TYPE_UUID:"UUID",FIELD_TYPE_RPCFILE:"Файл-rpc",FIELD_TYPE_TIME_INTERVAL:"Временной интервал"};if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),X=Y;e["Browser/_Transport/URL/getHostName"]=true;var z=function(){"use strict";var e={},t=function(e,t){function r(){var e=process&&process.domain&&process.domain.req;return e?e.hostname:location.hostname}Object.defineProperty(t,"__esModule",{value:true}),t.default=r}(I,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_Transport/URL/getQueryParam"]=true;var V=function(){"use strict";var e={},t=function(e,t){function n(e,t){var r=t.exec(e);return r&&decodeURI(r[1])}function r(e){var t="undefined"!==typeof process&&process.domain&&process.domain.req,r=new RegExp("[?&]"+e+"=([^&]*)");return t&&t.query?t.query[e]:"undefined"!==typeof location?n(location.search,r):""}Object.defineProperty(t,"__esModule",{value:true}),t.default=r}(I,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_Transport/URL/getUrl"]=true;var q=function(){"use strict";var e={},t=function(e,t){function r(){var e=process&&process.domain&&process.domain.req;return e?e.originalUrl:location?location.href:""}Object.defineProperty(t,"__esModule",{value:true}),t.default=r}(I,e);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/Template"]=true;var J=function(){"use strict";var e={},t=(n=I,c=s,d=R,f=N,h=i,p=D,(m=(r=A)({},{$protected:{_templateName:"",_dReady:null,_loadedHandlers:{},_configuration:{autoWidth:false,autoHeight:false,isRelativeTemplate:false,minWidth:0}},$constructor:function(e){this._templateName=e.templateName,this._dReady=new c,this._dReady.getResult().addCallback(this._attachResources.bind(this)).addCallback(this._loadDependencies.bind(this))},isPage:function(){throw new Error("Template::isPage - method is not implemented!")},_collectAllControlsToPreload:function(e){throw new Error("Template::_collectAllControlsToPreload - method is not implemented!")},_loadDependencies:function(){var e,t=this._collectAllControlsToPreload(this.getControls(void 0)).map(function(e){return[e.type,e]},[]);return this._loadControlsDependencies(t,true)},_loadControlsDependencies:function(e,i){var a={};function s(t,r){return function(){if(!f.constants.isServerScript&&h.defined(r)){var e=n(r);t.callback([r,e])}else n([r],function(e){t.callback([r,e])});return t}}function l(e,t){var r,n=new d,o=["Deprecated","Lib"],i=e.indexOf("/")>0?e.split("/")[0]:false;if(i&&(o.indexOf(i)>-1||Object.keys(f.constants.modules).some(function(e){return f.constants.modules[e]===i}))||-1===e.indexOf("SBIS3.")&&e.indexOf("/")>-1&&-1===e.indexOf("Control/"))r=s(n,e);else r=s(n,e);return r}function r(e,i){return e.reduce(function(e,t){var r=t[0],n,o;if(!(r in a))a[r]=true,o=l(r,i),e.push(o());return e},new c).done().getResult()}function o(e){var i=n.defined("Core/DependencyResolver")?n("Core/DependencyResolver"):false;return e.reduce(function(t,e){var r=e[0],n=e[1],o;return(o=i&&i.resolve(r,n)||[]).forEach(function(e){t.push([e,n])}),t},[])}function t(e,n){var o=Object.keys(n).reduce(function(e,t){var r=n[t];return e[r[0]]=r[1],e},{});return e.map(function(e){var t=e[0],r=o[t];if(i&&"function"!==typeof r)throw new Error("Can't instantiate class '"+t+"'. Class not exists");return r})}function u(n,e){var t;return r(n,e).addCallback(function(e){var t=o(n),r;if(t.length>0)r=u(t,false).addCallback(function(){return e});else r=e;return r})}return u(e,i).addCallback(t.bind(void 0,e))},getRenderResult:function(){return this._dReady.getResult()},getStyle:function(){throw new Error("Template::getStyle - method is not implemented!")},getDimensions:function(){throw new Error("Template::getDimensions - method is not implemented!")},getAlignment:function(){throw new Error("Template::getAlignment - method is not implemented!")},getTitle:function(){throw new Error("Template::getTitle - method is not implemented!")},getConfig:function(e){throw new Error("Template::getConfig - method is not implemented!")},getDeclaredHandlers:function(){return this._loadedHandlers},createMarkup:function(e){throw new Error("Template::createMarkup - method is not implemented!")},getControls:function(e,t){throw new Error("Template::getControls - method is not implemented!")},getName:function(){return this._templateName},_getIncludeDescriptorNodes:function(){throw new Error("Template::_getIncludeDescriptorNodes - method is not implemented!")},_attachResources:function(){var e=this._getIncludeDescriptorNodes(),t=new c;if(e.length>0){var r=e[0].getAttribute("spec");if(r){try{r=JSON.parse(r)}catch(e){r=false}if(r){if(r.js)t.push(this._requireModuleUrls(r.js));if(r.css)t.push(this._requireModuleUrls(r.css))}}}return t.done().getResult()},_requireModuleUrls:function(e){var t=new d;return t.addErrback(function(e){return e}),n(e,function(){t.callback()},function(e){t.errback(e)}),t},_mergeAttrToConfig:function(e,t,r){if("title"!==t&&"width"!==t&&"height"!==t)e[t]="false"===r?false:"true"===r?true:r},needSetZindexByOrder:function(){return false}}))._importNode=function(e,t,r,n){if(false!==n&&e.importNode)try{return e.importNode(t,r)}catch(e){n=false}switch(t.nodeType){case p.ELEMENT_NODE:var o=e.createElement(t.nodeName),i,a;if(t.attributes&&t.attributes.length>0)for(i=0,a=t.attributes.length;i<a;i++){var s=t.attributes[i].nodeName,l=t.getAttribute(s);if("style"===s.toLowerCase()&&f.compatibility.isIE)o.style.cssText=l;else o.setAttribute(s,l)}if(r&&t.childNodes&&t.childNodes.length>0)for(i=0,a=t.childNodes.length;i<a;i++){var u=m._importNode(e,t.childNodes[i],r,n);if(u)o.appendChild(u)}return o;case p.TEXT_NODE:case p.CDATA_SECTION_NODE:return e.createTextNode(t.nodeValue);case p.COMMENT_NODE:return null}},m.extend=function(e,t){return r(this,e,t)},m),n,r,c,d,f,h,p,m;if(t instanceof Function)return t;else for(var o in t)if(t.hasOwnProperty(o))e[o]=t[o];return e}(),G=J;e["Browser/_Transport/RPC/Error"]=true;var Q=function(){"use strict";var e={},t=function(e,t,r,n){Object.defineProperty(t,"__esModule",{value:true});var o=function(p){function e(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=this,o;if("string"===typeof e){var i,a,s,l,u,c,d,f,h;o={message:e,httpError:t[0],code:t[1],methodName:t[2],details:t[3],url:t[4],classid:t[5],errType:t[6],addinfo:t[7],error_code:t[8]}}else o=e;return(n=p.call(this,o)||this).name="Transport error",n.code=o.code||0,n.details=o.details||"",n.methodName=o.methodName||"",n.classid=o.classid||"",n.errType=o.errType||"error",n.addinfo=o.addinfo||"",n.error_code=o.error_code,n}return r.__extends(e,p),e.prototype.toString=function(){return this.name+": "+this.message+"; method: "+this.methodName+"; code: "+this.code+"; httpError: "+this.httpError+"; details: "+this.details},e}(n.HTTP);t.default=o}(I,e,_,j);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/ReportPrinter"]=true;var K=function(){"use strict";var e={},t=(s=R,l=w,u=k,n=(r=A).extend({},{$protected:{_options:{columns:[],titleColumn:""}},prepareReport:function(e,t,r,n){var o=new s,i=n&&n.documentElement?n:u.serialize(e,this._options.columns,this._options.titleColumn,r),a=new l({xml:i,xsl:t});return a.execute().addCallback(function(){a.transformToText().addCallback(function(e){e.replace('<transformiix:result xmlns:transformiix="http://www.mozilla.org/TransforMiix">',"").replace("</transformiix:result>",""),a.destroy(),o.callback(e)})}),o},getColumns:function(){return this._options.columns},setColumns:function(e){this._options.columns=e},getTitleColumn:function(){return this._options.titleColumn}})),r,s,l,u,n;if(t instanceof Function)return t;else for(var o in t)if(t.hasOwnProperty(o))e[o]=t[o];return e}(),W=K;e["Browser/_Transport/URL"]=true;var Z=function(){"use strict";var e={},t=(r=I,n=e,o=U,i=x,a=z,s=V,l=q,Object.defineProperty(n,"__esModule",{value:true}),n.deserializeData=o.default,n.serializeData=i.default,n.getHostName=a.default,n.getQueryParam=s.default,void(n.getUrl=l.default)),r,n,o,i,a,s,l;if(t instanceof Function)return t;else for(var u in t)if(t.hasOwnProperty(u))e[u]=t[u];return e}();e["Browser/_TransportOld/loadTemplateFile"]=true;var ee=function(){"use strict";var e={},t=(a=R,s=N,l=m,u=D,function e(n,o){function t(t){if(!o&&t instanceof Array)for(var e=0,r=t.length;e<r;e++)if(l.isStored("resfile://"+t[e])||e==r-1){t=t[e];break}var n="undefined"!==typeof document&&(s.cookie.get("s3rh")||s.cookie.get("rightshash"))||0;return l.store("resfile://"+t,function(e){e.dependOn(s.IoC.resolve("ITransport",{dataType:o?"text":"xml",url:function(){var e=t+(o?".fast.xml":".xml");if(n)e=e.replace(/(\.fast)?(\.v[0-9a-f]+)?(\.l[\S-]+)?(\.xml)$/,"$1.r"+n+"$2$3$4");return e}()}).execute(null))})}if(s.constants.xmlPackages[n]&&!o)return(new a).dependOn(t(s.constants.xmlPackages[n])).addCallback(function(e){for(var t=e.documentElement,r=t.childNodes.length-1;r>=0;--r){if(t.childNodes[r].nodeType!=u.ELEMENT_NODE)continue;if(t.childNodes[r].getAttribute("id")==n)return t.childNodes[r]}return new Error(n+" is not found in the package "+s.constants.xmlPackages[n])});var r=n.charAt(0),i="";if("/"!==r&&"."!==r)if(n in s.constants.xmlContents){if("/"!==(r=(n=s.constants.xmlContents[n]).charAt(0)))i=s.constants.resourceRoot}else i=s.constants.wsRoot+"res/xml/";return t(i+n)}),a,s,l,u;if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/EmptyTemplate"]=true;var te=function(){"use strict";var e={},t=n=(r=J).extend({$constructor:function(){this._dReady.done()},_collectAllControlsToPreload:function(){return[]},isPage:function(){return true},getConfig:function(){return{}},getStyle:function(){return""},getAlignment:function(){return{horizontalAlignment:"Stretch",verticalAlignment:"Stretch"}},getTitle:function(){return""},createMarkup:function(e){e.get(0).innerHTML=""},getDimensions:function(){return{width:"",height:""}},getControls:function(){return[]},_getIncludeDescriptorNodes:function(){return[]}}),r,n;if(t instanceof Function)return t;else for(var o in t)if(t.hasOwnProperty(o))e[o]=t[o];return e}(),re=te;e["Browser/_TransportOld/CompoundControlTemplate"]=true;var ne=function(){"use strict";var e={},t=(o=p,i=h,n=f,a=(r=J).extend({$protected:{_options:{template:null},_elementId:null,_docFragment:null,_instance:null},$constructor:function(){this._elementId=n(),this._loadedHandlers=this._options.template&&this._options.template.handlers||{},this._dReady.done()},_collectAllControlsToPreload:function(e){return e[0]&&[e[0]]||[]},getConfig:function(){var e=this._options.template,t=e.prototype,r={},n=e.dimensions||e.prototype.dimensions||{};if(t&&t._initializer)if(t._initializer.call(r,i),void 0===(r=r._options||{}).isRelativeTemplate)r.isRelativeTemplate=true;return o(r,n),r},getStyle:function(){return""},getDimensions:function(){var r=this.getConfig();return"width height".split(" ").reduce(function(e,t){if(t in r)e[t]=r[t];return e},{})},isPage:function(){return true},getTitle:function(){var e=this.getConfig();return e&&e.title||this._options.template.title||""},createMarkup:function(e,t){var r=document.createElement("div");if(r.setAttribute("id",this._elementId),t)r._componentConfig=t;e.append(r)},getControls:function(e,t){if(e&&this._elementId!=e)return[];var r=t&&t.find("#"+this._elementId).get(0);return[o({id:this._elementId,type:this._templateName},r&&r._componentConfig||{})]},_getIncludeDescriptorNodes:function(){return[]}})),r,o,i,n,a;if(t instanceof Function)return t;else for(var s in t)if(t.hasOwnProperty(s))e[s]=t[s];return e}(),oe=ne;e["Browser/_Transport/RPC/ErrorCreator"]=true;var ie=function(){"use strict";var e={},t=(r=I,i=e,n=Q,o=O,a=j,Object.defineProperty(i,"__esModule",{value:true}),i.fromRPC=function(e,t,r){return new n.default({httpError:"undefined"!==e.httpError?e.httpError:"",code:e.code,methodName:t,details:e.details,url:r||o.constants.defaultServiceUrl,message:e.message,classid:e.data&&e.data.classid,errType:e.type,addinfo:e.data&&e.data.addinfo,error_code:e.data&&e.data.error_code})},void(i.fromHTTP=function(e,t){if(!(e instanceof a.HTTP))return e;var r={message:e.message,httpError:e.httpError,code:0},n;try{n=JSON.parse(e.payload)}catch(e){n={}}var o=n.error;return Object.assign(r,o),i.fromRPC(r,t,e.url)})),r,i,n,o,a;if(t instanceof Function)return t;else for(var s in t)if(t.hasOwnProperty(s))e[s]=t[s];return e}();e["Browser/_TransportOld/FastTemplate"]=true;var ae=function(){"use strict";var e={},t=(_=N,v=f,g=c,y=u,T=R,C=l,E=d,b=a,s=function(e,t,r){if(null===e||void 0===e||0===e.length)return;var n,o,i;if(e instanceof Array){if(e.forEach)e.forEach(t,r);else for(o=e.length,n=0;n<o;n++)if(n in e)t.call(r,e[n],n,e)}else if("length"in e&&e.length-1 in e){for(o=parseInt(e.length,10),n=0;n<o;n++)if(n in e)t.call(r,e[n],n,e)}else for(i in e)if(e.hasOwnProperty(i))t.call(r,e[i],i,e)},O=function(e,n,o){var i=[];if(null===e||void 0===e)return i;return s(e,function(e,t,r){if(n){if(n.call(o,e,t,r))i[i.length]=e}else if(!!e)i[i.length]=e},o),i},o=function(e,n,t,o){var i=arguments.length>2,a=t;if(null===e||void 0===e)e=[];if(s(e,function(e,t,r){if(!i)a=e,i=true;else a=n.call(o,a,e,t,r)}),!i)throw new TypeError("Reduce of empty array with no initial value");return a},w=function(e,t,r){function n(){var e;if("getElementsByClassName"in document)e=document.getElementsByClassName("ws-style-holder-current")[0];else for(var t=document.getElementsByTagName("style"),r=0,n=t.length;r<n;r++)if(i(t[r],"ws-style-holder-current")){e=t[r];break}return e=e||o()}function o(){var e=document.createElement("style"),t=document.getElementsByTagName("head")[0];return e.setAttribute("type","text/css"),e.setAttribute("media","all"),e.className="ws-style-holder ws-style-holder-current",t.appendChild(e),e}function i(e,t){for(var r=" "+e.className+" ",n=t.split(" "),o=0,i=n.length;o<i;o++)if(-1==r.indexOf(" "+n[o]+" "))return false;return true}function a(){var e,t="absolute"===c.css("position"),r=+new Date-f>_.constants.styleLoadTimeout,n=$("#onlineChecker");if(t||r)if(c.remove(),d)if(clearInterval(d),r)n.text(rk("Страница загружается слишком долго. Попробуйте перезагрузить страницу")),n.css("display",""),n.css("zIndex",9999),l.callback();else l.callback();return t}var s="",l=null,u,c,d,f,h;if(t)u=v("cssReady-"),c=$('<div id="'+u+'" style="display: none;" />').appendTo($("body")),s="#"+u+" { position: absolute; }";if(_.compatibility.standartStylesheetProperty)(h=o()).appendChild(document.createTextNode(e+s));else{var p,m,g;if(e+=s,((h=n()).styleSheet.cssText.match(/\{|,/g)||[]).length+(e.match(/\{|,/g)||[]).length>4e3)h.className="ws-style-holder",h=o();try{h.styleSheet.cssText+=e}catch(e){throw _.IoC.resolve("ILogger").error("insertCss","Failed to insert styles to document! IE8/9 Stylesheet limit exceeded (31 per document)?"),e}}if(t)if(f=+new Date,!a())(l=new T).addErrback(function(e){return e}),d=setInterval(a,1);return l},n=(r=J).extend({$protected:{_options:{template:""},_dom:null,_rootConfig:{},_controlsConfig:[]},$constructor:function(){var r=this;if(this._dom=document.createElement("div"),this._dom.innerHTML=this._options.template,!this._dom.firstChild)throw new Error("Wrong template ("+this.getName()+") came from server");var e=this._dom.firstChild;for(var n in this._rootConfig=JSON.parse(e.getAttribute("templateConfig")),this._controlsConfig=JSON.parse(e.getAttribute("config")),e.removeAttribute("templateConfig"),e.removeAttribute("config"),this._controlsConfig.functions)if(this._controlsConfig.functions.hasOwnProperty(n)){var t,o='["'+(t=this._controlsConfig.functions[n]).split("/").join('"]["')+'"]',i=new Function("s","val","return arguments.length == 1 ? s"+o+" : (s"+o+" = val);"),a=r._controlsConfig,s=i(a).split("#");switch(s[0]){case"function":r._dReady.push(g.getHandler(s[1]).addCallback(function(e){i(a,e)}));break;case"moduleFunc":var l=s[1].split("/"),u=l.length>1?l.pop():"",c=l.join("/");r._dReady.push(b.require(c).addCallback(function(e){var t=e[0][u];if(!t)_.IoC.resolve("ILogger").error(rk("Шаблон")+" "+r.getName(),rk("В шаблоне указан обработчик, но в модуле")+" "+c+" "+rk("не найдена функция")+" "+u+" "+rk("для этого обработчика"));else t.wsHandlerPath=c+(u?":"+u:""),i(a,t)}));break;case"floatArea":i(a,function(e){var t=this.getTopParent().getContainer();this.setEnabled(false),g.attachInstance("Lib/Control/FloatArea/FloatArea",{opener:this,template:s[1],target:t,side:"right",autHide:true,animationLength:300,offset:{x:0,y:window.scrollY>t.offset().top?window.scrollY:0},handlers:{onAfterClose:function(){this.getOpener().setEnabled(true)}}})});break;case"dialog":i(a,function(){var e=new T,t=y.createContext(e,null,this.getLinkedContext());g.attachInstance("Lib/Control/Dialog/Dialog",{template:s[1],opener:this,context:t,handlers:{onDestroy:function(){e.callback()}}})});break;case"command":var d=function(e){e.setResult(C.sendCommand.apply(C,[this,s[1]].concat(Array.prototype.slice.call(arguments,1))))};d.isCommand=true,i(a,d);break;case"newpage":case"page":i(a,function(){var e="function"===typeof this.getOpenLink?this.getOpenLink()||s[1]:s[1];if("page"==s[0])window.location=e;else window.open(e)});break;case"menu":i(a,function(){if(E.instanceOfModule(this,"Deprecated/Controls/Button/Button"))this._options.menuName=s[1],this.unsubscribe("onActivated",arguments.callee),this._initMenu(),this._notify("onActivated")})}}for(var n in this._rootConfig)if(this._rootConfig.hasOwnProperty(n)){var t=this._rootConfig[n];if("on"==n.substr(0,2)){var f;t.split("|").forEach(function(e,t){r._dReady.push(g.getHandler(e).addCallback(function(e){return r._loadedHandlers[n]=r._loadedHandlers[n]||[],r._loadedHandlers[n][t]=e}))})}}if(this._rootConfig.style){var h=w(this._rootConfig.style,true,this.getName());if(h)this._dReady.push(h)}var p=O(this._dom.firstChild.childNodes,function(e){return"I"==e.nodeName});if(p.length>0){var m=p[0].getAttribute("spec");if(m){try{m=JSON.parse(m)}catch(e){m=false}if(m)m.js&&r._dReady.push(g.attachSequentally(m.js)),m.css&&r._dReady.push(g.attachSequentally(m.css))}}this._dReady.done()},_getIncludeDescriptorNodes:function(){return O(this._dom.firstChild.childNodes,function(e){return"I"==e.nodeName})},_collectAllControlsToPreload:function(e){return o(e,function(e,t){if(t.children&&t.children.length)e=e.concat(this._collectAllControlsToPreload(t.children));return e.push(t),e},[],this)},isPage:function(){return!this._rootConfig.isApplication},getConfig:function(){for(var e in this._rootConfig)if(this._rootConfig.hasOwnProperty(e))this._mergeAttrToConfig(this._configuration,e,this._rootConfig[e]);return this._configuration},getStyle:function(){return this._rootConfig.windowStyle||""},getAlignment:function(){var e=this._rootConfig.HorizontalAlignment,t=this._rootConfig.VerticalAlignment;return{horizontalAlignment:!e?"Stretch":e,verticalAlignment:!t?"Stretch":t}},getTitle:function(){return this._rootConfig.title},createMarkup:function(e){e.html(this._dom.firstChild.innerHTML)},getDimensions:function(){var e=this._rootConfig.width+"",t=this._rootConfig.height+"";return{width:!e?"":"auto"===e.toLowerCase()?"auto":e.indexOf("%")>=0?e:parseInt(e,10)+"px",height:!t?"":"auto"===t.toLowerCase()?"auto":t.indexOf("%")>=0?t:parseInt(t,10)+"px"}},getControls:function(e){if(e)return[];return this._controlsConfig.children},needSetZindexByOrder:function(){return true}})),r,_,v,g,y,T,C,E,b,n,s,O,o,w;if(t instanceof Function)return t;else for(var i in t)if(t.hasOwnProperty(i))e[i]=t[i];return e}(),se=ae;e["Browser/_TransportOld/XMLTemplate"]=true;var le=function(){"use strict";var e={},t=function(c,_,d,p,v,m,g,f,h,u,y,T){var e,t=function(e,t,r){if(null===e||void 0===e||0===e.length)return;var n,o,i;if(e instanceof Array){if(e.forEach)e.forEach(t,r);else for(o=e.length,n=0;n<o;n++)if(n in e)t.call(r,e[n],n,e)}else if("length"in e&&e.length-1 in e){for(o=parseInt(e.length,10),n=0;n<o;n++)if(n in e)t.call(r,e[n],n,e)}else for(i in e)if(e.hasOwnProperty(i))t.call(r,e[i],i,e)},r=function(e,n,o){var i=[];if(null===e||void 0===e)return i;return t(e,function(e,t,r){if(n){if(n.call(o,e,t,r))i[i.length]=e}else if(!!e)i[i.length]=e},o),i},i=function(e,t,r){function n(){var e;if("getElementsByClassName"in document)e=document.getElementsByClassName("ws-style-holder-current")[0];else for(var t=document.getElementsByTagName("style"),r=0,n=t.length;r<n;r++)if(i(t[r],"ws-style-holder-current")){e=t[r];break}return e=e||o()}function o(){var e=document.createElement("style"),t=document.getElementsByTagName("head")[0];return e.setAttribute("type","text/css"),e.setAttribute("media","all"),e.className="ws-style-holder ws-style-holder-current",t.appendChild(e),e}function i(e,t){for(var r=" "+e.className+" ",n=t.split(" "),o=0,i=n.length;o<i;o++)if(-1==r.indexOf(" "+n[o]+" "))return false;return true}function a(){var e,t="absolute"===c.css("position"),r=+new Date-f>_.constants.styleLoadTimeout,n=$("#onlineChecker");if(t||r)if(c.remove(),d)if(clearInterval(d),r)n.text(rk("Страница загружается слишком долго. Попробуйте перезагрузить страницу")),n.css("display",""),n.css("zIndex",9999),l.callback();else l.callback();return t}var s="",l=null,u,c,d,f,h;if(t)u=T("cssReady-"),c=$('<div id="'+u+'" style="display: none;" />').appendTo($("body")),s="#"+u+" { position: absolute; }";if(_.compatibility.standartStylesheetProperty)(h=o()).appendChild(document.createTextNode(e+s));else{var p,m,g;if(e+=s,((h=n()).styleSheet.cssText.match(/\{|,/g)||[]).length+(e.match(/\{|,/g)||[]).length>4e3)h.className="ws-style-holder",h=o();try{h.styleSheet.cssText+=e}catch(e){throw _.IoC.resolve("ILogger").error("insertCss","Failed to insert styles to document! IE8/9 Stylesheet limit exceeded (31 per document)?"),e}}if(t)if(f=+new Date,!a())(l=new v).addErrback(function(e){return e}),d=setInterval(a,1);return l};return e=c.extend({$protected:{_xml:null,_toText:[],_html:"",_dReady:null,_innerTemplates:[],_templateName:"",_document:void 0,_controlTagCache:""},$constructor:function(e){var t=this;this._xml=e.templateXML,this._document=this._xml.documentElement?this._xml.documentElement:this._xml,this._innerTemplates[this._templateName=e.templateName]=true,this._includeInnerTemplate(new v).addCallbacks(function(){t._assignId(),t._loadEventHandlers()},function(e){return _.IoC.resolve("ILogger").log("Template","Building failed. Reason: "+e.message),e});var r=this._xml.getElementsByTagName("style")[0];if(r){var n=this._findCDATA(r,true);if(n){var o=i(n,true,this.getName());if(o)this._dReady.push(o)}}},_getIncludeDescriptorNodes:function(){var e;if(this._xml.nodeType==d.DOCUMENT_NODE)e=this._xml.firstChild.childNodes;else e=this._xml.childNodes;return r(e,function(e){return"I"==e.nodeName.toUpperCase()})},isPage:function(){return"false"===this._document.getAttribute("isApplication")},_collectAllControlsToPreload:function(e){return this._getControlsByFilter(function(){return true})},_extractControlConfiguration:function(e){var t,r=e.getAttribute("config");if(r)try{t=eval("("+r+")")}catch(e){t={}}else t=this._parseConfiguration(e.getElementsByTagName("configuration")[0]);return t},_findCDATA:function(e,t){for(var r,n,o=0,i=e.childNodes.length;o<i;o++)if((r=e.childNodes[o]).nodeType===d.CDATA_SECTION_NODE){n=t?r.nodeValue:r;break}return n},_includeInnerTemplate:function(n){var u=this,e=this._xml.getElementsByTagName("include"),t=new m,r,o,i,a=[],c=[];if(0===e.length)n.callback();else{for(var s=0,l=e.length;s<l;s++)if(o=(r=e[s]).parentNode,null!==(i=e[s].getAttribute("name")))if(this._innerTemplates[i])return n.errback("Cyclic dependency detected");else a.push(i),c[s]="",function(a,s,l){t.push(p(i).addCallback(function(e){var t=e.documentElement?e.documentElement.childNodes:e.childNodes,r=e.getElementsByTagName("style")[0],n;if(r)c[l]=u._findCDATA(r,true),(e.documentElement?e.documentElement:e).removeChild(r);for(var o=0,i=t.length;o<i;o++){if(n=t[0],u._xml.adoptNode)n=u._xml.adoptNode(n);a.insertBefore(n,s)}return a.removeChild(s),e}))}(o,r,s);else for(var d in r.childNodes)if(r.childNodes.hasOwnProperty(d)){var f=r.childNodes[d];if(f.getAttribute){var h=f.getAttribute("source");if(h)t.push(g.attach(h))}}t.done().getResult().addCallback(function(){for(var e=u._xml.getElementsByTagName("style")[0],t=0,r=a.length;t<r;t++)u._innerTemplates[a[t]]=true;if(e)u._findCDATA(e,false).nodeValue+=c.join("");else(e=u._xml.createElement("style")).appendChild(u._xml.createCDATASection(c.join(""))),u._document.appendChild(e);u._includeInnerTemplate(n)})}return n},_assignId:function(){for(var e=this._getControlTags(this._xml),t=0,r=e.length;t<r;t++){var n=e[t];if(!n.getAttribute("id"))n.setAttribute("id",T())}},_getControlTags:function(e){var t;if(this._controlTagCache)return this._controlTagCache;if(e.querySelectorAll){var r=e.querySelectorAll('div[wsControl="true"]');if(r)t=r}if(!t){t=[];for(var n=e.getElementsByTagName("div"),o=0,i=n.length;o<i;o++){var a=n[o];if(a.getAttribute("wsControl"))t.push(a)}}return this._controlTagCache=t},_getFunctionOptions:function(){var e;if(this._xml.querySelectorAll)if(e=this._xml.querySelectorAll('option[type="function"]'))return e;var t=this._xml.getElementsByTagName("option");e=[];for(var r=0;r<t.length;r++)if("function"===t[r].getAttribute("type"))e.push(t[r]);return e},_loadEventHandlers:function(){for(var e=this._getFunctionOptions(),t=0;t<e.length;t++){var r=e[t].getAttribute("name"),n=e[t].getAttribute("value");if(null!==n&&n.length>0)this._dReady.push(g.getHandler(n))}this._dReady.push(this._processTemplateHandlers()).done(this)},_processTemplateHandlers:function(){for(var n=new m,o=this,e=this._document.attributes,t={},r=0,i=e.length;r<i;r++){var a=e[r],s=a.nodeName;if("on"==s.substring(0,2)&&""!==a.nodeValue)t[s]=a.nodeValue.split("|")}if(!u(t))for(var l in t)if(t.hasOwnProperty(l))(function(r,e){o._loadedHandlers[r]=[];for(var t=0;t<e.length;++t)(function(t){n.push(g.getHandler(e[t]).addCallbacks(function(e){return o._loadedHandlers[r][t]=e},function(e){return _.IoC.resolve("ILogger").error("Template","Error while loading handler "+r+": "+e.message,e),e}))})(t)})(l,t[l]);return n.done().getResult()},getStyle:function(){return this._document.getAttribute("windowStyle")||""},getDimensions:function(){var e=this._document.getAttribute("width"),t=this._document.getAttribute("height");return{width:!e?"":"auto"===e.toLowerCase()?"auto":e.indexOf("%")>=0?e:parseInt(e,10)+"px",height:!t?"":"auto"===t.toLowerCase()?"auto":t.indexOf("%")>=0?t:parseInt(t,10)+"px"}},getAlignment:function(){var e=this._document.getAttribute("HorizontalAlignment"),t=this._document.getAttribute("VerticalAlignment");return{horizontalAlignment:!e?"Stretch":e,verticalAlignment:!t?"Stretch":t}},getTitle:function(){return this._document.getAttribute("title")},getConfig:function(e){var t=this._configuration,r=e||this._document;if(null!==r.attributes)for(var n=0,o=r.attributes.length;n<o;n++){var i=r.attributes[n];this._mergeAttrToConfig(t,i.nodeName,i.nodeValue)}return t},getDeclaredHandlers:function(){return this._loadedHandlers},createMarkup:function(e){var t;if(""===this._html){var r="ws-template"==this._xml.nodeName?this._xml:this._xml.getElementsByTagName("ws-template")[0],n=e.get(0).ownerDocument,o=n.createElement("div"),i=r?r.childNodes:[],a,s=0,l;while(i.length&&s<i.length)if((a=i.item(s)).nodeType==d.ELEMENT_NODE&&"style"!=a.nodeName)a=c._importNode(n,a,true),s++,o.appendChild(a);else s++;var u=o.getElementsByTagName("configuration");for(s=0,l=u.length;s<l;s++)u[0].parentNode.removeChild(u[0]);this._html=t=o.innerHTML.replace(/<\/ ?br>/gi,"").replace(/&amp;/gi,"&")}else t=this._html;e.html(t)},_getControlsByFilter:function(e){for(var t=this._getControlTags(this._xml),r=[],n=0,o=t.length;n<o;n++){var i=t[n];if(e(i)){var a=this._extractControlConfiguration(i);a.type=i.getAttribute("type"),a.id=i.getAttribute("id"),r.push(a)}}return r},getControls:function(t){return this._getControlsByFilter(function(e){return t==e.getAttribute("parentId")})},_parseConfiguration:function(e,n){var o,t,r,i,a=new function(){var r=this;r.mass=n?[]:{},r.push=function(e,t){if(n)r.mass.push(t);else if(null!==e)r.mass[e]=t}};if(e&&e.childNodes)for(var s=e.childNodes,l=0,u=s.length;l<u;l++){var c=s[l];if(c.nodeName&&("option"==c.nodeName||"options"==c.nodeName))if(o=c.getAttribute("name"),r=c.getAttribute("type"),t=c.getAttribute("value"),"array"===r||null===t&&"cdata"!=r){if(null===t)t=this._parseConfiguration(c,"array"===r);a.push(o,t)}else switch(r){case"cdata":a.push(o,this._findCDATA(c,true));break;case"boolean":a.push(o,"true"===t);break;case"moduleFunc":case"function":if("string"===typeof t&&t.length>0){var d=g.getHandler(t);if(!d.isReady()||d.isSuccessful())(function(t){d.addCallback(function(e){if("function"==typeof e)return a.push(t,e),e;else throw new Error("Integrity error! Some serious problems in $ws.core.getHandler()!")})})(o);else throw new Error(t+" function is not ready or don't exist")}break;case"dialog":if("string"===typeof t&&t.length>0)(function(r){a.push(o,function(){var e=new v,t=f.createContext(e,null,this.getLinkedContext());g.attachInstance("Lib/Control/Dialog/Dialog",{template:r,opener:this,context:t,handlers:{onDestroy:function(){e.callback()}}})})})(t);break;case"floatArea":if("string"===typeof t&&t.length>0)(function(t){a.push(o,function(){var e=this.getTopParent().getContainer();this.setEnabled(false),g.attachInstance("Lib/Control/FloatArea/FloatArea",{id:this.getId(),opener:this,name:this.getName()+"-floatArea",template:t,target:e,side:"right",autHide:true,showDelay:300,animationLength:300,offset:{x:0,y:window.scrollY>e.offset().top?window.scrollY:0},handlers:{onAfterClose:function(){this.getOpener().setEnabled(true)}}})})})(t);break;case"command":if("string"===typeof t&&t.length>0)(function(t){a.push(o,function(e){e.setResult(h.sendCommand.apply(h,[this,t].concat(Array.prototype.slice.call(arguments,1))))})})(t);break;case"page":case"newpage":if("string"===typeof t&&t.length>0)(function(t,r){a.push(o,function(){var e="function"===typeof this.getOpenLink?this.getOpenLink()||t:t;if("page"==r)window.location=e;else window.open(e)})})(t,r);break;case"menu":if("string"===typeof t&&t.length>0)(function(e){a.push(o,function(){if(y.instanceOfModule(this,"Deprecated/Controls/Button/Button"))this._options.menu=e,this.unsubscribe("onActivated",arguments.callee),this._initMenu(),this._notify("onActivated")})})(t);break;case null:default:if("null"===t)t=null;if("Infinity"===t)t=1/0;a.push(o,t)}}return a.mass},needSetZindexByOrder:function(){return true}}),e}(J,N,D,ee,R,s,c,u,l,n,d,f);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),ue=le;e["Browser/_Transport/RPC/getInvocationUrl"]=true;var ce=function(){"use strict";var e={},t=function(e,t,s,l){Object.defineProperty(t,"__esModule",{value:true});var u=".";function r(e,t,r,n){var n,o=(n=n||{}).id||0,i=n.url||s.constants.defaultServiceUrl,a=e+u+t;return i+"?id="+encodeURIComponent(o)+"&method="+encodeURIComponent(a)+"&protocol="+encodeURIComponent(s.constants.JSONRPC_PROOTOCOL_VERSION)+"&params="+encodeURIComponent(l.serializeData(r||{}))}t.default=r}(I,e,O,Z);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}();e["Browser/_TransportOld/attachTemplate"]=true;var de=function(){"use strict";var e={},t=function(r,s,l,u,c,d,f,h){var e;function p(e){var t=$("#xmlContent");if(!t.length)t=$('<div id="xmlContent" style="display:none; visibility: hidden;"></div>'),$("body").append(t);if(!t.data(e))t.data(e,true),t.append('<div name="'+e+'">')}function t(o,e){var t,i=false,a="",n=new r;if(e&&"object"==typeof e)i=e.fast||false,a=e.html||"";else i=e,a=arguments[2];return l.store("res://"+o,function(n){function t(e,t,r){n.callback({transportTemplate:e,templateXML:t,template:t,templateName:r})}var e=["Deprecated","Lib"],r=o.indexOf("/")>0?o.split("/")[0]:false;if(e.indexOf(r)>-1||s.constants.modules.hasOwnProperty(r)||"."!==o[0]&&-1===o.indexOf("SBIS3.")&&o.indexOf("/")>-1)I([o],function(e){t(f,e,o)},function(e){n.errback(e)});else if(i&&a)t(c,a,o);else if(o)h(o,i).addCallbacks(function(e){return t(i?c:d,e,o),p(o),e},function(e){return n.errback(e),e});else t(u,"","")}).addCallbacks(function(e){var t=e.transportTemplate;if("string"==typeof t)t=I(t);var r=new t(e);return r.getRenderResult().addCallback(function(){n.callback(r)}).addErrback(function(e){n.errback(new Error("attachTemplate: "+e.message))}),e},function(e){return n.errback(e),e}),n}return{attachTemplate:t,loadTemplateFile:h}}(R,N,m,te,ae,le,ne,ee);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),fe=de;e["Browser/_Transport/RPC/Body"]=true;var he=function(){"use strict";var e={},t=(r=I,n=e,o=O,i=Z,Object.defineProperty(n,"__esModule",{value:true}),n.getBody=function(e,t,r){return JSON.stringify({jsonrpc:"2.0",protocol:o.constants.JSONRPC_PROOTOCOL_VERSION,method:e,params:t,id:void 0!==r?r:1})},n.getURL=function(e,t,r){return"?protocol="+o.constants.JSONRPC_PROOTOCOL_VERSION+"&method="+encodeURI(e)+"&params="+encodeURIComponent(i.serializeData(t))+"&id="+(void 0!==r?r:1)},void(n.getEmptyResponse=function(){return{error:{message:rk("Получен пустой ответ от сервиса"),code:"",details:""}}})),r,n,o,i;if(t instanceof Function)return t;else for(var a in t)if(t.hasOwnProperty(a))e[a]=t[a];return e}();e["Browser/_Transport/RPC"]=true;var pe=function(){"use strict";var e={},t=(r=I,n=e,o=he,i=ie,a=B,s=Q,l=ce,Object.defineProperty(n,"__esModule",{value:true}),n.Body=o,n.ErrorCreator=i,n.Headers=a.default,n.Error=s.default,void(n.getInvocationUrl=l.default)),r,n,o,i,a,s,l;if(t instanceof Function)return t;else for(var u in t)if(t.hasOwnProperty(u))e[u]=t[u];return e}();e["Browser/_TransportOld/prepareGetRPCInvocationURL"]=true;var me=function(){"use strict";var e={},t=function(p,m){var g=",",t;function _(e){if(e)return e;if(t)return t;try{t=I("Core/Context").global}catch(e){}return t}return function e(t,r,n,o,i,a){var s=Object.assign({},n||{});for(var l in s)if(s.hasOwnProperty(l)){var u=s[l];if(null!==u&&"object"===typeof u&&"fieldName"in u){var c=_(o);if(c)s[l]=c.getValue(u.fieldName);else m.IoC.resolve("ILogger").warn("Browser/_TransportOld/prepareGetRPCInvocationURL",'Using context fields in vdom environment is not supported. Parameter name: "'+l+'"')}if("ИдО"===l){var d=s[l];if(!d)return"";if("string"===typeof d){var f=String(d).split(g);if(1===f.length)f=[f[0],""];if(f[0])s[l]=f[0];if(f[1])t=f[1]}}}var h={};if(i)h.url=i;if(a)h.id=a;return p.getInvocationUrl(t,r,s,h)}}(pe,N);if(t instanceof Function)return t;else for(var r in t)if(t.hasOwnProperty(r))e[r]=t[r];return e}(),ge=me;return e.ReportPrinter=W,e.RecordTypes=X,e.RecordSetToXMLSerializer=S,e.RecordSet=H,e.Record=P,e.prepareGetRPCInvocationURL=ge,e.nodeType=t,e.attachTemplate=fe,e.CompoundControlTemplate=oe,e.EmptyTemplate=re,e.Template=G,e.FastTemplate=se,e.XMLTemplate=ue,e.BLObject=F,e});