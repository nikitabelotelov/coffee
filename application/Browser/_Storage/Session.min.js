define("Browser/_Storage/Session",["require","exports","Core/UserInfo","Env/Env","Env/Constants","Browser/_Storage/_storage"],function(e,t,r,n,o,s){"use strict";var i;Object.defineProperty(t,"__esModule",{value:true});var a=s.getSession(),f=4*1e3,u="wsss",c;function l(){if(!o.constants.isBrowserPlatform&&o.constants.isBuildOnServer){var e=process&&process.domain&&process.domain.req||{};c=e.sessionStorage=e.sessionStorage||{}}if(c)return c;var t=a.getItem(u);try{c=JSON.parse(t)||{}}catch(e){c={}}if(!r.isValid(c.user))a.removeItem(u),(c={}).user=r.getCurrent();return c}if(o.constants.isBrowserPlatform){var d=n.detection.firefox?"beforeunload":"unload";window.addEventListener(d,function(){a.setItem(u,JSON.stringify(l()))})}function v(){if(!o.constants.isBrowserPlatform)return;if(i)clearTimeout(i);i=setTimeout(function(){a.setItem(u,JSON.stringify(l())),i=null},f)}var m={get:function(e){return l()[e]},set:function(e,t){if(!e)return;if(null==t&&"object"==typeof e&&"[object Object]"==Object.prototype.toString.call(e)){for(var r in e)if(e.hasOwnProperty(r))l()[r]=e[r]}else l()[e]=t;v()},remove:function(e){delete l()[e],v()},toObject:function(){return l()}};t.default=m});