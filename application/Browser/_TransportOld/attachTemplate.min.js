define("Browser/_TransportOld/attachTemplate",["Core/Deferred","Env/Env","Core/Storage","Browser/_TransportOld/EmptyTemplate","Browser/_TransportOld/FastTemplate","Browser/_TransportOld/XMLTemplate","Browser/_TransportOld/CompoundControlTemplate","Browser/_TransportOld/loadTemplateFile"],function(r,i,s,d,p,f,c,u){var e;function m(e){var t=$("#xmlContent");if(!t.length)t=$('<div id="xmlContent" style="display:none; visibility: hidden;"></div>'),$("body").append(t);if(!t.data(e))t.data(e,true),t.append('<div name="'+e+'">')}function t(n,e){var t,l=false,o="",a=new r;if(e&&"object"==typeof e)l=e.fast||false,o=e.html||"";else l=e,o=arguments[2];return s.store("res://"+n,function(a){function t(e,t,r){a.callback({transportTemplate:e,templateXML:t,template:t,templateName:r})}var e=["Deprecated","Lib"],r=n.indexOf("/")>0?n.split("/")[0]:false;if(e.indexOf(r)>-1||i.constants.modules.hasOwnProperty(r)||"."!==n[0]&&-1===n.indexOf("SBIS3.")&&n.indexOf("/")>-1)require([n],function(e){t(c,e,n)},function(e){a.errback(e)});else if(l&&o)t(p,o,n);else if(n)u(n,l).addCallbacks(function(e){return t(l?p:f,e,n),m(n),e},function(e){return a.errback(e),e});else t(d,"","")}).addCallbacks(function(e){var t=e.transportTemplate;if("string"==typeof t)t=require(t);var r=new t(e);return r.getRenderResult().addCallback(function(){a.callback(r)}).addErrback(function(e){a.errback(new Error("attachTemplate: "+e.message))}),e},function(e){return a.errback(e),e}),a}return{attachTemplate:t,loadTemplateFile:u}});