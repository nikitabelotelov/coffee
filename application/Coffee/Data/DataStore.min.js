define("Coffee/Data/DataStore",["require","exports"],function(e,a){Object.defineProperty(a,"__esModule",{value:true});var o={G1:{val1:"val1",val2:"val2"},G2:{val3:"val3",val4:"val4"},G3:{val5:"val5"}};a.SettingsStruct=o;var t={val1:"val1",val2:"val2"},s={val3:"val3",val4:"val4"},n={val5:"val5"},l={socket:null,messageHandlers:new Array,_parseDataStructure:function(e,a){var t={};for(var o in a)for(var s in t[o]={},a[o])t[o][s]=e[s];return t},initDataStore:function(){var t=this;return new Promise(function(e,a){t.socket=new WebSocket("ws://localhost:8080"),t.socket.onopen=function(){console.log("Соединение установлено."),e()},t.socket.onclose=function(e){if(e.wasClean)console.log("Соединение закрыто чисто");else console.log("Обрыв соединения");console.log("Код: "+e.code+" причина: "+e.reason)},t.socket.onmessage=function(e){t._handleMessage(e.data),console.log("Получены данные "+e.data)},t.socket.onerror=function(e){console.log("Ошибка "+e.message),a()}})},onSettingsUpdated:function(e){this.messageHandlers["settingsUpdated"]=e},_handleMessage:function(e){var a=JSON.parse(e),t=a.data;if(a.type)switch(a.type){case"settingsUpdated":t=this._parseDataStructure(t,o);default:if(this.messageHandlers[a.type])this.messageHandlers[a.type].call(this,t)}},closeConnection:function(){this.socket.close()}};return a.DataStore=l,a});