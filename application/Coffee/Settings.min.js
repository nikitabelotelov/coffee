define("Coffee/Settings",["require","exports","tslib","Core/Control","wml!Coffee/Settings/Settings","Coffee/Data/DataStore","Coffee/Settings/SettingsModel/SettingsModel","css!Coffee/Settings/Settings"],function(t,e,n,o,i,s,a){var r=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._template=i,t}return n.__extends(t,e),t.prototype._beforeMount=function(t){var o=this,e;return new Promise(function(t,e){var n=s.DataStore.getInitialSettings();if(n)o.saveSettings(n),t();else s.DataStore.on("initialSettings",function(){o.saveSettings(s.DataStore.getInitialSettings()),o._forceUpdate(),s.DataStore.removeHandler("initialSettings"),t()})})},t.prototype.settingChangedHandler=function(t,e){s.DataStore.sendSettings(this.settingsInfo)},t.prototype.saveSettings=function(t){var e=a.SettingsModel.parseSettings(t);this.settingsInfo={settingsInfo:new a.SettingsModel(e)}},t.prototype.checkUpdate=function(){s.DataStore.closeConnection(),setTimeout(function(){fetch("/Update").then(function(){console.log("Update started")},function(){console.error("Update failed")})},2e3)},t}(o),e;return r});