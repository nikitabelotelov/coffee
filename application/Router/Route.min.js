define("Router/Route",["require","exports","tslib","Core/Control","wml!Router/Route","Router/Controller","Router/Data","Router/MaskResolver","Router/History"],function(t,e,r,o,s,i,n,l,a){var u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._template=s,t._urlOptions=null,t._isResolved=false,t}return r.__extends(t,e),t.prototype._beforeMount=function(t){this._urlOptions={},this._applyNewUrl(t.mask,t)},t.prototype._afterMount=function(){this._register(),this._checkUrlResolved()},t.prototype._beforeUpdate=function(t){this._applyNewUrl(t.mask,t)},t.prototype._beforeUnmount=function(){this._unregister()},t.prototype._register=function(){var r=this;i.addRoute(this,function(t,e){return r._beforeApplyNewUrl(t,e)},function(){return r._forceUpdate(),Promise.resolve(true)})},t.prototype._unregister=function(){i.removeRoute(this)},t.prototype._beforeApplyNewUrl=function(t,e){var r;this._urlOptions=l.calculateUrlParams(this._options.mask,t.state);var o=this._hasResolvedParams();if(this._fillUrlOptionsFromCfg(this._options),o&&!this._isResolved)r=this._notify("enter",[t,e]),this._isResolved=true;else if(!o&&this._isResolved)r=this._notify("leave",[t,e]),this._isResolved=false;else r=Promise.resolve(true);return r},t.prototype._applyNewUrl=function(t,e){this._urlOptions=l.calculateUrlParams(t);var r=this._hasResolvedParams();return this._fillUrlOptionsFromCfg(e),r},t.prototype._hasResolvedParams=function(){var t=false;for(var e in this._urlOptions)if(this._urlOptions.hasOwnProperty(e))if(void 0!==this._urlOptions[e]){t=true;break}return t},t.prototype._fillUrlOptionsFromCfg=function(t){for(var e in t)if(!this._urlOptions.hasOwnProperty(e)&&t.hasOwnProperty(e)&&"mask"!==e&&"content"!==e&&"_logicParent"!==e)this._urlOptions[e]=t[e]},t.prototype._checkUrlResolved=function(){this._urlOptions=l.calculateUrlParams(this._options.mask,n.getRelativeUrl());var t=this._hasResolvedParams();this._fillUrlOptionsFromCfg(this._options);var e=a.getCurrentState(),r=a.getPrevState();if(t){if(this._isResolved=true,!r)r={state:l.calculateHref(this._options.mask,{clear:true})};return this._notify("enter",[e,r])}return Promise.resolve(true)},t}(o),e;return u});