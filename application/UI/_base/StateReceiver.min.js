define("UI/_base/StateReceiver",["require","exports","Core/Serializer","Env/Env","View/Executor/Utils"],function(e,r,c,t,l){"use strict";function f(e){var r,t={},i=e._linksStorage,a;for(var o in i)if(i.hasOwnProperty(o))if((r=i[o]).module)t[(a=c.parseDeclaration(r.module)).name]=true;var n=e._depsStorage||{};for(var s in n)if(n.hasOwnProperty(s))t[s]=true;return t}Object.defineProperty(r,"__esModule",{value:true});var i=function(){function e(){this.receivedStateObjectsArray={},this.deserialized={}}return e.prototype.serialize=function(){var e,r={},t={},i=this.receivedStateObjectsArray;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a].getState();if(o)r[a]=o}e=new c;var n=JSON.stringify(r,e.serialize);l.Common.componentOptsReArray.forEach(function(e){n=n.replace(e.toFind,e.toReplace)}),n=n.replace(/\\"/g,'\\\\"');var s=f(e);for(var d in s)if(s.hasOwnProperty(d))t[d]=true;return{serialized:n,additionalDeps:t}},e.prototype.deserialize=function(r){var e=new c;try{this.deserialized=JSON.parse(r,e.deserialize)}catch(e){t.IoC.resolve("ILogger").error("Deserialize","Cant't deserialize "+r)}},e.prototype.register=function(e,r){if(this.deserialized[e])r.setState(this.deserialized[e]),delete this.deserialized[e];this.receivedStateObjectsArray[e]=r},e.prototype.unregister=function(e){delete this.receivedStateObjectsArray[e]},e}();r.default=i});