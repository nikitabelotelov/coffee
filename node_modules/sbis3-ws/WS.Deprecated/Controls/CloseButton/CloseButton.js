/**
 * Created by elifantievon on 20.06.14.
 */
define('Deprecated/Controls/CloseButton/CloseButton', [
   'Env/Env',
   "Deprecated/Controls/Button/Button",
   "css!Deprecated/Controls/CloseButton/CloseButton"
], function(Env, button){

   var CloseButtonConfig = {
      $protected: {
         _options: {
            allowChangeEnable: false,
            enabled: true,
            caption: '',
            cssClass: 'sbisname-window-title-close'
         }
      }
   };

   if (Env.constants.browser.isMacOSDesktop) {
      //Стандартную обработку события "click" нужно выключить. См. комментарий в конструкторе.
      CloseButtonConfig._onClickHandler = function () {};

      CloseButtonConfig.$constructor = function () {
         //Хак для Сафари на Маке: в нём после прокрутки плав. панели вертикальная крутилка пропадает, но
         //клик сквозь только что пропавшую полосу прокрутки не доходит, а mouseup доходит.
         //Поэтому для этой кнопки мы эмулируем клик через mouseup, а обработку клика выключаем
         this.getContainer().bind('mouseup', CloseButton.superclass._onClickHandler.bind(this));
      };
   }

   var CloseButton = button.extend(CloseButtonConfig);

   return CloseButton;

});
